 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 16:39 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 5.51234913367983      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:   80 x  80 x  80
                              FFT-box:   33 x  33 x  33
                                  PPD:    5 x   5 x   1
Grid space d1=  1.181078945625a0 (KE cutoff=   5.44561Eh = 148.18246eV)
Grid space d2=  1.181078945625a0 (KE cutoff=   5.44561Eh = 148.18246eV)
Grid space d3=  1.181078945625a0 (KE cutoff=   5.44561Eh = 148.18246eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:     80    80    80
          Real-space ('12') slabs/node (min max mean):     26    27    26
         Recip-space ('23') slabs/node (min max mean):     13    14    13
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    160   160   160
          Real-space ('12') slabs/node (min max mean):     53    54    53
         Recip-space ('23') slabs/node (min max mean):     27    27    27
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1108      4780
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  391    0.0153846154    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   15    1   33.0740948021
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 5251.4750983772   -7.1198707144   10.1555137512   -2.4512395500
  2 2089.3361115865   -3.1439684010   13.3512176305   -3.1746868256
  3 1078.8951212360   -2.9482890732   13.5590305904   -3.2264338251
  4  553.5467430338   -2.9069446141   13.6036957793   -3.2392735075
  5  280.3760812825   -2.8934287111   13.6184238135   -3.2441443872
  6  138.3286988658   -2.8875288540   13.6248815056   -3.2464463266
  7   64.4642655176   -2.8846785616   13.6280075469   -3.2476045029
  8   26.0548012432   -2.8832614931   13.6295632814   -3.2481957844
  9    6.0818910794   -2.8825510683   13.6303437170   -3.2484986802
 10   -4.3040183472   -2.8821939068   13.6307362642   -3.2486540056
 11   -9.7046897687   -2.8820141459   13.6309339178   -3.2487337030
 12  -12.5130383146   -2.8819236265   13.6310334869   -3.2487746169
 13  -13.9733793199   -2.8818780346   13.6310836569   -3.2487956318
 14  -14.7327565495   -2.8818550690   13.6311089390   -3.2488064317
 15  -15.1276326751   -2.8818435004   13.6311216799   -3.2488119850
 16  -15.3329682501   -2.8818376728   13.6311281009   -3.2488148421
 17  -15.4397427473   -2.8818347374   13.6311313367   -3.2488163129
 18  -15.4952654867   -2.8818332587   13.6311329674   -3.2488170704
 19  -15.5241373127   -2.8818325140   13.6311337892   -3.2488174609
 20  -15.5391506634   -2.8818321389   13.6311342033   -3.2488176622
 21  -15.5469576067   -2.8818319500   13.6311344120   -3.2488177661
 22  -15.5510172177   -2.8818318548   13.6311345171   -3.2488178197
 23  -15.5531282159   -2.8818318069   13.6311345701   -3.2488178474
 24  -15.5542259352   -2.8818317828   13.6311345968   -3.2488178618
 25  -15.5547967493   -2.8818317707   13.6311346102   -3.2488178692
 26  -15.5550935727   -2.8818317646   13.6311346170   -3.2488178730
 27  -15.5552479210   -2.8818317615   13.6311346204   -3.2488178750
 28  -15.5553281821   -2.8818317599   13.6311346222   -3.2488178760
 29  -15.5553699179   -2.8818317592   13.6311346230   -3.2488178765
 30  -15.5553916205   -2.8818317588   13.6311346235   -3.2488178768
 31  -15.5554029059   -2.8818317586   13.6311346237   -3.2488178770
 32  -15.5554087743   -2.8818317585   13.6311346238   -3.2488178770
 33  -15.5554118258   -2.8818317584   13.6311346238   -3.2488178771
 34  -15.5554134126   -2.8818317584   13.6311346239   -3.2488178771
 35  -15.5554142378   -2.8818317584   13.6311346239   -3.2488178771
 36  -15.5554146669   -2.8818317584   13.6311346239   -3.2488178771
 37  -15.5554148900   -2.8818317584   13.6311346239   -3.2488178771
 38  -15.5554150060   -2.8818317584   13.6311346239   -3.2488178771
 39  -15.5554150663   -2.8818317584   13.6311346239   -3.2488178771
Atom SCF converged after  39 iterations to a total energy of    -15.55541507

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  391    0.0153846154    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   15    0   33.0740948021
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  876.6359324468   -0.2254400117    0.2820976042   -0.2424203342
  2  350.3962719589   -0.2112290261    0.3031866271   -0.2589000736
  3  181.9936447181   -0.2047325092    0.3114374215   -0.2660309815
  4   94.4241075705   -0.2012721369    0.3157616087   -0.2698689054
  5   48.8881734202   -0.1995378153    0.3179173821   -0.2718184456
  6   25.2096586050   -0.1986900183    0.3189668019   -0.2727839812
  7   12.8969238797   -0.1982801591    0.3194717963   -0.2732568660
  8    6.4943469053   -0.1980829606    0.3197134975   -0.2734874788
  9    3.1650274442   -0.1979882323    0.3198289240   -0.2735998644
 10    1.4337902993   -0.1979427221    0.3198840179   -0.2736547040
 11    0.5335507356   -0.1979208338    0.3199103255   -0.2736815284
 12    0.0654276485   -0.1979102887    0.3199228992   -0.2736946902
 13   -0.1779958149   -0.1979051980    0.3199289164   -0.2737011712
 14   -0.3045758478   -0.1979027348    0.3199318000   -0.2737043748
 15   -0.3703974334   -0.1979015400    0.3199331840   -0.2737059646
 16   -0.4046246690   -0.1979009589    0.3199338493   -0.2737067569
 17   -0.4224228507   -0.1979006756    0.3199341696   -0.2737071533
 18   -0.4316779219   -0.1979005370    0.3199343241   -0.2737073526
 19   -0.4364905710   -0.1979004691    0.3199343987   -0.2737074531
 20   -0.4389931564   -0.1979004357    0.3199344348   -0.2737075040
 21   -0.4402945057   -0.1979004193    0.3199344523   -0.2737075299
 22   -0.4409712104   -0.1979004111    0.3199344607   -0.2737075432
 23   -0.4413230986   -0.1979004071    0.3199344648   -0.2737075500
 24   -0.4415060815   -0.1979004051    0.3199344668   -0.2737075534
 25   -0.4416012332   -0.1979004041    0.3199344678   -0.2737075552
 26   -0.4416507124   -0.1979004036    0.3199344683   -0.2737075562
 27   -0.4416764418   -0.1979004034    0.3199344685   -0.2737075567
 28   -0.4416898212   -0.1979004032    0.3199344686   -0.2737075569
 29   -0.4416967785   -0.1979004032    0.3199344687   -0.2737075570
 30   -0.4417003964   -0.1979004031    0.3199344687   -0.2737075571
 31   -0.4417022777   -0.1979004031    0.3199344687   -0.2737075572
 32   -0.4417032560   -0.1979004031    0.3199344687   -0.2737075572
 33   -0.4417037647   -0.1979004031    0.3199344687   -0.2737075572
 34   -0.4417040292   -0.1979004031    0.3199344687   -0.2737075572
 35   -0.4417041668   -0.1979004031    0.3199344687   -0.2737075572
 36   -0.4417042383   -0.1979004031    0.3199344687   -0.2737075572
Atom SCF converged after  36 iterations to a total energy of     -0.44170424
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20011616E+01     0.93018761E+00
               2       0.18191086E+01     0.86776217E+00
               3       0.16240512E+01     0.76105585E+00
               4       0.14222728E+01     0.60084315E+00
               5       0.12071286E+01     0.41300942E+00
               6       0.96764586E+00     0.31956207E+00
               7       0.69845415E+00     0.23675994E+00
               8       0.41578638E+00     0.13842167E+00
               9       0.16668161E+00     0.53163322E-01
              10       0.27742891E-01     0.87520492E-02
              11       0.76966639E-03     0.24280688E-03
              12       0.59238635E-06     0.18688029E-06
              13       0.35099192E-12     0.11113332E-12
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -0.76702610780634    0.5869535
               2          -0.87883541875990    0.5789400
               3          -1.01652119776979    0.5711070
               4          -1.16354901436836    0.5697180
               5          -1.28596652863326    0.5683379
               6          -1.36493396998782    0.5413521
               7          -1.41199652486720    0.5111747
               8          -1.43021305895210    0.5008247
               9          -1.43233894294674    0.5000045
              10          -1.43236457346343    0.5000060
              11          -1.43236457723375    0.9990501
              12          -1.43236457723375    0.9990501
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999993]
Closest occupancy to 0.5:     0.99999999999999
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -14.555139574131=    -14.555139574131+      0.000000000000
    Trial step:       1.000000000000
            G0:     -10.257656175267
WARNING: minimum value of charge density: -0.0706
      Q1=E1+P1:     351.068079249028=    -23.166447305355+    374.234526554384
Quadratic term:    -375.880874998426
   Linear term:     -10.257656175267
  Optimal step:       0.013644823211
 Predicted min:     -14.625121526665
    !!! Quadratic minimum step length accepted !!!
 1    -14.55513957413075 0.53379293154 0.09882386844 0.0136  0.000    8.00000000
WARNING: minimum value of charge density: -0.0001
      Q0=E0+P0:     -14.687199813318=    -14.694782993590+      0.007583180272
    Trial step:       0.116811057742
            G0:      -0.047955979673
WARNING: minimum value of charge density: -0.0001
      Q1=E1+P1:     -14.692745360898=    -14.700255197646+      0.007509836748
Quadratic term:      -0.000056241131
   Linear term:      -0.005601788711
  Optimal step:       5.817369366087
    !!! Quadratic fit may be unreliable; taking second trial step !!!
WARNING: minimum value of charge density: -0.0004
      Q2=E2+P2:     -14.713539804718=    -14.937333058130+      0.223793253412
Quadratic term:      -0.252637655668
   Linear term:      -0.278977647069
  Optimal step:       3.211944026293
 2    -14.69478299358972 0.47207281131 0.09611166829 3.2119 -0.879    8.00000000
WARNING: minimum value of charge density: -0.0002
      Q0=E0+P0:     -14.782795567281=    -14.836280185431+      0.053484618150
    Trial step:       4.322622442933
            G0:      -7.528147242284
WARNING: minimum value of charge density: -0.7602
      Q1=E1+P1:   52620.649149099576=     -5.206768126729+  52625.855917226305
Quadratic term:  -52667.973282890060
   Linear term:     -32.541338223200
  Optimal step:       0.001335383822
    !!! Quadratic fit may be unreliable; taking second trial step !!!
WARNING: minimum value of charge density: -0.0003
      Q2=E2+P2:     -14.792787423514=    -14.847254448230+      0.054467024716
Quadratic term:      -0.000061109805
   Linear term:      -0.010052966038
  Optimal step:       0.109839724327
 3    -14.83628018543142 0.45676204012 0.04336320891 0.1098  3.255    8.00000000
WARNING: minimum value of charge density: -0.0012

======================== Penalty functional minimisation =======================
   Final total energy     :     -15.712446110854
   Final penalty energy   :       0.683962288906
   RMS occupancy error    :       0.168815
   Occupancy bounds       : [-0.173, 1.255]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.168815 (step -0.2877 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.014815 (step -0.4821 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000544 (step -0.5009 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000001 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.642092687426
             Q0:     -14.674280437817
             G0:      -0.025344050150
   RMS gradient:       0.026533024574
     Trial step:       0.500000000000
             Q1:     -14.677521791233
 Quadratic coef:       0.009430671660
 Linear coef   :      -0.012672025075
           Qmin:     -14.678537298444
Quadratic minimum step length (  0.335925836789) accepted
    Initial Ne1:       7.99999471
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000592 (step -0.4989 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.67428043781719 0.00000000000 0.01989975139 0.3359  0.000    8.00000000
      ideal mu1:      -0.632359178243
             Q0:     -14.678536826711
             G0:      -0.001885635365
   RMS gradient:       0.007226487809
     Trial step:       0.409832793215
             Q1:     -14.678729841525
 Quadratic coef:       0.000579780395
 Linear coef   :      -0.000772795209
           Qmin:     -14.678794343367
Quadratic minimum step length (  0.273135157428) accepted
    Initial Ne1:       7.99999968
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000097 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.67853682671122 0.00053210758 0.00541986586 0.2731  0.074    8.00000000
      ideal mu1:      -0.628946458097
             Q0:     -14.678794568183
             G0:      -0.000033166922
   RMS gradient:       0.000959293553
     Trial step:       0.334573974621
             Q1:     -14.678801760174
 Quadratic coef:       0.000003904798
 Linear coef   :      -0.000011096789
           Qmin:     -14.678802451992
Quadratic minimum step length (  0.475401946085) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.67879456818273 0.00003466649 0.00071947018 0.4754  0.018    8.00000000
      ideal mu1:      -0.629024451004
             Q0:     -14.678802452645
             G0:      -0.000005447682
   RMS gradient:       0.000388982765
     Trial step:       0.398819656793
             Q1:     -14.678803351678
 Quadratic coef:       0.000001273610
 Linear coef   :      -0.000002172643
           Qmin:     -14.678803379220
Quadratic minimum step length (  0.340171997022) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.67880245264510 0.00000100535 0.00029173707 0.3402  0.164    8.00000000
      ideal mu1:      -0.629063253425
             Q0:     -14.678803379238
             G0:      -0.000000070413
   RMS gradient:       0.000044225227
     Trial step:       0.368330393944
             Q1:     -14.678803395014
 Quadratic coef:       0.000000010159
 Linear coef   :      -0.000000025935
           Qmin:     -14.678803395791
Quadratic minimum step length (  0.470163242282) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.67880337923787 0.00000013528 0.00003316892 0.4702  0.013    8.00000000
      ideal mu1:      -0.629060116754
             Q0:     -14.678803395791
             G0:      -0.000000001328
   RMS gradient:       0.000006073578
     Trial step:       0.416143499586
             Q1:     -14.678803396096
 Quadratic coef:       0.000000000247
 Linear coef   :      -0.000000000553
           Qmin:     -14.678803396100
Quadratic minimum step length (  0.464867678760) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -14.67880339579091 0.00000000210 0.00000455518 0.4649  0.019    8.00000000
      ideal mu1:      -0.629060750392
             Q0:     -14.678803396100
             G0:      -0.000000000345
   RMS gradient:       0.000003096592
     Trial step:       0.439831402566
             Q1:     -14.678803396125
 Quadratic coef:       0.000000000127
 Linear coef   :      -0.000000000152
           Qmin:     -14.678803396145
Quadratic minimum step length (  0.263204456905) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -14.67880339609958 0.00000000004 0.00000232244 0.2632  0.000    8.00000000
      ideal mu1:      -0.629060270696
             Q0:     -14.678803396145
             G0:      -0.000000000036
   RMS gradient:       0.000000995813
     Trial step:       0.340243420865
             Q1:     -14.678803396154
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000012
           Qmin:     -14.678803396156
Quadratic minimum step length (  0.611619659975) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.67880339614499 0.00000000001 0.00000074686 0.6116  0.103    8.00000000
      ideal mu1:      -0.629060393777
             Q0:     -14.678803396156
             G0:      -0.000000000002
   RMS gradient:       0.000000229110
     Trial step:       0.456179312747
             Q1:     -14.678803396156
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -14.678803396156
Quadratic minimum step length (  0.457215065200) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.67880339615570 0.00000000000 0.00000017183 0.4572  0.053    8.00000000
      ideal mu1:      -0.629060363271
10    -14.67880339615609 0.00000000000 0.00000003110 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.07381511598814              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.34610582E+00     0.27504467E+00
               2       0.10181276E+00     0.86800758E-01
               3       0.10129702E-01     0.86787142E-02
               4       0.10129059E-03     0.86781059E-04
               5       0.10127952E-07     0.86771554E-08
               6       0.93179628E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18800015E+00     0.13585914E+00
               2       0.27162073E-01     0.21916172E-01
               3       0.70408903E-03     0.57705637E-03
               4       0.48845686E-06     0.40038819E-06
               5       0.23518747E-12     0.19262369E-12
================================================================================
RMS gradient                =       0.07381511598814
Trial step length           =               0.122474
Gradient along search dir.  =        -17.95337209279
Functional at step 0        =     -14.67880339615609
Functional at step 1        =     -14.60393217173272
Functional predicted        =     -15.21040946280195
Selected quadratic step     =               0.059221
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.22380986
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.023731 (step -0.4450 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000513 (step -0.4989 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.614565127124
             Q0:     -15.158020203843
             G0:      -0.217740193229
   RMS gradient:       0.077771065962
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000608 (step -0.4984 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -15.15802020384269 0.00000000000 0.05832829947 0.1000  0.000    8.00000000
      ideal mu1:      -0.604337767154
             Q0:     -15.177394384257
             G0:      -0.237119473274
   RMS gradient:       0.060838844690
    Initial Ne1:       8.00000025
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001933 (step -0.4950 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.17739438425682 0.00136087621 0.04562913321 0.1000  0.612    8.00000000
      ideal mu1:      -0.589210636309
             Q0:     -15.196368387029
             G0:      -0.104659989889
   RMS gradient:       0.037442555487
     Trial step:       0.456696895348
             Q1:     -15.192099712563
 Quadratic coef:       0.052066566916
 Linear coef   :      -0.047797892450
           Qmin:     -15.207338183282
Quadratic minimum step length (  0.209627313447) accepted
    Initial Ne1:       8.00000020
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.005222 (step -0.4868 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.19636838702896 0.00264083420 0.02808191662 0.2096  0.379    8.00000000
      ideal mu1:      -0.565714425444
             Q0:     -15.207824144528
             G0:      -0.004410459922
   RMS gradient:       0.010456241809
     Trial step:       0.309412577688
             Q1:     -15.208639792346
 Quadratic coef:       0.000549003955
 Linear coef   :      -0.001364651773
           Qmin:     -15.208672168684
Quadratic minimum step length (  0.384551348583) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001268 (step -0.4968 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.20782414452815 0.00287540057 0.00784218136 0.3846  0.078    8.00000000
      ideal mu1:      -0.566698999353
             Q0:     -15.208695692992
             G0:      -0.000871262547
   RMS gradient:       0.004840821955
     Trial step:       0.344942058929
             Q1:     -15.208848485816
 Quadratic coef:       0.000147742272
 Linear coef   :      -0.000300535097
           Qmin:     -15.208848528980
Quadratic minimum step length (  0.350837960844) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000289 (step -0.4993 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.20869569299184 0.00014948752 0.00363061647 0.3508  0.214    8.00000000
      ideal mu1:      -0.569500601211
             Q0:     -15.208849786470
             G0:      -0.000094230978
   RMS gradient:       0.001611125842
     Trial step:       0.347877519487
             Q1:     -15.208866067648
 Quadratic coef:       0.000016499661
 Linear coef   :      -0.000032780839
           Qmin:     -15.208866068371
Quadratic minimum step length (  0.345574284766) accepted
    Initial Ne1:       8.00000062
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000036 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.20884978646960 0.00002597603 0.00120834422 0.3456  0.111    8.00000000
      ideal mu1:      -0.570097318166
             Q0:     -15.208866088733
             G0:      -0.000023830477
   RMS gradient:       0.000813607832
     Trial step:       0.346723989627
             Q1:     -15.208871500166
 Quadratic coef:       0.000002851165
 Linear coef   :      -0.000008262598
           Qmin:     -15.208872074929
Quadratic minimum step length (  0.502398267278) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.20886608873331 0.00000236613 0.00061020588 0.5024  0.000    8.00000000
      ideal mu1:      -0.569985747412
             Q0:     -15.208872074914
             G0:      -0.000003328722
   RMS gradient:       0.000304081100
     Trial step:       0.417364986088
             Q1:     -15.208872537653
 Quadratic coef:       0.000000926553
 Linear coef   :      -0.000001389292
           Qmin:     -15.208872595697
Quadratic minimum step length (  0.312902796854) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.20887207491394 0.00000074827 0.00022806083 0.3129  0.140    8.00000000
      ideal mu1:      -0.569912040637
             Q0:     -15.208872595698
             G0:      -0.000000091143
   RMS gradient:       0.000050316420
     Trial step:       0.361378847549
             Q1:     -15.208872615330
 Quadratic coef:       0.000000013305
 Linear coef   :      -0.000000032937
           Qmin:     -15.208872616082
Quadratic minimum step length (  0.447304266876) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.20887259569771 0.00000007419 0.00003773732 0.4473  0.027    8.00000000
      ideal mu1:      -0.569951617971
10    -15.20887261608213 0.00000000263 0.00000864546 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.02592774302058              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.74804366E-01     0.65661795E-01
               2       0.45653268E-02     0.42405962E-02
               3       0.18934866E-04     0.17495345E-04
               4       0.32103399E-09     0.29624492E-09
               5       0.11413961E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16026465E-01     0.14101505E-01
               2       0.20820235E-03     0.19567217E-03
               3       0.39777870E-07     0.37263487E-07
               4       0.15137757E-14     0.12212453E-14
================================================================================
RMS gradient                =       0.02592774302058
Trial step length           =               0.085165
Gradient along search dir.  =         -2.17716124193
Functional at step 0        =     -15.20887261608213
Functional at step 1        =     -15.28187499091647
Functional predicted        =     -15.28532949654787
Selected quadratic step     =               0.070235
Conjugate gradients coeff.  =               0.123378
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.10422134
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010577 (step -0.4734 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000089 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.583034641462
             Q0:     -15.283772972690
             G0:      -0.025902284012
   RMS gradient:       0.026823644220
     Trial step:       0.402052609079
             Q1:     -15.290072279480
 Quadratic coef:       0.004114774079
 Linear coef   :      -0.010414080868
           Qmin:     -15.290362221471
Quadratic minimum step length (  0.508777432734) accepted
    Initial Ne1:       7.99999986
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001892 (step -0.4951 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.28377297269049 0.00000000000 0.02011773247 0.5088  0.000    8.00000000
      ideal mu1:      -0.566891865505
             Q0:     -15.290415154774
             G0:      -0.001268562304
   RMS gradient:       0.005883115388
     Trial step:       0.452277894962
             Q1:     -15.290715371605
 Quadratic coef:       0.000273525857
 Linear coef   :      -0.000573742689
           Qmin:     -15.290716022740
Quadratic minimum step length (  0.474344798654) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000206 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.29041515477422 0.00082365610 0.00441233654 0.4743  0.048    8.00000000
      ideal mu1:      -0.566349317509
             Q0:     -15.290716650613
             G0:      -0.000176923342
   RMS gradient:       0.002213871557
     Trial step:       0.463179951014
             Q1:     -15.290745384390
 Quadratic coef:       0.000053213567
 Linear coef   :      -0.000081947345
           Qmin:     -15.290748199744
Quadratic minimum step length (  0.356641822129) accepted
    Initial Ne1:       8.00000023
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000031 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.29071665061277 0.00004005439 0.00166040378 0.3566  0.142    8.00000000
      ideal mu1:      -0.567606111260
             Q0:     -15.290748221793
             G0:      -0.000001200937
   RMS gradient:       0.000182603720
     Trial step:       0.406434916934
             Q1:     -15.290748591814
 Quadratic coef:       0.000000118081
 Linear coef   :      -0.000000488103
           Qmin:     -15.290748726200
Quadratic minimum step length (  0.840021808862) accepted
    Initial Ne1:       7.99999983
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.29074822179283 0.00000455823 0.00013695279 0.8400  0.007    8.00000000
      ideal mu1:      -0.567613489343
             Q0:     -15.290748726202
             G0:      -0.000000169222
   RMS gradient:       0.000068561211
     Trial step:       0.584306592559
             Q1:     -15.290748739784
 Quadratic coef:       0.000000085296
 Linear coef   :      -0.000000098878
           Qmin:     -15.290748754858
Quadratic minimum step length (  0.338673077525) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.29074872620229 0.00000006358 0.00005142091 0.3387  0.141    8.00000000
      ideal mu1:      -0.567608321524
             Q0:     -15.290748754858
             G0:      -0.000000003716
   RMS gradient:       0.000010159993
     Trial step:       0.444847065765
             Q1:     -15.290748755726
 Quadratic coef:       0.000000000785
 Linear coef   :      -0.000000001653
           Qmin:     -15.290748755728
Quadratic minimum step length (  0.468586935428) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.29074875485769 0.00000000409 0.00000761999 0.4686  0.022    8.00000000
      ideal mu1:      -0.567601497788
             Q0:     -15.290748755728
             G0:      -0.000000000061
   RMS gradient:       0.000001297601
     Trial step:       0.456562726557
             Q1:     -15.290748755744
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000028
           Qmin:     -15.290748755745
Quadratic minimum step length (  0.531062171881) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.29074875572847 0.00000000011 0.00000097320 0.5311  0.000    8.00000000
      ideal mu1:      -0.567602270272
             Q0:     -15.290748755745
             G0:      -0.000000000008
   RMS gradient:       0.000000454055
     Trial step:       0.492405516993
             Q1:     -15.290748755746
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000004
           Qmin:     -15.290748755746
Quadratic minimum step length (  0.354344377765) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.29074875574490 0.00000000000 0.00000034054 0.3543  0.122    8.00000000
      ideal mu1:      -0.567602104424
             Q0:     -15.290748755746
             G0:      -0.000000000001
   RMS gradient:       0.000000121624
     Trial step:       0.417709380463
             Q1:     -15.290748755746
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.290748755746
  Cubic LS coeff:       0.574872734546
Predicted energy:     -15.290748755746
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.29074875574612 0.00000000000 0.00000009122 0.5749  0.072    8.00000000
      ideal mu1:      -0.567602031088
10    -15.29074875574624 0.00000000000 0.00000002359 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01284983943095              |
           | Maximum change in energy =  0.17668973997535 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46618004E-01     0.33095539E-01
               2       0.17289007E-02     0.11786212E-02
               3       0.24007204E-05     0.15770401E-05
               4       0.44254350E-11     0.28949065E-11
               5       0.10797164E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.51916489E-02     0.36364607E-02
               2       0.21189139E-04     0.14290053E-04
               3       0.36216691E-09     0.23417135E-09
               4       0.13633572E-14     0.88817842E-15
================================================================================
RMS gradient                =       0.01284983943095
Trial step length           =               0.077341
Gradient along search dir.  =         -0.57638222470
Functional at step 0        =     -15.29074875574624
Functional at step 1        =     -15.31486584649008
Functional predicted        =     -15.31502919953006
Selected quadratic step     =               0.084251
Conjugate gradients coeff.  =               0.245621
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05802887
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.005977 (step -0.4849 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000037 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.593967660758
             Q0:     -15.314635726242
             G0:      -0.005530966640
   RMS gradient:       0.012395078145
     Trial step:       0.490030339665
             Q1:     -15.316065086658
 Quadratic coef:       0.001280981046
 Linear coef   :      -0.002710341461
           Qmin:     -15.316069383450
Quadratic minimum step length (  0.518411084798) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000363 (step -0.4991 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -15.31463572624234 0.00000000000 0.00929630856 0.5184  0.000    8.00000000
      ideal mu1:      -0.583083178715
             Q0:     -15.316071073319
             G0:      -0.000347959444
   RMS gradient:       0.003102819732
     Trial step:       0.504020991596
             Q1:     -15.316146328181
 Quadratic coef:       0.000100124003
 Linear coef   :      -0.000175378864
           Qmin:     -15.316147872451
Quadratic minimum step length (  0.441425765252) accepted
    Initial Ne1:       8.00000140
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000051 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.31607107331921 0.00017920715 0.00232711533 0.4414  0.063    8.00000000
      ideal mu1:      -0.583832922748
             Q0:     -15.316147910253
             G0:      -0.000053945501
   RMS gradient:       0.001223772864
     Trial step:       0.471686179486
             Q1:     -15.316161281006
 Quadratic coef:       0.000012074594
 Linear coef   :      -0.000025445347
           Qmin:     -15.316161315791
Quadratic minimum step length (  0.497002987702) accepted
    Initial Ne1:       8.00000026
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.31614791025291 0.00001023688 0.00091782965 0.4970  0.156    8.00000000
      ideal mu1:      -0.583911524579
             Q0:     -15.316161318763
             G0:      -0.000000533202
   RMS gradient:       0.000121684902
     Trial step:       0.484179140879
             Q1:     -15.316161518639
 Quadratic coef:       0.000000058290
 Linear coef   :      -0.000000258165
           Qmin:     -15.316161604617
Quadratic minimum step length (  1.072216676549) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.31616131876345 0.00000195556 0.00009126368 1.0722  0.010    8.00000000
      ideal mu1:      -0.583930899135
             Q0:     -15.316161604617
             G0:      -0.000000043017
   RMS gradient:       0.000034567598
     Trial step:       0.720517140176
             Q1:     -15.316161605381
 Quadratic coef:       0.000000030230
 Linear coef   :      -0.000000030994
           Qmin:     -15.316161612561
Quadratic minimum step length (  0.369365088946) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.31616160461706 0.00000003615 0.00002592570 0.3694  0.081    8.00000000
      ideal mu1:      -0.583915451040
             Q0:     -15.316161612561
             G0:      -0.000000003179
   RMS gradient:       0.000009397713
     Trial step:       0.515881650738
             Q1:     -15.316161613317
 Quadratic coef:       0.000000000885
 Linear coef   :      -0.000000001640
           Qmin:     -15.316161613322
Quadratic minimum step length (  0.478281350388) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.31616161256146 0.00000000107 0.00000704828 0.4783  0.074    8.00000000
      ideal mu1:      -0.583914970259
             Q0:     -15.316161613322
             G0:      -0.000000000016
   RMS gradient:       0.000000662758
     Trial step:       0.496725852513
             Q1:     -15.316161613326
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000008
           Qmin:     -15.316161613326
Quadratic minimum step length (  0.509609991261) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.31616161332173 0.00000000010 0.00000049707 0.5096  0.000    8.00000000
      ideal mu1:      -0.583915279289
             Q0:     -15.316161613326
             G0:      -0.000000000001
   RMS gradient:       0.000000182511
     Trial step:       0.503126681223
             Q1:     -15.316161613326
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.316161613326
Quadratic minimum step length (  0.302654180878) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.31616161332574 0.00000000000 0.00000013688 0.3027  0.076    8.00000000
      ideal mu1:      -0.583915327303
             Q0:     -15.316161613326
             G0:      -0.000000000000
   RMS gradient:       0.000000076175
     Trial step:       0.390222236147
             Q1:     -15.316161613326
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.316161613326
  Cubic LS coeff:       0.551104948857
Predicted energy:     -15.316161613326
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.31616161332583 0.00000000000 0.00000005713 0.5511  0.174    8.00000000
      ideal mu1:      -0.583915319495
10    -15.31616161332593 0.00000000000 0.00000004069 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00786166777391              |
           | Maximum change in energy =  0.02729204655470 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.40594900E-01     0.24550367E-01
               2       0.12752546E-02     0.71683472E-03
               3       0.12609892E-05     0.68338270E-06
               4       0.11974104E-11     0.64714900E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20955567E-02     0.12227101E-02
               2       0.33666794E-05     0.18138955E-05
               3       0.87817647E-11     0.45442539E-11
               4       0.10919993E-14     0.77715612E-15
================================================================================
RMS gradient                =       0.00786166777391
Trial step length           =               0.080722
Gradient along search dir.  =         -0.21362015292
Functional at step 0        =     -15.31616161332593
Functional at step 1        =     -15.32513748837315
Functional predicted        =     -15.32515264100093
Selected quadratic step     =               0.084178
Conjugate gradients coeff.  =               0.374312
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.03182076
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003719 (step -0.4911 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000021 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.603477074024
             Q0:     -15.324994011830
             G0:      -0.001073573542
   RMS gradient:       0.005460905353
     Trial step:       0.463738509825
             Q1:     -15.325263936042
 Quadratic coef:       0.000227933183
 Linear coef   :      -0.000497857395
           Qmin:     -15.325265869993
Quadratic minimum step length (  0.506454662807) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000061 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32499401183012 0.00000000000 0.00409567901 0.5065  0.000    8.00000000
      ideal mu1:      -0.598488228859
             Q0:     -15.325265953469
             G0:      -0.000085342410
   RMS gradient:       0.001538623870
     Trial step:       0.484626176164
             Q1:     -15.325283526478
 Quadratic coef:       0.000023786156
 Linear coef   :      -0.000041359166
           Qmin:     -15.325283932210
Quadratic minimum step length (  0.421331937845) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32526595346850 0.00003398227 0.00115396790 0.4213  0.079    8.00000000
      ideal mu1:      -0.598621638353
             Q0:     -15.325283932992
             G0:      -0.000009577665
   RMS gradient:       0.000515722338
     Trial step:       0.451872200886
             Q1:     -15.325286708657
 Quadratic coef:       0.000001552216
 Linear coef   :      -0.000004327881
           Qmin:     -15.325286949736
Quadratic minimum step length (  0.629953885229) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32528393299200 0.00000242859 0.00038679175 0.6300  0.112    8.00000000
      ideal mu1:      -0.598655676022
             Q0:     -15.325286949899
             G0:      -0.000000094355
   RMS gradient:       0.000051193592
     Trial step:       0.533534111914
             Q1:     -15.325286989088
 Quadratic coef:       0.000000011152
 Linear coef   :      -0.000000050341
           Qmin:     -15.325287006710
Quadratic minimum step length (  1.204207286712) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32528694989907 0.00000042303 0.00003839519 1.2042  0.010    8.00000000
      ideal mu1:      -0.598661302287
             Q0:     -15.325287006710
             G0:      -0.000000015051
   RMS gradient:       0.000020447095
     Trial step:       0.801552035289
             Q1:     -15.325287004525
 Quadratic coef:       0.000000014250
 Linear coef   :      -0.000000012064
           Qmin:     -15.325287009264
Quadratic minimum step length (  0.339311296083) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32528700671021 0.00000000718 0.00001533532 0.3393  0.160    8.00000000
      ideal mu1:      -0.598657294724
             Q0:     -15.325287009264
             G0:      -0.000000000365
   RMS gradient:       0.000003184310
     Trial step:       0.521512856957
             Q1:     -15.325287009368
 Quadratic coef:       0.000000000086
 Linear coef   :      -0.000000000190
           Qmin:     -15.325287009369
Quadratic minimum step length (  0.579627854625) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32528700926368 0.00000000037 0.00000238823 0.5796  0.024    8.00000000
      ideal mu1:      -0.598656675362
             Q0:     -15.325287009369
             G0:      -0.000000000003
   RMS gradient:       0.000000277643
     Trial step:       0.549803036039
             Q1:     -15.325287009370
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -15.325287009370
Quadratic minimum step length (  0.657711452359) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.32528700936922 0.00000000001 0.00000020823 0.6577  0.000    8.00000000
      ideal mu1:      -0.598656871234
             Q0:     -15.325287009370
             G0:      -0.000000000001
   RMS gradient:       0.000000141741
     Trial step:       0.601341627816
             Q1:     -15.325287009370
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.325287009371
Quadratic minimum step length (  0.420629911062) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32528700937035 0.00000000000 0.00000010631 0.4206  0.261    8.00000000
      ideal mu1:      -0.598656838133
             Q0:     -15.325287009370
             G0:      -0.000000000000
   RMS gradient:       0.000000047792
     Trial step:       0.502933669012
             Q1:     -15.325287009371
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.325287009371
  Cubic LS coeff:       1.372760593154
Predicted energy:     -15.325287009371
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32528700937045 0.00000000000 0.00000003584 1.3728  0.114    8.00000000
      ideal mu1:      -0.598656753166
10    -15.32528700937058 0.00000000000 0.00000005487 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00481094346018              |
           | Maximum change in energy =  0.00847095252656 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        7.98137350979359 |
           | Pseudopotential (local)    :      -42.29703859782537 |
           | Pseudopotential (non-local):       -0.81648199665233 |
           | Hartree                    :       17.57271959914541 |
           | Exchange-correlation       :       -3.70170877180271 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.32528700937059 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -42.29703859782528 |
           | Hartree                    :       17.57271959914536 |
           --------------------------------------------------------
           Integrated density           :        8.00000000000009
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.55287312E-02     0.19946380E-02
               2       0.19368585E-04     0.76965617E-05
               3       0.26235215E-09     0.11621715E-09
               4       0.90805992E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15208631E-02     0.52935948E-03
               2       0.15541607E-05     0.60476309E-06
               3       0.17420432E-11     0.75017770E-12
================================================================================
RMS gradient                =       0.00481094346018
Trial step length           =               0.082432
Gradient along search dir.  =         -0.07626335814
Functional at step 0        =     -15.32528700937058
Functional at step 1        =     -15.32751808575065
Functional predicted        =     -15.32772326195548
Selected quadratic step     =               0.063891
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99774313
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000352 (step -0.5005 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.599633944424
             Q0:     -15.327722331685
             G0:      -0.000006563587
   RMS gradient:       0.000426991640
     Trial step:       0.830907649375
             Q1:     -15.327723425343
 Quadratic coef:       0.000004360077
 Linear coef   :      -0.000005453735
           Qmin:     -15.327724037115
Quadratic minimum step length (  0.519663938790) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32772233168520 0.00000000000 0.00032024373 0.5197  0.000    8.00000000
      ideal mu1:      -0.600017685868
             Q0:     -15.327724037300
             G0:      -0.000000883542
   RMS gradient:       0.000156659984
     Trial step:       0.657109383471
             Q1:     -15.327724192324
 Quadratic coef:       0.000000425561
 Linear coef   :      -0.000000580584
           Qmin:     -15.327724235320
Quadratic minimum step length (  0.448240844009) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32772403730035 0.00000021318 0.00011749499 0.4482  0.135    8.00000000
      ideal mu1:      -0.600011738414
             Q0:     -15.327724235325
             G0:      -0.000000078600
   RMS gradient:       0.000046726026
     Trial step:       0.542718402722
             Q1:     -15.327724258705
 Quadratic coef:       0.000000019278
 Linear coef   :      -0.000000042657
           Qmin:     -15.327724258923
Quadratic minimum step length (  0.600461090904) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32772423532529 0.00000002808 0.00003504452 0.6005  0.089    8.00000000
      ideal mu1:      -0.599999421875
             Q0:     -15.327724258923
             G0:      -0.000000000617
   RMS gradient:       0.000004141439
     Trial step:       0.570860126609
             Q1:     -15.327724259159
 Quadratic coef:       0.000000000117
 Linear coef   :      -0.000000000352
           Qmin:     -15.327724259189
Quadratic minimum step length (  0.860874513456) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32772425892306 0.00000000325 0.00000310608 0.8609  0.008    8.00000000
      ideal mu1:      -0.600000072775
             Q0:     -15.327724259189
             G0:      -0.000000000311
   RMS gradient:       0.000002942456
     Trial step:       0.701027056358
             Q1:     -15.327724259246
 Quadratic coef:       0.000000000161
 Linear coef   :      -0.000000000218
           Qmin:     -15.327724259262
Quadratic minimum step length (  0.475658318702) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32772425918852 0.00000000003 0.00000220684 0.4757  0.505    8.00000000
      ideal mu1:      -0.599999934285
             Q0:     -15.327724259262
             G0:      -0.000000000024
   RMS gradient:       0.000000822934
     Trial step:       0.577450734688
             Q1:     -15.327724259270
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000014
           Qmin:     -15.327724259270
Quadratic minimum step length (  0.625717846162) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32772425926247 0.00000000001 0.00000061720 0.6257  0.078    8.00000000
      ideal mu1:      -0.599999878373
             Q0:     -15.327724259270
             G0:      -0.000000000000
   RMS gradient:       0.000000048685
     Trial step:       0.601100016614
             Q1:     -15.327724259270
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.327724259270
  Cubic LS coeff:       0.831919917371
Predicted energy:     -15.327724259270
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32772425927010 0.00000000000 0.00000003651 0.8319  0.000    8.00000000
      ideal mu1:      -0.599999878389
             Q0:     -15.327724259270
             G0:      -0.000000000000
   RMS gradient:       0.000000009909
     Trial step:       0.707154209599
             Q1:     -15.327724259270
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.327724259270
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32772425927018 0.00000000000 0.00000000743 0.1500  0.041    8.00000000
      ideal mu1:      -0.599999877901
             Q0:     -15.327724259270
             G0:      -0.000000000000
   RMS gradient:       0.000000007072
     Trial step:       0.325688703273
             Q1:     -15.327724259270
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.327724259270
Quadratic minimum step length (  0.001390649636) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.32772425927024 0.00000000000 0.00000000530 0.0014  0.509    8.00000000
      ideal mu1:      -0.599999877897
10    -15.32772425927024 0.00000000000 0.00000000528 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00277496276612              |
           | Maximum change in energy =  0.00304179868155 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.69033940E-02     0.24614500E-02
               2       0.31461354E-04     0.13028703E-04
               3       0.72725828E-09     0.31531500E-09
               4       0.88793484E-15     0.36721928E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20005677E-02     0.69491602E-03
               2       0.27391840E-05     0.11026421E-05
               3       0.55921731E-11     0.23633318E-11
               4       0.86464949E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00277496276612
Trial step length           =               0.072571
Gradient along search dir.  =         -0.02537657460
Functional at step 0        =     -15.32772425927024
Functional at step 1        =     -15.32880601253396
Functional predicted        =     -15.32884010276075
Selected quadratic step     =               0.087943
Conjugate gradients coeff.  =               0.332701
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99658495
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000693 (step -0.5005 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.603034522764
             Q0:     -15.328836022299
             G0:      -0.000001854288
   RMS gradient:       0.000226953733
     Trial step:       0.021281890813
             Q1:     -15.328836061157
 Quadratic coef:       0.000000000605
 Linear coef   :      -0.000000039463
           Qmin:     -15.328836665828
Quadratic minimum step length (  0.694097987487) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32883602229938 0.00000000000 0.00017021530 0.6941  0.000    8.00000000
      ideal mu1:      -0.602888955367
             Q0:     -15.328836666026
             G0:      -0.000000442438
   RMS gradient:       0.000110840355
     Trial step:       0.121538955004
             Q1:     -15.328836711732
 Quadratic coef:       0.000000008067
 Linear coef   :      -0.000000053773
           Qmin:     -15.328836755638
Quadratic minimum step length (  0.405083091347) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32883666602591 0.00000008044 0.00008313027 0.4051  0.239    8.00000000
      ideal mu1:      -0.602916785766
             Q0:     -15.328836755640
             G0:      -0.000000003948
   RMS gradient:       0.000010472415
     Trial step:       0.221885951813
             Q1:     -15.328836756382
 Quadratic coef:       0.000000000134
 Linear coef   :      -0.000000000876
           Qmin:     -15.328836757074
Quadratic minimum step length (  0.726113581506) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32883675564017 0.00000001388 0.00000785431 0.7261  0.009    8.00000000
      ideal mu1:      -0.602924003554
             Q0:     -15.328836757073
             G0:      -0.000000000663
   RMS gradient:       0.000004290488
     Trial step:       0.401390586782
             Q1:     -15.328836757288
 Quadratic coef:       0.000000000052
 Linear coef   :      -0.000000000266
           Qmin:     -15.328836757416
Quadratic minimum step length (  1.034287600947) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32883675707336 0.00000000018 0.00000321787 1.0343  0.168    8.00000000
      ideal mu1:      -0.602921884384
             Q0:     -15.328836757416
             G0:      -0.000000000029
   RMS gradient:       0.000000902790
     Trial step:       0.644323914693
             Q1:     -15.328836757419
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000019
           Qmin:     -15.328836757421
Quadratic minimum step length (  0.386633655387) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -15.32883675741564 0.00000000005 0.00000067709 0.3866  0.044    8.00000000
      ideal mu1:      -0.602921890518
             Q0:     -15.328836757421
             G0:      -0.000000000004
   RMS gradient:       0.000000337248
     Trial step:       0.499116529872
             Q1:     -15.328836757423
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -15.328836757423
Quadratic minimum step length (  1.031314832266) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32883675742113 0.00000000000 0.00000025294 1.0313  0.140    8.00000000
      ideal mu1:      -0.602921975285
             Q0:     -15.328836757422
             G0:      -0.000000000001
   RMS gradient:       0.000000122569
     Trial step:       0.717458208041
             Q1:     -15.328836757423
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.328836757424
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  5.223992799602)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32883675742250 0.00000000000 0.00000009193 0.1500  0.000    8.00000000
      ideal mu1:      -0.602921970279
             Q0:     -15.328836757423
             G0:      -0.000000000001
   RMS gradient:       0.000000094553
     Trial step:       0.328052939640
             Q1:     -15.328836757423
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.328836757423
Quadratic minimum step length (  0.296412564802) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32883675742278 0.00000000000 0.00000007091 0.2964  0.595    8.00000000
      ideal mu1:      -0.602921955948
             Q0:     -15.328836757423
             G0:      -0.000000000000
   RMS gradient:       0.000000043364
     Trial step:       0.311831706581
             Q1:     -15.328836757423
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.328836757423
Quadratic minimum step length (  0.124221805695) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32883675742293 0.00000000000 0.00000003252 0.1242  0.210    8.00000000
      ideal mu1:      -0.602921953102
10    -15.32883675742296 0.00000000000 0.00000002426 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00174908733730              |
           | Maximum change in energy =  0.00081241663322 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.93279872E-02     0.33661281E-02
               2       0.57846526E-04     0.23832427E-04
               3       0.24554697E-08     0.10676175E-08
               4       0.91884262E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54640845E-03     0.19633393E-03
               2       0.20165486E-06     0.82351293E-07
               3       0.29968766E-13     0.13045121E-13
================================================================================
RMS gradient                =       0.00174908733730
Trial step length           =               0.079888
Gradient along search dir.  =         -0.01004715296
Functional at step 0        =     -15.32883675742296
Functional at step 1        =     -15.32921880131753
Functional predicted        =     -15.32921968516087
Selected quadratic step     =               0.076226
Conjugate gradients coeff.  =               0.397291
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99686145
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000680 (step -0.5005 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606438189359
             Q0:     -15.329216201763
             G0:      -0.000032148757
   RMS gradient:       0.000944997894
     Trial step:       0.196815389806
             Q1:     -15.329221560174
 Quadratic coef:       0.000000968959
 Linear coef   :      -0.000006327370
           Qmin:     -15.329226531307
Quadratic minimum step length (  0.642609282400) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32921620176264 0.00000000000 0.00070874842 0.6426  0.000    8.00000000
      ideal mu1:      -0.605528248211
             Q0:     -15.329226535561
             G0:      -0.000003879237
   RMS gradient:       0.000328145774
     Trial step:       0.355633795369
             Q1:     -15.329227399578
 Quadratic coef:       0.000000515570
 Linear coef   :      -0.000001379588
           Qmin:     -15.329227458453
Quadratic minimum step length (  0.475811226394) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32922653556076 0.00000129119 0.00024610933 0.4758  0.121    8.00000000
      ideal mu1:      -0.605617894919
             Q0:     -15.329227458456
             G0:      -0.000000510784
   RMS gradient:       0.000119115376
     Trial step:       0.411356964596
             Q1:     -15.329227587079
 Quadratic coef:       0.000000081491
 Linear coef   :      -0.000000210114
           Qmin:     -15.329227593894
Quadratic minimum step length (  0.530313878084) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32922745845622 0.00000012934 0.00008933653 0.5303  0.132    8.00000000
      ideal mu1:      -0.605638417787
             Q0:     -15.329227593894
             G0:      -0.000000002210
   RMS gradient:       0.000007835130
     Trial step:       0.467063493726
             Q1:     -15.329227594609
 Quadratic coef:       0.000000000317
 Linear coef   :      -0.000000001032
           Qmin:     -15.329227594734
Quadratic minimum step length (  0.759387899412) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32922759389448 0.00000001943 0.00000587635 0.7594  0.004    8.00000000
      ideal mu1:      -0.605637451288
             Q0:     -15.329227594734
             G0:      -0.000000001372
   RMS gradient:       0.000006172124
     Trial step:       0.595552151699
             Q1:     -15.329227595144
 Quadratic coef:       0.000000000407
 Linear coef   :      -0.000000000817
           Qmin:     -15.329227595144
Quadratic minimum step length (  0.597730988782) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -15.32922759473385 0.00000000011 0.00000462909 0.5977  0.621    8.00000000
      ideal mu1:      -0.605637667755
             Q0:     -15.329227595144
             G0:      -0.000000000098
   RMS gradient:       0.000001647832
     Trial step:       0.596640575645
             Q1:     -15.329227595177
 Quadratic coef:       0.000000000025
 Linear coef   :      -0.000000000058
           Qmin:     -15.329227595177
Quadratic minimum step length (  0.688156401671) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.32922759514368 0.00000000008 0.00000123587 0.6882  0.071    8.00000000
      ideal mu1:      -0.605637711100
             Q0:     -15.329227595177
             G0:      -0.000000000000
   RMS gradient:       0.000000046163
     Trial step:       0.640766752904
             Q1:     -15.329227595177
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329227595177
  Cubic LS coeff:       0.894672461955
Predicted energy:     -15.329227595177
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32922759517705 0.00000000000 0.00000003462 0.8947  0.000    8.00000000
      ideal mu1:      -0.605637737126
             Q0:     -15.329227595177
             G0:      -0.000000000000
   RMS gradient:       0.000000030929
     Trial step:       0.757150162358
             Q1:     -15.329227595177
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329227595177
Quadratic minimum step length (  0.106287804149) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32922759517731 0.00000000000 0.00000002320 0.1063  0.449    8.00000000
      ideal mu1:      -0.605637734479
             Q0:     -15.329227595177
             G0:      -0.000000000000
   RMS gradient:       0.000000023887
     Trial step:       0.283682618728
             Q1:     -15.329227595177
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329227595177
Quadratic minimum step length (  0.007093605145) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32922759517735 0.00000000000 0.00000001792 0.0071  0.596    8.00000000
      ideal mu1:      -0.605637734163
10    -15.32922759517716 0.00000000000 0.00000001734 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00084148739220              |
           | Maximum change in energy =  0.00037083271757 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.58176736E-02     0.21699756E-02
               2       0.20766997E-04     0.82733487E-05
               3       0.29700207E-09     0.13055063E-09
               4       0.96680506E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22974959E-02     0.84825509E-03
               2       0.33181728E-05     0.13350926E-05
               3       0.76745192E-11     0.33881231E-11
               4       0.73864231E-15     0.38857806E-15
================================================================================
RMS gradient                =       0.00084148739220
Trial step length           =               0.078036
Gradient along search dir.  =         -0.00237719996
Functional at step 0        =     -15.32922759517716
Functional at step 1        =     -15.32927299906273
Functional predicted        =     -15.32928900134271
Selected quadratic step     =               0.051663
Conjugate gradients coeff.  =               0.231458
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99793221
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000414 (step -0.5002 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.607066302626
             Q0:     -15.329287651857
             G0:      -0.000009620048
   RMS gradient:       0.000516936706
     Trial step:       0.044859029010
             Q1:     -15.329288067924
 Quadratic coef:       0.000000015479
 Linear coef   :      -0.000000431546
           Qmin:     -15.329290659629
Quadratic minimum step length (  0.625313308979) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32928765185743 0.00000000000 0.00038770253 0.6253  0.000    8.00000000
      ideal mu1:      -0.606564487203
             Q0:     -15.329290660493
             G0:      -0.000000958348
   RMS gradient:       0.000163121978
     Trial step:       0.167484171991
             Q1:     -15.329290793716
 Quadratic coef:       0.000000027285
 Linear coef   :      -0.000000160508
           Qmin:     -15.329290896549
Quadratic minimum step length (  0.492631162005) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32929066049264 0.00000037597 0.00012234148 0.4926  0.100    8.00000000
      ideal mu1:      -0.606604558546
             Q0:     -15.329290896550
             G0:      -0.000000152525
   RMS gradient:       0.000065090578
     Trial step:       0.287241922890
             Q1:     -15.329290928745
 Quadratic coef:       0.000000011617
 Linear coef   :      -0.000000043812
           Qmin:     -15.329290937859
Quadratic minimum step length (  0.541665644405) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32929089654985 0.00000003246 0.00004881793 0.5417  0.159    8.00000000
      ideal mu1:      -0.606610300340
             Q0:     -15.329290937858
             G0:      -0.000000000233
   RMS gradient:       0.000002543531
     Trial step:       0.394447818174
             Q1:     -15.329290937900
 Quadratic coef:       0.000000000049
 Linear coef   :      -0.000000000092
           Qmin:     -15.329290937901
Quadratic minimum step length (  0.368179828595) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -15.32929093785767 0.00000000607 0.00000190765 0.3682  0.002    8.00000000
      ideal mu1:      -0.606610046656
             Q0:     -15.329290937900
             G0:      -0.000000000018
   RMS gradient:       0.000000710364
     Trial step:       0.381087562228
             Q1:     -15.329290937906
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000007
           Qmin:     -15.329290937907
Quadratic minimum step length (  0.724746571573) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32929093790041 0.00000000001 0.00000053277 0.7247  0.078    8.00000000
      ideal mu1:      -0.606610047361
             Q0:     -15.329290937906
             G0:      -0.000000000001
   RMS gradient:       0.000000206259
     Trial step:       0.525539631421
             Q1:     -15.329290937906
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.329290937906
Quadratic minimum step length (  0.410434228641) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32929093790581 0.00000000000 0.00000015469 0.4104  0.084    8.00000000
      ideal mu1:      -0.606610040450
             Q0:     -15.329290937906
             G0:      -0.000000000000
   RMS gradient:       0.000000106852
     Trial step:       0.464434552163
             Q1:     -15.329290937906
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329290937906
  Cubic LS coeff:       0.698886577989
Predicted energy:     -15.329290937906
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32929093790594 0.00000000000 0.00000008014 0.6989  0.000    8.00000000
      ideal mu1:      -0.606610046717
             Q0:     -15.329290937906
             G0:      -0.000000000000
   RMS gradient:       0.000000021247
     Trial step:       0.569725438137
             Q1:     -15.329290937906
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329290937906
Quadratic minimum step length (  0.018199992876) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32929093790641 0.00000000000 0.00000001593 0.0182  0.040    8.00000000
      ideal mu1:      -0.606610046678
             Q0:     -15.329290937906
             G0:      -0.000000000000
   RMS gradient:       0.000000020850
     Trial step:       0.101828281510
             Q1:     -15.329290937906
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329290937906
  Cubic LS coeff:       0.094782852956
Predicted energy:     -15.329290937906
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.32929093790630 0.00000000000 0.00000001564 0.0948  0.963    8.00000000
      ideal mu1:      -0.606610046256
10    -15.32929093790627 0.00000000000 0.00000001275 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00034848400707              |
           | Maximum change in energy =  0.00013027925140 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17718873E-02     0.69343584E-03
               2       0.15128498E-05     0.70811863E-06
               3       0.12965498E-11     0.63693495E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.38570590E-03     0.13532410E-03
               2       0.76483434E-07     0.33399786E-07
               3       0.34962010E-14     0.18873791E-14
================================================================================
RMS gradient                =       0.00034848400707
Trial step length           =               0.063494
Gradient along search dir.  =         -0.00040014843
Functional at step 0        =     -15.32929093790627
Functional at step 1        =     -15.32930555513414
Functional predicted        =     -15.32930589453152
Selected quadratic step     =               0.074755
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99753947
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000444 (step -0.5003 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.607238908128
             Q0:     -15.329304154522
             G0:      -0.000002958377
   RMS gradient:       0.000286665530
     Trial step:       0.098242429902
             Q1:     -15.329304424554
 Quadratic coef:       0.000000020607
 Linear coef   :      -0.000000290638
           Qmin:     -15.329305179318
Quadratic minimum step length (  0.692809605295) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930415452224 0.00000000000 0.00021499915 0.6928  0.000    8.00000000
      ideal mu1:      -0.606983056081
             Q0:     -15.329305179563
             G0:      -0.000000179921
   RMS gradient:       0.000070682006
     Trial step:       0.260889438429
             Q1:     -15.329305218233
 Quadratic coef:       0.000000008269
 Linear coef   :      -0.000000046940
           Qmin:     -15.329305246173
Quadratic minimum step length (  0.740436871602) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930517956306 0.00000012810 0.00005301150 0.7404  0.061    8.00000000
      ideal mu1:      -0.607008644402
             Q0:     -15.329305246173
             G0:      -0.000000008595
   RMS gradient:       0.000015451380
     Trial step:       0.439513548852
             Q1:     -15.329305247571
 Quadratic coef:       0.000000002379
 Linear coef   :      -0.000000003777
           Qmin:     -15.329305247672
Quadratic minimum step length (  0.348937784566) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930524617299 0.00000000884 0.00001158853 0.3489  0.048    8.00000000
      ideal mu1:      -0.607006453384
             Q0:     -15.329305247672
             G0:      -0.000000000378
   RMS gradient:       0.000003241780
     Trial step:       0.391615735158
             Q1:     -15.329305247800
 Quadratic coef:       0.000000000020
 Linear coef   :      -0.000000000148
           Qmin:     -15.329305247941
Quadratic minimum step length (  1.418365374734) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930524767238 0.00000000020 0.00000243133 1.4184  0.044    8.00000000
      ideal mu1:      -0.607006156007
             Q0:     -15.329305247937
             G0:      -0.000000000063
   RMS gradient:       0.000001331030
     Trial step:       0.745287997320
             Q1:     -15.329305247939
 Quadratic coef:       0.000000000044
 Linear coef   :      -0.000000000047
           Qmin:     -15.329305247949
Quadratic minimum step length (  0.394118174879) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930524793665 0.00000000004 0.00000099827 0.3941  0.169    8.00000000
      ideal mu1:      -0.607006577109
             Q0:     -15.329305247949
             G0:      -0.000000000005
   RMS gradient:       0.000000384854
     Trial step:       0.541970059379
             Q1:     -15.329305247951
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -15.329305247951
Quadratic minimum step length (  0.612054327365) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.32930524794926 0.00000000000 0.00000028864 0.6121  0.084    8.00000000
      ideal mu1:      -0.607006545210
             Q0:     -15.329305247951
             G0:      -0.000000000000
   RMS gradient:       0.000000063226
     Trial step:       0.575947150479
             Q1:     -15.329305247951
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329305247951
Quadratic minimum step length (  0.081932242772) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930524795107 0.00000000000 0.00000004742 0.0819  0.000    8.00000000
      ideal mu1:      -0.607006544306
             Q0:     -15.329305247951
             G0:      -0.000000000000
   RMS gradient:       0.000000057827
     Trial step:       0.217229467976
             Q1:     -15.329305247951
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329305247951
Quadratic minimum step length (  0.036869869860) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930524795089 0.00000000000 0.00000004337 0.0369  0.836    8.00000000
      ideal mu1:      -0.607006543661
             Q0:     -15.329305247951
             G0:      -0.000000000000
   RMS gradient:       0.000000053671
     Trial step:       0.089494257994
             Q1:     -15.329305247951
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329305247951
  Cubic LS coeff:       0.128007078217
Predicted energy:     -15.329305247951
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32930524795080 0.00000000000 0.00000004025 0.1280  0.861    8.00000000
      ideal mu1:      -0.607006540931
10    -15.32930524795080 0.00000000000 0.00000002656 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00018308891648              |
           | Maximum change in energy =  0.00002111424304 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        7.95425817823249 |
           | Pseudopotential (local)    :      -42.21917972415645 |
           | Pseudopotential (non-local):       -0.81688463430588 |
           | Hartree                    :       17.50597600779329 |
           | Exchange-correlation       :       -3.68932432348507 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.32930524795080 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -42.21917972415645 |
           | Hartree                    :       17.50597600779322 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999985
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.105189E-03
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13580908E-02     0.59863443E-03
               2       0.96518904E-06     0.58194345E-06
               3       0.60331245E-12     0.37170267E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44017807E-04     0.17323926E-04
               2       0.10008205E-08     0.54107274E-09
               3       0.93394356E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00018308891648
Trial step length           =               0.068895
Gradient along search dir.  =         -0.00011045351
Functional at step 0        =     -15.32930524795080
Functional at step 1        =     -15.32930892628002
Functional predicted        =     -15.32930893035210
Selected quadratic step     =               0.066678
Conjugate gradients coeff.  =              -0.276031
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00221130
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000380 (step -0.4997 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606607307044
             Q0:     -15.329307609035
             G0:      -0.000000923757
   RMS gradient:       0.000160187123
     Trial step:       0.107032231048
             Q1:     -15.329307700581
 Quadratic coef:       0.000000007325
 Linear coef   :      -0.000000098872
           Qmin:     -15.329307942652
Quadratic minimum step length (  0.722304670223) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930760903481 0.00000000000 0.00012014034 0.7223  0.000    8.00000000
      ideal mu1:      -0.606722037913
             Q0:     -15.329307942613
             G0:      -0.000000084431
   RMS gradient:       0.000048433211
     Trial step:       0.278046543496
             Q1:     -15.329307960147
 Quadratic coef:       0.000000005941
 Linear coef   :      -0.000000023476
           Qmin:     -15.329307965802
Quadratic minimum step length (  0.549305302853) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930794261268 0.00000004170 0.00003632491 0.5493  0.091    8.00000000
      ideal mu1:      -0.606727507067
             Q0:     -15.329307965803
             G0:      -0.000000013816
   RMS gradient:       0.000019589679
     Trial step:       0.390809980403
             Q1:     -15.329307968866
 Quadratic coef:       0.000000002336
 Linear coef   :      -0.000000005399
           Qmin:     -15.329307968923
Quadratic minimum step length (  0.451655180679) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930796580292 0.00000000316 0.00001469226 0.4517  0.164    8.00000000
      ideal mu1:      -0.606716341697
             Q0:     -15.329307968923
             G0:      -0.000000000508
   RMS gradient:       0.000003755847
     Trial step:       0.420132541360
             Q1:     -15.329307969102
 Quadratic coef:       0.000000000035
 Linear coef   :      -0.000000000213
           Qmin:     -15.329307969250
Quadratic minimum step length (  1.288019134338) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930796892338 0.00000000046 0.00000281689 1.2880  0.037    8.00000000
      ideal mu1:      -0.606716163409
             Q0:     -15.329307969252
             G0:      -0.000000000152
   RMS gradient:       0.000002048738
     Trial step:       0.735621337531
             Q1:     -15.329307969255
 Quadratic coef:       0.000000000109
 Linear coef   :      -0.000000000112
           Qmin:     -15.329307969280
Quadratic minimum step length (  0.378226853842) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930796925156 0.00000000004 0.00000153655 0.3782  0.298    8.00000000
      ideal mu1:      -0.606716664802
             Q0:     -15.329307969280
             G0:      -0.000000000006
   RMS gradient:       0.000000410126
     Trial step:       0.527476771160
             Q1:     -15.329307969282
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -15.329307969283
Quadratic minimum step length (  0.818283299440) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32930796928018 0.00000000000 0.00000030759 0.8183  0.040    8.00000000
      ideal mu1:      -0.606716557736
             Q0:     -15.329307969282
             G0:      -0.000000000001
   RMS gradient:       0.000000123164
     Trial step:       0.656982064202
             Q1:     -15.329307969282
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329307969282
Quadratic minimum step length (  0.387989406363) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930796928226 0.00000000000 0.00000009237 0.3880  0.000    8.00000000
      ideal mu1:      -0.606716578454
             Q0:     -15.329307969282
             G0:      -0.000000000000
   RMS gradient:       0.000000049631
     Trial step:       0.504878283431
             Q1:     -15.329307969282
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329307969282
Quadratic minimum step length (  0.127355093458) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930796928239 0.00000000000 0.00000003722 0.1274  0.162    8.00000000
      ideal mu1:      -0.606716579425
             Q0:     -15.329307969282
             G0:      -0.000000000000
   RMS gradient:       0.000000037626
     Trial step:       0.253572121834
             Q1:     -15.329307969282
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329307969282
Quadratic minimum step length (  0.050955394155) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32930796928241 0.00000000000 0.00000002822 0.0510  0.575    8.00000000
      ideal mu1:      -0.606716579522
10    -15.32930796928230 0.00000000000 0.00000002403 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00024018729915              |
           | Maximum change in energy =  0.00000477001484 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.52445156E-02     0.20356691E-02
               2       0.13413763E-04     0.64867069E-05
               3       0.10557211E-09     0.53345883E-10
               4       0.91737349E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.47535019E-02     0.17736237E-02
               2       0.11247468E-04     0.53287589E-05
               3       0.74749100E-10     0.36742276E-10
               4       0.10230223E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00024018729915
Trial step length           =               0.067777
Gradient along search dir.  =         -0.00023810227
Functional at step 0        =     -15.32930796928230
Functional at step 1        =     -15.32927300616928
Functional predicted        =     -15.32930924339337
Selected quadratic step     =               0.010702
Conjugate gradients coeff.  =              -1.720981
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99902118
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000166 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606904050505
             Q0:     -15.329309004513
             G0:      -0.000000195141
   RMS gradient:       0.000073624530
     Trial step:       0.113669993467
             Q1:     -15.329309024963
 Quadratic coef:       0.000000001731
 Linear coef   :      -0.000000022182
           Qmin:     -15.329309075566
Quadratic minimum step length (  0.728227184391) accepted
    Initial Ne1:       7.99999704
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930900451288 0.00000000000 0.00005521822 0.7282  0.000    8.00000000
      ideal mu1:      -0.606849511795
             Q0:     -15.329309075571
             G0:      -0.000000016825
   RMS gradient:       0.000021617036
     Trial step:       0.287710930088
             Q1:     -15.329309079186
 Quadratic coef:       0.000000001226
 Linear coef   :      -0.000000004841
           Qmin:     -15.329309080351
Quadratic minimum step length (  0.568167222649) accepted
    Initial Ne1:       7.99999980
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930907557112 0.00000000888 0.00001621278 0.5682  0.086    8.00000000
      ideal mu1:      -0.606848297339
             Q0:     -15.329309080351
             G0:      -0.000000002699
   RMS gradient:       0.000008658888
     Trial step:       0.404311662056
             Q1:     -15.329309080932
 Quadratic coef:       0.000000000510
 Linear coef   :      -0.000000001091
           Qmin:     -15.329309080934
Quadratic minimum step length (  0.432415555984) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930908035069 0.00000000065 0.00000649417 0.4324  0.160    8.00000000
      ideal mu1:      -0.606852908956
             Q0:     -15.329309080934
             G0:      -0.000000000089
   RMS gradient:       0.000001573364
     Trial step:       0.418127554867
             Q1:     -15.329309080965
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000037
           Qmin:     -15.329309080993
Quadratic minimum step length (  1.312724179275) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -15.32930908093410 0.00000000009 0.00000118002 1.3127  0.033    8.00000000
      ideal mu1:      -0.606853042481
             Q0:     -15.329309080992
             G0:      -0.000000000030
   RMS gradient:       0.000000923672
     Trial step:       0.740868511475
             Q1:     -15.329309080992
 Quadratic coef:       0.000000000022
 Linear coef   :      -0.000000000022
           Qmin:     -15.329309080998
Quadratic minimum step length (  0.376466356160) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930908099187 0.00000000001 0.00000069275 0.3765  0.345    8.00000000
      ideal mu1:      -0.606852801027
             Q0:     -15.329309080998
             G0:      -0.000000000001
   RMS gradient:       0.000000185810
     Trial step:       0.528121263451
             Q1:     -15.329309080998
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.329309080998
Quadratic minimum step length (  0.686620109463) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32930908099768 0.00000000000 0.00000013936 0.6866  0.040    8.00000000
      ideal mu1:      -0.606852831109
             Q0:     -15.329309080998
             G0:      -0.000000000000
   RMS gradient:       0.000000032616
     Trial step:       0.602178279017
             Q1:     -15.329309080998
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309080998
Quadratic minimum step length (  0.325738862458) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930908099807 0.00000000000 0.00000002446 0.3257  0.000    8.00000000
      ideal mu1:      -0.606852834835
             Q0:     -15.329309080998
             G0:      -0.000000000000
   RMS gradient:       0.000000017723
     Trial step:       0.442891485134
             Q1:     -15.329309080998
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309080998
Quadratic minimum step length (  0.021970932255) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930908099818 0.00000000000 0.00000001329 0.0220  0.295    8.00000000
      ideal mu1:      -0.606852834892
             Q0:     -15.329309080998
             G0:      -0.000000000000
   RMS gradient:       0.000000017157
     Trial step:       0.098644507278
             Q1:     -15.329309080998
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309080998
Quadratic minimum step length (  0.001333724724) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32930908099813 0.00000000000 0.00000001287 0.0013  0.937    8.00000000
      ideal mu1:      -0.606852834894
10    -15.32930908099809 0.00000000000 0.00000001283 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006706948638              |
           | Maximum change in energy =  0.00000090711050 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.122788E-04
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56507162E-03     0.25039746E-03
               2       0.16068659E-06     0.98042761E-07
               3       0.16089734E-13     0.10214052E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.45038045E-03     0.19993535E-03
               2       0.10274848E-06     0.62813308E-07
               3       0.65086514E-14     0.42188475E-14
================================================================================
RMS gradient                =       0.00006706948638
Trial step length           =               0.026933
Gradient along search dir.  =         -0.00001482195
Functional at step 0        =     -15.32930908099809
Functional at step 1        =     -15.32930845778964
Functional predicted        =     -15.32930911996424
Selected quadratic step     =               0.005258
Conjugate gradients coeff.  =              -0.077974
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00017760
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000030 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606817970823
             Q0:     -15.329309110100
             G0:      -0.000000006595
   RMS gradient:       0.000013534760
     Trial step:       0.011470162084
             Q1:     -15.329309110175
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000076
           Qmin:     -15.329309112454
Quadratic minimum step length (  0.714095651746) accepted
    Initial Ne1:       7.99999988
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930911009979 0.00000000000 0.00001015107 0.7141  0.000    8.00000000
      ideal mu1:      -0.606827976307
             Q0:     -15.329309112494
             G0:      -0.000000000545
   RMS gradient:       0.000003856755
     Trial step:       0.090502999225
             Q1:     -15.329309112540
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000049
           Qmin:     -15.329309112656
Quadratic minimum step length (  0.591387046329) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930911249448 0.00000000029 0.00000289257 0.5914  0.081    8.00000000
      ideal mu1:      -0.606828226729
             Q0:     -15.329309112655
             G0:      -0.000000000088
   RMS gradient:       0.000001568955
     Trial step:       0.231348873772
             Q1:     -15.329309112670
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000020
           Qmin:     -15.329309112673
Quadratic minimum step length (  0.404861751624) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930911265523 0.00000000002 0.00000117672 0.4049  0.165    8.00000000
      ideal mu1:      -0.606827500268
             Q0:     -15.329309112674
             G0:      -0.000000000003
   RMS gradient:       0.000000281134
     Trial step:       0.306046255118
             Q1:     -15.329309112674
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.329309112675
Quadratic minimum step length (  0.813580167153) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -15.32930911267358 0.00000000000 0.00000021085 0.8136  0.032    8.00000000
      ideal mu1:      -0.606827422230
             Q0:     -15.329309112675
             G0:      -0.000000000002
   RMS gradient:       0.000000180679
     Trial step:       0.498992147629
             Q1:     -15.329309112676
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.329309112676
Quadratic minimum step length (  0.943038554364) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930911267515 0.00000000000 0.00000013551 0.9430  0.413    8.00000000
      ideal mu1:      -0.606827548124
             Q0:     -15.329309112676
             G0:      -0.000000000000
   RMS gradient:       0.000000164875
     Trial step:       0.685980199086
             Q1:     -15.329309112675
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309112676
Quadratic minimum step length (  0.118477528266) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32930911267559 0.00000000000 0.00000012366 0.1185  0.833    8.00000000
      ideal mu1:      -0.606827537662
             Q0:     -15.329309112676
             G0:      -0.000000000001
   RMS gradient:       0.000000139893
     Trial step:       0.285084616259
             Q1:     -15.329309112676
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309112677
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  5.372309009715)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930911267552 0.00000000000 0.00000010492 0.1500  0.000    8.00000000
      ideal mu1:      -0.606827512302
             Q0:     -15.329309112676
             G0:      -0.000000000000
   RMS gradient:       0.000000081371
     Trial step:       0.206791422547
             Q1:     -15.329309112676
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309112676
Quadratic minimum step length (  0.564283524126) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930911267575 0.00000000000 0.00000006103 0.5643  0.338    8.00000000
      ideal mu1:      -0.606827426360
             Q0:     -15.329309112676
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000001
   RMS gradient:       0.000000130471
     Trial step:       0.341597705896
             Q1:     -15.329309112676
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309112676
  Cubic LS coeff:       0.454065078019
Predicted energy:     -15.329309112676
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32930911267550 0.00000000000 0.00000009785 0.4541  2.571    8.00000000
      ideal mu1:      -0.606827496237
10    -15.32930911267568 0.00000000000 0.00000003895 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006519885260              |
           | Maximum change in energy =  0.00000037057193 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.53696611E-03     0.22970140E-03
               2       0.13878413E-06     0.79615424E-07
               3       0.11159264E-13     0.64392935E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.47714136E-03     0.20351609E-03
               2       0.10941743E-06     0.62397877E-07
               3       0.69210604E-14     0.39968029E-14
================================================================================
RMS gradient                =       0.00006519885260
Trial step length           =               0.011900
Gradient along search dir.  =         -0.00001587693
Functional at step 0        =     -15.32930911267568
Functional at step 1        =     -15.32930849636660
Functional predicted        =     -15.32930912375816
Selected quadratic step     =               0.001396
Conjugate gradients coeff.  =              -0.944996
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99990813
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000015 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606845663553
             Q0:     -15.329309122537
             G0:      -0.000000001780
   RMS gradient:       0.000007032004
     Trial step:       0.393837008138
             Q1:     -15.329309123049
 Quadratic coef:       0.000000000189
 Linear coef   :      -0.000000000701
           Qmin:     -15.329309123186
Quadratic minimum step length (  0.728849531811) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930912253686 0.00000000000 0.00000527400 0.7288  0.000    8.00000000
      ideal mu1:      -0.606840297150
             Q0:     -15.329309123185
             G0:      -0.000000000145
   RMS gradient:       0.000002008447
     Trial step:       0.535768531169
             Q1:     -15.329309123228
 Quadratic coef:       0.000000000035
 Linear coef   :      -0.000000000078
           Qmin:     -15.329309123228
Quadratic minimum step length (  0.588507148239) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930912318528 0.00000000008 0.00000150634 0.5885  0.082    8.00000000
      ideal mu1:      -0.606840307078
             Q0:     -15.329309123228
             G0:      -0.000000000022
   RMS gradient:       0.000000787004
     Trial step:       0.561519020510
             Q1:     -15.329309123232
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000013
           Qmin:     -15.329309123233
Quadratic minimum step length (  0.415246629874) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930912322813 0.00000000001 0.00000059025 0.4152  0.154    8.00000000
      ideal mu1:      -0.606840697113
             Q0:     -15.329309123233
             G0:      -0.000000000001
   RMS gradient:       0.000000147744
     Trial step:       0.482875637071
             Q1:     -15.329309123233
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123233
Quadratic minimum step length (  0.690144569989) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930912323278 0.00000000000 0.00000011081 0.6901  0.035    8.00000000
      ideal mu1:      -0.606840704825
             Q0:     -15.329309123233
             G0:      -0.000000000000
   RMS gradient:       0.000000082232
     Trial step:       0.577281559470
             Q1:     -15.329309123233
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123233
Quadratic minimum step length (  0.443734348503) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930912323303 0.00000000000 0.00000006167 0.4437  0.310    8.00000000
      ideal mu1:      -0.606840686275
             Q0:     -15.329309123233
             G0:      -0.000000000000
   RMS gradient:       0.000000041595
     Trial step:       0.506122175660
             Q1:     -15.329309123233
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123233
  Cubic LS coeff:       0.813909247548
Predicted energy:     -15.329309123233
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32930912323307 0.00000000000 0.00000003120 0.8139  0.256    8.00000000
      ideal mu1:      -0.606840683506
             Q0:     -15.329309123233
             G0:      -0.000000000000
   RMS gradient:       0.000000016032
     Trial step:       0.641823588814
             Q1:     -15.329309123233
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123233
Quadratic minimum step length (  0.268219314067) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930912323320 0.00000000000 0.00000001202 0.2682  0.000    8.00000000
      ideal mu1:      -0.606840688400
             Q0:     -15.329309123233
             G0:      -0.000000000000
   RMS gradient:       0.000000006351
     Trial step:       0.414909005378
             Q1:     -15.329309123233
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123233
Quadratic minimum step length (  0.018523681727) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -15.32930912323323 0.00000000000 0.00000000476 0.0185  0.157    8.00000000
      ideal mu1:      -0.606840688559
             Q0:     -15.329309123233
             G0:      -0.000000000000
   RMS gradient:       0.000000006123
     Trial step:       0.087667795462
             Q1:     -15.329309123233
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123233
Quadratic minimum step length (  0.000110077242) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.32930912323329 0.00000000000 0.00000000459 0.0001  0.930    8.00000000
      ideal mu1:      -0.606840688560
10    -15.32930912323331 0.00000000000 0.00000000459 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002388283040              |
           | Maximum change in energy =  0.00000001055920 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.157019E-05
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.89758927E-04     0.39200402E-04
               2       0.39471049E-08     0.23567517E-08
               3       0.90222053E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.76741471E-04     0.33530865E-04
               2       0.28869533E-08     0.17250894E-08
               3       0.13397989E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00002388283040
Trial step length           =               0.004076
Gradient along search dir.  =         -0.00000187943
Functional at step 0        =     -15.32930912323331
Functional at step 1        =     -15.32930910427798
Functional predicted        =     -15.32930912378450
Selected quadratic step     =               0.000587
Conjugate gradients coeff.  =              -0.134181
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00001984
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606836766071
             Q0:     -15.329309123483
             G0:      -0.000000000083
   RMS gradient:       0.000001518573
     Trial step:       0.003106481791
             Q1:     -15.329309123483
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123483
  Cubic LS coeff:       0.004970915508
Predicted energy:     -15.329309123483
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930912348271 0.00000000000 0.00000113893 0.0050  0.000    8.00000000
      ideal mu1:      -0.606836773942
             Q0:     -15.329309123483
             G0:      -0.000000000163
   RMS gradient:       0.000001508170
     Trial step:       0.003929638471
             Q1:     -15.329309123484
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000001
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123484
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930912348301 0.00000000000 0.00000113113 0.1500  0.986    8.00000000
      ideal mu1:      -0.606837244009
             Q0:     -15.329309123503
             G0:      -0.000000000064
   RMS gradient:       0.000000905091
     Trial step:       0.024278504291
             Q1:     -15.329309123504
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -15.329309123509
Quadratic minimum step length (  0.200534760544) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930912350259 0.00000000000 0.00000067882 0.2005  0.360    8.00000000
      ideal mu1:      -0.606837646196
             Q0:     -15.329309123512
             G0:      -0.000000000014
   RMS gradient:       0.000000448782
     Trial step:       0.069775956062
             Q1:     -15.329309123512
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.329309123515
Quadratic minimum step length (  0.453810668271) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930912351154 0.00000000000 0.00000033659 0.4538  0.246    8.00000000
      ideal mu1:      -0.606837992864
             Q0:     -15.329309123515
             G0:      -0.000000000001
   RMS gradient:       0.000000222183
     Trial step:       0.177946827029
             Q1:     -15.329309123515
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123515
Quadratic minimum step length (  0.092394152987) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930912351467 0.00000000000 0.00000016664 0.0924  0.245    8.00000000
      ideal mu1:      -0.606837984957
             Q0:     -15.329309123515
             G0:      -0.000000000002
   RMS gradient:       0.000000197282
     Trial step:       0.128223423601
             Q1:     -15.329309123515
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123515
Quadratic minimum step length (  0.093229205364) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.32930912351472 0.00000000000 0.00000014796 0.0932  0.788    8.00000000
      ideal mu1:      -0.606837954745
             Q0:     -15.329309123515
             G0:      -0.000000000001
   RMS gradient:       0.000000147948
     Trial step:       0.109335117375
             Q1:     -15.329309123515
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123515
  Cubic LS coeff:       0.179240381032
Predicted energy:     -15.329309123515
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930912351489 0.00000000000 0.00000011096 0.1792  0.000    8.00000000
      ideal mu1:      -0.606837918485
             Q0:     -15.329309123515
             G0:      -0.000000000001
   RMS gradient:       0.000000103067
     Trial step:       0.139990242869
             Q1:     -15.329309123515
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123515
Quadratic minimum step length (  0.162514471428) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930912351495 0.00000000000 0.00000007730 0.1625  0.485    8.00000000
      ideal mu1:      -0.606837879958
             Q0:     -15.329309123515
             G0:      -0.000000000000
   RMS gradient:       0.000000056651
     Trial step:       0.150832490946
             Q1:     -15.329309123515
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123515
  Cubic LS coeff:       0.194918319415
Predicted energy:     -15.329309123515
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.32930912351498 0.00000000000 0.00000004249 0.1949  0.302    8.00000000
      ideal mu1:      -0.606837852056
10    -15.32930912351517 0.00000000000 0.00000002001 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002112405158              |
           | Maximum change in energy =  0.00000000351921 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        7.95506312148289 |
           | Pseudopotential (local)    :      -42.22104959003986 |
           | Pseudopotential (non-local):       -0.81698325109721 |
           | Hartree                    :       17.50741575718752 |
           | Exchange-correlation       :       -3.68960440901935 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.32930912351517 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -42.22104959003968 |
           | Hartree                    :       17.50741575718747 |
           --------------------------------------------------------
           Integrated density           :        8.00000000000005
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.61577244E-04     0.26747222E-04
               2       0.18464034E-08     0.10918956E-08
               3       0.10785211E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54488814E-04     0.23661538E-04
               2       0.14453661E-08     0.85430885E-09
               3       0.10282792E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00002112405158
Trial step length           =               0.001546
Gradient along search dir.  =         -0.00000156513
Functional at step 0        =     -15.32930912351517
Functional at step 1        =     -15.32930911548308
Functional predicted        =     -15.32930912365525
Selected quadratic step     =               0.000179
Conjugate gradients coeff.  =              -0.782317
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998921
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606839987882
             Q0:     -15.329309123738
             G0:      -0.000000000025
   RMS gradient:       0.000000838705
     Trial step:       0.171464327626
             Q1:     -15.329309123741
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -15.329309123745
Quadratic minimum step length (  0.550026585002) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930912373763 0.00000000000 0.00000062903 0.5500  0.000    8.00000000
      ideal mu1:      -0.606839502641
             Q0:     -15.329309123746
             G0:      -0.000000000003
   RMS gradient:       0.000000269940
     Trial step:       0.307099232454
             Q1:     -15.329309123747
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.329309123747
Quadratic minimum step length (  0.663214838846) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.32930912374616 0.00000000000 0.00000020246 0.6632  0.104    8.00000000
      ideal mu1:      -0.606839333902
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000090143
     Trial step:       0.451301194284
             Q1:     -15.329309123747
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123747
  Cubic LS coeff:       0.564420419507
Predicted energy:     -15.329309123747
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -15.32930912374720 0.00000000000 0.00000006761 0.5644  0.112    8.00000000
      ideal mu1:      -0.606839388447
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000032484
     Trial step:       0.504701505250
             Q1:     -15.329309123747
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123747
  Cubic LS coeff:       0.588443158493
Predicted energy:     -15.329309123747
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930912374717 0.00000000000 0.00000002436 0.5884  0.130    8.00000000
      ideal mu1:      -0.606839392395
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000018641
     Trial step:       0.544966189635
             Q1:     -15.329309123747
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123747
Quadratic minimum step length (  0.757863001687) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930912374724 0.00000000000 0.00000001398 0.7579  0.329    8.00000000
      ideal mu1:      -0.606839393554
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000004709
     Trial step:       0.642658316911
             Q1:     -15.329309123747
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123747
Quadratic minimum step length (  0.001046869460) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32930912374735 0.00000000000 0.00000000353 0.0010  0.064    8.00000000
      ideal mu1:      -0.606839393550
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000004699
     Trial step:       0.025937990776
             Q1:     -15.329309123747
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123747
Quadratic minimum step length (  0.000002351722) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.32930912374735 0.00000000000 0.00000000352 0.0000  0.000    8.00000000
      ideal mu1:      -0.606839393550
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000004699
     Trial step:       0.000246979642
             Q1:     -15.329309123747
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123747
  Cubic LS coeff:       0.000316954352
Predicted energy:     -15.329309123747
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930912374732 0.00000000000 0.00000000352 0.0003  1.000    8.00000000
      ideal mu1:      -0.606839393548
             Q0:     -15.329309123747
             G0:      -0.000000000000
   RMS gradient:       0.000000004693
     Trial step:       0.000279787906
             Q1:     -15.329309123747
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123747
  Cubic LS coeff:       0.000376918361
Predicted energy:     -15.329309123747
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32930912374733 0.00000000000 0.00000000352 0.0004  0.998    8.00000000
      ideal mu1:      -0.606839393545
10    -15.32930912374730 0.00000000000 0.00000000351 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001053971512              |
           | Maximum change in energy =  0.00000000009395 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.268330E-06
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11680358E-04     0.50858151E-05
               2       0.66605299E-10     0.39560799E-10
               3       0.79960912E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.98931434E-05     0.43079264E-05
               2       0.47785825E-10     0.28386182E-10
               3       0.56259597E-15     0.24980018E-15
================================================================================
RMS gradient                =       0.00001053971512
Trial step length           =               0.000526
Gradient along search dir.  =         -0.00000036603
Functional at step 0        =     -15.32930912374730
Functional at step 1        =     -15.32930912330998
Functional predicted        =     -15.32930912376202
Selected quadratic step     =               0.000080
Conjugate gradients coeff.  =              -0.248945
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000272
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606838855291
             Q0:     -15.329309123733
             G0:      -0.000000000002
   RMS gradient:       0.000000206541
     Trial step:       0.000324741742
             Q1:     -15.329309123733
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123733
Quadratic minimum step length (  0.000003798819) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930912373324 0.00000000000 0.00000015491 0.0000  0.000    8.00000000
      ideal mu1:      -0.606838855292
             Q0:     -15.329309123733
             G0:      -0.000000000003
   RMS gradient:       0.000000206540
     Trial step:       0.000035123143
             Q1:     -15.329309123733
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123733
Quadratic minimum step length (  0.000000029625) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930912373320 0.00000000000 0.00000015490 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855292
             Q0:     -15.329309123733
             G0:      -0.000000000005
   RMS gradient:       0.000000206540
     Trial step:       0.000001020065
             Q1:     -15.329309123733
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123733
  Cubic LS coeff:       0.000006364101
Predicted energy:     -15.329309123733
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930912373321 0.00000000000 0.00000015490 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855296
             Q0:     -15.329309123733
             G0:      -0.000000000006
   RMS gradient:       0.000000206534
     Trial step:       0.000002547900
             Q1:     -15.329309123733
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123733
  Cubic LS coeff:       0.000008484753
Predicted energy:     -15.329309123733
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930912373316 0.00000000000 0.00000015490 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855303
             Q0:     -15.329309123733
             G0:      -0.000000000008
   RMS gradient:       0.000000206525
     Trial step:       0.000004649549
             Q1:     -15.329309123733
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123733
Quadratic minimum step length (  0.000000000881) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930912373321 0.00000000000 0.00000015489 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855303
             Q0:     -15.329309123733
             G0:      -0.000000000009
   RMS gradient:       0.000000206525
     Trial step:       0.000000064017
             Q1:     -15.329309123733
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123733
Quadratic minimum step length (  0.000000000001) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.32930912373321 0.00000000000 0.00000015489 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855303
             Q0:     -15.329309123733
             G0:      -0.000000000002
   RMS gradient:       0.000000206525
     Trial step:       0.000000000220
             Q1:     -15.329309123733
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123733
  Cubic LS coeff:       0.000000000233
Predicted energy:     -15.329309123733
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.32930912373321 0.00000000000 0.00000015489 0.0000  0.000    8.00000000
      ideal mu1:      -0.606838855303
             Q0:     -15.329309123733
             G0:      -0.000000000003
   RMS gradient:       0.000000206525
     Trial step:       0.000000000227
             Q1:     -15.329309123733
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123733
  Cubic LS coeff:       0.000000000621
Predicted energy:     -15.329309123733
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930912373320 0.00000000000 0.00000015489 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855303
             Q0:     -15.329309123733
             G0:      -0.000000000005
   RMS gradient:       0.000000206525
     Trial step:       0.000000000375
             Q1:     -15.329309123733
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123733
  Cubic LS coeff:       0.000000000621
Predicted energy:     -15.329309123733
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.32930912373321 0.00000000000 0.00000015489 0.0000  1.000    8.00000000
      ideal mu1:      -0.606838855303
10    -15.32930912373322 0.00000000000 0.00000015489 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000603793598              |
           | Maximum change in energy =  0.00000000007738 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.60761710E-05     0.26439501E-05
               2       0.18011207E-10     0.10685119E-10
               3       0.84733858E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.58987980E-05     0.25655863E-05
               2       0.16966177E-10     0.10057066E-10
               3       0.88910041E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00000603793598
Trial step length           =               0.000206
Gradient along search dir.  =         -0.00000009571
Functional at step 0        =     -15.32930912373322
Functional at step 1        =     -15.32930912374791
Functional predicted        =     -15.32930912375261
Selected quadratic step     =               0.000405
Conjugate gradients coeff.  =              -0.328185
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998180
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.606842457997
             Q0:     -15.329309123460
             G0:      -0.000000000051
   RMS gradient:       0.000001188441
     Trial step:       0.000000000483
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.329309123460
Quadratic minimum step length (  0.000000000000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.32930912346026 0.00000000000 0.00000089133 0.0000  0.000    8.00000000
      ideal mu1:      -0.606842457997
             Q0:     -15.329309123460
             G0:      -0.000000000102
   RMS gradient:       0.000001188441
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:      -0.000041928492
Predicted energy:     -23.485987365223
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.32930912346026 0.00000000000 0.00000089133-0.0000  1.000    8.00000000
      ideal mu1:      -0.606842458100
             Q0:     -15.329309123460
             G0:      -0.000000000153
   RMS gradient:       0.000001188578
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.329309123460
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.32930912346032-0.00000000000 0.00000089143 0.0000  1.000    8.00000000
      ideal mu1:      -0.606842458100
             Q0:     -15.329309123460
             G0:      -0.000000000203
   RMS gradient:       0.000001188578
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.329309123460
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.32930912346031 0.00000000000 0.00000089143 0.0000  1.000    8.00000000
      ideal mu1:      -0.606842458100
             Q0:     -15.329309123460
             G0:      -0.000000000254
   RMS gradient:       0.000001188578
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.329309123460
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.32930912346032 0.00000000000 0.00000089143 0.0000  1.000    8.00000000
      ideal mu1:      -0.606842458100
             Q0:     -15.329309123460
             G0:      -0.000000000305
   RMS gradient:       0.000001188578
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.329309123460
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.32930912346031 0.00000000000 0.00000089143 0.0000  1.000    8.00000000
      ideal mu1:      -0.606842458100
             Q0:     -15.329309123460
             G0:      -0.000000000051
   RMS gradient:       0.000001188578
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.329309123460
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.32930912346033 0.00000000000 0.00000089143 0.0000  0.000    8.00000000
      ideal mu1:      -0.606842458100
             Q0:     -15.329309123460
             G0:      -0.000000000102
   RMS gradient:       0.000001188578
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
  Cubic LS coeff:      -0.000044566885
Predicted energy:     -56.995731093208
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.32930912346032 0.00000000000 0.00000089143-0.0000  1.000    8.00000000
      ideal mu1:      -0.606842458210
             Q0:     -15.329309123460
             G0:      -0.000000000153
   RMS gradient:       0.000001188724
     Trial step:       0.000000000000
             Q1:     -15.329309123460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.329309123460
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.32930912346029-0.00000000000 0.00000089154 0.1500  1.000    8.00000000
      ideal mu1:      -0.606841901677
10    -15.32930912347617 0.00000000000 0.00000037419 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00003040264170              |
           | Maximum change in energy =  0.00000000008568 / atom  |
           | Criteria satisfied:                                  |
           | -> Energy change per atom lower than set threshold.  |
           | -> Maximum degree of convergence for applied level   |
           |    of density kernel truncation has been reached.    | 
           ========================================================
WARNING: No kernel truncation, yet energy has risen on last 2 iterations.
WARNING: This most likely indicates, a problem with the density kernel.
WARNING: Either kernel occupation numbers may be unreliable, or
WARNING: requested NGWF gradient tolerance may be unachievable.

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        7.95504410174754 |
           | Pseudopotential (local)    :      -42.22100509217704 |
           | Pseudopotential (non-local):       -0.81698099345333 |
           | Hartree                    :       17.50738128950529 |
           | Exchange-correlation       :       -3.68959767706947 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.32930912347617 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -42.22100509217699 |
           | Hartree                    :       17.50738128950534 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999996
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.07381511598814    -14.67880339615609   0.059221    -15.21040946280195
   2     0.02592774302058    -15.20887261608213   0.070235    -15.28532949654787
   3     0.01284983943095    -15.29074875574624   0.084251    -15.31502919953006
   4     0.00786166777391    -15.31616161332593   0.084178    -15.32515264100093
   5     0.00481094346018    -15.32528700937058   0.063891    -15.32772326195548
   6     0.00277496276612    -15.32772425927024   0.087943    -15.32884010276075
   7     0.00174908733730    -15.32883675742296   0.076226    -15.32921968516087
   8     0.00084148739220    -15.32922759517716   0.051663    -15.32928900134271
   9     0.00034848400707    -15.32929093790627   0.074755    -15.32930589453152
  10     0.00018308891648    -15.32930524795080   0.066678    -15.32930893035210
  11     0.00024018729915    -15.32930796928230   0.010702    -15.32930924339337
  12     0.00006706948638    -15.32930908099809   0.005258    -15.32930911996424
  13     0.00006519885260    -15.32930911267568   0.001396    -15.32930912375816
  14     0.00002388283040    -15.32930912323331   0.000587    -15.32930912378450
  15     0.00002112405158    -15.32930912351517   0.000179    -15.32930912365525
  16     0.00001053971512    -15.32930912374730   0.000080    -15.32930912376202
  17     0.00000603793598    -15.32930912373322   0.000405    -15.32930912375261
  18     0.00003040264170    -15.32930912347617  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.293230560 Eh
                 Mid-gap level:      -0.089471240 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.319012674   1.0000000
                            2    -0.472458765   1.0000000
                            3    -0.399809648   1.0000000
                            4    -0.236086520   1.0000000
                        .......   --- gap ---   .........
                            5     0.057144040   0.0000000
                            6     0.182821905   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.68385786  -0.09627795  -0.10690012 *
*    H       2     -1.03390042   0.83026503  -1.03062229 *
*    H       3     -1.00249954  -0.71629424   1.14944240 *
*                                                        *
**********************************************************
TOTAL:             -0.35254210   0.01769284   0.01191999
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.33145570  -0.01820192  -0.02840391 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.33145570  -0.01820192  -0.02840391
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00181610  -0.00017817   0.00036673 *
*    H       2      0.00036245   0.00046603  -0.00032880 *
*    H       3      0.00071747  -0.00010055   0.00062758 *
*                                                        *
**********************************************************
TOTAL:              0.00289602   0.00018731   0.00066551
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00606346  -0.00010726  -0.00527280 *
*    H       2     -0.00606346  -0.00010726  -0.00527280 *
*    H       3     -0.00606346  -0.00010726  -0.00527280 *
*                                                        *
**********************************************************
TOTAL:             -0.01819038  -0.00032177  -0.01581841

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.27755624   0.01837991   0.00484152 *
*    H       2      0.14188511  -0.09986422   0.11447981 *
*    H       3      0.13567113   0.08148431  -0.11932133 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     245.220s on      3 node(s)                                    
TOTAL TIME:       245.220s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    72        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    35        0.00s   0.001%  ------ ||
|| pseudopotentials_nonlocal_mat        :    35        0.00s   0.002%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.002%  ------ ||
|| restart_ngwfs_tightbox_output        :    17        0.00s   0.002%  ------ ||
|| restart_kernel_write                 :    20        0.00s   0.002%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.002%  ------ ||
|| integrals_grad                       :     1        0.01s   0.003%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.01s   0.003%  ------ ||
|| basis_dot_function_with_box          :  2801        0.01s   0.005%  ------ ||
|| sparse_hotelling_invert              :    35        0.01s   0.005%  ------ ||
|| ngwf_gradient_coeffs                 :    18        0.01s   0.006%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.02s   0.008%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.02s   0.009%  ------ ||
|| basis_add_function_to_box            :  5712        0.02s   0.010%  ------ ||
|| pseudo_make_structure_factor         :     1        0.04s   0.015%  ------ ||
|| density_initial_guess_real           :     1        0.05s   0.019%  ------ ||
|| fourier_apply_box_pair               :   120        0.06s   0.024%  16.635 ||
|| basis_copy_function_to_box           :  1300        0.06s   0.026%  ------ ||
|| integrals_kinetic                    :    35        0.10s   0.040%  ------ ||
|| lnv_gradient_norm                    :   180        0.11s   0.046%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.12s   0.048%  ------ ||
|| kernel_fix                           :   180        0.12s   0.051%  ------ ||
|| kernel_purify                        :   587        0.15s   0.059%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.15s   0.060%  ------ ||
|| projectors_gradient_batch            :    18        0.16s   0.065%  ------ ||
|| sparse_trace                         :  4968        0.16s   0.065%  ------ ||
|| forces_calculate                     :     1        0.20s   0.083%  ------ ||
|| density_batch_row_sums               :   404        0.21s   0.087%  ------ ||
|| projectors_func_ovlp_box             :    35        0.23s   0.092%  ------ ||
|| projectors_init_fftbox_recip         :    56        0.26s   0.105%  ------ ||
|| sparse_product                       :  6312        0.27s   0.111%  ------ ||
|| integrals_locpot_mat_els_batch       :   193        0.52s   0.213%  ------ ||
|| properties_calculate                 :     1        0.62s   0.252%  ------ ||
|| ngwf_gradient_batch                  :    18        1.04s   0.426%  ------ ||
|| ngwf_gradient_lnv                    :    18        1.21s   0.495%  ------ ||
|| cell_grid_extract_box                :   880        1.41s   0.575%  ------ ||
|| hamiltonian_energy_components        :     4        2.73s   1.115%  ------ ||
|| cell_grid_deposit_box                :  1617        4.11s   1.676%  ------ ||
|| density_fftbox_deposit_to_cell       :  1616        4.12s   1.679%  ------ ||
|| fourier_apply_box                    :  2998        4.40s   1.794%  27.767 ||
|| density_fftbox_interpolate_multiply  :  1616        4.54s   1.853%  ------ ||
|| potential_apply_to_ngwf_batch        :   193        5.05s   2.060%  ------ ||
|| penalty_denskernel_optimise_cg       :     1        5.31s   2.167%  ------ ||
|| integrals_locpot_dbl_grid            :   193        5.67s   2.310%  ------ ||
|| density_batch_interp_deposit         :   404        9.16s   3.733%  ------ ||
|| density_on_dbl_grid                  :   404       10.99s   4.483%  ------ ||
|| hartree_on_grid                      :   404       33.52s  13.670%  ------ ||
|| fourier_apply_cell_forward           :  2021       74.96s  30.567%   6.115 ||
|| fourier_apply_cell_backward          :  2021       84.70s  34.540%   5.412 ||
|| xc_energy_potential                  :   404      178.40s  72.750%  ------ ||
|| lnv_denskernel_optimise_cg           :    18      223.69s  91.222%  ------ ||
|| ngwf_cg_optimise                     :     1      238.01s  97.061%  ------ ||
|| total_time                           :     1      245.22s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 16:43 (-0000)

