 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 16:57 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 11.0246982673597      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  117 x 117 x 117
                              FFT-box:   45 x  45 x  45
                                  PPD:    9 x   9 x   1
Grid space d1=  0.807575347436a0 (KE cutoff=  11.64764Eh = 316.94838eV)
Grid space d2=  0.807575347436a0 (KE cutoff=  11.64764Eh = 316.94838eV)
Grid space d3=  0.807575347436a0 (KE cutoff=  11.64764Eh = 316.94838eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    117   117   117
          Real-space ('12') slabs/node (min max mean):     39    39    39
         Recip-space ('23') slabs/node (min max mean):     19    20    19
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    234   234   234
          Real-space ('12') slabs/node (min max mean):     78    78    78
         Recip-space ('23') slabs/node (min max mean):     39    40    39
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1260      5780
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  553    0.0108695652    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   21    1   66.1481896042
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3707.4031314259   -7.1201798812   10.1554635880   -2.4512395521
  2 1471.7073938368   -3.1442955109   13.3511566179   -3.1747095552
  3  757.7279538472   -2.9484393479   13.5591511522   -3.2265046037
  4  386.5396724148   -2.9070673233   13.6038454923   -3.2393522651
  5  193.5322761020   -2.8935475582   13.6185777968   -3.2442248304
  6   93.1697941903   -2.8876474105   13.6250358915   -3.2465275687
  7   40.9815096975   -2.8847974286   13.6281616392   -3.2476863209
  8   13.8436429868   -2.8833806799   13.6297170525   -3.2482780426
  9   -0.2680364437   -2.8826704553   13.6304972917   -3.2485812693
 10   -7.6061059415   -2.8823133833   13.6308897594   -3.2487368365
 11  -11.4219006580   -2.8821336427   13.6310874050   -3.2488167052
 12  -13.4061133641   -2.8820431102   13.6311869989   -3.2488577369
 13  -14.4379037662   -2.8819974939   13.6312372027   -3.2488788306
 14  -14.9744347041   -2.8819745038   13.6312625162   -3.2488896820
 15  -15.2534307721   -2.8819629149   13.6312752823   -3.2488952684
 16  -15.3985087258   -2.8819570723   13.6312817216   -3.2488981463
 17  -15.4739492650   -2.8819541262   13.6312849702   -3.2488996301
 18  -15.5131783495   -2.8819526404   13.6312866094   -3.2489003956
 19  -15.5335774766   -2.8819518910   13.6312874367   -3.2489007908
 20  -15.5441850250   -2.8819515130   13.6312878543   -3.2489009950
 21  -15.5497009516   -2.8819513223   13.6312880651   -3.2489011007
 22  -15.5525692344   -2.8819512260   13.6312881716   -3.2489011553
 23  -15.5540607420   -2.8819511774   13.6312882253   -3.2489011836
 24  -15.5548363263   -2.8819511529   13.6312882525   -3.2489011983
 25  -15.5552396303   -2.8819511405   13.6312882662   -3.2489012059
 26  -15.5554493486   -2.8819511342   13.6312882732   -3.2489012098
 27  -15.5555584021   -2.8819511311   13.6312882767   -3.2489012119
 28  -15.5556151100   -2.8819511295   13.6312882784   -3.2489012130
 29  -15.5556445981   -2.8819511287   13.6312882793   -3.2489012135
 30  -15.5556599319   -2.8819511283   13.6312882798   -3.2489012138
 31  -15.5556679055   -2.8819511281   13.6312882800   -3.2489012140
 32  -15.5556720518   -2.8819511280   13.6312882801   -3.2489012140
 33  -15.5556742079   -2.8819511279   13.6312882802   -3.2489012141
 34  -15.5556753290   -2.8819511279   13.6312882802   -3.2489012141
 35  -15.5556759120   -2.8819511279   13.6312882802   -3.2489012141
 36  -15.5556762152   -2.8819511279   13.6312882802   -3.2489012141
 37  -15.5556763728   -2.8819511279   13.6312882802   -3.2489012141
 38  -15.5556764548   -2.8819511279   13.6312882803   -3.2489012141
Atom SCF converged after  38 iterations to a total energy of    -15.55567645

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  553    0.0108695652    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   21    0   66.1481896042
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  619.2906844721   -0.2254747895    0.2820962108   -0.2424203412
  2  247.4581643748   -0.2112614795    0.3031935075   -0.2589090051
  3  128.4658097459   -0.2047615710    0.3114484756   -0.2660448600
  4   66.5896143739   -0.2012993929    0.3157747933   -0.2698854391
  5   34.4142182799   -0.1995641817    0.3179315886   -0.2718363293
  6   17.6831834402   -0.1987159542    0.3189814894   -0.2728025427
  7    8.9831383874   -0.1983058867    0.3194867098   -0.2732757685
  8    4.4591600789   -0.1981085867    0.3197285179   -0.2735065541
  9    2.1067119384   -0.1980138082    0.3198439955   -0.2736190283
 10    0.8834478856   -0.1979682729    0.3198991143   -0.2736739137
 11    0.2473543314   -0.1979463718    0.3199254342   -0.2737007621
 12   -0.0834128304   -0.1979358201    0.3199380141   -0.2737139366
 13   -0.2554112127   -0.1979307260    0.3199440345   -0.2737204244
 14   -0.3448502036   -0.1979282609    0.3199469197   -0.2737236315
 15   -0.3913584475   -0.1979270651    0.3199483046   -0.2737252234
 16   -0.4155427455   -0.1979264835    0.3199489704   -0.2737260167
 17   -0.4281185998   -0.1979261999    0.3199492910   -0.2737264138
 18   -0.4346580608   -0.1979260612    0.3199494456   -0.2737266133
 19   -0.4380585925   -0.1979259932    0.3199495203   -0.2737267140
 20   -0.4398268769   -0.1979259597    0.3199495564   -0.2737267651
 21   -0.4407463898   -0.1979259432    0.3199495739   -0.2737267910
 22   -0.4412245395   -0.1979259351    0.3199495824   -0.2737268043
 23   -0.4414731791   -0.1979259310    0.3199495865   -0.2737268111
 24   -0.4416024727   -0.1979259290    0.3199495885   -0.2737268146
 25   -0.4416697060   -0.1979259280    0.3199495895   -0.2737268164
 26   -0.4417046677   -0.1979259275    0.3199495900   -0.2737268173
 27   -0.4417228479   -0.1979259273    0.3199495902   -0.2737268178
 28   -0.4417323018   -0.1979259272    0.3199495903   -0.2737268181
 29   -0.4417372178   -0.1979259271    0.3199495904   -0.2737268182
 30   -0.4417397742   -0.1979259271    0.3199495904   -0.2737268183
 31   -0.4417411035   -0.1979259271    0.3199495904   -0.2737268183
 32   -0.4417417948   -0.1979259270    0.3199495904   -0.2737268183
 33   -0.4417421543   -0.1979259270    0.3199495904   -0.2737268183
 34   -0.4417423412   -0.1979259270    0.3199495904   -0.2737268183
 35   -0.4417424384   -0.1979259270    0.3199495904   -0.2737268183
Atom SCF converged after  35 iterations to a total energy of     -0.44174244
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20227249E+01     0.84994435E+00
               2       0.18036108E+01     0.73027281E+00
               3       0.15507648E+01     0.56315926E+00
               4       0.13101124E+01     0.48865563E+00
               5       0.11074752E+01     0.41803964E+00
               6       0.85949709E+00     0.32469249E+00
               7       0.52257938E+00     0.19786942E+00
               8       0.19348598E+00     0.73566899E-01
               9       0.26679445E-01     0.10197766E-01
              10       0.51844967E-03     0.20270699E-03
              11       0.20966561E-06     0.88913544E-07
              12       0.39429032E-13     0.17541524E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.43778381763755    0.5875420
               2          -1.50828429543796    0.5769983
               3          -1.59922415291477    0.5593690
               4          -1.70696832708736    0.5337944
               5          -1.81497886981173    0.5066103
               6          -1.89421070112164    0.4943142
               7          -1.92843517942455    0.4985190
               8          -1.93667764636915    0.4999792
               9          -1.93722078312208    0.5000000
              10          -1.93722306125309    0.5000603
              11          -1.93722306129308    0.5000603
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999999]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.065754486405=    -16.065754486405+      0.000000000000
    Trial step:       1.000000000000
            G0:      -4.520234678793
WARNING: minimum value of charge density: -0.0529
      Q1=E1+P1:      74.391460071173=    -20.396333147212+     94.787793218384
Quadratic term:     -94.977449236371
   Linear term:      -4.520234678793
  Optimal step:       0.023796357531
 Predicted min:     -16.119537046675
    !!! Quadratic minimum step length accepted !!!
 1    -16.06575448640542 0.35434739227 0.01225037712 0.0238  0.000    8.00000000
      Q0=E0+P0:     -16.162333956568=    -16.173174793032+      0.010840836464
    Trial step:       0.154260680443
            G0:      -0.003753007757
      Q1=E1+P1:     -16.162879085092=    -16.173801498735+      0.010922413643
Quadratic term:      -0.000033813007
   Linear term:      -0.000578941530
  Optimal step:       1.320614808807
 Predicted min:     -16.164812095379
    !!! Quadratic minimum step length accepted !!!
 2    -16.17317479303244 0.27992107208 0.01177539867 1.3206 -0.789    8.00000000
      Q0=E0+P0:     -16.164753190687=    -16.178018421372+      0.013265230685
    Trial step:       0.451352344638
WARNING: internal_polak_cg_coeff =  8.00279
WARNING: setting internal_polak_cg_coeff to zero
            G0:      -2.844262260871
WARNING: minimum value of charge density: -0.0035
      Q1=E1+P1:     -11.746630375930=    -17.750138950414+      6.003508574484
Quadratic term:      -5.701887254967
   Linear term:      -1.283764440210
  Optimal step:       0.050810377700
 Predicted min:     -16.237012210563
    !!! Quadratic minimum step length accepted !!!
 3    -16.17801842137191 0.28108234563 0.00954187041 0.0508  0.000    8.00000000
WARNING: minimum value of charge density: -0.0003

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.359034570092
   Final penalty energy   :       0.088293912425
   RMS occupancy error    :       0.060654
   Occupancy bounds       : [-0.070, 1.097]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.060654 (step -0.4013 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.003253 (step -0.4972 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000023 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.497886741839
             Q0:     -16.066941588972
             G0:      -0.004902585704
   RMS gradient:       0.011669744479
     Trial step:       0.500000000000
             Q1:     -16.067433698620
 Quadratic coef:       0.001959183204
 Linear coef   :      -0.002451292852
           Qmin:     -16.067708341749
Quadratic minimum step length (  0.312795256534) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000121 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.06694158897227 0.00000000000 0.00875230828 0.3128  0.000    8.00000000
      ideal mu1:      -0.488764103736
             Q0:     -16.067707761773
             G0:      -0.000047311315
   RMS gradient:       0.001146066802
     Trial step:       0.395471400062
             Q1:     -16.067722302916
 Quadratic coef:       0.000004169129
 Linear coef   :      -0.000018710272
           Qmin:     -16.067728753824
Quadratic minimum step length (  0.887400862868) accepted
    Initial Ne1:       8.00000030
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000013 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.06770776177315 0.00009584410 0.00085955011 0.8874  0.010    8.00000000
      ideal mu1:      -0.489499891920
             Q0:     -16.067728743291
             G0:      -0.000005731122
   RMS gradient:       0.000399198108
     Trial step:       0.592403293082
             Q1:     -16.067730334822
 Quadratic coef:       0.000001803604
 Linear coef   :      -0.000003395135
           Qmin:     -16.067730341056
Quadratic minimum step length (  0.557575020192) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.06772874329135 0.00000265077 0.00029939858 0.5576  0.121    8.00000000
      ideal mu1:      -0.489244166240
             Q0:     -16.067730341093
             G0:      -0.000000309262
   RMS gradient:       0.000092681455
     Trial step:       0.574725393647
             Q1:     -16.067730464471
 Quadratic coef:       0.000000054363
 Linear coef   :      -0.000000177741
           Qmin:     -16.067730486374
Quadratic minimum step length (  0.939531354815) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.06773034109328 0.00000022404 0.00006951109 0.9395  0.054    8.00000000
      ideal mu1:      -0.489232265672
             Q0:     -16.067730486375
             G0:      -0.000000021553
   RMS gradient:       0.000024468037
     Trial step:       0.734828230092
             Q1:     -16.067730491009
 Quadratic coef:       0.000000011204
 Linear coef   :      -0.000000015838
           Qmin:     -16.067730491972
Quadratic minimum step length (  0.519354685300) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.06773048637528 0.00000001926 0.00001835103 0.5194  0.070    8.00000000
      ideal mu1:      -0.489251789074
             Q0:     -16.067730491972
             G0:      -0.000000005646
   RMS gradient:       0.000012522981
     Trial step:       0.617767338234
             Q1:     -16.067730493597
 Quadratic coef:       0.000000001863
 Linear coef   :      -0.000000003488
           Qmin:     -16.067730493605
Quadratic minimum step length (  0.578277616197) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.06773049197211 0.00000000075 0.00000939224 0.5783  0.262    8.00000000
      ideal mu1:      -0.489244263047
             Q0:     -16.067730493605
             G0:      -0.000000000293
   RMS gradient:       0.000002853334
     Trial step:       0.597696431074
             Q1:     -16.067730493682
 Quadratic coef:       0.000000000098
 Linear coef   :      -0.000000000175
           Qmin:     -16.067730493683
Quadratic minimum step length (  0.536614449011) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.06773049360482 0.00000000026 0.00000214000 0.5366  0.000    8.00000000
      ideal mu1:      -0.489245932337
             Q0:     -16.067730493684
             G0:      -0.000000000034
   RMS gradient:       0.000000970523
     Trial step:       0.566332535739
             Q1:     -16.067730493690
 Quadratic coef:       0.000000000013
 Linear coef   :      -0.000000000019
           Qmin:     -16.067730493691
Quadratic minimum step length (  0.431252145321) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.06773049368363 0.00000000001 0.00000072789 0.4313  0.116    8.00000000
      ideal mu1:      -0.489245373642
             Q0:     -16.067730493691
             G0:      -0.000000000004
   RMS gradient:       0.000000309836
     Trial step:       0.494198463173
             Q1:     -16.067730493692
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.067730493694
Quadratic minimum step length (  1.604153584548) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.06773049369096 0.00000000000 0.00000023238 1.6042  0.102    8.00000000
      ideal mu1:      -0.489245727163
10    -16.06773049369021 0.00000000000 0.00000030236 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.02118642738293              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.69265245E-01     0.59091593E-01
               2       0.36449421E-02     0.34382222E-02
               3       0.12083699E-04     0.11687143E-04
               4       0.13955456E-09     0.13512125E-09
               5       0.81161971E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.29845580E-01     0.24739945E-01
               2       0.65497897E-03     0.60917986E-03
               3       0.38561306E-06     0.37177460E-06
               4       0.14328542E-12     0.13844481E-12
================================================================================
RMS gradient                =       0.02118642738293
Trial step length           =               0.122474
Gradient along search dir.  =         -4.62644851703
Functional at step 0        =     -16.06773049369021
Functional at step 1        =     -16.42766125660771
Functional predicted        =     -16.45606399717621
Selected quadratic step     =               0.167875
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.22505160
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.027334 (step -0.4413 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000994 (step -0.4984 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.518495129898
             Q0:     -16.451206087395
             G0:      -0.040916742744
   RMS gradient:       0.033713145616
     Trial step:       0.890376457560
             Q1:     -16.451081549587
 Quadratic coef:       0.036555842267
 Linear coef   :      -0.036431304459
           Qmin:     -16.460282885126
Quadratic minimum step length (  0.443671569257) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001653 (step -0.4969 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.45120608739530 0.00000000000 0.02528485921 0.4437  0.000    8.00000000
      ideal mu1:      -0.480609658078
             Q0:     -16.460201618185
             G0:      -0.003821829278
   RMS gradient:       0.010310307097
     Trial step:       0.628517875764
             Q1:     -16.461173595197
 Quadratic coef:       0.001430111007
 Linear coef   :      -0.002402088019
           Qmin:     -16.461210285838
Quadratic minimum step length (  0.527845479160) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000547 (step -0.4990 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.46020161818480 0.00113459972 0.00773273032 0.5278  0.094    8.00000000
      ideal mu1:      -0.485104255131
             Q0:     -16.461215099816
             G0:      -0.000531824358
   RMS gradient:       0.003832727738
     Trial step:       0.575986388115
             Q1:     -16.461365776023
 Quadratic coef:       0.000155647384
 Linear coef   :      -0.000306323591
           Qmin:     -16.461365815716
Quadratic minimum step length (  0.566788256320) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000147 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.46121509981564 0.00013772460 0.00287454580 0.5668  0.138    8.00000000
      ideal mu1:      -0.484444853123
             Q0:     -16.461366165157
             G0:      -0.000004748338
   RMS gradient:       0.000362679912
     Trial step:       0.571368813100
             Q1:     -16.461367887257
 Quadratic coef:       0.000000990953
 Linear coef   :      -0.000002713052
           Qmin:     -16.461368022120
Quadratic minimum step length (  0.782152838044) accepted
    Initial Ne1:       8.00000010
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.46136616515745 0.00002176950 0.00027200992 0.7822  0.009    8.00000000
      ideal mu1:      -0.484693195489
             Q0:     -16.461368022134
             G0:      -0.000001275850
   RMS gradient:       0.000188264816
     Trial step:       0.668504105250
             Q1:     -16.461368200205
 Quadratic coef:       0.000000674840
 Linear coef   :      -0.000000852911
           Qmin:     -16.461368291626
Quadratic minimum step length (  0.422451510040) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.46136802213394 0.00000023517 0.00014119861 0.4225  0.269    8.00000000
      ideal mu1:      -0.484557695824
             Q0:     -16.461368291615
             G0:      -0.000000028790
   RMS gradient:       0.000028278952
     Trial step:       0.531423154116
             Q1:     -16.461368301839
 Quadratic coef:       0.000000005075
 Linear coef   :      -0.000000015299
           Qmin:     -16.461368303145
Quadratic minimum step length (  0.800958375613) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.46136829161548 0.00000004291 0.00002120921 0.8010  0.023    8.00000000
      ideal mu1:      -0.484574643486
             Q0:     -16.461368303145
             G0:      -0.000000007945
   RMS gradient:       0.000014856232
     Trial step:       0.652416911402
             Q1:     -16.461368303870
 Quadratic coef:       0.000000004458
 Linear coef   :      -0.000000005184
           Qmin:     -16.461368304652
Quadratic minimum step length (  0.379275420440) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.46136830314474 0.00000000148 0.00001114217 0.3793  0.000    8.00000000
      ideal mu1:      -0.484565408883
             Q0:     -16.461368304651
             G0:      -0.000000000665
   RMS gradient:       0.000004298844
     Trial step:       0.497439140372
             Q1:     -16.461368304888
 Quadratic coef:       0.000000000095
 Linear coef   :      -0.000000000331
           Qmin:     -16.461368304940
Quadratic minimum step length (  0.868996861027) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.46136830465128 0.00000000019 0.00000322413 0.8690  0.084    8.00000000
      ideal mu1:      -0.484567821472
             Q0:     -16.461368304939
             G0:      -0.000000000076
   RMS gradient:       0.000001455615
     Trial step:       0.657474753534
             Q1:     -16.461368304949
 Quadratic coef:       0.000000000041
 Linear coef   :      -0.000000000050
           Qmin:     -16.461368304955
Quadratic minimum step length (  0.405194258015) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.46136830493949 0.00000000004 0.00000109171 0.4052  0.115    8.00000000
      ideal mu1:      -0.484566809649
10    -16.46136830495481 0.00000000000 0.00000028333 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00590645855303              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23083705E-01     0.17418257E-01
               2       0.37633661E-03     0.30979191E-03
               3       0.11561360E-06     0.97916349E-07
               4       0.11740368E-13     0.99920072E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19631591E-01     0.14826402E-01
               2       0.26595237E-03     0.22240616E-03
               3       0.57739748E-07     0.49975742E-07
               4       0.29757346E-14     0.25535130E-14
================================================================================
RMS gradient                =       0.00590645855303
Trial step length           =               0.143389
Gradient along search dir.  =         -0.36775682190
Functional at step 0        =     -16.46136830495481
Functional at step 1        =     -16.49889545201450
Functional predicted        =     -16.50708786656111
Selected quadratic step     =               0.248640
Conjugate gradients coeff.  =               0.077721
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.08120199
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.009302 (step -0.4784 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000124 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512864714218
             Q0:     -16.506228174946
             G0:      -0.010824690668
   RMS gradient:       0.017340295611
     Trial step:       0.516144354732
             Q1:     -16.508370673750
 Quadratic coef:       0.003444604175
 Linear coef   :      -0.005587102980
           Qmin:     -16.508493726960
Quadratic minimum step length (  0.418589700827) accepted
    Initial Ne1:       7.99999956
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000409 (step -0.4991 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.50622817494551 0.00000000000 0.01300522036 0.4186  0.000    8.00000000
      ideal mu1:      -0.493508107179
             Q0:     -16.508493345659
             G0:      -0.000725656242
   RMS gradient:       0.004483306241
     Trial step:       0.464814706126
             Q1:     -16.508678665388
 Quadratic coef:       0.000151975964
 Linear coef   :      -0.000337295693
           Qmin:     -16.508680494307
Quadratic minimum step length (  0.515805245195) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000096 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.50849334565875 0.00028319400 0.00336247968 0.5158  0.067    8.00000000
      ideal mu1:      -0.494427887865
             Q0:     -16.508680644979
             G0:      -0.000083647998
   RMS gradient:       0.001523284746
     Trial step:       0.489646672064
             Q1:     -16.508707946636
 Quadratic coef:       0.000013656308
 Linear coef   :      -0.000040957964
           Qmin:     -16.508711355235
Quadratic minimum step length (  0.734273546743) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000031 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.50868064497924 0.00002501920 0.00114246356 0.7343  0.115    8.00000000
      ideal mu1:      -0.494353063092
             Q0:     -16.508711368442
             G0:      -0.000000345605
   RMS gradient:       0.000097957346
     Trial step:       0.599612040029
             Q1:     -16.508711503958
 Quadratic coef:       0.000000071713
 Linear coef   :      -0.000000207229
           Qmin:     -16.508711518149
Quadratic minimum step length (  0.866347186304) accepted
    Initial Ne1:       7.99999986
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.50871136844176 0.00000431865 0.00007346801 0.8663  0.004    8.00000000
      ideal mu1:      -0.494420022295
             Q0:     -16.508711518148
             G0:      -0.000000039377
   RMS gradient:       0.000033073383
     Trial step:       0.720744201332
             Q1:     -16.508711519142
 Quadratic coef:       0.000000027387
 Linear coef   :      -0.000000028381
           Qmin:     -16.508711525500
Quadratic minimum step length (  0.373451439942) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.50871151814762 0.00000001881 0.00002480504 0.3735  0.114    8.00000000
      ideal mu1:      -0.494392733027
             Q0:     -16.508711525500
             G0:      -0.000000000750
   RMS gradient:       0.000004563294
     Trial step:       0.518809174762
             Q1:     -16.508711525759
 Quadratic coef:       0.000000000130
 Linear coef   :      -0.000000000389
           Qmin:     -16.508711525791
Quadratic minimum step length (  0.776501209083) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.50871152549957 0.00000000102 0.00000342247 0.7765  0.019    8.00000000
      ideal mu1:      -0.494392358089
             Q0:     -16.508711525790
             G0:      -0.000000000160
   RMS gradient:       0.000002109140
     Trial step:       0.634709344098
             Q1:     -16.508711525832
 Quadratic coef:       0.000000000060
 Linear coef   :      -0.000000000102
           Qmin:     -16.508711525833
Quadratic minimum step length (  0.534636577513) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.50871152579020 0.00000000004 0.00000158186 0.5346  0.000    8.00000000
      ideal mu1:      -0.494392337106
             Q0:     -16.508711525833
             G0:      -0.000000000029
   RMS gradient:       0.000000896018
     Trial step:       0.582527966234
             Q1:     -16.508711525843
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000017
           Qmin:     -16.508711525843
Quadratic minimum step length (  0.680738801187) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.50871152583308 0.00000000001 0.00000067201 0.6807  0.180    8.00000000
      ideal mu1:      -0.494392860090
             Q0:     -16.508711525843
             G0:      -0.000000000005
   RMS gradient:       0.000000367874
     Trial step:       0.629721676133
             Q1:     -16.508711525844
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000003
           Qmin:     -16.508711525844
Quadratic minimum step length (  0.616232315001) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.50871152584286 0.00000000000 0.00000027591 0.6162  0.169    8.00000000
      ideal mu1:      -0.494392480062
10    -16.50871152584446 0.00000000000 0.00000006240 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00296150894121              |
           | Maximum change in energy =  0.13121260375487 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19058155E-01     0.98286920E-02
               2       0.23207408E-03     0.11771261E-03
               3       0.38029300E-07     0.19540257E-07
               4       0.13737637E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11444662E-01     0.59786388E-02
               2       0.81577175E-04     0.42073162E-04
               3       0.46190143E-08     0.23887433E-08
               4       0.93066629E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00296150894121
Trial step length           =               0.188818
Gradient along search dir.  =         -0.09374530749
Functional at step 0        =     -16.50871152584446
Functional at step 1        =     -16.52058029095537
Functional predicted        =     -16.52214242782265
Selected quadratic step     =               0.286540
Conjugate gradients coeff.  =               0.251404
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.03703502
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003967 (step -0.4908 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000024 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.520388760393
             Q0:     -16.521934287845
             G0:      -0.003187430548
   RMS gradient:       0.009409555645
     Trial step:       0.622940483746
             Q1:     -16.522370274271
 Quadratic coef:       0.001549593102
 Linear coef   :      -0.001985579527
           Qmin:     -16.522570346120
Quadratic minimum step length (  0.399104084132) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000105 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.52193428784500 0.00000000000 0.00705716669 0.3991  0.000    8.00000000
      ideal mu1:      -0.509986369475
             Q0:     -16.522569445125
             G0:      -0.000145045316
   RMS gradient:       0.002007057944
     Trial step:       0.498616176266
             Q1:     -16.522605885675
 Quadratic coef:       0.000035881391
 Linear coef   :      -0.000072321941
           Qmin:     -16.522605887854
Quadratic minimum step length (  0.502501279217) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52256944512549 0.00007950728 0.00150529348 0.5025  0.045    8.00000000
      ideal mu1:      -0.509929726130
             Q0:     -16.522605893326
             G0:      -0.000008173336
   RMS gradient:       0.000476306877
     Trial step:       0.500554958433
             Q1:     -16.522608753610
 Quadratic coef:       0.000001230921
 Linear coef   :      -0.000004091204
           Qmin:     -16.522609292804
Quadratic minimum step length (  0.831845714889) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52260589332639 0.00000476341 0.00035723016 0.8318  0.056    8.00000000
      ideal mu1:      -0.509884811593
             Q0:     -16.522609293016
             G0:      -0.000000019044
   RMS gradient:       0.000022999132
     Trial step:       0.645278619853
             Q1:     -16.522609301111
 Quadratic coef:       0.000000004194
 Linear coef   :      -0.000000012289
           Qmin:     -16.522609302017
Quadratic minimum step length (  0.945259795431) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.52260929301618 0.00000045026 0.00001724935 0.9453  0.002    8.00000000
      ideal mu1:      -0.509893361070
             Q0:     -16.522609302017
             G0:      -0.000000003116
   RMS gradient:       0.000009303891
     Trial step:       0.780996758123
             Q1:     -16.522609302124
 Quadratic coef:       0.000000002327
 Linear coef   :      -0.000000002434
           Qmin:     -16.522609302654
Quadratic minimum step length (  0.408490940330) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.52260930201721 0.00000000113 0.00000697792 0.4085  0.164    8.00000000
      ideal mu1:      -0.509888855408
             Q0:     -16.522609302654
             G0:      -0.000000000039
   RMS gradient:       0.000001043551
     Trial step:       0.564827495896
             Q1:     -16.522609302668
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000022
           Qmin:     -16.522609302670
Quadratic minimum step length (  0.843043354778) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.52260930265374 0.00000000009 0.00000078266 0.8430  0.013    8.00000000
      ideal mu1:      -0.509889455308
             Q0:     -16.522609302670
             G0:      -0.000000000014
   RMS gradient:       0.000000632582
     Trial step:       0.690053669660
             Q1:     -16.522609302671
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000010
           Qmin:     -16.522609302673
Quadratic minimum step length (  0.406487973603) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52260930266973 0.00000000000 0.00000047444 0.4065  0.000    8.00000000
      ideal mu1:      -0.509889035497
             Q0:     -16.522609302673
             G0:      -0.000000000002
   RMS gradient:       0.000000212780
     Trial step:       0.529621107828
             Q1:     -16.522609302673
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.522609302673
Quadratic minimum step length (  0.711805229499) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.52260930267288 0.00000000000 0.00000015959 0.7118  0.113    8.00000000
      ideal mu1:      -0.509889117327
             Q0:     -16.522609302673
             G0:      -0.000000000000
   RMS gradient:       0.000000081092
     Trial step:       0.613992731394
             Q1:     -16.522609302674
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.522609302673
  Cubic LS coeff:       0.712051688446
Predicted energy:     -16.522609302674
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52260930267342 0.00000000000 0.00000006082 0.7121  0.145    8.00000000
      ideal mu1:      -0.509889138930
10    -16.52260930267345 0.00000000000 0.00000003481 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00173697342034              |
           | Maximum change in energy =  0.01578107362988 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18206366E-01     0.71912823E-02
               2       0.21466131E-03     0.85223931E-04
               3       0.31727278E-07     0.14516063E-07
               4       0.10723935E-14     0.48919202E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46375321E-02     0.18102067E-02
               2       0.13705644E-04     0.51026989E-05
               3       0.12654249E-09     0.55147005E-10
               4       0.74382977E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00173697342034
Trial step length           =               0.232603
Gradient along search dir.  =         -0.03218260493
Functional at step 0        =     -16.52260930267345
Functional at step 1        =     -16.52703539219960
Functional predicted        =     -16.52718794939101
Selected quadratic step     =               0.284542
Conjugate gradients coeff.  =               0.344001
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01510807
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001853 (step -0.4952 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525514354430
             Q0:     -16.527142915079
             G0:      -0.000458949099
   RMS gradient:       0.003570516222
     Trial step:       0.661206897335
             Q1:     -16.527201070261
 Quadratic coef:       0.000245305127
 Linear coef   :      -0.000303460310
           Qmin:     -16.527236765705
Quadratic minimum step length (  0.408980546755) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52714291507856 0.00000000000 0.00267788717 0.4090  0.000    8.00000000
      ideal mu1:      -0.521504224579
             Q0:     -16.527236690955
             G0:      -0.000024530508
   RMS gradient:       0.000825513379
     Trial step:       0.520019959607
             Q1:     -16.527243631674
 Quadratic coef:       0.000005815634
 Linear coef   :      -0.000012756354
           Qmin:     -16.527243686089
Quadratic minimum step length (  0.570321162648) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52723669095495 0.00001173133 0.00061913503 0.5703  0.053    8.00000000
      ideal mu1:      -0.521425864051
             Q0:     -16.527243686742
             G0:      -0.000002049670
   RMS gradient:       0.000238556910
     Trial step:       0.544590110049
             Q1:     -16.527244406855
 Quadratic coef:       0.000000396117
 Linear coef   :      -0.000001116230
           Qmin:     -16.527244473106
Quadratic minimum step length (  0.767308316795) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52724368674173 0.00000092105 0.00017891768 0.7673  0.084    8.00000000
      ideal mu1:      -0.521431806757
             Q0:     -16.527244473118
             G0:      -0.000000001544
   RMS gradient:       0.000006549393
     Trial step:       0.646427506133
             Q1:     -16.527244473575
 Quadratic coef:       0.000000000541
 Linear coef   :      -0.000000000998
           Qmin:     -16.527244473578
Quadratic minimum step length (  0.595926317905) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.52724447311780 0.00000010698 0.00000491204 0.5959  0.001    8.00000000
      ideal mu1:      -0.521432935635
             Q0:     -16.527244473578
             G0:      -0.000000000485
   RMS gradient:       0.000003670091
     Trial step:       0.620663486538
             Q1:     -16.527244473765
 Quadratic coef:       0.000000000114
 Linear coef   :      -0.000000000301
           Qmin:     -16.527244473777
Quadratic minimum step length (  0.819730687339) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.52724447357808 0.00000000006 0.00000275257 0.8197  0.314    8.00000000
      ideal mu1:      -0.521432382240
             Q0:     -16.527244473777
             G0:      -0.000000000007
   RMS gradient:       0.000000443930
     Trial step:       0.713285992030
             Q1:     -16.527244473779
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000005
           Qmin:     -16.527244473779
Quadratic minimum step length (  0.661343228007) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.52724447377663 0.00000000003 0.00000033295 0.6613  0.015    8.00000000
      ideal mu1:      -0.521432601834
             Q0:     -16.527244473779
             G0:      -0.000000000001
   RMS gradient:       0.000000143907
     Trial step:       0.686823747741
             Q1:     -16.527244473779
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.527244473779
Quadratic minimum step length (  0.785647900105) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52724447377889 0.00000000000 0.00000010793 0.7856  0.000    8.00000000
      ideal mu1:      -0.521432389202
             Q0:     -16.527244473779
             G0:      -0.000000000000
   RMS gradient:       0.000000140970
     Trial step:       0.734575819882
             Q1:     -16.527244473779
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.527244473779
Quadratic minimum step length (  0.229574781760) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52724447377927 0.00000000000 0.00000010573 0.2296  0.960    8.00000000
      ideal mu1:      -0.521432407003
             Q0:     -16.527244473779
             G0:      -0.000000000001
   RMS gradient:       0.000000120591
     Trial step:       0.410658110276
             Q1:     -16.527244473780
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.527244473779
  Cubic LS coeff:       0.439907486059
Predicted energy:     -16.527244473780
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.52724447377940 0.00000000000 0.00000009044 0.4399  0.732    8.00000000
      ideal mu1:      -0.521432558222
10    -16.52724447377943 0.00000000000 0.00000005332 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00099780661831              |
           | Maximum change in energy =  0.00463259227633 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.26104075119802 |
           | Pseudopotential (local)    :      -45.59318161663966 |
           | Pseudopotential (non-local):       -2.56137962068374 |
           | Hartree                    :       19.49760895771417 |
           | Exchange-correlation       :       -4.06718219333906 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.52724447377943 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -45.59318161663975 |
           | Hartree                    :       19.49760895771409 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999979
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.52650889E-02     0.17794513E-02
               2       0.17903987E-04     0.71643352E-05
               3       0.24431070E-09     0.10601311E-09
               4       0.81939511E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.93890506E-03     0.29834752E-03
               2       0.57341966E-06     0.21825498E-06
               3       0.24414240E-12     0.10246665E-12
================================================================================
RMS gradient                =       0.00099780661831
Trial step length           =               0.257265
Gradient along search dir.  =         -0.01026183522
Functional at step 0        =     -16.52724447377943
Functional at step 1        =     -16.52830980756006
Functional predicted        =     -16.52835099518621
Selected quadratic step     =               0.215658
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99854737
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000332 (step -0.5002 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.522086019882
             Q0:     -16.528350373201
             G0:      -0.000001619017
   RMS gradient:       0.000212067647
     Trial step:       0.425031265816
             Q1:     -16.528350701603
 Quadratic coef:       0.000000359731
 Linear coef   :      -0.000000688133
           Qmin:     -16.528350702285
Quadratic minimum step length (  0.406523035246) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52835037320106 0.00000000000 0.00015905074 0.4065  0.000    8.00000000
      ideal mu1:      -0.522294145003
             Q0:     -16.528350702286
             G0:      -0.000000117844
   RMS gradient:       0.000057215393
     Trial step:       0.415674151534
             Q1:     -16.528350738293
 Quadratic coef:       0.000000012979
 Linear coef   :      -0.000000048985
           Qmin:     -16.528350748507
Quadratic minimum step length (  0.784435068483) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52835070228643 0.00000004114 0.00004291154 0.7844  0.073    8.00000000
      ideal mu1:      -0.522282538169
             Q0:     -16.528350748507
             G0:      -0.000000010843
   RMS gradient:       0.000017355115
     Trial step:       0.571024851933
             Q1:     -16.528350751925
 Quadratic coef:       0.000000002774
 Linear coef   :      -0.000000006192
           Qmin:     -16.528350751962
Quadratic minimum step length (  0.637323413098) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52835074850694 0.00000000620 0.00001301634 0.6373  0.092    8.00000000
      ideal mu1:      -0.522273720057
             Q0:     -16.528350751963
             G0:      -0.000000000275
   RMS gradient:       0.000002765288
     Trial step:       0.603264044675
             Q1:     -16.528350752044
 Quadratic coef:       0.000000000085
 Linear coef   :      -0.000000000166
           Qmin:     -16.528350752044
Quadratic minimum step length (  0.590089093762) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.52835075196275 0.00000000047 0.00000207397 0.5901  0.025    8.00000000
      ideal mu1:      -0.522273743541
             Q0:     -16.528350752044
             G0:      -0.000000000045
   RMS gradient:       0.000001122955
     Trial step:       0.596640204329
             Q1:     -16.528350752058
 Quadratic coef:       0.000000000014
 Linear coef   :      -0.000000000027
           Qmin:     -16.528350752058
Quadratic minimum step length (  0.599451613888) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.52835075204423 0.00000000001 0.00000084222 0.5995  0.165    8.00000000
      ideal mu1:      -0.522274220944
             Q0:     -16.528350752058
             G0:      -0.000000000003
   RMS gradient:       0.000000271746
     Trial step:       0.598044257054
             Q1:     -16.528350752059
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.528350752059
Quadratic minimum step length (  1.151323422085) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.52835075205754 0.00000000000 0.00000020381 1.1513  0.059    8.00000000
      ideal mu1:      -0.522274199385
             Q0:     -16.528350752059
             G0:      -0.000000000001
   RMS gradient:       0.000000135506
     Trial step:       0.829784526603
             Q1:     -16.528350752059
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.528350752059
Quadratic minimum step length (  0.351958425592) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52835075205878 0.00000000000 0.00000010163 0.3520  0.000    8.00000000
      ideal mu1:      -0.522274209775
             Q0:     -16.528350752059
             G0:      -0.000000000000
   RMS gradient:       0.000000069998
     Trial step:       0.540416187363
             Q1:     -16.528350752059
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528350752059
Quadratic minimum step length (  0.452178727762) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52835075205883 0.00000000000 0.00000005250 0.4522  0.267    8.00000000
      ideal mu1:      -0.522274213870
             Q0:     -16.528350752059
             G0:      -0.000000000000
   RMS gradient:       0.000000021580
     Trial step:       0.494332584465
             Q1:     -16.528350752059
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528350752059
  Cubic LS coeff:       0.696357024855
Predicted energy:     -16.528350752059
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52835075205877 0.00000000000 0.00000001619 0.6964  0.095    8.00000000
      ideal mu1:      -0.522274204259
10    -16.52835075205871 0.00000000000 0.00000000819 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00056713586722              |
           | Maximum change in energy =  0.00154505703533 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.61547717E-02     0.20013782E-02
               2       0.23837195E-04     0.86408459E-05
               3       0.41133039E-09     0.16529126E-09
               4       0.84104544E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16842394E-03     0.54296867E-04
               2       0.18042243E-07     0.66328850E-08
               3       0.70865040E-15     0.33306691E-15
================================================================================
RMS gradient                =       0.00056713586722
Trial step length           =               0.235544
Gradient along search dir.  =         -0.00331406072
Functional at step 0        =     -16.52835075205871
Functional at step 1        =     -16.52875011898725
Functional predicted        =     -16.52875033443175
Selected quadratic step     =               0.241144
Conjugate gradients coeff.  =               0.323059
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99724493
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000395 (step -0.5005 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.523806875259
             Q0:     -16.528749278401
             G0:      -0.000000849707
   RMS gradient:       0.000153632603
     Trial step:       0.586712849533
             Q1:     -16.528749530808
 Quadratic coef:       0.000000246128
 Linear coef   :      -0.000000498534
           Qmin:     -16.528749530848
Quadratic minimum step length (  0.594195924699) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52874927840128 0.00000000000 0.00011522445 0.5942  0.000    8.00000000
      ideal mu1:      -0.523742095558
             Q0:     -16.528749530848
             G0:      -0.000000187570
   RMS gradient:       0.000072181160
     Trial step:       0.590442532480
             Q1:     -16.528749589604
 Quadratic coef:       0.000000051993
 Linear coef   :      -0.000000110749
           Qmin:     -16.528749589824
Quadratic minimum step length (  0.628841470351) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52874953084777 0.00000003156 0.00005413587 0.6288  0.221    8.00000000
      ideal mu1:      -0.523797490740
             Q0:     -16.528749589823
             G0:      -0.000000016931
   RMS gradient:       0.000021687020
     Trial step:       0.609339601768
             Q1:     -16.528749594734
 Quadratic coef:       0.000000005406
 Linear coef   :      -0.000000010317
           Qmin:     -16.528749594745
Quadratic minimum step length (  0.581427203020) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52874958982321 0.00000000900 0.00001626526 0.5814  0.090    8.00000000
      ideal mu1:      -0.523775753323
             Q0:     -16.528749594746
             G0:      -0.000000000140
   RMS gradient:       0.000001974997
     Trial step:       0.595219808428
             Q1:     -16.528749594803
 Quadratic coef:       0.000000000026
 Linear coef   :      -0.000000000084
           Qmin:     -16.528749594814
Quadratic minimum step length (  0.968586996956) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.52874959474556 0.00000000068 0.00000148125 0.9686  0.008    8.00000000
      ideal mu1:      -0.523776614340
             Q0:     -16.528749594813
             G0:      -0.000000000008
   RMS gradient:       0.000000473218
     Trial step:       0.759290568079
             Q1:     -16.528749594814
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000006
           Qmin:     -16.528749594815
Quadratic minimum step length (  0.466559665193) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.52874959481311 0.00000000001 0.00000035491 0.4666  0.057    8.00000000
      ideal mu1:      -0.523776638174
             Q0:     -16.528749594815
             G0:      -0.000000000001
   RMS gradient:       0.000000130064
     Trial step:       0.595192702599
             Q1:     -16.528749594815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528749594815
Quadratic minimum step length (  0.746676867374) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.52874959481510 0.00000000000 0.00000009755 0.7467  0.076    8.00000000
      ideal mu1:      -0.523776635707
             Q0:     -16.528749594815
             G0:      -0.000000000000
   RMS gradient:       0.000000036793
     Trial step:       0.666645800002
             Q1:     -16.528749594815
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528749594816
  Cubic LS coeff:       1.786082851330
Predicted energy:     -16.528749594816
WARNING in lnv_denskernel_optimise_cg: setting cubic step to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.52874959481523 0.00000000000 0.00000002759 0.1500  0.000    8.00000000
      ideal mu1:      -0.523776635392
             Q0:     -16.528749594815
             G0:      -0.000000000000
   RMS gradient:       0.000000030729
     Trial step:       0.316222817014
             Q1:     -16.528749594815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528749594815
Quadratic minimum step length (  0.054754861459) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.52874959481536 0.00000000000 0.00000002305 0.0548  0.698    8.00000000
      ideal mu1:      -0.523776635212
             Q0:     -16.528749594815
             G0:      -0.000000000000
   RMS gradient:       0.000000027549
     Trial step:       0.131585472358
             Q1:     -16.528749594815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528749594815
Quadratic minimum step length (  0.025056517217) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52874959481527 0.00000000000 0.00000002066 0.0251  0.804    8.00000000
      ideal mu1:      -0.523776635103
10    -16.52874959481530 0.00000000000 0.00000001931 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00026882440666              |
           | Maximum change in energy =  0.00036875942643 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.53174112E-02     0.16752118E-02
               2       0.17443000E-04     0.61273113E-05
               3       0.21226255E-09     0.81976510E-10
               4       0.93519494E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12789598E-02     0.39581587E-03
               2       0.10196665E-05     0.37373838E-06
               3       0.70966048E-12     0.25962197E-12
================================================================================
RMS gradient                =       0.00026882440666
Trial step length           =               0.238328
Gradient along search dir.  =         -0.00074318946
Functional at step 0        =     -16.52874959481530
Functional at step 1        =     -16.52881377097851
Functional predicted        =     -16.52881903571412
Selected quadratic step     =               0.186873
Conjugate gradients coeff.  =               0.224679
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99784995
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000265 (step -0.5004 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525134834461
             Q0:     -16.528818528525
             G0:      -0.000003404166
   RMS gradient:       0.000307506377
     Trial step:       0.057420150240
             Q1:     -16.528818709662
 Quadratic coef:       0.000000014331
 Linear coef   :      -0.000000195468
           Qmin:     -16.528819195031
Quadratic minimum step length (  0.391582343421) accepted
    Initial Ne1:       7.99999911
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52881852852546 0.00000000000 0.00023062966 0.3916  0.000    8.00000000
      ideal mu1:      -0.524806818892
             Q0:     -16.528819195134
             G0:      -0.000000103523
   RMS gradient:       0.000053618976
     Trial step:       0.149949047981
             Q1:     -16.528819208848
 Quadratic coef:       0.000000001809
 Linear coef   :      -0.000000015523
           Qmin:     -16.528819228439
Quadratic minimum step length (  0.643436080775) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52881919513391 0.00000008331 0.00004021423 0.6434  0.030    8.00000000
      ideal mu1:      -0.524786244020
             Q0:     -16.528819228446
             G0:      -0.000000008929
   RMS gradient:       0.000015746683
     Trial step:       0.310616528455
             Q1:     -16.528819230690
 Quadratic coef:       0.000000000529
 Linear coef   :      -0.000000002773
           Qmin:     -16.528819232080
Quadratic minimum step length (  0.813994990672) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52881922844581 0.00000000429 0.00001181001 0.8140  0.086    8.00000000
      ideal mu1:      -0.524788541014
             Q0:     -16.528819232080
             G0:      -0.000000000028
   RMS gradient:       0.000000888097
     Trial step:       0.502832276392
             Q1:     -16.528819232091
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000014
           Qmin:     -16.528819232093
Quadratic minimum step length (  0.892605836729) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.52881923208028 0.00000000049 0.00000066607 0.8926  0.003    8.00000000
      ideal mu1:      -0.524788533951
             Q0:     -16.528819232093
             G0:      -0.000000000010
   RMS gradient:       0.000000537517
     Trial step:       0.669948523995
             Q1:     -16.528819232095
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000007
           Qmin:     -16.528819232095
Quadratic minimum step length (  0.553627393326) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.52881923209263 0.00000000000 0.00000040314 0.5536  0.366    8.00000000
      ideal mu1:      -0.524788605209
             Q0:     -16.528819232095
             G0:      -0.000000000000
   RMS gradient:       0.000000077179
     Trial step:       0.609017122093
             Q1:     -16.528819232096
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528819232096
  Cubic LS coeff:       0.931009162307
Predicted energy:     -16.528819232096
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.52881923209535 0.00000000000 0.00000005788 0.9310  0.021    8.00000000
      ideal mu1:      -0.524788586208
             Q0:     -16.528819232096
             G0:      -0.000000000000
   RMS gradient:       0.000000025448
     Trial step:       0.752994369614
             Q1:     -16.528819232096
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528819232096
Quadratic minimum step length (  0.062010460348) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.52881923209566 0.00000000000 0.00000001909 0.0620  0.000    8.00000000
      ideal mu1:      -0.524788587726
             Q0:     -16.528819232095
             G0:      -0.000000000000
   RMS gradient:       0.000000022905
     Trial step:       0.216086851750
             Q1:     -16.528819232096
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528819232096
  Cubic LS coeff:       0.319852061401
Predicted energy:     -16.528819232096
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52881923209544 0.00000000000 0.00000001718 0.3199  0.810    8.00000000
      ideal mu1:      -0.524788600500
             Q0:     -16.528819232096
             G0:      -0.000000000000
   RMS gradient:       0.000000012116
     Trial step:       0.262898887358
             Q1:     -16.528819232095
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528819232096
Quadratic minimum step length (  0.000785609549) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52881923209565 0.00000000000 0.00000000909 0.0008  0.280    8.00000000
      ideal mu1:      -0.524788600495
10    -16.52881923209555 0.00000000000 0.00000000908 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00007812414784              |
           | Maximum change in energy =  0.00013294758553 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30860571E-02     0.99900394E-03
               2       0.57914811E-05     0.22119753E-05
               3       0.24261484E-10     0.10239954E-10
               4       0.79849682E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19978470E-02     0.63501901E-03
               2       0.24404512E-05     0.91149239E-06
               3       0.42614764E-11     0.17657494E-11
               4       0.88321285E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00007812414784
Trial step length           =               0.211038
Gradient along search dir.  =         -0.00006307251
Functional at step 0        =     -16.52881923209555
Functional at step 1        =     -16.52881501556444
Functional predicted        =     -16.52882175922513
Selected quadratic step     =               0.080134
Conjugate gradients coeff.  =               0.084457
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99934463
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000106 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525216729432
             Q0:     -16.528821690248
             G0:      -0.000000757010
   RMS gradient:       0.000145010491
     Trial step:       0.014371356110
             Q1:     -16.528821700937
 Quadratic coef:       0.000000000190
 Linear coef   :      -0.000000010879
           Qmin:     -16.528821846254
Quadratic minimum step length (  0.412165014872) accepted
    Initial Ne1:       7.99999961
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52882169024765 0.00000000000 0.00010875785 0.4122  0.000    8.00000000
      ideal mu1:      -0.525053067813
             Q0:     -16.528821846062
             G0:      -0.000000027883
   RMS gradient:       0.000027847269
     Trial step:       0.076963434207
             Q1:     -16.528821848050
 Quadratic coef:       0.000000000157
 Linear coef   :      -0.000000002146
           Qmin:     -16.528821853383
Quadratic minimum step length (  0.525162585121) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52882184606163 0.00000001950 0.00002088545 0.5252  0.037    8.00000000
      ideal mu1:      -0.525048164632
             Q0:     -16.528821853384
             G0:      -0.000000000928
   RMS gradient:       0.000005075747
     Trial step:       0.201043070181
             Q1:     -16.528821853550
 Quadratic coef:       0.000000000020
 Linear coef   :      -0.000000000186
           Qmin:     -16.528821853824
Quadratic minimum step length (  0.948622212223) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.52882185338363 0.00000000095 0.00000380681 0.9486  0.033    8.00000000
      ideal mu1:      -0.525047377272
             Q0:     -16.528821853821
             G0:      -0.000000000001
   RMS gradient:       0.000000186160
     Trial step:       0.436708051205
             Q1:     -16.528821853822
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.528821853822
Quadratic minimum step length (  0.545890987220) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.52882185382120 0.00000000006 0.00000013962 0.5459  0.001    8.00000000
      ideal mu1:      -0.525047439940
             Q0:     -16.528821853822
             G0:      -0.000000000000
   RMS gradient:       0.000000082606
     Trial step:       0.488257093342
             Q1:     -16.528821853822
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821853822
Quadratic minimum step length (  0.521166258305) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.52882185382173 0.00000000000 0.00000006195 0.5212  0.197    8.00000000
      ideal mu1:      -0.525047423084
             Q0:     -16.528821853822
             G0:      -0.000000000000
   RMS gradient:       0.000000038957
     Trial step:       0.504443378813
             Q1:     -16.528821853821
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821853822
Quadratic minimum step length (  0.035406028513) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.52882185382171 0.00000000000 0.00000002922 0.0354  0.222    8.00000000
      ideal mu1:      -0.525047422665
             Q0:     -16.528821853822
             G0:      -0.000000000000
   RMS gradient:       0.000000037529
     Trial step:       0.133642570513
             Q1:     -16.528821853822
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821853822
  Cubic LS coeff:       0.125755657989
Predicted energy:     -16.528821853822
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52882185382172 0.00000000000 0.00000002815 0.1258  0.000    8.00000000
      ideal mu1:      -0.525047422252
             Q0:     -16.528821853822
             G0:      -0.000000000000
   RMS gradient:       0.000000033831
     Trial step:       0.129639150684
             Q1:     -16.528821853821
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821853822
Quadratic minimum step length (  0.001991966576) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52882185382174 0.00000000000 0.00000002537 0.0020  0.813    8.00000000
      ideal mu1:      -0.525047422244
             Q0:     -16.528821853822
             G0:      -0.000000000000
   RMS gradient:       0.000000033732
     Trial step:       0.016069749692
             Q1:     -16.528821853822
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821853822
Quadratic minimum step length (  0.000041444267) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52882185382188 0.00000000000 0.00000002530 0.0000  0.994    8.00000000
      ideal mu1:      -0.525047422244
10    -16.52882185382175 0.00000000000 0.00000002530 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00003121558017              |
           | Maximum change in energy =  0.00002321242675 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14603490E-02     0.48562649E-03
               2       0.12759783E-05     0.51854939E-06
               3       0.12254227E-11     0.54121204E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11866605E-02     0.39248992E-03
               2       0.84432764E-06     0.34092445E-06
               3       0.53499324E-12     0.23519056E-12
================================================================================
RMS gradient                =       0.00003121558017
Trial step length           =               0.130044
Gradient along search dir.  =         -0.00001004327
Functional at step 0        =     -16.52882185382175
Functional at step 1        =     -16.52881985621156
Functional predicted        =     -16.52882198290522
Selected quadratic step     =               0.025705
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99981394
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000031 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525154502194
             Q0:     -16.528821976970
             G0:      -0.000000052348
   RMS gradient:       0.000038132714
     Trial step:       0.000816087612
             Q1:     -16.528821977013
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000043
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821977055
  Cubic LS coeff:       0.005595912458
Predicted energy:     -16.528821977177
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.52882197696994 0.00000000000 0.00002859953 0.0056  0.000    8.00000000
      ideal mu1:      -0.525153919273
             Q0:     -16.528821977261
             G0:      -0.000000101193
   RMS gradient:       0.000037616886
     Trial step:       0.002136996686
             Q1:     -16.528821977477
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000216
           Qmin:     -16.528821991631
Quadratic minimum step length (  0.284008975232) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52882197726117 0.00000000002 0.00002821266 0.2840  0.973    8.00000000
      ideal mu1:      -0.525095949129
             Q0:     -16.528821986408
             G0:      -0.000000002844
   RMS gradient:       0.000016853173
     Trial step:       0.024635873008
             Q1:     -16.528821986477
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000070
           Qmin:     -16.528821987026
Quadratic minimum step length (  0.434513186370) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52882198640850 0.00000000357 0.00001263988 0.4345  0.201    8.00000000
      ideal mu1:      -0.525095271103
             Q0:     -16.528821986997
             G0:      -0.000000006214
   RMS gradient:       0.000013223676
     Trial step:       0.103463093322
             Q1:     -16.528821987533
 Quadratic coef:       0.000000000108
 Linear coef   :      -0.000000000643
           Qmin:     -16.528821987958
Quadratic minimum step length (  0.309189121823) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.52882198699729 0.00000000010 0.00000991776 0.3092  0.616    8.00000000
      ideal mu1:      -0.525106065714
             Q0:     -16.528821987959
             G0:      -0.000000001262
   RMS gradient:       0.000005916984
     Trial step:       0.178856542976
             Q1:     -16.528821988137
 Quadratic coef:       0.000000000047
 Linear coef   :      -0.000000000226
           Qmin:     -16.528821988228
Quadratic minimum step length (  0.427199773224) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.52882198795881 0.00000000014 0.00000443774 0.4272  0.200    8.00000000
      ideal mu1:      -0.525111853573
             Q0:     -16.528821988226
             G0:      -0.000000000408
   RMS gradient:       0.000003382616
     Trial step:       0.276419019966
             Q1:     -16.528821988291
 Quadratic coef:       0.000000000047
 Linear coef   :      -0.000000000113
           Qmin:     -16.528821988293
Quadratic minimum step length (  0.330170044156) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.52882198822560 0.00000000004 0.00000253696 0.3302  0.327    8.00000000
      ideal mu1:      -0.525111357044
             Q0:     -16.528821988293
             G0:      -0.000000000057
   RMS gradient:       0.000001260082
     Trial step:       0.302101439963
             Q1:     -16.528821988305
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000017
           Qmin:     -16.528821988306
Quadratic minimum step length (  0.462926726561) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52882198829298 0.00000000001 0.00000094506 0.4629  0.000    8.00000000
      ideal mu1:      -0.525109879929
             Q0:     -16.528821988305
             G0:      -0.000000000004
   RMS gradient:       0.000000322754
     Trial step:       0.373966349678
             Q1:     -16.528821988306
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.528821988307
Quadratic minimum step length (  0.684355524484) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52882198830531 0.00000000000 0.00000024207 0.6844  0.066    8.00000000
      ideal mu1:      -0.525110055327
             Q0:     -16.528821988306
             G0:      -0.000000000001
   RMS gradient:       0.000000148497
     Trial step:       0.505891230773
             Q1:     -16.528821988307
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988307
  Cubic LS coeff:       0.946255606708
Predicted energy:     -16.528821988307
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52882198830617 0.00000000000 0.00000011137 0.9463  0.212    8.00000000
      ideal mu1:      -0.525110007381
10    -16.52882198830662 0.00000000000 0.00000005436 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000804155301              |
           | Maximum change in energy =  0.00000087390873 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.24927494800209 |
           | Pseudopotential (local)    :      -45.55730569886004 |
           | Pseudopotential (non-local):       -2.56270194235472 |
           | Hartree                    :       19.46801946910512 |
           | Exchange-correlation       :       -4.06195801216990 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.52882198830662 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -45.55730569886014 |
           | Hartree                    :       19.46801946910546 |
           --------------------------------------------------------
           Integrated density           :        8.00000000000026
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.693049E-06
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.57989074E-03     0.19946674E-03
               2       0.19663050E-06     0.83593359E-07
               3       0.29777969E-13     0.13518592E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56024484E-03     0.19280479E-03
               2       0.18351582E-06     0.78055268E-07
               3       0.26226786E-13     0.11774436E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56177319E-06     0.19127038E-06
               2       0.18597330E-12     0.78028296E-13
================================================================================
RMS gradient                =       0.00000804155301
Trial step length           =               0.057817
Gradient along search dir.  =         -0.00000066652
Functional at step 0        =     -16.52882198830662
Functional at step 1        =     -16.52882144572080
Rejected quadratic step     =               0.001917
Functional at new step 1    =     -16.52882198892682
Functional predicted        =     -16.52882198892735
Selected quadratic step     =               0.001863
Conjugate gradients coeff.  =              -0.066365
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00001354
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525102498058
             Q0:     -16.528821988894
             G0:      -0.000000000267
   RMS gradient:       0.000002721529
     Trial step:       0.691883236900
             Q1:     -16.528821988923
 Quadratic coef:       0.000000000156
 Linear coef   :      -0.000000000184
           Qmin:     -16.528821988949
Quadratic minimum step length (  0.409782313778) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52882198889395 0.00000000000 0.00000204115 0.4098  0.000    8.00000000
      ideal mu1:      -0.525105546780
             Q0:     -16.528821988949
             G0:      -0.000000000009
   RMS gradient:       0.000000502300
     Trial step:       0.532467382739
             Q1:     -16.528821988951
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.528821988951
Quadratic minimum step length (  0.554110615441) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52882198894856 0.00000000001 0.00000037673 0.5541  0.034    8.00000000
      ideal mu1:      -0.525105649070
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000084444
     Trial step:       0.543181212076
             Q1:     -16.528821988951
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988951
Quadratic minimum step length (  0.128154615679) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.52882198895133 0.00000000000 0.00000006333 0.1282  0.028    8.00000000
      ideal mu1:      -0.525105651554
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000070190
     Trial step:       0.263839306165
             Q1:     -16.528821988951
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988951
  Cubic LS coeff:       0.327088627871
Predicted energy:     -16.528821988951
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.52882198895115 0.00000000000 0.00000005264 0.3271  0.691    8.00000000
      ideal mu1:      -0.525105657606
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000024162
     Trial step:       0.293766636350
             Q1:     -16.528821988951
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988951
  Cubic LS coeff:       0.363689049635
Predicted energy:     -16.528821988951
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.52882198895106 0.00000000000 0.00000001812 0.3637  0.118    8.00000000
      ideal mu1:      -0.525105649436
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000011780
     Trial step:       0.326863440581
             Q1:     -16.528821988951
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988951
Quadratic minimum step length (  0.037154451077) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.52882198895130 0.00000000000 0.00000000884 0.0372  0.238    8.00000000
      ideal mu1:      -0.525105649227
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000010961
     Trial step:       0.110201777263
             Q1:     -16.528821988951
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988951
Quadratic minimum step length (  0.000176014786) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52882198895134 0.00000000000 0.00000000822 0.0002  0.000    8.00000000
      ideal mu1:      -0.525105649227
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000010958
     Trial step:       0.004404218681
             Q1:     -16.528821988951
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988951
Quadratic minimum step length (  0.000000786699) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52882198895128 0.00000000000 0.00000000822 0.0000  1.000    8.00000000
      ideal mu1:      -0.525105649227
             Q0:     -16.528821988951
             G0:      -0.000000000000
   RMS gradient:       0.000000010958
     Trial step:       0.000058862501
             Q1:     -16.528821988951
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988951
  Cubic LS coeff:       0.000186014294
Predicted energy:     -16.528821988951
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52882198895127 0.00000000000 0.00000000822 0.0002  1.000    8.00000000
      ideal mu1:      -0.525105649227
10    -16.52882198895126 0.00000000000 0.00000000821 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000233256410              |
           | Maximum change in energy =  0.00000004482829 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11716943E-03     0.39788268E-04
               2       0.81020185E-08     0.33915434E-08
               3       0.91711192E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11572731E-03     0.39296453E-04
               2       0.79036774E-08     0.33083701E-08
               3       0.10513953E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.62106389E-06     0.21134288E-06
               2       0.22742701E-12     0.95383770E-13
================================================================================
RMS gradient                =       0.00000233256410
Trial step length           =               0.010377
Gradient along search dir.  =         -0.00000005232
Functional at step 0        =     -16.52882198895126
Functional at step 1        =     -16.52882196746540
Rejected quadratic step     =               0.000128
Functional at new step 1    =     -16.52882198895562
Functional predicted        =     -16.52882198895606
Selected quadratic step     =               0.000183
Conjugate gradients coeff.  =              -0.084137
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999856
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525106451655
             Q0:     -16.528821988955
             G0:      -0.000000000003
   RMS gradient:       0.000000285144
     Trial step:       0.000104638743
             Q1:     -16.528821988955
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988955
  Cubic LS coeff:       0.000277390531
Predicted energy:     -16.528821988955
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.52882198895499 0.00000000000 0.00000021386 0.0003  0.000    8.00000000
      ideal mu1:      -0.525106451439
             Q0:     -16.528821988955
             G0:      -0.000000000006
   RMS gradient:       0.000000284950
     Trial step:       0.000170369588
             Q1:     -16.528821988955
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988955
  Cubic LS coeff:       0.000215865489
Predicted energy:     -16.528821988955
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.52882198895506 0.00000000000 0.00000021371 0.0002  0.999    8.00000000
      ideal mu1:      -0.525106451103
             Q0:     -16.528821988955
             G0:      -0.000000000009
   RMS gradient:       0.000000284649
     Trial step:       0.000191773080
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988955
Quadratic minimum step length (  0.000000905012) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.52882198895526 0.00000000000 0.00000021349 0.0000  0.998    8.00000000
      ideal mu1:      -0.525106451101
             Q0:     -16.528821988955
             G0:      -0.000000000012
   RMS gradient:       0.000000284647
     Trial step:       0.000013174101
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988955
Quadratic minimum step length (  0.000000005274) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.52882198895524 0.00000000000 0.00000021349 0.0000  1.000    8.00000000
      ideal mu1:      -0.525106451101
             Q0:     -16.528821988955
             G0:      -0.000000000015
   RMS gradient:       0.000000284647
     Trial step:       0.000000263588
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988955
Quadratic minimum step length (  0.000000000006) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.52882198895524 0.00000000000 0.00000021349 0.0000  1.000    8.00000000
      ideal mu1:      -0.525106451101
             Q0:     -16.528821988955
             G0:      -0.000000000017
   RMS gradient:       0.000000284647
     Trial step:       0.000000001226
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.528821988955
Quadratic minimum step length (  0.000000000000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.52882198895524 0.00000000000 0.00000021349 0.0000  1.000    8.00000000
      ideal mu1:      -0.525106451101
             Q0:     -16.528821988955
             G0:      -0.000000000003
   RMS gradient:       0.000000284647
     Trial step:       0.000000000001
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988955
  Cubic LS coeff:      -0.001777172527
Predicted energy:   -2723.986312276050
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.52882198895524 0.00000000000 0.00000021349-0.0018  0.000    8.00000000
      ideal mu1:      -0.525106452483
             Q0:     -16.528821988955
             G0:      -0.000000000006
   RMS gradient:       0.000000285885
     Trial step:       0.000000000001
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988955
  Cubic LS coeff:       0.000000000001
Predicted energy:     -16.528821988955
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.52882198895508-0.00000000000 0.00000021441 0.0000  1.009    8.00000000
      ideal mu1:      -0.525106452483
             Q0:     -16.528821988955
             G0:      -0.000000000009
   RMS gradient:       0.000000285885
     Trial step:       0.000000000001
             Q1:     -16.528821988955
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.528821988955
  Cubic LS coeff:       0.000000000000
Predicted energy:     -16.528821988955
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.52882198895508 0.00000000000 0.00000021441 0.0000  1.000    8.00000000
      ideal mu1:      -0.525106452483
10    -16.52882198895508 0.00000000000 0.00000021441 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000178568393              |
           | Maximum change in energy =  0.00000000021488 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.24929757450943 |
           | Pseudopotential (local)    :      -45.55734361222851 |
           | Pseudopotential (non-local):       -2.56271111756246 |
           | Hartree                    :       19.46804964849951 |
           | Exchange-correlation       :       -4.06196373014388 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.52882198895507 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -45.55734361222867 |
           | Hartree                    :       19.46804964849951 |
           --------------------------------------------------------
           Integrated density           :        8.00000000000020
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.02118642738293    -16.06773049369021   0.167875    -16.45606399717621
   2     0.00590645855303    -16.46136830495481   0.248640    -16.50708786656111
   3     0.00296150894121    -16.50871152584446   0.286540    -16.52214242782265
   4     0.00173697342034    -16.52260930267345   0.284542    -16.52718794939101
   5     0.00099780661831    -16.52724447377943   0.215658    -16.52835099518621
   6     0.00056713586722    -16.52835075205871   0.241144    -16.52875033443175
   7     0.00026882440666    -16.52874959481530   0.186873    -16.52881903571412
   8     0.00007812414784    -16.52881923209555   0.080134    -16.52882175922513
   9     0.00003121558017    -16.52882185382175   0.025705    -16.52882198290522
  10     0.00000804155301    -16.52882198830662   0.001863    -16.52882198892735
  11     0.00000233256410    -16.52882198895126   0.000183    -16.52882198895606
  12     0.00000178568393    -16.52882198895508  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.315170312 Eh
                 Mid-gap level:      -0.096891477 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.015746912   1.0000000
                            2    -0.466907635   1.0000000
                            3    -0.363294629   1.0000000
                            4    -0.254476633   1.0000000
                        .......   --- gap ---   .........
                            5     0.060693679   0.0000000
                            6     0.160589185   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.56443292  -0.09135891  -0.09439272 *
*    H       2     -1.15804785   0.91591819  -1.12606558 *
*    H       3     -1.11799339  -0.78381524   1.25953442 *
*                                                        *
**********************************************************
TOTAL:             -0.71160833   0.04074404   0.03907612
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.74343233  -0.04673208  -0.05357964 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.74343233  -0.04673208  -0.05357964
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00095790   0.00040941   0.00065536 *
*    H       2     -0.00005638  -0.00013511  -0.00041492 *
*    H       3      0.00005588   0.00019806   0.00055962 *
*                                                        *
**********************************************************
TOTAL:              0.00095740   0.00047237   0.00080006
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.01092713  -0.00183855  -0.00456782 *
*    H       2      0.01092713  -0.00183855  -0.00456782 *
*    H       3      0.01092713  -0.00183855  -0.00456782 *
*                                                        *
**********************************************************
TOTAL:              0.03278140  -0.00551566  -0.01370346

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00285335  -0.00291233  -0.00824316 *
*    H       2      0.00032827  -0.01308090   0.01824541 *
*    H       3      0.00252509   0.01599323  -0.01000226 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000  -0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     630.841s on      3 node(s)                                    
TOTAL TIME:       630.842s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    48        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    25        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    14        0.00s   0.001%  ------ ||
|| restart_ngwfs_tightbox_output        :    11        0.00s   0.001%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    25        0.01s   0.001%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    25        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    12        0.01s   0.001%  ------ ||
|| integrals_grad                       :     1        0.02s   0.003%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.02s   0.003%  ------ ||
|| basis_dot_function_with_box          :  1927        0.02s   0.003%  ------ ||
|| basis_add_function_to_box            :  3816        0.04s   0.006%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.05s   0.008%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.05s   0.009%  ------ ||
|| lnv_gradient_norm                    :   120        0.07s   0.012%  ------ ||
|| kernel_fix                           :   120        0.08s   0.013%  ------ ||
|| kernel_purify                        :   390        0.10s   0.015%  ------ ||
|| basis_copy_function_to_box           :   876        0.11s   0.018%  ------ ||
|| fourier_apply_box_pair               :    82        0.11s   0.018%  16.688 ||
|| sparse_trace                         :  3352        0.11s   0.018%  ------ ||
|| pseudo_make_structure_factor         :     1        0.12s   0.019%  ------ ||
|| density_initial_guess_real           :     1        0.14s   0.023%  ------ ||
|| density_batch_row_sums               :   270        0.18s   0.028%  ------ ||
|| sparse_product                       :  4252        0.18s   0.029%  ------ ||
|| integrals_kinetic                    :    25        0.18s   0.029%  ------ ||
|| projectors_gradient_batch            :    12        0.32s   0.050%  ------ ||
|| projectors_func_ovlp_box             :    25        0.43s   0.068%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.44s   0.070%  ------ ||
|| projectors_init_fftbox_recip         :    40        0.47s   0.074%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.49s   0.078%  ------ ||
|| forces_calculate                     :     1        0.64s   0.102%  ------ ||
|| integrals_locpot_mat_els_batch       :   131        1.00s   0.158%  ------ ||
|| ngwf_gradient_batch                  :    12        2.04s   0.323%  ------ ||
|| properties_calculate                 :     1        2.36s   0.374%  ------ ||
|| ngwf_gradient_lnv                    :    12        2.37s   0.376%  ------ ||
|| cell_grid_extract_box                :   596        2.77s   0.439%  ------ ||
|| hamiltonian_energy_components        :     3        7.72s   1.223%  ------ ||
|| cell_grid_deposit_box                :  1081        8.40s   1.331%  ------ ||
|| density_fftbox_deposit_to_cell       :  1080        8.40s   1.332%  ------ ||
|| fourier_apply_box                    :  2020        8.66s   1.372%  25.880 ||
|| density_fftbox_interpolate_multiply  :  1080        8.70s   1.380%  ------ ||
|| potential_apply_to_ngwf_batch        :   131        9.46s   1.499%  ------ ||
|| integrals_locpot_dbl_grid            :   131       10.54s   1.670%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       15.97s   2.532%  ------ ||
|| density_batch_interp_deposit         :   270       17.95s   2.846%  ------ ||
|| density_on_dbl_grid                  :   270       21.01s   3.331%  ------ ||
|| hartree_on_grid                      :   270       95.26s  15.100%  ------ ||
|| fourier_apply_cell_forward           :  1351      186.11s  29.502%   5.522 ||
|| fourier_apply_cell_backward          :  1351      271.82s  43.089%   3.780 ||
|| xc_energy_potential                  :   270      470.89s  74.644%  ------ ||
|| lnv_denskernel_optimise_cg           :    12      568.25s  90.078%  ------ ||
|| ngwf_cg_optimise                     :     1      608.60s  96.474%  ------ ||
|| total_time                           :     1      630.84s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 17:08 (-0000)

