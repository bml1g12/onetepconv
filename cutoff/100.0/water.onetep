 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 16:37 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 3.67489942245322      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:   66 x  66 x  66
                              FFT-box:   27 x  27 x  27
                                  PPD:    6 x   6 x   1
Grid space d1=  1.431610843182a0 (KE cutoff=   3.70641Eh = 100.85668eV)
Grid space d2=  1.431610843182a0 (KE cutoff=   3.70641Eh = 100.85668eV)
Grid space d3=  1.431610843182a0 (KE cutoff=   3.70641Eh = 100.85668eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:     66    66    66
          Real-space ('12') slabs/node (min max mean):     22    22    22
         Recip-space ('23') slabs/node (min max mean):     11    12    11
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):        940      3716
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  319    0.0188679245    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   12    1   22.0493965347
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 6442.7105834676   -7.1158809204   10.1555642418   -2.4512395475
  2 2565.8340442596   -3.1466271482   13.3468502789   -3.1740352270
  3 1326.6730356573   -2.9486720661   13.5570482148   -3.2262611628
  4  682.3917391150   -2.9072355792   13.6018186819   -3.2390753334
  5  347.3761804020   -2.8938394864   13.6164201242   -3.2438904276
  6  173.1694716166   -2.8880200740   13.6227921019   -3.2461594191
  7   82.5821858365   -2.8852113667   13.6258737784   -3.2473010352
  8   35.4768352288   -2.8838146025   13.6274078727   -3.2478843480
  9   10.9820623993   -2.8831139351   13.6281779273   -3.2481834728
 10   -1.7552165598   -2.8827614405   13.6285655202   -3.2483370310
 11   -8.3786005675   -2.8825839227   13.6287607988   -3.2484159045
 12  -11.8227599800   -2.8824944552   13.6288592572   -3.2484564435
 13  -13.6137226992   -2.8824493992   13.6289088626   -3.2484772806
 14  -14.5450232888   -2.8824266844   13.6289338813   -3.2484880022
 15  -15.0292996145   -2.8824152337   13.6289464992   -3.2484935221
 16  -15.2811232926   -2.8824094709   13.6289528524   -3.2484963622
 17  -15.4120716150   -2.8824065651   13.6289560573   -3.2484978262
 18  -15.4801647482   -2.8824051010   13.6289576730   -3.2484985811
 19  -15.5155731812   -2.8824043635   13.6289584873   -3.2484989705
 20  -15.5339855687   -2.8824039921   13.6289588976   -3.2484991715
 21  -15.5435600116   -2.8824038051   13.6289591043   -3.2484992753
 22  -15.5485387229   -2.8824037109   13.6289592084   -3.2484993289
 23  -15.5511276532   -2.8824036635   13.6289592609   -3.2484993566
 24  -15.5524738973   -2.8824036397   13.6289592873   -3.2484993710
 25  -15.5531739444   -2.8824036277   13.6289593006   -3.2484993784
 26  -15.5535379690   -2.8824036217   13.6289593073   -3.2484993822
 27  -15.5537272619   -2.8824036186   13.6289593107   -3.2484993842
 28  -15.5538256942   -2.8824036171   13.6289593123   -3.2484993853
 29  -15.5538768790   -2.8824036163   13.6289593132   -3.2484993858
 30  -15.5539034951   -2.8824036159   13.6289593136   -3.2484993861
 31  -15.5539173355   -2.8824036158   13.6289593138   -3.2484993862
 32  -15.5539245325   -2.8824036157   13.6289593140   -3.2484993863
 33  -15.5539282750   -2.8824036156   13.6289593140   -3.2484993863
 34  -15.5539302210   -2.8824036156   13.6289593140   -3.2484993864
 35  -15.5539312330   -2.8824036156   13.6289593140   -3.2484993864
 36  -15.5539317592   -2.8824036156   13.6289593141   -3.2484993864
 37  -15.5539320329   -2.8824036156   13.6289593141   -3.2484993864
 38  -15.5539321751   -2.8824036156   13.6289593141   -3.2484993864
 39  -15.5539322491   -2.8824036156   13.6289593141   -3.2484993864
Atom SCF converged after  39 iterations to a total energy of    -15.55393225

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  319    0.0188679245    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   12    0   22.0493965347
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1 1075.1734547195   -0.2249212772    0.2820990067   -0.2424203251
  2  429.8114868356   -0.2108143539    0.3030222005   -0.2587605208
  3  223.2898421670   -0.2043796350    0.3112011626   -0.2658277683
  4  115.8984058929   -0.2009507039    0.3154889361   -0.2696334626
  5   60.0550756130   -0.1992314657    0.3176272801   -0.2715675681
  6   31.0167103013   -0.1983907666    0.3186685402   -0.2725258605
  7   15.9168511461   -0.1979842261    0.3191697459   -0.2729953710
  8    8.0649684477   -0.1977885773    0.3194096918   -0.2732244150
  9    3.9820095330   -0.1976945729    0.3195243050   -0.2733360715
 10    1.8588796486   -0.1976494011    0.3195790219   -0.2733905724
 11    0.7548557544   -0.1976276709    0.3196051546   -0.2734172396
 12    0.1807647649   -0.1976171996    0.3196176474   -0.2734303288
 13   -0.1177620323   -0.1976121431    0.3196236272   -0.2734367764
 14   -0.2729958110   -0.1976096957    0.3196264937   -0.2734399647
 15   -0.3537173504   -0.1976085081    0.3196278700   -0.2734415478
 16   -0.3956925650   -0.1976079303    0.3196285319   -0.2734423371
 17   -0.4175196975   -0.1976076483    0.3196288507   -0.2734427323
 18   -0.4288698239   -0.1976075104    0.3196290045   -0.2734429310
 19   -0.4347719021   -0.1976074427    0.3196290789   -0.2734430314
 20   -0.4378409909   -0.1976074094    0.3196291149   -0.2734430823
 21   -0.4394369222   -0.1976073930    0.3196291324   -0.2734431082
 22   -0.4402668095   -0.1976073848    0.3196291408   -0.2734431214
 23   -0.4406983527   -0.1976073808    0.3196291449   -0.2734431282
 24   -0.4409227563   -0.1976073788    0.3196291469   -0.2734431317
 25   -0.4410394467   -0.1976073778    0.3196291479   -0.2734431335
 26   -0.4411001261   -0.1976073773    0.3196291484   -0.2734431345
 27   -0.4411316795   -0.1976073770    0.3196291486   -0.2734431350
 28   -0.4411480875   -0.1976073769    0.3196291487   -0.2734431352
 29   -0.4411566196   -0.1976073768    0.3196291488   -0.2734431353
 30   -0.4411610564   -0.1976073768    0.3196291488   -0.2734431354
 31   -0.4411633635   -0.1976073768    0.3196291488   -0.2734431354
 32   -0.4411645633   -0.1976073768    0.3196291488   -0.2734431355
 33   -0.4411651871   -0.1976073768    0.3196291488   -0.2734431355
 34   -0.4411655115   -0.1976073768    0.3196291488   -0.2734431355
 35   -0.4411656802   -0.1976073768    0.3196291489   -0.2734431355
 36   -0.4411657679   -0.1976073768    0.3196291489   -0.2734431355
Atom SCF converged after  36 iterations to a total energy of     -0.44116577
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20753542E+01     0.97199427E+00
               2       0.19185239E+01     0.94548685E+00
               3       0.17723381E+01     0.89646694E+00
               4       0.16153603E+01     0.81168272E+00
               5       0.14296624E+01     0.68024190E+00
               6       0.12120440E+01     0.50618093E+00
               7       0.96137989E+00     0.32220976E+00
               8       0.70101327E+00     0.21127549E+00
               9       0.43858029E+00     0.13346961E+00
              10       0.18929384E+00     0.57934255E-01
              11       0.35822654E-01     0.10964675E-01
              12       0.12832624E-02     0.39278349E-03
              13       0.16467625E-05     0.50404430E-06
              14       0.27117963E-11     0.83000273E-12
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -0.47167297530915    0.5865434
               2          -0.58616119896950    0.5775424
               3          -0.72769454956268    0.5671287
               4          -0.88061639423001    0.5612206
               5          -1.01056077611479    0.5580108
               6          -1.09427105238303    0.5346562
               7          -1.14277126423072    0.5081135
               8          -1.16214952634303    0.5004145
               9          -1.16464700487817    0.5000010
              10          -1.16468386366055    0.5000210
              11          -1.16468387173609    0.9993998
              12          -1.16468387173609    0.9993998
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999945]
Closest occupancy to 0.5:     0.99999999999982
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -13.514448177654=    -13.514448177654+      0.000000000000
    Trial step:       1.000000000000
            G0:     -12.783128334084
WARNING: minimum value of charge density: -0.0814
      Q1=E1+P1:     535.203815202451=    -23.944340359842+    559.148155562293
Quadratic term:    -561.501391714188
   Linear term:     -12.783128334084
  Optimal step:       0.011382989003
 Predicted min:     -13.587203282279
    !!! Quadratic minimum step length accepted !!!
 1    -13.51444817765371 0.59589168325 0.10580342617 0.0114  0.000    8.00000000
      Q0=E0+P0:     -13.653056794407=    -13.659647268293+      0.006590473886
    Trial step:       0.106691091488
            G0:      -0.048126402545
      Q1=E1+P1:     -13.658158014225=    -13.664692707683+      0.006534693458
Quadratic term:      -0.000033438599
   Linear term:      -0.005134658417
  Optimal step:       8.191466274952
    !!! Quadratic fit may be unreliable; taking second trial step !!!
WARNING: minimum value of charge density: -0.0063
      Q2=E2+P2:     -13.601883931289=    -14.006981542200+      0.405097610911
Quadratic term:      -0.445398666496
   Linear term:      -0.394225803378
  Optimal step:       3.625165066718
 2    -13.65964726829340 0.53808822263 0.10359978891 3.6252 -0.899    8.00000000
      Q0=E0+P0:     -13.772690911111=    -13.823247135449+      0.050556224338
    Trial step:       5.449350180082
            G0:      -9.794805265298
WARNING: minimum value of charge density: -0.9681
      Q1=E1+P1:  217242.140800688503=     17.832007433065+ 217224.308793255448
Quadratic term: -217309.288815435924
   Linear term:     -53.375323836314
  Optimal step:       0.000669232393
    !!! Quadratic fit may be unreliable; taking second trial step !!!
      Q2=E2+P2:     -13.779225988588=    -13.830314429371+      0.051088440783
Quadratic term:      -0.000019923486
   Linear term:      -0.006555000962
  Optimal step:       0.110091653260
 3    -13.82324713544872 0.52111798866 0.04799052985 0.1101  1.517    8.00000000
WARNING: minimum value of charge density: -0.0066

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.954226105117
   Final penalty energy   :       0.903366105772
   RMS occupancy error    :       0.194011
   Occupancy bounds       : [-0.192, 1.293]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.194011 (step -0.2673 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.018238 (step -0.4750 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000694 (step -0.5012 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000001 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.678736576910
             Q0:     -13.652717049792
             G0:      -0.047447421436
   RMS gradient:       0.036304048380
     Trial step:       0.500000000000
             Q1:     -13.661461968329
 Quadratic coef:       0.014978792181
 Linear coef   :      -0.023723710718
           Qmin:     -13.662110571703
Quadratic minimum step length (  0.395955001436) accepted
    Initial Ne1:       7.99998818
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001564 (step -0.4969 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -13.65271704979156 0.00000000000 0.02722798740 0.3960  0.000    8.00000000
      ideal mu1:      -0.663203364830
             Q0:     -13.662160653636
             G0:      -0.001527003213
   RMS gradient:       0.006488357196
     Trial step:       0.444946626820
             Q1:     -13.662300093544
 Quadratic coef:       0.000539995020
 Linear coef   :      -0.000679434929
           Qmin:     -13.662374374043
Quadratic minimum step length (  0.279921358767) accepted
    Initial Ne1:       7.99999973
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000088 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -13.66216065363581 0.00117419024 0.00486626790 0.2799  0.032    8.00000000
      ideal mu1:      -0.661810579872
             Q0:     -13.662374457462
             G0:      -0.000093777584
   RMS gradient:       0.001613193976
     Trial step:       0.352916511881
             Q1:     -13.662396593784
 Quadratic coef:       0.000010959336
 Linear coef   :      -0.000033095658
           Qmin:     -13.662399443524
Quadratic minimum step length (  0.532879204976) accepted
    Initial Ne1:       7.99999991
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -13.66237445746224 0.00002776225 0.00120989548 0.5329  0.062    8.00000000
      ideal mu1:      -0.662008691218
             Q0:     -13.662399449772
             G0:      -0.000006345095
   RMS gradient:       0.000419775981
     Trial step:       0.433661008477
             Q1:     -13.662400151014
 Quadratic coef:       0.000002050378
 Linear coef   :      -0.000002751620
           Qmin:     -13.662400372945
Quadratic minimum step length (  0.290987896068) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -13.66239944977189 0.00000332826 0.00031483198 0.2910  0.068    8.00000000
      ideal mu1:      -0.662000716477
             Q0:     -13.662400372978
             G0:      -0.000001200309
   RMS gradient:       0.000182594954
     Trial step:       0.355232465385
             Q1:     -13.662400645697
 Quadratic coef:       0.000000153670
 Linear coef   :      -0.000000426389
           Qmin:     -13.662400668754
Quadratic minimum step length (  0.492832675379) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -13.66240037297796 0.00000012376 0.00013694622 0.4928  0.189    8.00000000
      ideal mu1:      -0.662022144107
             Q0:     -13.662400668758
             G0:      -0.000000071777
   RMS gradient:       0.000044651575
     Trial step:       0.418413869628
             Q1:     -13.662400686416
 Quadratic coef:       0.000000012374
 Linear coef   :      -0.000000030032
           Qmin:     -13.662400686980
Quadratic minimum step length (  0.507737465160) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -13.66240066875812 0.00000004448 0.00003348868 0.5077  0.060    8.00000000
      ideal mu1:      -0.662014761615
             Q0:     -13.662400686980
             G0:      -0.000000002238
   RMS gradient:       0.000007884230
     Trial step:       0.460916909597
             Q1:     -13.662400687148
 Quadratic coef:       0.000000000863
 Linear coef   :      -0.000000001031
           Qmin:     -13.662400687288
Quadratic minimum step length (  0.275292778519) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -13.66240068698015 0.00000000244 0.00000591317 0.2753  0.000    8.00000000
      ideal mu1:      -0.662014787214
             Q0:     -13.662400687288
             G0:      -0.000000000133
   RMS gradient:       0.000001918983
     Trial step:       0.356212151266
             Q1:     -13.662400687316
 Quadratic coef:       0.000000000020
 Linear coef   :      -0.000000000047
           Qmin:     -13.662400687316
Quadratic minimum step length (  0.422446433692) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -13.66240068728819 0.00000000004 0.00000143924 0.4224  0.059    8.00000000
      ideal mu1:      -0.662015131905
             Q0:     -13.662400687316
             G0:      -0.000000000002
   RMS gradient:       0.000000214005
     Trial step:       0.387918229708
             Q1:     -13.662400687317
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -13.662400687317
Quadratic minimum step length (  0.614373195660) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -13.66240068731617 0.00000000000 0.00000016050 0.6144  0.012    8.00000000
      ideal mu1:      -0.662015084863
10    -13.66240068731651 0.00000000000 0.00000011019 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.13869346043240              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10254567E+01     0.56652417E+00
               2       0.71078239E+00     0.41979007E+00
               3       0.43421988E+00     0.25303110E+00
               4       0.17099259E+00     0.98055386E-01
               5       0.26316533E-01     0.15069510E-01
               6       0.62268945E-03     0.35656498E-03
               7       0.34862194E-06     0.19962820E-06
               8       0.10923997E-12     0.62616579E-13
================================================================================
    Initial Ne1:      10.98989886
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.130215 (step -0.3224 Ne1=      8.0000)
            Final RMS occupancy error   :  0.027063 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0276,  1.0238]
================================================================================

============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56042048E+00     0.27783252E+00
               2       0.18004119E+00     0.98315043E-01
               3       0.24114139E-01     0.13593037E-01
               4       0.51311207E-03     0.28148071E-03
               5       0.23520144E-06     0.12765935E-06
               6       0.48702297E-13     0.26312286E-13
================================================================================
RMS gradient                =       0.13869346043240
Trial step length           =               0.122474
Gradient along search dir.  =        -35.58637053842
Functional at step 0        =     -13.66240068731651
Functional at step 1        =     -11.48360087378493
Functional predicted        =     -14.38885015109837
Selected quadratic step     =               0.040827
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.35912394
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.031406 (step -0.4365 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000989 (step -0.4979 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.660724175283
             Q0:     -14.238434237765
             G0:      -0.252165395229
   RMS gradient:       0.083693454415
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000663 (step -0.4983 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.23843423776549 0.00000000000 0.06277009080 0.1000  0.000    8.00000000
      ideal mu1:      -0.651830697114
             Q0:     -14.260889928418
             G0:      -0.276232003466
   RMS gradient:       0.065633275496
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002117 (step -0.4946 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.26088992841763 0.00157603372 0.04922495662 0.1000  0.615    8.00000000
      ideal mu1:      -0.638500947657
             Q0:     -14.283067309019
             G0:      -0.125086091719
   RMS gradient:       0.040819895140
     Trial step:       0.488187015846
             Q1:     -14.273801714365
 Quadratic coef:       0.070331000494
 Linear coef   :      -0.061065405840
           Qmin:     -14.296322430389
Quadratic minimum step length (  0.211935974457) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.005946 (step -0.4852 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000015 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.28306730901901 0.00307972955 0.03061492135 0.2119  0.387    8.00000000
      ideal mu1:      -0.616748922294
             Q0:     -14.296988527316
             G0:      -0.005226257847
   RMS gradient:       0.011294628940
     Trial step:       0.321658811352
             Q1:     -14.297920118177
 Quadratic coef:       0.000749481027
 Linear coef   :      -0.001681071887
           Qmin:     -14.297931180495
Quadratic minimum step length (  0.360737340772) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001334 (step -0.4966 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.29698852731623 0.00349579401 0.00847097169 0.3607  0.077    8.00000000
      ideal mu1:      -0.615813487709
             Q0:     -14.297959232245
             G0:      -0.001126894563
   RMS gradient:       0.005493908012
     Trial step:       0.340638142672
             Q1:     -14.298175660733
 Quadratic coef:       0.000167434782
 Linear coef   :      -0.000383863271
           Qmin:     -14.298179244790
Quadratic minimum step length (  0.390475831472) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000411 (step -0.4990 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.29795923224462 0.00016699753 0.00412043101 0.3905  0.237    8.00000000
      ideal mu1:      -0.617610528233
             Q0:     -14.298182012937
             G0:      -0.000142515435
   RMS gradient:       0.001976695705
     Trial step:       0.364706679389
             Q1:     -14.298205008562
 Quadratic coef:       0.000028980706
 Linear coef   :      -0.000051976331
           Qmin:     -14.298205317571
Quadratic minimum step length (  0.327047158368) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000052 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -14.29818201293708 0.00003860452 0.00148252178 0.3270  0.129    8.00000000
      ideal mu1:      -0.618159725276
             Q0:     -14.298205365694
             G0:      -0.000030320450
   RMS gradient:       0.000917733468
     Trial step:       0.345363986443
             Q1:     -14.298212009599
 Quadratic coef:       0.000003827687
 Linear coef   :      -0.000010471591
           Qmin:     -14.298212527606
Quadratic minimum step length (  0.472414618914) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.29820536569414 0.00000349279 0.00068830010 0.4724  0.000    8.00000000
      ideal mu1:      -0.618277765052
             Q0:     -14.298212527507
             G0:      -0.000005829398
   RMS gradient:       0.000402411227
     Trial step:       0.403924492996
             Q1:     -14.298213381088
 Quadratic coef:       0.000001501056
 Linear coef   :      -0.000002354637
           Qmin:     -14.298213450909
Quadratic minimum step length (  0.316808752021) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.29821252750702 0.00000089524 0.00030180842 0.3168  0.192    8.00000000
      ideal mu1:      -0.618234596580
             Q0:     -14.298213450917
             G0:      -0.000000184741
   RMS gradient:       0.000071635603
     Trial step:       0.357724495299
             Q1:     -14.298213493032
 Quadratic coef:       0.000000023971
 Linear coef   :      -0.000000066086
           Qmin:     -14.298213496465
Quadratic minimum step length (  0.493106175488) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.29821345091707 0.00000013761 0.00005372670 0.4931  0.032    8.00000000
      ideal mu1:      -0.618248753448
10    -14.29821349646556 0.00000000591 0.00001493763 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.06385147424729              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16225837E+00     0.11610551E+00
               2       0.18441013E-01     0.14302429E-01
               3       0.30426942E-03     0.23297398E-03
               4       0.85718309E-07     0.65239036E-07
               5       0.69449984E-14     0.55511151E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.86242227E-01     0.61513626E-01
               2       0.50486338E-02     0.39679031E-02
               3       0.22389876E-04     0.17524061E-04
               4       0.46083565E-09     0.35868153E-09
               5       0.11721803E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.06385147424729
Trial step length           =               0.070713
Gradient along search dir.  =         -6.57669790744
Functional at step 0        =     -14.29821349646556
Functional at step 1        =     -14.33105775934554
Functional predicted        =     -14.42331287905061
Selected quadratic step     =               0.038043
Conjugate gradients coeff.  =               0.211948
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.19458904
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.017163 (step -0.4623 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000320 (step -0.4993 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.635161057931
             Q0:     -14.415422522379
             G0:      -0.017406752967
   RMS gradient:       0.021989109026
     Trial step:       0.419995425874
             Q1:     -14.419235947197
 Quadratic coef:       0.003497331807
 Linear coef   :      -0.007310756625
           Qmin:     -14.419243089413
Quadratic minimum step length (  0.438975269124) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000884 (step -0.4977 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.41542252237863 0.00000000000 0.01649183177 0.4390  0.000    8.00000000
      ideal mu1:      -0.628629301513
             Q0:     -14.419257195198
             G0:      -0.002508393898
   RMS gradient:       0.008306059968
     Trial step:       0.429380489897
             Q1:     -14.419688980592
 Quadratic coef:       0.000645270007
 Linear coef   :      -0.001077055401
           Qmin:     -14.419706638192
Quadratic minimum step length (  0.358351209860) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000279 (step -0.4993 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.41925719519813 0.00047757088 0.00622954498 0.3584  0.143    8.00000000
      ideal mu1:      -0.625207659113
             Q0:     -14.419708094558
             G0:      -0.000151036524
   RMS gradient:       0.002043586481
     Trial step:       0.392261415442
             Q1:     -14.419746428550
 Quadratic coef:       0.000020911809
 Linear coef   :      -0.000059245801
           Qmin:     -14.419750057270
Quadratic minimum step length (  0.555663106062) accepted
    Initial Ne1:       7.99999962
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000040 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -14.41970809455798 0.00006467128 0.00153268992 0.5557  0.061    8.00000000
      ideal mu1:      -0.625960509680
             Q0:     -14.419750082810
             G0:      -0.000008653848
   RMS gradient:       0.000490187016
     Trial step:       0.466867429248
             Q1:     -14.419751748497
 Quadratic coef:       0.000002374513
 Linear coef   :      -0.000004040200
           Qmin:     -14.419751801396
Quadratic minimum step length (  0.397184064484) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.41975008281043 0.00000563682 0.00036764026 0.3972  0.058    8.00000000
      ideal mu1:      -0.625983124236
             Q0:     -14.419751801511
             G0:      -0.000001715930
   RMS gradient:       0.000218314771
     Trial step:       0.430618512286
             Q1:     -14.419752207189
 Quadratic coef:       0.000000333234
 Linear coef   :      -0.000000738911
           Qmin:     -14.419752211126
Quadratic minimum step length (  0.477425638000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.41975180151116 0.00000022825 0.00016373608 0.4774  0.198    8.00000000
      ideal mu1:      -0.625972207520
             Q0:     -14.419752211139
             G0:      -0.000000017685
   RMS gradient:       0.000022163739
     Trial step:       0.453418479953
             Q1:     -14.419752216377
 Quadratic coef:       0.000000002780
 Linear coef   :      -0.000000008019
           Qmin:     -14.419752216920
Quadratic minimum step length (  0.653828122037) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.41975221113865 0.00000006200 0.00001662280 0.6538  0.010    8.00000000
      ideal mu1:      -0.625968335272
             Q0:     -14.419752216920
             G0:      -0.000000000979
   RMS gradient:       0.000005215479
     Trial step:       0.544479341431
             Q1:     -14.419752217111
 Quadratic coef:       0.000000000343
 Linear coef   :      -0.000000000533
           Qmin:     -14.419752217127
Quadratic minimum step length (  0.423798524877) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.41975221691997 0.00000000073 0.00000391161 0.4238  0.000    8.00000000
      ideal mu1:      -0.625969356623
             Q0:     -14.419752217127
             G0:      -0.000000000222
   RMS gradient:       0.000002485264
     Trial step:       0.480363967971
             Q1:     -14.419752217178
 Quadratic coef:       0.000000000056
 Linear coef   :      -0.000000000107
           Qmin:     -14.419752217178
Quadratic minimum step length (  0.454126626906) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -14.41975221712744 0.00000000003 0.00000186395 0.4541  0.227    8.00000000
      ideal mu1:      -0.625969603515
             Q0:     -14.419752217178
             G0:      -0.000000000021
   RMS gradient:       0.000000763349
     Trial step:       0.467061097140
             Q1:     -14.419752217184
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000010
           Qmin:     -14.419752217185
Quadratic minimum step length (  0.640927173608) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.41975221717792 0.00000000001 0.00000057251 0.6409  0.094    8.00000000
      ideal mu1:      -0.625969427131
10    -14.41975221718453 0.00000000000 0.00000014609 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.03065519481604              |
           | Maximum change in energy =  0.21193760304968 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54774377E-01     0.36959634E-01
               2       0.20114305E-02     0.14181242E-02
               3       0.31132370E-05     0.21231943E-05
               4       0.71710875E-11     0.47403192E-11
               5       0.14809157E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14104800E-01     0.92960261E-02
               2       0.13374359E-03     0.90554980E-04
               3       0.13642245E-07     0.88082508E-08
               4       0.14721725E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.03065519481604
Trial step length           =               0.051867
Gradient along search dir.  =         -1.70497172634
Functional at step 0        =     -14.41975221718453
Functional at step 1        =     -14.45279474424651
Functional predicted        =     -14.45504857851867
Selected quadratic step     =               0.041404
Conjugate gradients coeff.  =               0.230498
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.08289550
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.007539 (step -0.4820 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000064 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.647941778286
             Q0:     -14.454347324398
             G0:      -0.002798521477
   RMS gradient:       0.008816842274
     Trial step:       0.547130833432
             Q1:     -14.455152723118
 Quadratic coef:       0.000725758667
 Linear coef   :      -0.001531157388
           Qmin:     -14.455154907914
Quadratic minimum step length (  0.577150129810) accepted
    Initial Ne1:       7.99999993
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000253 (step -0.4993 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -14.45434732439763 0.00000000000 0.00661263150 0.5772  0.000    8.00000000
      ideal mu1:      -0.642391099888
             Q0:     -14.455155792123
             G0:      -0.000227783604
   RMS gradient:       0.002510512837
     Trial step:       0.561940060450
             Q1:     -14.455192879068
 Quadratic coef:       0.000090913788
 Linear coef   :      -0.000128000732
           Qmin:     -14.455200846311
Quadratic minimum step length (  0.395587626737) accepted
    Initial Ne1:       8.00000023
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000033 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -14.45515579212326 0.00010094794 0.00188288481 0.3956  0.081    8.00000000
      ideal mu1:      -0.642347024498
             Q0:     -14.455200866563
             G0:      -0.000038022558
   RMS gradient:       0.001027516866
     Trial step:       0.471483334681
             Q1:     -14.455210310087
 Quadratic coef:       0.000008483478
 Linear coef   :      -0.000017927002
           Qmin:     -14.455210337249
Quadratic minimum step length (  0.498161411130) accepted
    Initial Ne1:       8.00000005
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.45520086656313 0.00000610854 0.00077063765 0.4982  0.168    8.00000000
      ideal mu1:      -0.642619245035
             Q0:     -14.455210338734
             G0:      -0.000001689322
   RMS gradient:       0.000216613602
     Trial step:       0.484638838032
             Q1:     -14.455210915897
 Quadratic coef:       0.000000241549
 Linear coef   :      -0.000000818711
           Qmin:     -14.455211032474
Quadratic minimum step length (  0.821323015908) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.45521033873442 0.00000140013 0.00016246020 0.8213  0.044    8.00000000
      ideal mu1:      -0.642592236324
             Q0:     -14.455211032502
             G0:      -0.000000214893
   RMS gradient:       0.000077258688
     Trial step:       0.630908101136
             Q1:     -14.455211030966
 Quadratic coef:       0.000000137114
 Linear coef   :      -0.000000135578
           Qmin:     -14.455211066017
Quadratic minimum step length (  0.311920233524) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.45521103250235 0.00000009128 0.00005794402 0.3119  0.127    8.00000000
      ideal mu1:      -0.642605640218
             Q0:     -14.455211066018
             G0:      -0.000000009829
   RMS gradient:       0.000016523657
     Trial step:       0.443613573100
             Q1:     -14.455211069097
 Quadratic coef:       0.000000001281
 Linear coef   :      -0.000000004360
           Qmin:     -14.455211069727
Quadratic minimum step length (  0.754769332998) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.45521106601761 0.00000000475 0.00001239274 0.7548  0.046    8.00000000
      ideal mu1:      -0.642603718971
             Q0:     -14.455211069728
             G0:      -0.000000000171
   RMS gradient:       0.000002180864
     Trial step:       0.578641443968
             Q1:     -14.455211069790
 Quadratic coef:       0.000000000037
 Linear coef   :      -0.000000000099
           Qmin:     -14.455211069794
Quadratic minimum step length (  0.775101675057) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.45521106972769 0.00000000049 0.00000163565 0.7751  0.000    8.00000000
      ideal mu1:      -0.642604275558
             Q0:     -14.455211069794
             G0:      -0.000000000017
   RMS gradient:       0.000000676618
     Trial step:       0.669705870123
             Q1:     -14.455211069796
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000011
           Qmin:     -14.455211069798
Quadratic minimum step length (  0.421998297917) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.45521106979402 0.00000000001 0.00000050746 0.4220  0.096    8.00000000
      ideal mu1:      -0.642604035584
             Q0:     -14.455211069798
             G0:      -0.000000000003
   RMS gradient:       0.000000294221
     Trial step:       0.531615215449
             Q1:     -14.455211069798
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -14.455211069798
Quadratic minimum step length (  0.332272945525) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.45521106979771 0.00000000000 0.00000022067 0.3323  0.189    8.00000000
      ideal mu1:      -0.642604017813
10    -14.45521106979829 0.00000000000 0.00000006555 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01780869484589              |
           | Maximum change in energy =  0.04051290690633 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.37924535E-01     0.22553786E-01
               2       0.10273813E-02     0.56179320E-03
               3       0.77829326E-06     0.41239243E-06
               4       0.39953306E-12     0.21849189E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.38223158E-02     0.21977022E-02
               2       0.10449554E-04     0.54397491E-05
               3       0.79298376E-10     0.42265746E-10
               4       0.14520519E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.01780869484589
Trial step length           =               0.046341
Gradient along search dir.  =         -0.59148215675
Functional at step 0        =     -14.45521106979829
Functional at step 1        =     -14.46775393963432
Functional predicted        =     -14.46784477151492
Selected quadratic step     =               0.042719
Conjugate gradients coeff.  =               0.337486
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.04438552
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004513 (step -0.4886 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000023 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.659137558934
             Q0:     -14.467594083245
             G0:      -0.001265365158
   RMS gradient:       0.005928661921
     Trial step:       0.420287227409
             Q1:     -14.467938830163
 Quadratic coef:       0.000187069896
 Linear coef   :      -0.000531816814
           Qmin:     -14.467972055769
Quadratic minimum step length (  0.597412568510) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000117 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -14.46759408324479 0.00000000000 0.00444649643 0.5974  0.000    8.00000000
      ideal mu1:      -0.654874641534
             Q0:     -14.467972477590
             G0:      -0.000107380289
   RMS gradient:       0.001724678361
     Trial step:       0.501083697638
             Q1:     -14.467993908242
 Quadratic coef:       0.000032375860
 Linear coef   :      -0.000053806512
           Qmin:     -14.467994833295
Quadratic minimum step length (  0.416383782657) accepted
    Initial Ne1:       8.00000010
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.46797247759002 0.00004724657 0.00129350880 0.4164  0.085    8.00000000
      ideal mu1:      -0.655036451135
             Q0:     -14.467994837294
             G0:      -0.000019017998
   RMS gradient:       0.000726764801
     Trial step:       0.456774698785
             Q1:     -14.467999748794
 Quadratic coef:       0.000003775441
 Linear coef   :      -0.000008686940
           Qmin:     -14.467999834257
Quadratic minimum step length (  0.525498232355) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.46799483729449 0.00000303804 0.00054507360 0.5255  0.178    8.00000000
      ideal mu1:      -0.655117714395
             Q0:     -14.467999834679
             G0:      -0.000000741653
   RMS gradient:       0.000143526173
     Trial step:       0.489932951327
             Q1:     -14.468000103183
 Quadratic coef:       0.000000094856
 Linear coef   :      -0.000000363360
           Qmin:     -14.468000182654
Quadratic minimum step length (  0.938377167626) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.46799983467910 0.00000074562 0.00010764463 0.9384  0.039    8.00000000
      ideal mu1:      -0.655108633469
             Q0:     -14.468000182660
             G0:      -0.000000202992
   RMS gradient:       0.000075090254
     Trial step:       0.678042694225
             Q1:     -14.468000174745
 Quadratic coef:       0.000000145553
 Linear coef   :      -0.000000137637
           Qmin:     -14.468000215198
Quadratic minimum step length (  0.320584516799) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.46800018266025 0.00000004553 0.00005631769 0.3206  0.274    8.00000000
      ideal mu1:      -0.655116337567
             Q0:     -14.468000215198
             G0:      -0.000000003439
   RMS gradient:       0.000009773513
     Trial step:       0.466229545929
             Q1:     -14.468000216325
 Quadratic coef:       0.000000000476
 Linear coef   :      -0.000000001603
           Qmin:     -14.468000216547
Quadratic minimum step length (  0.784462402497) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.46800021519846 0.00000000523 0.00000733013 0.7845  0.017    8.00000000
      ideal mu1:      -0.655115736698
             Q0:     -14.468000216547
             G0:      -0.000000000068
   RMS gradient:       0.000001373739
     Trial step:       0.604764044661
             Q1:     -14.468000216570
 Quadratic coef:       0.000000000018
 Linear coef   :      -0.000000000041
           Qmin:     -14.468000216570
Quadratic minimum step length (  0.674180716385) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.46800021654688 0.00000000017 0.00000103030 0.6742  0.000    8.00000000
      ideal mu1:      -0.655115940647
             Q0:     -14.468000216570
             G0:      -0.000000000012
   RMS gradient:       0.000000592635
     Trial step:       0.638529761932
             Q1:     -14.468000216572
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000008
           Qmin:     -14.468000216572
Quadratic minimum step length (  0.415700121192) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.46800021656971 0.00000000000 0.00000044448 0.4157  0.186    8.00000000
      ideal mu1:      -0.655115802941
             Q0:     -14.468000216572
             G0:      -0.000000000002
   RMS gradient:       0.000000239592
     Trial step:       0.515205686518
             Q1:     -14.468000216573
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -14.468000216573
Quadratic minimum step length (  0.591655234393) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.46800021657218 0.00000000000 0.00000017969 0.5917  0.163    8.00000000
      ideal mu1:      -0.655115814360
10    -14.46800021657278 0.00000000000 0.00000001491 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01022792337212              |
           | Maximum change in energy =  0.01181961753792 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        6.96116955480078 |
           | Pseudopotential (local)    :      -39.68476300500315 |
           | Pseudopotential (non-local):       -0.42626008924008 |
           | Hartree                    :       16.18880892858916 |
           | Exchange-correlation       :       -3.44280485369033 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -14.46800021657278 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -39.68476300500326 |
           | Hartree                    :       16.18880892858920 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999999
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.58096069E-02     0.24299713E-02
               2       0.22955926E-04     0.10818099E-04
               3       0.41964673E-09     0.19373547E-09
               4       0.18118223E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16607508E-02     0.69629004E-03
               2       0.19229487E-05     0.83571541E-06
               3       0.28848346E-11     0.12364554E-11
               4       0.11674483E-14     0.58980598E-15
================================================================================
RMS gradient                =       0.01022792337212
Trial step length           =               0.044493
Gradient along search dir.  =         -0.19352927054
Functional at step 0        =     -14.46800021657278
Functional at step 1        =     -14.47110612604403
Functional predicted        =     -14.47136747374670
Selected quadratic step     =               0.034798
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00037840
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000443 (step -0.4991 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.657478855096
             Q0:     -14.471367054835
             G0:      -0.000031505227
   RMS gradient:       0.000935491955
     Trial step:       0.552108812842
             Q1:     -14.471374376590
 Quadratic coef:       0.000010072559
 Linear coef   :      -0.000017394314
           Qmin:     -14.471374564400
Quadratic minimum step length (  0.476718671347) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47136705483506 0.00000000000 0.00070161897 0.4767  0.000    8.00000000
      ideal mu1:      -0.657155357801
             Q0:     -14.471374563826
             G0:      -0.000004429104
   RMS gradient:       0.000350724290
     Trial step:       0.513030778508
             Q1:     -14.471375340896
 Quadratic coef:       0.000001495196
 Linear coef   :      -0.000002272267
           Qmin:     -14.471375427123
Quadratic minimum step length (  0.389829258301) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -14.47137456382560 0.00000093870 0.00026304322 0.3898  0.141    8.00000000
      ideal mu1:      -0.656971722060
             Q0:     -14.471375427099
             G0:      -0.000000255893
   RMS gradient:       0.000084308644
     Trial step:       0.447207343267
             Q1:     -14.471375504893
 Quadratic coef:       0.000000036644
 Linear coef   :      -0.000000114437
           Qmin:     -14.471375516445
Quadratic minimum step length (  0.698306669163) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.47137542709944 0.00000012310 0.00006323148 0.6983  0.058    8.00000000
      ideal mu1:      -0.656984251863
             Q0:     -14.471375516445
             G0:      -0.000000007941
   RMS gradient:       0.000014851719
     Trial step:       0.558827227595
             Q1:     -14.471375518240
 Quadratic coef:       0.000000002642
 Linear coef   :      -0.000000004437
           Qmin:     -14.471375518308
Quadratic minimum step length (  0.469221107777) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.47137551644462 0.00000001190 0.00001113879 0.4692  0.031    8.00000000
      ideal mu1:      -0.656985846034
             Q0:     -14.471375518308
             G0:      -0.000000003132
   RMS gradient:       0.000009327872
     Trial step:       0.512067896659
             Q1:     -14.471375519316
 Quadratic coef:       0.000000000596
 Linear coef   :      -0.000000001604
           Qmin:     -14.471375519387
Quadratic minimum step length (  0.689035865882) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47137551830770 0.00000000024 0.00000699590 0.6890  0.394    8.00000000
      ideal mu1:      -0.656985552013
             Q0:     -14.471375519387
             G0:      -0.000000000049
   RMS gradient:       0.000001166516
     Trial step:       0.593997598113
             Q1:     -14.471375519406
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000029
           Qmin:     -14.471375519407
Quadratic minimum step length (  0.822128248106) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.47137551938694 0.00000000019 0.00000087489 0.8221  0.016    8.00000000
      ideal mu1:      -0.656985506368
             Q0:     -14.471375519407
             G0:      -0.000000000003
   RMS gradient:       0.000000265428
     Trial step:       0.698814857252
             Q1:     -14.471375519408
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -14.471375519408
Quadratic minimum step length (  0.852385177190) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.47137551940693 0.00000000000 0.00000019907 0.8524  0.000    8.00000000
      ideal mu1:      -0.656985498831
             Q0:     -14.471375519408
             G0:      -0.000000000000
   RMS gradient:       0.000000110385
     Trial step:       0.771789754999
             Q1:     -14.471375519408
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.471375519408
Quadratic minimum step length (  0.648812914444) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.47137551940788 0.00000000000 0.00000008279 0.6488  0.173    8.00000000
      ideal mu1:      -0.656985510402
             Q0:     -14.471375519408
             G0:      -0.000000000000
   RMS gradient:       0.000000046944
     Trial step:       0.707634906063
             Q1:     -14.471375519408
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.471375519408
Quadratic minimum step length (  0.095674279831) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.47137551940802 0.00000000000 0.00000003521 0.0957  0.181    8.00000000
      ideal mu1:      -0.656985508053
10    -14.47137551940792 0.00000000000 0.00000002634 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00589354023708              |
           | Maximum change in energy =  0.00426304892483 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.75962693E-02     0.31161295E-02
               2       0.41130682E-04     0.17209433E-04
               3       0.13804717E-08     0.57058744E-09
               4       0.10794807E-14     0.52735594E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.47465504E-02     0.18222297E-02
               2       0.16102747E-04     0.70016106E-05
               3       0.19861798E-09     0.91070235E-10
               4       0.11308990E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00589354023708
Trial step length           =               0.039348
Gradient along search dir.  =         -0.06440179309
Functional at step 0        =     -14.47137551940792
Functional at step 1        =     -14.47300735040626
Functional predicted        =     -14.47315482845043
Selected quadratic step     =               0.055257
Conjugate gradients coeff.  =               0.332030
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00161339
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001006 (step -0.4978 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.662337021719
             Q0:     -14.473150202596
             G0:      -0.000154976771
   RMS gradient:       0.002074827776
     Trial step:       0.260196963896
             Q1:     -14.473180478620
 Quadratic coef:       0.000010048461
 Linear coef   :      -0.000040324485
           Qmin:     -14.473190658145
Quadratic minimum step length (  0.522085333242) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47315020259593 0.00000000000 0.00155612083 0.5221  0.000    8.00000000
      ideal mu1:      -0.661585256599
             Q0:     -14.473190687377
             G0:      -0.000029409670
   RMS gradient:       0.000903192369
     Trial step:       0.368571592237
             Q1:     -14.473196725044
 Quadratic coef:       0.000004801903
 Linear coef   :      -0.000010839569
           Qmin:     -14.473196804549
Quadratic minimum step length (  0.415997314932) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.47319068737723 0.00000505694 0.00067739428 0.4160  0.189    8.00000000
      ideal mu1:      -0.661156935053
             Q0:     -14.473196805047
             G0:      -0.000002205121
   RMS gradient:       0.000247465057
     Trial step:       0.391567098632
             Q1:     -14.473197417161
 Quadratic coef:       0.000000251339
 Linear coef   :      -0.000000863453
           Qmin:     -14.473197546626
Quadratic minimum step length (  0.672596862226) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.47319680504678 0.00000091044 0.00018559879 0.6726  0.075    8.00000000
      ideal mu1:      -0.661216546480
             Q0:     -14.473197546622
             G0:      -0.000000135711
   RMS gradient:       0.000061399031
     Trial step:       0.513192753155
             Q1:     -14.473197579823
 Quadratic coef:       0.000000036445
 Linear coef   :      -0.000000069646
           Qmin:     -14.473197579896
Quadratic minimum step length (  0.490354656555) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.47319754662243 0.00000010101 0.00004604927 0.4904  0.062    8.00000000
      ideal mu1:      -0.661228120255
             Q0:     -14.473197579896
             G0:      -0.000000056634
   RMS gradient:       0.000039663301
     Trial step:       0.501643754292
             Q1:     -14.473197598754
 Quadratic coef:       0.000000009552
 Linear coef   :      -0.000000028410
           Qmin:     -14.473197601021
Quadratic minimum step length (  0.746032656755) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47319757989588 0.00000000444 0.00002974748 0.7460  0.417    8.00000000
      ideal mu1:      -0.661223400234
             Q0:     -14.473197601022
             G0:      -0.000000000343
   RMS gradient:       0.000003084660
     Trial step:       0.611753727213
             Q1:     -14.473197601149
 Quadratic coef:       0.000000000083
 Linear coef   :      -0.000000000210
           Qmin:     -14.473197601155
Quadratic minimum step length (  0.775998954551) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.47319760102166 0.00000000382 0.00000231349 0.7760  0.006    8.00000000
      ideal mu1:      -0.661223539304
             Q0:     -14.473197601154
             G0:      -0.000000000009
   RMS gradient:       0.000000510476
     Trial step:       0.688999457735
             Q1:     -14.473197601157
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000006
           Qmin:     -14.473197601157
Quadratic minimum step length (  0.541477240805) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -14.47319760115450 0.00000000002 0.00000038286 0.5415  0.000    8.00000000
      ideal mu1:      -0.661223460331
             Q0:     -14.473197601157
             G0:      -0.000000000002
   RMS gradient:       0.000000214015
     Trial step:       0.610800724697
             Q1:     -14.473197601157
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -14.473197601157
Quadratic minimum step length (  0.370464387755) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.47319760115707 0.00000000000 0.00000016051 0.3705  0.176    8.00000000
      ideal mu1:      -0.661223491050
             Q0:     -14.473197601157
             G0:      -0.000000000000
   RMS gradient:       0.000000055818
     Trial step:       0.475688886264
             Q1:     -14.473197601157
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473197601157
  Cubic LS coeff:       0.618866608967
Predicted energy:     -14.473197601157
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.47319760115729 0.00000000000 0.00000004186 0.6189  0.068    8.00000000
      ideal mu1:      -0.661223493670
10    -14.47319760115742 0.00000000000 0.00000001801 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00414008297132              |
           | Maximum change in energy =  0.00112510094505 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14637408E-01     0.56613697E-02
               2       0.15233455E-03     0.64509542E-04
               3       0.18045959E-07     0.80625124E-08
               4       0.13035936E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.37500056E-02     0.14103298E-02
               2       0.99172810E-05     0.43991902E-05
               3       0.73698235E-10     0.34206582E-10
               4       0.12840704E-14     0.77715612E-15
================================================================================
RMS gradient                =       0.00414008297132
Trial step length           =               0.046629
Gradient along search dir.  =         -0.03246578621
Functional at step 0        =     -14.47319760115742
Functional at step 1        =     -14.47376192454130
Functional predicted        =     -14.47380099050400
Selected quadratic step     =               0.037171
Conjugate gradients coeff.  =               0.493475
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00104008
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000787 (step -0.4983 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.665124657250
             Q0:     -14.473799172449
             G0:      -0.000106314498
   RMS gradient:       0.001718482032
     Trial step:       0.542575310870
             Q1:     -14.473826249379
 Quadratic coef:       0.000030606691
 Linear coef   :      -0.000057683622
           Qmin:     -14.473826351148
Quadratic minimum step length (  0.511288668292) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47379917244874 0.00000000000 0.00128886152 0.5113  0.000    8.00000000
      ideal mu1:      -0.664630513778
             Q0:     -14.473826350177
             G0:      -0.000022703590
   RMS gradient:       0.000793927993
     Trial step:       0.526699732431
             Q1:     -14.473831253354
 Quadratic coef:       0.000007054797
 Linear coef   :      -0.000011957975
           Qmin:     -14.473831417408
Quadratic minimum step length (  0.446381512204) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.47382635017698 0.00000339734 0.00059544599 0.4464  0.213    8.00000000
      ideal mu1:      -0.664229860848
             Q0:     -14.473831417396
             G0:      -0.000001589210
   RMS gradient:       0.000210090949
     Trial step:       0.484880421382
             Q1:     -14.473831915939
 Quadratic coef:       0.000000272033
 Linear coef   :      -0.000000770577
           Qmin:     -14.473831963091
Quadratic minimum step length (  0.686750808561) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -14.47383141739551 0.00000076886 0.00015756821 0.6868  0.070    8.00000000
      ideal mu1:      -0.664280162616
             Q0:     -14.473831963092
             G0:      -0.000000137813
   RMS gradient:       0.000061872533
     Trial step:       0.577054608715
             Q1:     -14.473831992249
 Quadratic coef:       0.000000050369
 Linear coef   :      -0.000000079526
           Qmin:     -14.473831994482
Quadratic minimum step length (  0.455546888450) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.47383196309181 0.00000007402 0.00004640440 0.4555  0.087    8.00000000
      ideal mu1:      -0.664292021292
             Q0:     -14.473831994482
             G0:      -0.000000047709
   RMS gradient:       0.000036403855
     Trial step:       0.512713790985
             Q1:     -14.473832011578
 Quadratic coef:       0.000000007365
 Linear coef   :      -0.000000024461
           Qmin:     -14.473832014792
Quadratic minimum step length (  0.851392271163) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47383199448217 0.00000000429 0.00002730289 0.8514  0.346    8.00000000
      ideal mu1:      -0.664287040361
             Q0:     -14.473832014791
             G0:      -0.000000000527
   RMS gradient:       0.000003824622
     Trial step:       0.660697025090
             Q1:     -14.473832014975
 Quadratic coef:       0.000000000165
 Linear coef   :      -0.000000000348
           Qmin:     -14.473832014975
Quadratic minimum step length (  0.698569955423) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -14.47383201479145 0.00000000350 0.00000286847 0.6986  0.011    8.00000000
      ideal mu1:      -0.664287667838
             Q0:     -14.473832014975
             G0:      -0.000000000013
   RMS gradient:       0.000000612152
     Trial step:       0.679369627938
             Q1:     -14.473832014980
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000009
           Qmin:     -14.473832014980
Quadratic minimum step length (  0.714164404474) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.47383201497524 0.00000000002 0.00000045911 0.7142  0.000    8.00000000
      ideal mu1:      -0.664287546552
             Q0:     -14.473832014980
             G0:      -0.000000000001
   RMS gradient:       0.000000202853
     Trial step:       0.696549786989
             Q1:     -14.473832014980
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -14.473832014980
Quadratic minimum step length (  0.307243630906) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.47383201498017 0.00000000000 0.00000015214 0.3072  0.110    8.00000000
      ideal mu1:      -0.664287581248
             Q0:     -14.473832014980
             G0:      -0.000000000000
   RMS gradient:       0.000000066341
     Trial step:       0.462612673477
             Q1:     -14.473832014980
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473832014980
  Cubic LS coeff:       0.635511742294
Predicted energy:     -14.473832014980
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.47383201498017 0.00000000000 0.00000004976 0.6355  0.107    8.00000000
      ideal mu1:      -0.664287600762
10    -14.47383201498041 0.00000000000 0.00000003448 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00168352369355              |
           | Maximum change in energy =  0.00060736058317 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.59597236E-02     0.27042583E-02
               2       0.24004119E-04     0.11738688E-04
               3       0.48568883E-09     0.22706981E-09
               4       0.12416852E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28024250E-02     0.12229608E-02
               2       0.53435800E-05     0.24903125E-05
               3       0.23474176E-10     0.10400125E-10
               4       0.10714586E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00168352369355
Trial step length           =               0.041632
Gradient along search dir.  =         -0.00550225268
Functional at step 0        =     -14.47383201498041
Functional at step 1        =     -14.47386439688245
Functional predicted        =     -14.47389871082491
Selected quadratic step     =               0.024243
Conjugate gradients coeff.  =               0.165356
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99990711
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000368 (step -0.4993 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.665310326892
             Q0:     -14.473898492690
             G0:      -0.000017281676
   RMS gradient:       0.000692853923
     Trial step:       0.542213782680
             Q1:     -14.473902097710
 Quadratic coef:       0.000005765343
 Linear coef   :      -0.000009370363
           Qmin:     -14.473902300083
Quadratic minimum step length (  0.440627691079) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47389849269025 0.00000000000 0.00051964044 0.4406  0.000    8.00000000
      ideal mu1:      -0.665199504197
             Q0:     -14.473902299832
             G0:      -0.000003160095
   RMS gradient:       0.000296264423
     Trial step:       0.488788714205
             Q1:     -14.473903090720
 Quadratic coef:       0.000000753731
 Linear coef   :      -0.000001544619
           Qmin:     -14.473903091178
Quadratic minimum step length (  0.500836765784) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.47390229983185 0.00000047592 0.00022219832 0.5008  0.183    8.00000000
      ideal mu1:      -0.665023235016
             Q0:     -14.473903091185
             G0:      -0.000000184280
   RMS gradient:       0.000071543853
     Trial step:       0.494776069322
             Q1:     -14.473903149404
 Quadratic coef:       0.000000032959
 Linear coef   :      -0.000000091177
           Qmin:     -14.473903154243
Quadratic minimum step length (  0.684370181573) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.47390309118537 0.00000011701 0.00005365789 0.6844  0.058    8.00000000
      ideal mu1:      -0.665034996897
             Q0:     -14.473903154243
             G0:      -0.000000020783
   RMS gradient:       0.000024027289
     Trial step:       0.581902043646
             Q1:     -14.473903156915
 Quadratic coef:       0.000000009421
 Linear coef   :      -0.000000012094
           Qmin:     -14.473903158124
Quadratic minimum step length (  0.373481821042) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.47390315424286 0.00000000843 0.00001802047 0.3735  0.113    8.00000000
      ideal mu1:      -0.665039310987
             Q0:     -14.473903158124
             G0:      -0.000000003290
   RMS gradient:       0.000009559420
     Trial step:       0.466186480852
             Q1:     -14.473903159336
 Quadratic coef:       0.000000000321
 Linear coef   :      -0.000000001534
           Qmin:     -14.473903159954
Quadratic minimum step length (  1.112514152241) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47390315812419 0.00000000054 0.00000716957 1.1125  0.158    8.00000000
      ideal mu1:      -0.665038140957
             Q0:     -14.473903159955
             G0:      -0.000000000087
   RMS gradient:       0.000001557774
     Trial step:       0.720165993040
             Q1:     -14.473903159986
 Quadratic coef:       0.000000000032
 Linear coef   :      -0.000000000063
           Qmin:     -14.473903159986
Quadratic minimum step length (  0.712724883991) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.47390315995523 0.00000000027 0.00000116833 0.7127  0.027    8.00000000
      ideal mu1:      -0.665038441016
             Q0:     -14.473903159986
             G0:      -0.000000000002
   RMS gradient:       0.000000243361
     Trial step:       0.716435777892
             Q1:     -14.473903159987
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -14.473903159987
Quadratic minimum step length (  0.627361421069) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -14.47390315998640 0.00000000000 0.00000018252 0.6274  0.000    8.00000000
      ideal mu1:      -0.665038409470
             Q0:     -14.473903159987
             G0:      -0.000000000000
   RMS gradient:       0.000000057456
     Trial step:       0.670420888489
             Q1:     -14.473903159987
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473903159987
Quadratic minimum step length (  0.662004689353) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.47390315998698 0.00000000000 0.00000004309 0.6620  0.056    8.00000000
      ideal mu1:      -0.665038422786
             Q0:     -14.473903159987
             G0:      -0.000000000000
   RMS gradient:       0.000000030830
     Trial step:       0.666199498664
             Q1:     -14.473903159987
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473903159987
  Cubic LS coeff:       1.072392720057
Predicted energy:     -14.473903159987
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.47390315998705 0.00000000000 0.00000002312 1.0724  0.288    8.00000000
      ideal mu1:      -0.665038408957
10    -14.47390315998709 0.00000000000 0.00000004034 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00040134560187              |
           | Maximum change in energy =  0.00021147127433 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.25385185E-02     0.11444477E-02
               2       0.41502938E-05     0.19926423E-05
               3       0.13582732E-10     0.59667826E-11
               4       0.13260653E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17397583E-02     0.79795831E-03
               2       0.19638933E-05     0.96342574E-06
               3       0.30949625E-11     0.14022117E-11
               4       0.10114349E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00040134560187
Trial step length           =               0.031769
Gradient along search dir.  =         -0.00029799484
Functional at step 0        =     -14.47390315998709
Functional at step 1        =     -14.47389806061751
Functional predicted        =     -14.47390469821122
Selected quadratic step     =               0.010324
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99990848
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000123 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.665189277542
             Q0:     -14.473904678968
             G0:      -0.000001584905
   RMS gradient:       0.000209821687
     Trial step:       0.845238127674
             Q1:     -14.473904533671
 Quadratic coef:       0.000001484920
 Linear coef   :      -0.000001339622
           Qmin:     -14.473904981104
Quadratic minimum step length (  0.381266302351) accepted
    Initial Ne1:       7.99999932
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47390467896822 0.00000000000 0.00015736621 0.3813  0.000    8.00000000
      ideal mu1:      -0.665179197128
             Q0:     -14.473904981085
             G0:      -0.000000200158
   RMS gradient:       0.000074566265
     Trial step:       0.567680205348
             Q1:     -14.473905037512
 Quadratic coef:       0.000000057199
 Linear coef   :      -0.000000113626
           Qmin:     -14.473905037515
Quadratic minimum step length (  0.563850695641) accepted
    Initial Ne1:       7.99999987
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.47390498108548 0.00000003777 0.00005592470 0.5639  0.126    8.00000000
      ideal mu1:      -0.665129646134
             Q0:     -14.473905037515
             G0:      -0.000000010397
   RMS gradient:       0.000016994522
     Trial step:       0.565762210374
             Q1:     -14.473905040861
 Quadratic coef:       0.000000002536
 Linear coef   :      -0.000000005882
           Qmin:     -14.473905040926
Quadratic minimum step length (  0.656103730309) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.47390503751517 0.00000000794 0.00001274589 0.6561  0.052    8.00000000
      ideal mu1:      -0.665131545294
             Q0:     -14.473905040926
             G0:      -0.000000001491
   RMS gradient:       0.000006435568
     Trial step:       0.609260778890
             Q1:     -14.473905041028
 Quadratic coef:       0.000000000807
 Linear coef   :      -0.000000000908
           Qmin:     -14.473905041182
Quadratic minimum step length (  0.343022397352) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -14.47390504092603 0.00000000045 0.00000482668 0.3430  0.143    8.00000000
      ideal mu1:      -0.665132630045
             Q0:     -14.473905041182
             G0:      -0.000000000084
   RMS gradient:       0.000001525088
     Trial step:       0.457154342632
             Q1:     -14.473905041213
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000038
           Qmin:     -14.473905041235
Quadratic minimum step length (  1.266373778713) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47390504118160 0.00000000004 0.00000114382 1.2664  0.056    8.00000000
      ideal mu1:      -0.665132422365
             Q0:     -14.473905041234
             G0:      -0.000000000005
   RMS gradient:       0.000000379348
     Trial step:       0.760873361562
             Q1:     -14.473905041236
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -14.473905041236
Quadratic minimum step length (  0.766251169246) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.47390504123405 0.00000000001 0.00000028451 0.7663  0.062    8.00000000
      ideal mu1:      -0.665132500392
             Q0:     -14.473905041236
             G0:      -0.000000000000
   RMS gradient:       0.000000072036
     Trial step:       0.763557530867
             Q1:     -14.473905041236
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905041236
Quadratic minimum step length (  0.312825196629) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.47390504123588 0.00000000000 0.00000005403 0.3128  0.000    8.00000000
      ideal mu1:      -0.665132495733
             Q0:     -14.473905041236
             G0:      -0.000000000000
   RMS gradient:       0.000000042088
     Trial step:       0.488733091504
             Q1:     -14.473905041236
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905041236
Quadratic minimum step length (  0.108776669070) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -14.47390504123595 0.00000000000 0.00000003157 0.1088  0.341    8.00000000
      ideal mu1:      -0.665132494752
             Q0:     -14.473905041236
             G0:      -0.000000000000
   RMS gradient:       0.000000033029
     Trial step:       0.230570504962
             Q1:     -14.473905041236
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905041236
  Cubic LS coeff:       0.317914240958
Predicted energy:     -14.473905041236
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -14.47390504123585 0.00000000000 0.00000002477 0.3179  0.616    8.00000000
      ideal mu1:      -0.665132492402
10    -14.47390504123578 0.00000000000 0.00000000682 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00013062273451              |
           | Maximum change in energy =  0.00002371500223 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        6.91400040413153 |
           | Pseudopotential (local)    :      -39.58348135413123 |
           | Pseudopotential (non-local):       -0.42330597937932 |
           | Hartree                    :       16.10935536321034 |
           | Exchange-correlation       :       -3.42632272303794 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -14.47390504123578 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -39.58348135413140 |
           | Hartree                    :       16.10935536321030 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999999
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.382410E-04
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14139765E-02     0.54022656E-03
               2       0.11472581E-05     0.48913518E-06
               3       0.92331219E-12     0.35688119E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13003812E-02     0.49373007E-03
               2       0.96570359E-06     0.41034711E-06
               3       0.65129717E-12     0.25404678E-12
================================================================================
RMS gradient                =       0.00013062273451
Trial step length           =               0.018110
Gradient along search dir.  =         -0.00003156525
Functional at step 0        =     -14.47390504123578
Functional at step 1        =     -14.47390210188386
Functional predicted        =     -14.47390506450469
Selected quadratic step     =               0.001474
Conjugate gradients coeff.  =              -0.105926
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00001248
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.665112420177
             Q0:     -14.473905061719
             G0:      -0.000000031858
   RMS gradient:       0.000029747905
     Trial step:       0.270742769197
             Q1:     -14.473905067230
 Quadratic coef:       0.000000003114
 Linear coef   :      -0.000000008625
           Qmin:     -14.473905067692
Quadratic minimum step length (  0.374974933905) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -14.47390506171873 0.00000000000 0.00002231093 0.3750  0.000    8.00000000
      ideal mu1:      -0.665113495133
             Q0:     -14.473905067692
             G0:      -0.000000003778
   RMS gradient:       0.000010243870
     Trial step:       0.318624782440
             Q1:     -14.473905068559
 Quadratic coef:       0.000000000336
 Linear coef   :      -0.000000001204
           Qmin:     -14.473905068769
Quadratic minimum step length (  0.570266907349) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -14.47390506769175 0.00000000075 0.00000768290 0.5703  0.119    8.00000000
      ideal mu1:      -0.665120354991
             Q0:     -14.473905068769
             G0:      -0.000000000194
   RMS gradient:       0.000002322954
     Trial step:       0.426264201273
             Q1:     -14.473905068825
 Quadratic coef:       0.000000000027
 Linear coef   :      -0.000000000083
           Qmin:     -14.473905068832
Quadratic minimum step length (  0.651589558210) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -14.47390506876890 0.00000000015 0.00000174222 0.6516  0.051    8.00000000
      ideal mu1:      -0.665120116718
             Q0:     -14.473905068832
             G0:      -0.000000000029
   RMS gradient:       0.000000898363
     Trial step:       0.527019262065
             Q1:     -14.473905068836
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000015
           Qmin:     -14.473905068837
Quadratic minimum step length (  0.342093067111) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -14.47390506883211 0.00000000001 0.00000067377 0.3421  0.150    8.00000000
      ideal mu1:      -0.665119965316
             Q0:     -14.473905068837
             G0:      -0.000000000001
   RMS gradient:       0.000000198681
     Trial step:       0.424605270559
             Q1:     -14.473905068838
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -14.473905068838
Quadratic minimum step length (  1.571178956688) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47390506883700 0.00000000000 0.00000014901 1.5712  0.049    8.00000000
      ideal mu1:      -0.665119998901
             Q0:     -14.473905068838
             G0:      -0.000000000000
   RMS gradient:       0.000000082013
     Trial step:       0.816780794339
             Q1:     -14.473905068838
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068838
Quadratic minimum step length (  0.395915352836) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.47390506883793 0.00000000000 0.00000006151 0.3959  0.170    8.00000000
      ideal mu1:      -0.665119989613
             Q0:     -14.473905068838
             G0:      -0.000000000000
   RMS gradient:       0.000000049678
     Trial step:       0.568661636107
             Q1:     -14.473905068838
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068838
  Cubic LS coeff:       0.946061696142
Predicted energy:     -14.473905068838
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -14.47390506883795 0.00000000000 0.00000003726 0.9461  0.000    8.00000000
      ideal mu1:      -0.665119980061
             Q0:     -14.473905068838
             G0:      -0.000000000000
   RMS gradient:       0.000000017103
     Trial step:       0.733477328884
             Q1:     -14.473905068838
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068838
Quadratic minimum step length (  0.034292034876) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.47390506883804 0.00000000000 0.00000001283 0.0343  0.119    8.00000000
      ideal mu1:      -0.665119980211
             Q0:     -14.473905068838
             G0:      -0.000000000000
   RMS gradient:       0.000000016447
     Trial step:       0.158595176921
             Q1:     -14.473905068838
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068838
Quadratic minimum step length (  0.001290632348) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -14.47390506883813 0.00000000000 0.00000001234 0.0013  0.925    8.00000000
      ideal mu1:      -0.665119980223
10    -14.47390506883803 0.00000000000 0.00000001230 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002806329415              |
           | Maximum change in energy =  0.00000062708290 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.42251014E-03     0.17615126E-03
               2       0.10953869E-06     0.49238696E-07
               3       0.85517823E-14     0.35527137E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.41878194E-03     0.17462430E-03
               2       0.10761363E-06     0.48382231E-07
               3       0.87035460E-14     0.34972025E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.53042204E-05     0.21733955E-05
               2       0.17050533E-10     0.75683904E-11
               3       0.13601394E-14     0.55511151E-15
================================================================================
RMS gradient                =       0.00002806329415
Trial step length           =               0.005167
Gradient along search dir.  =         -0.00000103904
Functional at step 0        =     -14.47390506883803
Functional at step 1        =     -14.47390476286869
Rejected quadratic step     =               0.000045
Functional at new step 1    =     -14.47390506893475
Functional predicted        =     -14.47390506882741
Selected quadratic step     =              -0.000020
Conjugate gradients coeff.  =              -0.046157
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000018
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.665119686467
             Q0:     -14.473905068777
             G0:      -0.000000000007
   RMS gradient:       0.000000432515
     Trial step:       0.014306923692
             Q1:     -14.473905068778
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068778
  Cubic LS coeff:       0.024634403238
Predicted energy:     -14.473905068778
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47390506877739 0.00000000000 0.00000032439 0.0246  0.000    8.00000000
      ideal mu1:      -0.665119687659
             Q0:     -14.473905068778
             G0:      -0.000000000011
   RMS gradient:       0.000000404263
     Trial step:       0.018773452728
             Q1:     -14.473905068778
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068778
Quadratic minimum step length (  0.035282321047) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.47390506877754 0.00000000000 0.00000030320 0.0353  0.874    8.00000000
      ideal mu1:      -0.665119691144
             Q0:     -14.473905068778
             G0:      -0.000000000010
   RMS gradient:       0.000000332767
     Trial step:       0.025736569047
             Q1:     -14.473905068778
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068778
  Cubic LS coeff:       0.054878129593
Predicted energy:     -14.473905068778
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -14.47390506877788 0.00000000000 0.00000024958 0.0549  0.678    8.00000000
      ideal mu1:      -0.665119699027
             Q0:     -14.473905068778
             G0:      -0.000000000005
   RMS gradient:       0.000000219688
     Trial step:       0.037581574893
             Q1:     -14.473905068779
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068779
  Cubic LS coeff:       0.064464168218
Predicted energy:     -14.473905068779
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -14.47390506877843 0.00000000000 0.00000016477 0.0645  0.436    8.00000000
      ideal mu1:      -0.665119709971
             Q0:     -14.473905068779
             G0:      -0.000000000002
   RMS gradient:       0.000000147403
     Trial step:       0.049220574619
             Q1:     -14.473905068779
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068779
Quadratic minimum step length (  0.028801972639) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47390506877880 0.00000000000 0.00000011055 0.0288  0.450    8.00000000
      ideal mu1:      -0.665119715668
             Q0:     -14.473905068779
             G0:      -0.000000000002
   RMS gradient:       0.000000130541
     Trial step:       0.037651688454
             Q1:     -14.473905068779
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068779
  Cubic LS coeff:       0.063623970721
Predicted energy:     -14.473905068779
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -14.47390506877872 0.00000000000 0.00000009791 0.0636  0.784    8.00000000
      ideal mu1:      -0.665119733174
             Q0:     -14.473905068779
             G0:      -0.000000000000
   RMS gradient:       0.000000098932
     Trial step:       0.048944355382
             Q1:     -14.473905068779
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068779
Quadratic minimum step length (  0.012504430126) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.47390506877899 0.00000000000 0.00000007420 0.0125  0.000    8.00000000
      ideal mu1:      -0.665119734511
             Q0:     -14.473905068779
             G0:      -0.000000000001
   RMS gradient:       0.000000097095
     Trial step:       0.024739063684
             Q1:     -14.473905068779
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068779
Quadratic minimum step length (  0.007240230915) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -14.47390506877901 0.00000000000 0.00000007282 0.0072  0.963    8.00000000
      ideal mu1:      -0.665119736012
             Q0:     -14.473905068779
             G0:      -0.000000000001
   RMS gradient:       0.000000095037
     Trial step:       0.013383442521
             Q1:     -14.473905068779
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068779
  Cubic LS coeff:      -0.026217208294
Predicted energy:     -14.473905068779
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -14.47390506877897 0.00000000000 0.00000007128-0.0262  0.958    8.00000000
      ideal mu1:      -0.665119728136
10    -14.47390506877901-0.00000000000 0.00000007943 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00003276673378              |
           | Maximum change in energy =  0.00000000920075 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.98405757E-03     0.41901378E-03
               2       0.60278795E-06     0.27556448E-06
               3       0.27284425E-12     0.11146639E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.97771978E-03     0.41641468E-03
               2       0.59498407E-06     0.27208765E-06
               3       0.26552609E-12     0.10869083E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11925654E-04     0.48867609E-05
               2       0.86192717E-10     0.38259174E-10
               3       0.77400992E-15     0.27755576E-15
================================================================================
RMS gradient                =       0.00003276673378
Trial step length           =               0.005167
Gradient along search dir.  =         -0.00000392678
Functional at step 0        =     -14.47390506877901
Functional at step 1        =     -14.47390338681228
Rejected quadratic step     =               0.000031
Functional at new step 1    =     -14.47390506895772
Functional predicted        =     -14.47390506871574
Selected quadratic step     =              -0.000032
Conjugate gradients coeff.  =               1.363292
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000067
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.665118654447
             Q0:     -14.473905068459
             G0:      -0.000000000094
   RMS gradient:       0.000001617408
     Trial step:       0.013383442521
             Q1:     -14.473905068460
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -14.473905068465
Quadratic minimum step length (  0.113049258480) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -14.47390506845927 0.00000000000 0.00000121306 0.1130  0.000    8.00000000
      ideal mu1:      -0.665118685392
             Q0:     -14.473905068468
             G0:      -0.000000000084
   RMS gradient:       0.000001164863
     Trial step:       0.038897149675
             Q1:     -14.473905068471
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -14.473905068478
Quadratic minimum step length (  0.234326560189) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -14.47390506846823 0.00000000000 0.00000087365 0.2343  0.519    8.00000000
      ideal mu1:      -0.665118809933
             Q0:     -14.473905068479
             G0:      -0.000000000011
   RMS gradient:       0.000000529522
     Trial step:       0.095470599058
             Q1:     -14.473905068479
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -14.473905068481
Quadratic minimum step length (  0.420553721928) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -14.47390506847857 0.00000000000 0.00000039714 0.4206  0.207    8.00000000
      ideal mu1:      -0.665119102037
             Q0:     -14.473905068481
             G0:      -0.000000000003
   RMS gradient:       0.000000300231
     Trial step:       0.200375936102
             Q1:     -14.473905068481
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -14.473905068481
Quadratic minimum step length (  0.372952969794) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -14.47390506848084 0.00000000000 0.00000022517 0.3730  0.321    8.00000000
      ideal mu1:      -0.665119229304
             Q0:     -14.473905068481
             G0:      -0.000000000001
   RMS gradient:       0.000000157486
     Trial step:       0.273369348034
             Q1:     -14.473905068481
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068481
  Cubic LS coeff:       0.422564690644
Predicted energy:     -14.473905068481
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -14.47390506848116 0.00000000000 0.00000011811 0.4226  0.275    8.00000000
      ideal mu1:      -0.665119187350
             Q0:     -14.473905068481
             G0:      -0.000000000000
   RMS gradient:       0.000000097169
     Trial step:       0.339876792358
             Q1:     -14.473905068482
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068482
Quadratic minimum step length (  0.180298740284) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -14.47390506848149 0.00000000000 0.00000007288 0.1803  0.381    8.00000000
      ideal mu1:      -0.665119160147
             Q0:     -14.473905068482
             G0:      -0.000000000000
   RMS gradient:       0.000000051574
     Trial step:       0.247546677445
             Q1:     -14.473905068482
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -14.473905068482
Quadratic minimum step length (  0.050049842329) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -14.47390506848154 0.00000000000 0.00000003868 0.0500  0.000    8.00000000
      ideal mu1:      -0.665119157565
             Q0:     -14.473905068481
             G0:      -0.000000000000
   RMS gradient:       0.000000046902
     Trial step:       0.111308904294
             Q1:     -14.473905068482
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068481
  Cubic LS coeff:       0.155717320481
Predicted energy:     -14.473905068482
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -14.47390506848143 0.00000000000 0.00000003518 0.1557  0.827    8.00000000
      ideal mu1:      -0.665119143760
             Q0:     -14.473905068481
             G0:      -0.000000000000
   RMS gradient:       0.000000026491
     Trial step:       0.131653804815
             Q1:     -14.473905068482
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -14.473905068481
  Cubic LS coeff:       0.173130786608
Predicted energy:     -14.473905068482
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -14.47390506848149 0.00000000000 0.00000001987 0.1731  0.319    8.00000000
      ideal mu1:      -0.665119136037
10    -14.47390506848150 0.00000000000 0.00000001397 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00004514655755              |
           | Maximum change in energy =  0.00000000009917 / atom  |
           | Criteria satisfied:                                  |
           | -> Energy change per atom lower than set threshold.  |
           | -> Maximum degree of convergence for applied level   |
           |    of density kernel truncation has been reached.    | 
           ========================================================
WARNING: No kernel truncation, yet energy has risen on last 2 iterations.
WARNING: This most likely indicates, a problem with the density kernel.
WARNING: Either kernel occupation numbers may be unreliable, or
WARNING: requested NGWF gradient tolerance may be unachievable.

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        6.91409054462100 |
           | Pseudopotential (local)    :      -39.58365213031320 |
           | Pseudopotential (non-local):       -0.42331625677160 |
           | Hartree                    :       16.10946939976548 |
           | Exchange-correlation       :       -3.42634587375402 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -14.47390506848150 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -39.58365213031313 |
           | Hartree                    :       16.10946939976542 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999995
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.13869346043240    -13.66240068731651   0.040827    -14.38885015109837
   2     0.06385147424729    -14.29821349646556   0.038043    -14.42331287905061
   3     0.03065519481604    -14.41975221718453   0.041404    -14.45504857851867
   4     0.01780869484589    -14.45521106979829   0.042719    -14.46784477151492
   5     0.01022792337212    -14.46800021657278   0.034798    -14.47136747374670
   6     0.00589354023708    -14.47137551940792   0.055257    -14.47315482845043
   7     0.00414008297132    -14.47319760115742   0.037171    -14.47380099050400
   8     0.00168352369355    -14.47383201498041   0.024243    -14.47389871082491
   9     0.00040134560187    -14.47390315998709   0.010324    -14.47390469821122
  10     0.00013062273451    -14.47390504123578   0.001474    -14.47390506450469
  11     0.00002806329415    -14.47390506883803  -0.000020    -14.47390506882741
  12     0.00003276673378    -14.47390506877901  -0.000032    -14.47390506871574
  13     0.00004514655755    -14.47390506848150  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.313306569 Eh
                 Mid-gap level:      -0.093161675 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.503355296   1.0000000
                            2    -0.488825897   1.0000000
                            3    -0.418480391   1.0000000
                            4    -0.249814960   1.0000000
                        .......   --- gap ---   .........
                            5     0.063491609   0.0000000
                            6     0.191284916   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.53093438  -0.09292328  -0.09435805 *
*    H       2     -0.87881998   0.73227246  -0.89552571 *
*    H       3     -0.84633879  -0.63293971   1.00328473 *
*                                                        *
**********************************************************
TOTAL:             -0.19422438   0.00640948   0.01340097
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.17525445  -0.00923952  -0.00088117 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.17525445  -0.00923952  -0.00088117
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00288791  -0.00084371  -0.00031788 *
*    H       2      0.00158164  -0.00019150   0.00049553 *
*    H       3      0.00043006  -0.00001600   0.00005741 *
*                                                        *
**********************************************************
TOTAL:              0.00489961  -0.00105121   0.00023507
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00469011  -0.00129375   0.00425162 *
*    H       2     -0.00469011  -0.00129375   0.00425162 *
*    H       3     -0.00469011  -0.00129375   0.00425162 *
*                                                        *
**********************************************************
TOTAL:             -0.01407033  -0.00388126   0.01275487

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.58698251   0.03121793   0.03469729 *
*    H       2      0.29681140  -0.19732782   0.24087630 *
*    H       3      0.29017111   0.16610989  -0.27557359 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:      91.844s on      3 node(s)                                    
TOTAL TIME:        91.845s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    52        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.001%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    27        0.00s   0.003%  ------ ||
|| pseudopotentials_nonlocal_mat        :    27        0.00s   0.003%  ------ ||
|| integrals_grad                       :     1        0.00s   0.003%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.00s   0.003%  ------ ||
|| restart_ngwfs_tightbox_output        :    12        0.00s   0.003%  ------ ||
|| sparse_init                          :     1        0.00s   0.003%  ------ ||
|| restart_kernel_write                 :    15        0.00s   0.004%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.006%  ------ ||
|| basis_dot_function_with_box          :  2073        0.01s   0.006%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.01s   0.007%  ------ ||
|| ngwf_gradient_coeffs                 :    13        0.01s   0.011%  ------ ||
|| basis_add_function_to_box            :  4056        0.01s   0.012%  ------ ||
|| sparse_hotelling_invert              :    27        0.01s   0.012%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.01s   0.012%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.01s   0.013%  ------ ||
|| pseudo_make_structure_factor         :     1        0.03s   0.030%  ------ ||
|| basis_copy_function_to_box           :   934        0.03s   0.031%  ------ ||
|| density_initial_guess_real           :     1        0.04s   0.045%  ------ ||
|| fourier_apply_box_pair               :    89        0.05s   0.054%   7.586 ||
|| projectors_gradient_batch            :    13        0.06s   0.066%  ------ ||
|| integrals_kinetic                    :    27        0.07s   0.073%  ------ ||
|| lnv_gradient_norm                    :   130        0.08s   0.089%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.08s   0.092%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.08s   0.092%  ------ ||
|| projectors_func_ovlp_box             :    27        0.10s   0.106%  ------ ||
|| kernel_fix                           :   131        0.10s   0.112%  ------ ||
|| kernel_purify                        :   415        0.11s   0.115%  ------ ||
|| projectors_init_fftbox_recip         :    43        0.11s   0.119%  ------ ||
|| forces_calculate                     :     1        0.11s   0.124%  ------ ||
|| density_batch_row_sums               :   286        0.12s   0.132%  ------ ||
|| sparse_trace                         :  3756        0.14s   0.155%  ------ ||
|| integrals_locpot_mat_els_batch       :   141        0.18s   0.195%  ------ ||
|| sparse_product                       :  4686        0.20s   0.223%  ------ ||
|| properties_calculate                 :     1        0.33s   0.357%  ------ ||
|| ngwf_gradient_batch                  :    13        0.37s   0.399%  ------ ||
|| ngwf_gradient_lnv                    :    13        0.44s   0.478%  ------ ||
|| cell_grid_extract_box                :   642        0.48s   0.522%  ------ ||
|| hamiltonian_energy_components        :     3        1.08s   1.172%  ------ ||
|| fourier_apply_box                    :  2156        1.45s   1.579%  31.474 ||
|| density_fftbox_interpolate_multiply  :  1144        1.49s   1.627%  ------ ||
|| cell_grid_deposit_box                :  1145        1.51s   1.645%  ------ ||
|| density_fftbox_deposit_to_cell       :  1144        1.51s   1.649%  ------ ||
|| potential_apply_to_ngwf_batch        :   141        1.76s   1.913%  ------ ||
|| integrals_locpot_dbl_grid            :   141        1.98s   2.155%  ------ ||
|| penalty_denskernel_optimise_cg       :     1        2.81s   3.063%  ------ ||
|| density_batch_interp_deposit         :   286        3.22s   3.501%  ------ ||
|| density_on_dbl_grid                  :   286        3.96s   4.308%  ------ ||
|| hartree_on_grid                      :   286       12.41s  13.516%  ------ ||
|| fourier_apply_cell_backward          :  1431       28.29s  30.802%   6.209 ||
|| fourier_apply_cell_forward           :  1431       29.68s  32.312%   5.919 ||
|| xc_energy_potential                  :   286       66.62s  72.535%  ------ ||
|| lnv_denskernel_optimise_cg           :    13       81.81s  89.072%  ------ ||
|| ngwf_cg_optimise                     :     1       87.81s  95.611%  ------ ||
|| total_time                           :     1       91.84s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 16:39 (-0000)

