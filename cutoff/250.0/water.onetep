 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 16:49 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 9.18724855613305      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  104 x 104 x 104
                              FFT-box:   45 x  45 x  45
                                  PPD:    8 x   8 x   1
Grid space d1=  0.908522265865a0 (KE cutoff=   9.20307Eh = 250.42835eV)
Grid space d2=  0.908522265865a0 (KE cutoff=   9.20307Eh = 250.42835eV)
Grid space d3=  0.908522265865a0 (KE cutoff=   9.20307Eh = 250.42835eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    104   104   104
          Real-space ('12') slabs/node (min max mean):     34    35    34
         Recip-space ('23') slabs/node (min max mean):     17    18    17
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    208   208   208
          Real-space ('12') slabs/node (min max mean):     69    70    69
         Recip-space ('23') slabs/node (min max mean):     35    35    35
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1204      5372
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  503    0.0119521912    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   20    1   55.1234913368
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 4077.6428610409   -7.1201309938   10.1554740437   -2.4512395517
  2 1619.8032822920   -3.1442385823   13.3511734595   -3.1747078116
  3  834.7378456119   -2.9484046718   13.5591432673   -3.2264963589
  4  426.5848360477   -2.9070362329   13.6038329422   -3.2393419942
  5  214.3557797010   -2.8935168335   13.6185644614   -3.2442134694
  6  103.9980346564   -2.8876166385   13.6250224282   -3.2465154501
  7   46.6122135558   -2.8847666127   13.6281481375   -3.2476736696
  8   16.7716279848   -2.8833498641   13.6297035055   -3.2482650276
  9    1.2545348676   -2.8826396668   13.6304836888   -3.2485680131
 10   -6.8143496695   -2.8822826314   13.6308761010   -3.2487234238
 11  -11.0101681579   -2.8821029254   13.6310736992   -3.2488031929
 12  -13.1919931962   -2.8820124211   13.6311732564   -3.2488441623
 13  -14.3265419935   -2.8819668257   13.6312234338   -3.2488652175
 14  -14.9165072869   -2.8819438503   13.6312487291   -3.2488760454
 15  -15.2232892138   -2.8819322713   13.6312614831   -3.2488816176
 16  -15.3828158107   -2.8819264350   13.6312679147   -3.2488844870
 17  -15.4657696425   -2.8819234930   13.6312711584   -3.2488859657
 18  -15.5089056380   -2.8819220098   13.6312727945   -3.2488867282
 19  -15.5313363582   -2.8819212620   13.6312736199   -3.2488871217
 20  -15.5430003347   -2.8819208849   13.6312740364   -3.2488873249
 21  -15.5490656037   -2.8819206947   13.6312742465   -3.2488874299
 22  -15.5522195444   -2.8819205988   13.6312743526   -3.2488874843
 23  -15.5538595941   -2.8819205504   13.6312744061   -3.2488875124
 24  -15.5547124202   -2.8819205260   13.6312744332   -3.2488875269
 25  -15.5551558900   -2.8819205137   13.6312744468   -3.2488875345
 26  -15.5553864944   -2.8819205074   13.6312744537   -3.2488875384
 27  -15.5555064088   -2.8819205043   13.6312744572   -3.2488875404
 28  -15.5555687642   -2.8819205027   13.6312744589   -3.2488875415
 29  -15.5556011891   -2.8819205019   13.6312744598   -3.2488875420
 30  -15.5556180501   -2.8819205015   13.6312744603   -3.2488875423
 31  -15.5556268178   -2.8819205013   13.6312744605   -3.2488875425
 32  -15.5556313770   -2.8819205012   13.6312744606   -3.2488875425
 33  -15.5556337478   -2.8819205012   13.6312744607   -3.2488875426
 34  -15.5556349806   -2.8819205011   13.6312744607   -3.2488875426
 35  -15.5556356216   -2.8819205011   13.6312744607   -3.2488875426
 36  -15.5556359550   -2.8819205011   13.6312744607   -3.2488875426
 37  -15.5556361283   -2.8819205011   13.6312744607   -3.2488875426
 38  -15.5556362185   -2.8819205011   13.6312744607   -3.2488875426
Atom SCF converged after  38 iterations to a total energy of    -15.55563622

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  503    0.0119521912    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   20    0   55.1234913368
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  680.9972914635   -0.2254676002    0.2820965012   -0.2424203400
  2  272.1408075659   -0.2112543598    0.3031922433   -0.2589071332
  3  141.3007880026   -0.2047552089    0.3114463041   -0.2660418283
  4   73.2638070569   -0.2012934567    0.3157721367   -0.2698817672
  5   37.8848024650   -0.1995584628    0.3179286903   -0.2718323254
  6   19.4878911956   -0.1987103433    0.3189784736   -0.2727983700
  7    9.9215903937   -0.1983003290    0.3194836376   -0.2732715103
  8    4.9471590938   -0.1981030552    0.3197254185   -0.2735022527
  9    2.3604753974   -0.1980082896    0.3198408831   -0.2736147048
 10    1.0154088557   -0.1979627608    0.3198959957   -0.2736695790
 11    0.3159780076   -0.1979408629    0.3199223125   -0.2736964215
 12   -0.0477245467   -0.1979303129    0.3199348909   -0.2737095930
 13   -0.2368493330   -0.1979252195    0.3199409105   -0.2737160792
 14   -0.3351940539   -0.1979227549    0.3199437954   -0.2737192856
 15   -0.3863332772   -0.1979215593    0.3199451801   -0.2737208770
 16   -0.4129256845   -0.1979209778    0.3199458458   -0.2737216701
 17   -0.4267537556   -0.1979206942    0.3199461664   -0.2737220671
 18   -0.4339443693   -0.1979205556    0.3199463210   -0.2737222665
 19   -0.4376835004   -0.1979204876    0.3199463957   -0.2737223672
 20   -0.4396278565   -0.1979204541    0.3199464318   -0.2737224182
 21   -0.4406389267   -0.1979204377    0.3199464493   -0.2737224442
 22   -0.4411646861   -0.1979204295    0.3199464578   -0.2737224574
 23   -0.4414380828   -0.1979204255    0.3199464619   -0.2737224642
 24   -0.4415802502   -0.1979204235    0.3199464639   -0.2737224677
 25   -0.4416541778   -0.1979204225    0.3199464648   -0.2737224695
 26   -0.4416926204   -0.1979204220    0.3199464653   -0.2737224705
 27   -0.4417126108   -0.1979204217    0.3199464655   -0.2737224710
 28   -0.4417230059   -0.1979204216    0.3199464656   -0.2737224712
 29   -0.4417284115   -0.1979204215    0.3199464657   -0.2737224713
 30   -0.4417312224   -0.1979204215    0.3199464657   -0.2737224714
 31   -0.4417326841   -0.1979204215    0.3199464657   -0.2737224714
 32   -0.4417334441   -0.1979204215    0.3199464657   -0.2737224715
 33   -0.4417338394   -0.1979204215    0.3199464657   -0.2737224715
 34   -0.4417340449   -0.1979204215    0.3199464657   -0.2737224715
 35   -0.4417341518   -0.1979204215    0.3199464657   -0.2737224715
 36   -0.4417342074   -0.1979204215    0.3199464657   -0.2737224715
Atom SCF converged after  36 iterations to a total energy of     -0.44173421
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20198090E+01     0.88624327E+00
               2       0.18020756E+01     0.78906893E+00
               3       0.15512561E+01     0.63359569E+00
               4       0.13036207E+01     0.48492555E+00
               5       0.10793301E+01     0.40846979E+00
               6       0.81087079E+00     0.30770402E+00
               7       0.46483346E+00     0.17760354E+00
               8       0.15288688E+00     0.59325240E-01
               9       0.16572279E-01     0.66210303E-02
              10       0.19624207E-03     0.82526296E-04
              11       0.28313992E-07     0.12850963E-07
              12       0.12002928E-14     0.66613381E-15
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.15573209110841    0.5866422
               2          -1.24443603790786    0.5760854
               3          -1.35753226812711    0.5598957
               4          -1.48802533377071    0.5399225
               5          -1.61209525178003    0.5231018
               6          -1.69634788532801    0.5112124
               7          -1.73210005314658    0.5018146
               8          -1.73965401576367    0.5000246
               9          -1.74001046457206    0.5000000
              10          -1.74001125180047    0.5000351
              11          -1.74001125180434    0.5000351
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -15.597946336181=    -15.597946336181+      0.000000000000
    Trial step:       1.000000000000
            G0:      -6.545272887364
WARNING: minimum value of charge density: -0.0914
      Q1=E1+P1:     149.789765607209=    -21.551024536208+    171.340790143417
Quadratic term:    -171.932984830754
   Linear term:      -6.545272887364
  Optimal step:       0.019034372299
 Predicted min:     -15.660238916648
    !!! Quadratic minimum step length accepted !!!
 1    -15.59794633618091 0.42639551564 0.05852001870 0.0190  0.000    8.00000000
      Q0=E0+P0:     -15.712550096253=    -15.722274625684+      0.009724529431
    Trial step:       0.137965112614
            G0:      -0.017772831057
      Q1=E1+P1:     -15.714940741529=    -15.724574234058+      0.009633492528
Quadratic term:      -0.000061385361
   Linear term:      -0.002452030638
  Optimal step:       2.755499644862
 Predicted min:     -15.737036611085
    !!! Quadratic minimum step length accepted !!!
 2    -15.72227462568360 0.35625312410 0.05528889690 2.7555 -0.833    8.00000000
      Q0=E0+P0:     -15.734749592873=    -15.760769486967+      0.026019894094
    Trial step:       0.616573449649
            G0:      -4.406638505492
WARNING: minimum value of charge density: -0.0100
      Q1=E1+P1:       6.613088505366=    -18.682091612932+     25.295180118298
Quadratic term:     -25.064854402924
   Linear term:      -2.717016304685
  Optimal step:       0.033418109852
 Predicted min:     -15.808380357701
    !!! Quadratic minimum step length accepted !!!
 3    -15.76076948696725 0.35020210496 0.01494513672 0.0334  3.102    8.00000000
WARNING: minimum value of charge density: -0.0004

======================== Penalty functional minimisation =======================
   Final total energy     :     -15.931277099486
   Final penalty energy   :       0.074056305498
   RMS occupancy error    :       0.055549
   Occupancy bounds       : [-0.066, 1.076]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.055549 (step -0.4165 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002014 (step -0.5002 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.534049955699
             Q0:     -15.630725440960
             G0:      -0.007312003421
   RMS gradient:       0.014251708885
     Trial step:       0.500000000000
             Q1:     -15.631852102653
 Quadratic coef:       0.002529340017
 Linear coef   :      -0.003656001710
           Qmin:     -15.632046571019
Quadratic minimum step length (  0.361359256338) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000250 (step -0.4994 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.63072544095966 0.00000000000 0.01068878165 0.3614  0.000    8.00000000
      ideal mu1:      -0.533293995080
             Q0:     -15.632046071415
             G0:      -0.000407307140
   RMS gradient:       0.003359789842
     Trial step:       0.425064263575
             Q1:     -15.632138152869
 Quadratic coef:       0.000081050255
 Linear coef   :      -0.000173131709
           Qmin:     -15.632138528215
Quadratic minimum step length (  0.453990566920) accepted
    Initial Ne1:       8.00000062
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000049 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.63204607141509 0.00016514126 0.00251984242 0.4540  0.056    8.00000000
      ideal mu1:      -0.530290449009
             Q0:     -15.632138577029
             G0:      -0.000053841819
   RMS gradient:       0.001222569295
     Trial step:       0.439289387532
             Q1:     -15.632150803880
 Quadratic coef:       0.000011425288
 Linear coef   :      -0.000023652140
           Qmin:     -15.632150817939
Quadratic minimum step length (  0.454698978003) accepted
    Initial Ne1:       8.00000011
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.63213857702891 0.00001222439 0.00091692698 0.4547  0.132    8.00000000
      ideal mu1:      -0.531019972144
             Q0:     -15.632150819863
             G0:      -0.000000293021
   RMS gradient:       0.000090213843
     Trial step:       0.446927774431
             Q1:     -15.632150911434
 Quadratic coef:       0.000000039389
 Linear coef   :      -0.000000130959
           Qmin:     -15.632150928716
Quadratic minimum step length (  0.742969260460) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.63215081986315 0.00000174572 0.00006766038 0.7430  0.005    8.00000000
      ideal mu1:      -0.531014485128
             Q0:     -15.632150928717
             G0:      -0.000000075314
   RMS gradient:       0.000045738369
     Trial step:       0.576240920144
             Q1:     -15.632150939575
 Quadratic coef:       0.000000032542
 Linear coef   :      -0.000000043399
           Qmin:     -15.632150943187
Quadratic minimum step length (  0.384248960177) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.63215092871749 0.00000001369 0.00003430378 0.3842  0.257    8.00000000
      ideal mu1:      -0.531019028768
             Q0:     -15.632150943187
             G0:      -0.000000004874
   RMS gradient:       0.000011635934
     Trial step:       0.470552839091
             Q1:     -15.632150944448
 Quadratic coef:       0.000000001033
 Linear coef   :      -0.000000002294
           Qmin:     -15.632150944460
Quadratic minimum step length (  0.522208357269) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.63215094318735 0.00000000228 0.00000872695 0.5222  0.065    8.00000000
      ideal mu1:      -0.531016479279
             Q0:     -15.632150944460
             G0:      -0.000000000188
   RMS gradient:       0.000002282675
     Trial step:       0.495708205611
             Q1:     -15.632150944514
 Quadratic coef:       0.000000000039
 Linear coef   :      -0.000000000093
           Qmin:     -15.632150944516
Quadratic minimum step length (  0.592810845518) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.63215094445998 0.00000000017 0.00000171201 0.5928  0.000    8.00000000
      ideal mu1:      -0.531017643274
             Q0:     -15.632150944516
             G0:      -0.000000000023
   RMS gradient:       0.000000799538
     Trial step:       0.542089660941
             Q1:     -15.632150944521
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000013
           Qmin:     -15.632150944521
Quadratic minimum step length (  0.445376859099) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.63215094451572 0.00000000001 0.00000059965 0.4454  0.123    8.00000000
      ideal mu1:      -0.531017069899
             Q0:     -15.632150944521
             G0:      -0.000000000002
   RMS gradient:       0.000000237014
     Trial step:       0.491359532867
             Q1:     -15.632150944521
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -15.632150944521
Quadratic minimum step length (  0.382070586803) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.63215094452084 0.00000000000 0.00000017776 0.3821  0.088    8.00000000
      ideal mu1:      -0.531017107609
10    -15.63215094452120 0.00000000000 0.00000004855 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.03438014191800              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12377578E+00     0.84678649E-01
               2       0.10161615E-01     0.70265687E-02
               3       0.70104616E-04     0.48780404E-04
               4       0.35920606E-08     0.24447252E-08
               5       0.76958724E-15     0.34694470E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11110228E-01     0.74120271E-02
               2       0.81821055E-04     0.54928522E-04
               3       0.45779590E-08     0.30503090E-08
               4       0.65068096E-15     0.22204460E-15
================================================================================
RMS gradient                =       0.03438014191800
Trial step length           =               0.122474
Gradient along search dir.  =         -8.55645571194
Functional at step 0        =     -15.63215094452120
Functional at step 1        =     -16.11240858392775
Functional predicted        =     -16.11577503358418
Selected quadratic step     =               0.113043
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.24278155
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.026146 (step -0.4613 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000704 (step -0.5007 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.545278468595
             Q0:     -16.107798453140
             G0:      -0.078244071503
   RMS gradient:       0.046620236278
     Trial step:       0.433282846480
             Q1:     -16.124595513098
 Quadratic coef:       0.017104754063
 Linear coef   :      -0.033901814021
           Qmin:     -16.124596896861
Quadratic minimum step length (  0.429385725915) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003025 (step -0.4941 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.10779845314045 0.00000000000 0.03496517721 0.4294  0.000    8.00000000
      ideal mu1:      -0.502945270735
             Q0:     -16.124701553461
             G0:      -0.005563567781
   RMS gradient:       0.012327184040
     Trial step:       0.431329884847
             Q1:     -16.126084332086
 Quadratic coef:       0.001016954426
 Linear coef   :      -0.002399733050
           Qmin:     -16.126117231137
Quadratic minimum step length (  0.508910012950) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000753 (step -0.4986 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.12470155346138 0.00209980547 0.00924538802 0.5089  0.070    8.00000000
      ideal mu1:      -0.508660747855
             Q0:     -16.126125101396
             G0:      -0.000697463865
   RMS gradient:       0.004387506892
     Trial step:       0.468516912484
             Q1:     -16.126263750689
 Quadratic coef:       0.000188124323
 Linear coef   :      -0.000326773616
           Qmin:     -16.126267003563
Quadratic minimum step length (  0.406909014724) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000127 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.12612510139583 0.00019208411 0.00329063017 0.4069  0.127    8.00000000
      ideal mu1:      -0.507396826402
             Q0:     -16.126267280965
             G0:      -0.000006598857
   RMS gradient:       0.000427615351
     Trial step:       0.436627707825
             Q1:     -16.126269194890
 Quadratic coef:       0.000000967319
 Linear coef   :      -0.000002881244
           Qmin:     -16.126269426474
Quadratic minimum step length (  0.650267062608) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.12626728096452 0.00002031579 0.00032071151 0.6503  0.009    8.00000000
      ideal mu1:      -0.507668664522
             Q0:     -16.126269426476
             G0:      -0.000000959305
   RMS gradient:       0.000163247164
     Trial step:       0.532845772265
             Q1:     -16.126269572072
 Quadratic coef:       0.000000365566
 Linear coef   :      -0.000000511162
           Qmin:     -16.126269605162
Quadratic minimum step length (  0.372532433183) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.12626942647614 0.00000027177 0.00012243537 0.3725  0.146    8.00000000
      ideal mu1:      -0.507557455960
             Q0:     -16.126269605160
             G0:      -0.000000019017
   RMS gradient:       0.000022983439
     Trial step:       0.445536005339
             Q1:     -16.126269609289
 Quadratic coef:       0.000000004343
 Linear coef   :      -0.000000008473
           Qmin:     -16.126269609292
Quadratic minimum step length (  0.434569670966) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.12626960516002 0.00000002564 0.00001723758 0.4346  0.020    8.00000000
      ideal mu1:      -0.507555021531
             Q0:     -16.126269609292
             G0:      -0.000000001051
   RMS gradient:       0.000005402316
     Trial step:       0.440018676017
             Q1:     -16.126269609597
 Quadratic coef:       0.000000000158
 Linear coef   :      -0.000000000462
           Qmin:     -16.126269609631
Quadratic minimum step length (  0.645434663226) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.12626960929222 0.00000000053 0.00000405174 0.6454  0.000    8.00000000
      ideal mu1:      -0.507554124352
             Q0:     -16.126269609631
             G0:      -0.000000000288
   RMS gradient:       0.000002830316
     Trial step:       0.532919605539
             Q1:     -16.126269609696
 Quadratic coef:       0.000000000089
 Linear coef   :      -0.000000000154
           Qmin:     -16.126269609698
Quadratic minimum step length (  0.460651079230) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.12626960963119 0.00000000004 0.00000212274 0.4607  0.274    8.00000000
      ideal mu1:      -0.507555662094
             Q0:     -16.126269609698
             G0:      -0.000000000025
   RMS gradient:       0.000000837792
     Trial step:       0.495469465694
             Q1:     -16.126269609704
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000013
           Qmin:     -16.126269609704
Quadratic minimum step length (  0.471601656641) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.12626960969764 0.00000000001 0.00000062834 0.4716  0.088    8.00000000
      ideal mu1:      -0.507554943526
10    -16.12626960970371 0.00000000000 0.00000015342 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00906613445742              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.37240927E-01     0.21837371E-01
               2       0.87697108E-03     0.51566965E-03
               3       0.48718915E-06     0.29695474E-06
               4       0.15761137E-12     0.10136336E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17870936E-01     0.10550488E-01
               2       0.20039864E-03     0.11869933E-03
               3       0.25430664E-07     0.15472201E-07
               4       0.82119749E-15     0.33306691E-15
================================================================================
RMS gradient                =       0.00906613445742
Trial step length           =               0.117664
Gradient along search dir.  =         -0.61128420654
Functional at step 0        =     -16.12626960970371
Functional at step 1        =     -16.17266310943309
Functional predicted        =     -16.17692396296283
Selected quadratic step     =               0.165731
Conjugate gradients coeff.  =               0.069539
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.07893327
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.007760 (step -0.4875 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000056 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.529134396171
             Q0:     -16.176394182454
             G0:      -0.016619974541
   RMS gradient:       0.021486413369
     Trial step:       0.483388271306
             Q1:     -16.180213668113
 Quadratic coef:       0.004214415103
 Linear coef   :      -0.008033900762
           Qmin:     -16.180222920243
Quadratic minimum step length (  0.460739308589) accepted
    Initial Ne1:       7.99999991
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000724 (step -0.4987 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.17639418245413 0.00000000000 0.01611480969 0.4607  0.000    8.00000000
      ideal mu1:      -0.507376162416
             Q0:     -16.180227442982
             G0:      -0.001338343423
   RMS gradient:       0.006078733559
     Trial step:       0.471927937191
             Q1:     -16.180570601789
 Quadratic coef:       0.000288442844
 Linear coef   :      -0.000631601651
           Qmin:     -16.180573196615
Quadratic minimum step length (  0.516688955860) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000191 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.18022744298250 0.00047859222 0.00455905017 0.5167  0.080    8.00000000
      ideal mu1:      -0.510040961835
             Q0:     -16.180573710051
             G0:      -0.000205437534
   RMS gradient:       0.002386904886
     Trial step:       0.493801532104
             Q1:     -16.180625435796
 Quadratic coef:       0.000049719624
 Linear coef   :      -0.000101445369
           Qmin:     -16.180625456032
Quadratic minimum step length (  0.503763650739) accepted
    Initial Ne1:       8.00000016
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000050 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.18057371005057 0.00004691926 0.00179017869 0.5038  0.154    8.00000000
      ideal mu1:      -0.509642673662
             Q0:     -16.180625496907
             G0:      -0.000001836111
   RMS gradient:       0.000225726845
     Trial step:       0.498757719292
             Q1:     -16.180626122867
 Quadratic coef:       0.000000289815
 Linear coef   :      -0.000000915775
           Qmin:     -16.180626220338
Quadratic minimum step length (  0.788002722615) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.18062549690746 0.00000756629 0.00016929513 0.7880  0.009    8.00000000
      ideal mu1:      -0.509747104690
             Q0:     -16.180626220326
             G0:      -0.000000213595
   RMS gradient:       0.000077029884
     Trial step:       0.626915018744
             Q1:     -16.180626239803
 Quadratic coef:       0.000000114429
 Linear coef   :      -0.000000133906
           Qmin:     -16.180626259500
Quadratic minimum step length (  0.366810374748) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.18062622032602 0.00000009146 0.00005777241 0.3668  0.116    8.00000000
      ideal mu1:      -0.509702546794
             Q0:     -16.180626259500
             G0:      -0.000000004765
   RMS gradient:       0.000011504308
     Trial step:       0.479540335072
             Q1:     -16.180626261019
 Quadratic coef:       0.000000000766
 Linear coef   :      -0.000000002285
           Qmin:     -16.180626261204
Quadratic minimum step length (  0.715345603439) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.18062625950003 0.00000000547 0.00000862823 0.7153  0.022    8.00000000
      ideal mu1:      -0.509700822628
             Q0:     -16.180626261204
             G0:      -0.000000000995
   RMS gradient:       0.000005258484
     Trial step:       0.585693665977
             Q1:     -16.180626261464
 Quadratic coef:       0.000000000323
 Linear coef   :      -0.000000000583
           Qmin:     -16.180626261467
Quadratic minimum step length (  0.528277335213) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.18062626120395 0.00000000022 0.00000394386 0.5283  0.000    8.00000000
      ideal mu1:      -0.509700923190
             Q0:     -16.180626261467
             G0:      -0.000000000177
   RMS gradient:       0.000002219325
     Trial step:       0.556245169969
             Q1:     -16.180626261522
 Quadratic coef:       0.000000000043
 Linear coef   :      -0.000000000099
           Qmin:     -16.180626261523
Quadratic minimum step length (  0.635765716950) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.18062626146684 0.00000000003 0.00000166449 0.6358  0.178    8.00000000
      ideal mu1:      -0.509702486048
             Q0:     -16.180626261523
             G0:      -0.000000000040
   RMS gradient:       0.000001063207
     Trial step:       0.594677735656
             Q1:     -16.180626261533
 Quadratic coef:       0.000000000015
 Linear coef   :      -0.000000000024
           Qmin:     -16.180626261533
Quadratic minimum step length (  0.491266457486) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.18062626152322 0.00000000001 0.00000079741 0.4913  0.230    8.00000000
      ideal mu1:      -0.509701495462
10    -16.18062626153291 0.00000000000 0.00000009687 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00458367797817              |
           | Maximum change in energy =  0.16470622172750 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31997142E-01     0.14525132E-01
               2       0.64773261E-03     0.28720194E-03
               3       0.27079975E-06     0.12644679E-06
               4       0.50708670E-13     0.25091040E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15139289E-01     0.68439888E-02
               2       0.14398172E-03     0.63040345E-04
               3       0.13404908E-07     0.61070040E-08
               4       0.63425992E-15     0.33306691E-15
================================================================================
RMS gradient                =       0.00458367797817
Trial step length           =               0.139645
Gradient along search dir.  =         -0.16212079380
Functional at step 0        =     -16.18062626153291
Functional at step 1        =     -16.19520167112599
Functional predicted        =     -16.19651617137062
Selected quadratic step     =               0.196026
Conjugate gradients coeff.  =               0.255614
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.04105375
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004069 (step -0.4931 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000019 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.538030416064
             Q0:     -16.196289163914
             G0:      -0.005083273492
   RMS gradient:       0.011882846521
     Trial step:       0.540504601777
             Q1:     -16.197234841792
 Quadratic coef:       0.001801854837
 Linear coef   :      -0.002747532714
           Qmin:     -16.197336547957
Quadratic minimum step length (  0.412090376368) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000176 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.19628916391423 0.00000000000 0.00891213485 0.4121  0.000    8.00000000
      ideal mu1:      -0.525653549122
             Q0:     -16.197335931349
             G0:      -0.000298042168
   RMS gradient:       0.002875519236
     Trial step:       0.471949938844
             Q1:     -16.197407972296
 Quadratic coef:       0.000068620035
 Linear coef   :      -0.000140660983
           Qmin:     -16.197408014932
Quadratic minimum step length (  0.483713991082) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000037 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.19733593134880 0.00013092301 0.00215663944 0.4837  0.059    8.00000000
      ideal mu1:      -0.525809299113
             Q0:     -16.197408038390
             G0:      -0.000026448947
   RMS gradient:       0.000856672317
     Trial step:       0.477795760246
             Q1:     -16.197416470660
 Quadratic coef:       0.000004204925
 Linear coef   :      -0.000012637195
           Qmin:     -16.197417533131
Quadratic minimum step length (  0.717967358500) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.19740803839045 0.00000954868 0.00064250424 0.7180  0.089    8.00000000
      ideal mu1:      -0.525798181799
             Q0:     -16.197417534477
             G0:      -0.000000176665
   RMS gradient:       0.000070046633
     Trial step:       0.585697669354
             Q1:     -16.197417604364
 Quadratic coef:       0.000000033585
 Linear coef   :      -0.000000103472
           Qmin:     -16.197417614174
Quadratic minimum step length (  0.902241037429) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.19741753447711 0.00000129979 0.00005253497 0.9022  0.007    8.00000000
      ideal mu1:      -0.525817193037
             Q0:     -16.197417614173
             G0:      -0.000000035267
   RMS gradient:       0.000031299717
     Trial step:       0.726939112180
             Q1:     -16.197417616564
 Quadratic coef:       0.000000023246
 Linear coef   :      -0.000000025637
           Qmin:     -16.197417621241
Quadratic minimum step length (  0.400857721740) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.19741761417290 0.00000001004 0.00002347479 0.4009  0.200    8.00000000
      ideal mu1:      -0.525808101535
             Q0:     -16.197417621241
             G0:      -0.000000000965
   RMS gradient:       0.000005178093
     Trial step:       0.539814001627
             Q1:     -16.197417621628
 Quadratic coef:       0.000000000135
 Linear coef   :      -0.000000000521
           Qmin:     -16.197417621745
Quadratic minimum step length (  1.043906330209) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.19741762124148 0.00000000106 0.00000388357 1.0439  0.027    8.00000000
      ideal mu1:      -0.525808219044
             Q0:     -16.197417621746
             G0:      -0.000000000101
   RMS gradient:       0.000001674514
     Trial step:       0.750676530493
             Q1:     -16.197417621757
 Quadratic coef:       0.000000000064
 Linear coef   :      -0.000000000076
           Qmin:     -16.197417621768
Quadratic minimum step length (  0.443795560893) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.19741762174581 0.00000000007 0.00000125589 0.4438  0.000    8.00000000
      ideal mu1:      -0.525807808311
             Q0:     -16.197417621768
             G0:      -0.000000000009
   RMS gradient:       0.000000508773
     Trial step:       0.577188800913
             Q1:     -16.197417621771
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000005
           Qmin:     -16.197417621771
Quadratic minimum step length (  0.518031079322) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.19741762176819 0.00000000000 0.00000038158 0.5180  0.092    8.00000000
      ideal mu1:      -0.525808227286
             Q0:     -16.197417621771
             G0:      -0.000000000001
   RMS gradient:       0.000000172136
     Trial step:       0.546810513350
             Q1:     -16.197417621771
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.197417621771
Quadratic minimum step length (  0.576576530863) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.19741762177073 0.00000000000 0.00000012910 0.5766  0.114    8.00000000
      ideal mu1:      -0.525808130991
10    -16.19741762177092 0.00000000000 0.00000004784 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00281353529006              |
           | Maximum change in energy =  0.01811888394307 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30148944E-01     0.11748208E-01
               2       0.58036943E-03     0.21615077E-03
               3       0.21811336E-06     0.88723120E-07
               4       0.33211528E-13     0.15249087E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.64555552E-02     0.24338318E-02
               2       0.26493277E-04     0.93329650E-05
               3       0.45384603E-09     0.17736976E-09
               4       0.84571905E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00281353529006
Trial step length           =               0.165451
Gradient along search dir.  =         -0.06061145607
Functional at step 0        =     -16.19741762177092
Functional at step 1        =     -16.20322061478548
Functional predicted        =     -16.20336790890013
Selected quadratic step     =               0.196342
Conjugate gradients coeff.  =               0.376770
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02017188
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002115 (step -0.4961 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.545230107513
             Q0:     -16.203306230734
             G0:      -0.000838241184
   RMS gradient:       0.004825399188
     Trial step:       0.561496312389
             Q1:     -16.203460565475
 Quadratic coef:       0.000316334593
 Linear coef   :      -0.000470669334
           Qmin:     -16.203481306134
Quadratic minimum step length (  0.417720826493) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000030 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20330623073394 0.00000000000 0.00361904939 0.4177  0.000    8.00000000
      ideal mu1:      -0.540140281665
             Q0:     -16.203481221201
             G0:      -0.000050536302
   RMS gradient:       0.001184597534
     Trial step:       0.484302285441
             Q1:     -16.203494127232
 Quadratic coef:       0.000011568815
 Linear coef   :      -0.000024474846
           Qmin:     -16.203494165874
Quadratic minimum step length (  0.512292045422) accepted
    Initial Ne1:       7.99999993
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20348122120108 0.00002188443 0.00088844814 0.5123  0.060    8.00000000
      ideal mu1:      -0.540089381699
             Q0:     -16.203494167194
             G0:      -0.000004108000
   RMS gradient:       0.000337714538
     Trial step:       0.498100600693
             Q1:     -16.203495518886
 Quadratic coef:       0.000000694505
 Linear coef   :      -0.000002046197
           Qmin:     -16.203495674355
Quadratic minimum step length (  0.733769115043) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20349416719362 0.00000171616 0.00025328590 0.7338  0.081    8.00000000
      ideal mu1:      -0.540102521331
             Q0:     -16.203495674399
             G0:      -0.000000008508
   RMS gradient:       0.000015372460
     Trial step:       0.604558381774
             Q1:     -16.203495677942
 Quadratic coef:       0.000000001600
 Linear coef   :      -0.000000005143
           Qmin:     -16.203495678532
Quadratic minimum step length (  0.971810062996) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20349567439861 0.00000020473 0.00001152934 0.9718  0.002    8.00000000
      ideal mu1:      -0.540104439595
             Q0:     -16.203495678533
             G0:      -0.000000003425
   RMS gradient:       0.000009753789
     Trial step:       0.766495870228
             Q1:     -16.203495678976
 Quadratic coef:       0.000000002182
 Linear coef   :      -0.000000002625
           Qmin:     -16.203495679322
Quadratic minimum step length (  0.461194621278) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20349567853261 0.00000000052 0.00000731534 0.4612  0.403    8.00000000
      ideal mu1:      -0.540103204147
             Q0:     -16.203495679322
             G0:      -0.000000000057
   RMS gradient:       0.000001254169
     Trial step:       0.594561832429
             Q1:     -16.203495679346
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000034
           Qmin:     -16.203495679349
Quadratic minimum step length (  0.945356823730) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20349567932246 0.00000000014 0.00000094063 0.9454  0.017    8.00000000
      ideal mu1:      -0.540103265023
             Q0:     -16.203495679349
             G0:      -0.000000000004
   RMS gradient:       0.000000336347
     Trial step:       0.749715336255
             Q1:     -16.203495679351
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000003
           Qmin:     -16.203495679351
Quadratic minimum step length (  0.682556544332) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20349567934938 0.00000000000 0.00000025226 0.6826  0.000    8.00000000
      ideal mu1:      -0.540103170068
             Q0:     -16.203495679351
             G0:      -0.000000000001
   RMS gradient:       0.000000138811
     Trial step:       0.715348243268
             Q1:     -16.203495679351
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.203495679351
Quadratic minimum step length (  0.391577483082) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.20349567935088 0.00000000000 0.00000010411 0.3916  0.170    8.00000000
      ideal mu1:      -0.540103246342
             Q0:     -16.203495679351
             G0:      -0.000000000000
   RMS gradient:       0.000000048533
     Trial step:       0.529258221123
             Q1:     -16.203495679351
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.203495679351
Quadratic minimum step length (  0.151835454790) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20349567935107 0.00000000000 0.00000003640 0.1518  0.122    8.00000000
      ideal mu1:      -0.540103248209
10    -16.20349567935101 0.00000000000 0.00000002862 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00163490812540              |
           | Maximum change in energy =  0.00559712007933 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.51702752084966 |
           | Pseudopotential (local)    :      -44.79394081866218 |
           | Pseudopotential (non-local):       -1.88676037092686 |
           | Hartree                    :       18.99707886544796 |
           | Exchange-correlation       :       -3.97275012403043 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.20349567935101 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -44.79394081866221 |
           | Hartree                    :       18.99707886544798 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999995
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.58898024E-02     0.19143675E-02
               2       0.20485088E-04     0.71120641E-05
               3       0.27501037E-09     0.10616392E-09
               4       0.77785068E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14104681E-02     0.43559258E-03
               2       0.12180781E-05     0.40213693E-06
               3       0.96485881E-12     0.35146365E-12
================================================================================
RMS gradient                =       0.00163490812540
Trial step length           =               0.180236
Gradient along search dir.  =         -0.01934930102
Functional at step 0        =     -16.20349567935101
Functional at step 1        =     -16.20476426305663
Functional predicted        =     -16.20486600583217
Selected quadratic step     =               0.141641
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99752265
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000357 (step -0.5008 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.540112608640
             Q0:     -16.204864638238
             G0:      -0.000016535637
   RMS gradient:       0.000677733911
     Trial step:       0.283478681219
             Q1:     -16.204867703752
 Quadratic coef:       0.000001621987
 Linear coef   :      -0.000004687501
           Qmin:     -16.204868024928
Quadratic minimum step length (  0.409623161742) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20486463823763 0.00000000000 0.00050830043 0.4096  0.000    8.00000000
      ideal mu1:      -0.540821426617
             Q0:     -16.204868024670
             G0:      -0.000000856150
   RMS gradient:       0.000154229397
     Trial step:       0.340763016901
             Q1:     -16.204868220218
 Quadratic coef:       0.000000096196
 Linear coef   :      -0.000000291744
           Qmin:     -16.204868245871
Quadratic minimum step length (  0.516734962003) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20486802467009 0.00000042334 0.00011567205 0.5167  0.052    8.00000000
      ideal mu1:      -0.540838823166
             Q0:     -16.204868245866
             G0:      -0.000000068624
   RMS gradient:       0.000043661854
     Trial step:       0.419623837014
             Q1:     -16.204868267633
 Quadratic coef:       0.000000007030
 Linear coef   :      -0.000000028796
           Qmin:     -16.204868275357
Quadratic minimum step length (  0.859483423619) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20486824586594 0.00000002908 0.00003274639 0.8595  0.080    8.00000000
      ideal mu1:      -0.540836198343
             Q0:     -16.204868275357
             G0:      -0.000000000553
   RMS gradient:       0.000003920363
     Trial step:       0.600549525076
             Q1:     -16.204868275573
 Quadratic coef:       0.000000000115
 Linear coef   :      -0.000000000332
           Qmin:     -16.204868275596
Quadratic minimum step length (  0.863889302855) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20486827535662 0.00000000400 0.00000294027 0.8639  0.008    8.00000000
      ideal mu1:      -0.540835666087
             Q0:     -16.204868275596
             G0:      -0.000000000107
   RMS gradient:       0.000001719851
     Trial step:       0.720283493180
             Q1:     -16.204868275608
 Quadratic coef:       0.000000000065
 Linear coef   :      -0.000000000077
           Qmin:     -16.204868275618
Quadratic minimum step length (  0.427682768976) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20486827559553 0.00000000003 0.00000128989 0.4277  0.192    8.00000000
      ideal mu1:      -0.540835617456
             Q0:     -16.204868275619
             G0:      -0.000000000004
   RMS gradient:       0.000000312580
     Trial step:       0.555025079444
             Q1:     -16.204868275620
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.204868275620
Quadratic minimum step length (  0.558963937006) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20486827561858 0.00000000000 0.00000023444 0.5590  0.033    8.00000000
      ideal mu1:      -0.540835610894
             Q0:     -16.204868275619
             G0:      -0.000000000001
   RMS gradient:       0.000000144696
     Trial step:       0.556991026447
             Q1:     -16.204868275620
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.204868275620
  Cubic LS coeff:       0.918134377288
Predicted energy:     -16.204868275620
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20486827561949 0.00000000000 0.00000010852 0.9181  0.000    8.00000000
      ideal mu1:      -0.540835616737
             Q0:     -16.204868275620
             G0:      -0.000000000000
   RMS gradient:       0.000000059516
     Trial step:       0.715117199641
             Q1:     -16.204868275620
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.204868275620
Quadratic minimum step length (  0.245753277936) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.20486827562013 0.00000000000 0.00000004464 0.2458  0.169    8.00000000
      ideal mu1:      -0.540835617435
             Q0:     -16.204868275620
             G0:      -0.000000000000
   RMS gradient:       0.000000036103
     Trial step:       0.419216407027
             Q1:     -16.204868275620
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.204868275620
Quadratic minimum step length (  0.060077815976) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20486827562015 0.00000000000 0.00000002708 0.0601  0.368    8.00000000
      ideal mu1:      -0.540835617537
10    -16.20486827562017 0.00000000000 0.00000002401 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00095400879159              |
           | Maximum change in energy =  0.00202601919337 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68711539E-02     0.21375578E-02
               2       0.27973764E-04     0.94053658E-05
               3       0.50034927E-09     0.17274060E-09
               4       0.70413019E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11787952E-02     0.38407588E-03
               2       0.85190037E-06     0.30927788E-06
               3       0.46301890E-12     0.16897594E-12
================================================================================
RMS gradient                =       0.00095400879159
Trial step length           =               0.159777
Gradient along search dir.  =         -0.00659809781
Functional at step 0        =     -16.20486827562017
Functional at step 1        =     -16.20546107745509
Functional predicted        =     -16.20547042905706
Selected quadratic step     =               0.182523
Conjugate gradients coeff.  =               0.340501
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99576485
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000580 (step -0.5013 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.542368715878
             Q0:     -16.205466555271
             G0:      -0.000003838614
   RMS gradient:       0.000326539686
     Trial step:       0.158699735839
             Q1:     -16.205467074449
 Quadratic coef:       0.000000090009
 Linear coef   :      -0.000000609187
           Qmin:     -16.205467586025
Quadratic minimum step length (  0.537044854577) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20546655527141 0.00000000000 0.00024490476 0.5370  0.000    8.00000000
      ideal mu1:      -0.542685742313
             Q0:     -16.205467585888
             G0:      -0.000000106367
   RMS gradient:       0.000054362680
     Trial step:       0.291939850920
             Q1:     -16.205467610043
 Quadratic coef:       0.000000006897
 Linear coef   :      -0.000000031053
           Qmin:     -16.205467620839
Quadratic minimum step length (  0.657182442704) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20546758588754 0.00000012884 0.00004077201 0.6572  0.028    8.00000000
      ideal mu1:      -0.542650314671
             Q0:     -16.205467620840
             G0:      -0.000000034941
   RMS gradient:       0.000031153472
     Trial step:       0.438015689617
             Q1:     -16.205467630389
 Quadratic coef:       0.000000005756
 Linear coef   :      -0.000000015305
           Qmin:     -16.205467631013
Quadratic minimum step length (  0.582294570944) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20546762084027 0.00000000449 0.00002336510 0.5823  0.328    8.00000000
      ideal mu1:      -0.542662508954
             Q0:     -16.205467631013
             G0:      -0.000000000114
   RMS gradient:       0.000001776375
     Trial step:       0.505028868533
             Q1:     -16.205467631057
 Quadratic coef:       0.000000000013
 Linear coef   :      -0.000000000057
           Qmin:     -16.205467631074
Quadratic minimum step length (  1.075574678691) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20546763101289 0.00000000170 0.00000133228 1.0756  0.003    8.00000000
      ideal mu1:      -0.542662224477
             Q0:     -16.205467631075
             G0:      -0.000000000011
   RMS gradient:       0.000000558098
     Trial step:       0.737018495699
             Q1:     -16.205467631078
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000008
           Qmin:     -16.205467631078
Quadratic minimum step length (  0.562443759340) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20546763107464 0.00000000001 0.00000041857 0.5624  0.099    8.00000000
      ideal mu1:      -0.542662239831
             Q0:     -16.205467631078
             G0:      -0.000000000003
   RMS gradient:       0.000000292565
     Trial step:       0.643841170961
             Q1:     -16.205467631079
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.205467631079
Quadratic minimum step length (  0.833435546125) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20546763107779 0.00000000000 0.00000021942 0.8334  0.275    8.00000000
      ideal mu1:      -0.542662239054
             Q0:     -16.205467631079
             G0:      -0.000000000000
   RMS gradient:       0.000000036989
     Trial step:       0.732529943373
             Q1:     -16.205467631079
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205467631079
  Cubic LS coeff:       0.921597406968
Predicted energy:     -16.205467631079
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20546763107881 0.00000000000 0.00000002774 0.9216  0.000    8.00000000
      ideal mu1:      -0.542662258270
             Q0:     -16.205467631079
             G0:      -0.000000000000
   RMS gradient:       0.000000038443
     Trial step:       0.821643290205
             Q1:     -16.205467631079
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205467631079
Quadratic minimum step length (  0.063826599140) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.20546763107896 0.00000000000 0.00000002883 0.0638  1.080    8.00000000
      ideal mu1:      -0.542662258618
             Q0:     -16.205467631079
             G0:      -0.000000000000
   RMS gradient:       0.000000036469
     Trial step:       0.229003705035
             Q1:     -16.205467631079
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205467631079
  Cubic LS coeff:       0.291794512641
Predicted energy:     -16.205467631079
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.20546763107894 0.00000000000 0.00000002735 0.2918  0.900    8.00000000
      ideal mu1:      -0.542662254962
10    -16.20546763107894 0.00000000000 0.00000000818 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00051523105938              |
           | Maximum change in energy =  0.00045753208972 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.69772318E-02     0.20862828E-02
               2       0.28883899E-04     0.97621521E-05
               3       0.52680179E-09     0.17736157E-09
               4       0.87673841E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68434245E-03     0.21438637E-03
               2       0.28439941E-06     0.10055141E-06
               3       0.51623781E-13     0.18540725E-13
================================================================================
RMS gradient                =       0.00051523105938
Trial step length           =               0.170772
Gradient along search dir.  =         -0.00191112050
Functional at step 0        =     -16.20546763107894
Functional at step 1        =     -16.20561586655174
Functional predicted        =     -16.20561712083525
Selected quadratic step     =               0.156442
Conjugate gradients coeff.  =               0.291675
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99653450
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000471 (step -0.5011 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544819825157
             Q0:     -16.205614715195
             G0:      -0.000010171374
   RMS gradient:       0.000531543199
     Trial step:       0.258499563837
             Q1:     -16.205616517203
 Quadratic coef:       0.000000827288
 Linear coef   :      -0.000002629296
           Qmin:     -16.205616804309
Quadratic minimum step length (  0.410783006813) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20561471519494 0.00000000000 0.00039865740 0.4108  0.000    8.00000000
      ideal mu1:      -0.544269873785
             Q0:     -16.205616804482
             G0:      -0.000000546441
   RMS gradient:       0.000123190746
     Trial step:       0.325863818324
             Q1:     -16.205616933510
 Quadratic coef:       0.000000049038
 Linear coef   :      -0.000000178065
           Qmin:     -16.205616966129
Quadratic minimum step length (  0.591633879413) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20561680448242 0.00000026114 0.00009239306 0.5916  0.054    8.00000000
      ideal mu1:      -0.544237030210
             Q0:     -16.205616966137
             G0:      -0.000000050171
   RMS gradient:       0.000037329372
     Trial step:       0.439080943557
             Q1:     -16.205616982033
 Quadratic coef:       0.000000006133
 Linear coef   :      -0.000000022029
           Qmin:     -16.205616985919
Quadratic minimum step length (  0.788572889585) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20561696613697 0.00000002129 0.00002799703 0.7886  0.092    8.00000000
      ideal mu1:      -0.544242597417
             Q0:     -16.205616985919
             G0:      -0.000000000500
   RMS gradient:       0.000003725094
     Trial step:       0.588427844704
             Q1:     -16.205616986142
 Quadratic coef:       0.000000000071
 Linear coef   :      -0.000000000294
           Qmin:     -16.205616986223
Quadratic minimum step length (  1.218552567222) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20561698591884 0.00000000271 0.00000279382 1.2186  0.010    8.00000000
      ideal mu1:      -0.544242695169
             Q0:     -16.205616986224
             G0:      -0.000000000072
   RMS gradient:       0.000001413967
     Trial step:       0.846776393618
             Q1:     -16.205616986224
 Quadratic coef:       0.000000000061
 Linear coef   :      -0.000000000061
           Qmin:     -16.205616986239
Quadratic minimum step length (  0.425535293892) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.20561698622378 0.00000000004 0.00000106048 0.4255  0.144    8.00000000
      ideal mu1:      -0.544242759083
             Q0:     -16.205616986239
             G0:      -0.000000000005
   RMS gradient:       0.000000389952
     Trial step:       0.600277637031
             Q1:     -16.205616986241
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.205616986242
Quadratic minimum step length (  0.900868490207) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.20561698623906 0.00000000000 0.00000029246 0.9009  0.076    8.00000000
      ideal mu1:      -0.544242752248
             Q0:     -16.205616986242
             G0:      -0.000000000000
   RMS gradient:       0.000000091279
     Trial step:       0.735371476587
             Q1:     -16.205616986242
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205616986242
Quadratic minimum step length (  0.652232762050) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.20561698624168 0.00000000000 0.00000006846 0.6522  0.000    8.00000000
      ideal mu1:      -0.544242751302
             Q0:     -16.205616986242
             G0:      -0.000000000000
   RMS gradient:       0.000000033025
     Trial step:       0.692555679572
             Q1:     -16.205616986242
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205616986242
Quadratic minimum step length (  0.039618013266) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.20561698624207 0.00000000000 0.00000002477 0.0396  0.131    8.00000000
      ideal mu1:      -0.544242751170
             Q0:     -16.205616986242
             G0:      -0.000000000000
   RMS gradient:       0.000000031420
     Trial step:       0.165643231377
             Q1:     -16.205616986242
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205616986242
  Cubic LS coeff:       0.243258589327
Predicted energy:     -16.205616986242
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20561698624183 0.00000000000 0.00000002357 0.2433  0.905    8.00000000
      ideal mu1:      -0.544242749739
10    -16.20561698624185 0.00000000000 0.00000001282 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00014477091275              |
           | Maximum change in energy =  0.00019978515292 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36311501E-02     0.10988229E-02
               2       0.73529409E-05     0.24101797E-05
               3       0.33178510E-10     0.11550663E-10
               4       0.70832882E-15     0.27755576E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26832244E-02     0.80782821E-03
               2       0.40610143E-05     0.13137773E-05
               3       0.10171054E-10     0.34632575E-11
               4       0.92821164E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00014477091275
Trial step length           =               0.163450
Gradient along search dir.  =         -0.00015150757
Functional at step 0        =     -16.20561698624185
Functional at step 1        =     -16.20559937899430
Functional predicted        =     -16.20562060457249
Selected quadratic step     =               0.047764
Conjugate gradients coeff.  =               0.078951
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99929367
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000124 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544676191083
             Q0:     -16.205620461043
             G0:      -0.000001034651
   RMS gradient:       0.000169529641
     Trial step:       0.200734000100
             Q1:     -16.205620621461
 Quadratic coef:       0.000000047272
 Linear coef   :      -0.000000207690
           Qmin:     -16.205620689165
Quadratic minimum step length (  0.440964026813) accepted
    Initial Ne1:       7.99999984
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20562046104285 0.00000000000 0.00012714722 0.4410  0.000    8.00000000
      ideal mu1:      -0.544489924144
             Q0:     -16.205620689174
             G0:      -0.000000058676
   RMS gradient:       0.000040370264
     Trial step:       0.297517181021
             Q1:     -16.205620701487
 Quadratic coef:       0.000000005144
 Linear coef   :      -0.000000017457
           Qmin:     -16.205620703986
Quadratic minimum step length (  0.504885438604) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20562068917395 0.00000002852 0.00003027770 0.5049  0.057    8.00000000
      ideal mu1:      -0.544487412477
             Q0:     -16.205620703987
             G0:      -0.000000004010
   RMS gradient:       0.000010553825
     Trial step:       0.387572048053
             Q1:     -16.205620705196
 Quadratic coef:       0.000000000345
 Linear coef   :      -0.000000001554
           Qmin:     -16.205620705737
Quadratic minimum step length (  0.872737294780) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20562070398735 0.00000000196 0.00000791537 0.8727  0.068    8.00000000
      ideal mu1:      -0.544487053419
             Q0:     -16.205620705738
             G0:      -0.000000000027
   RMS gradient:       0.000000858828
     Trial step:       0.581591420801
             Q1:     -16.205620705749
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000015
           Qmin:     -16.205620705752
Quadratic minimum step length (  1.063623898003) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.20562070573795 0.00000000023 0.00000064412 1.0636  0.007    8.00000000
      ideal mu1:      -0.544487124407
             Q0:     -16.205620705752
             G0:      -0.000000000004
   RMS gradient:       0.000000314158
     Trial step:       0.786507809267
             Q1:     -16.205620705752
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000003
           Qmin:     -16.205620705753
Quadratic minimum step length (  0.411196331918) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20562070575226 0.00000000000 0.00000023562 0.4112  0.134    8.00000000
      ideal mu1:      -0.544487133361
             Q0:     -16.205620705753
             G0:      -0.000000000000
   RMS gradient:       0.000000080385
     Trial step:       0.568690712246
             Q1:     -16.205620705753
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205620705753
  Cubic LS coeff:       1.083724206022
Predicted energy:     -16.205620705753
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20562070575287 0.00000000000 0.00000006029 1.0837  0.065    8.00000000
      ideal mu1:      -0.544487132164
             Q0:     -16.205620705753
             G0:      -0.000000000000
   RMS gradient:       0.000000034217
     Trial step:       0.785050247182
             Q1:     -16.205620705753
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205620705753
Quadratic minimum step length (  0.107525526460) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.20562070575304 0.00000000000 0.00000002566 0.1075  0.000    8.00000000
      ideal mu1:      -0.544487132207
             Q0:     -16.205620705753
             G0:      -0.000000000000
   RMS gradient:       0.000000028159
     Trial step:       0.290539052669
             Q1:     -16.205620705753
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205620705753
Quadratic minimum step length (  0.047477903364) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.20562070575317 0.00000000000 0.00000002112 0.0475  0.677    8.00000000
      ideal mu1:      -0.544487132231
             Q0:     -16.205620705753
             G0:      -0.000000000000
   RMS gradient:       0.000000024342
     Trial step:       0.117448648635
             Q1:     -16.205620705753
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205620705753
  Cubic LS coeff:       0.247431994975
Predicted energy:     -16.205620705753
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20562070575294 0.00000000000 0.00000001826 0.2474  0.747    8.00000000
      ideal mu1:      -0.544487132350
10    -16.20562070575322 0.00000000000 0.00000000811 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00007184580541              |
           | Maximum change in energy =  0.00004978505430 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14118144E-02     0.43862087E-03
               2       0.10392305E-05     0.35995773E-06
               3       0.63419639E-12     0.24591440E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10568347E-02     0.32606356E-03
               2       0.58675532E-06     0.20086553E-06
               3       0.20337803E-12     0.77493567E-13
================================================================================
RMS gradient                =       0.00007184580541
Trial step length           =               0.088358
Gradient along search dir.  =         -0.00003736641
Functional at step 0        =     -16.20562070575322
Functional at step 1        =     -16.20561782785677
Functional predicted        =     -16.20562114675251
Selected quadratic step     =               0.023604
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99968014
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000056 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544651502270
             Q0:     -16.205621116646
             G0:      -0.000000156581
   RMS gradient:       0.000065950539
     Trial step:       0.170471561965
             Q1:     -16.205621138192
 Quadratic coef:       0.000000005147
 Linear coef   :      -0.000000026693
           Qmin:     -16.205621151256
Quadratic minimum step length (  0.442075052412) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20562111664598 0.00000000000 0.00004946290 0.4421  0.000    8.00000000
      ideal mu1:      -0.544578990155
             Q0:     -16.205621151257
             G0:      -0.000000008573
   RMS gradient:       0.000015431219
     Trial step:       0.274519989601
             Q1:     -16.205621152958
 Quadratic coef:       0.000000000653
 Linear coef   :      -0.000000002353
           Qmin:     -16.205621153377
Quadratic minimum step length (  0.494579111017) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20562115125746 0.00000000433 0.00001157341 0.4946  0.055    8.00000000
      ideal mu1:      -0.544578181741
             Q0:     -16.205621153377
             G0:      -0.000000000519
   RMS gradient:       0.000003798488
     Trial step:       0.368472322452
             Q1:     -16.205621153529
 Quadratic coef:       0.000000000039
 Linear coef   :      -0.000000000191
           Qmin:     -16.205621153610
Quadratic minimum step length (  0.895170194239) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20562115337736 0.00000000028 0.00000284887 0.8952  0.061    8.00000000
      ideal mu1:      -0.544577960514
             Q0:     -16.205621153610
             G0:      -0.000000000004
   RMS gradient:       0.000000319253
     Trial step:       0.574321722087
             Q1:     -16.205621153612
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.205621153612
Quadratic minimum step length (  0.898003582944) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20562115361030 0.00000000003 0.00000023944 0.8980  0.007    8.00000000
      ideal mu1:      -0.544577988484
             Q0:     -16.205621153612
             G0:      -0.000000000001
   RMS gradient:       0.000000116007
     Trial step:       0.718152465843
             Q1:     -16.205621153612
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621153612
  Cubic LS coeff:       0.840230648667
Predicted energy:     -16.205621153612
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20562115361189 0.00000000000 0.00000008701 0.8402  0.132    8.00000000
      ideal mu1:      -0.544577992983
             Q0:     -16.205621153612
             G0:      -0.000000000000
   RMS gradient:       0.000000100548
     Trial step:       0.776797085613
             Q1:     -16.205621153612
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621153613
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  6.094103738830)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.20562115361225 0.00000000000 0.00000007541 0.1500  0.000    8.00000000
      ideal mu1:      -0.544577993993
             Q0:     -16.205621153612
             G0:      -0.000000000000
   RMS gradient:       0.000000085683
     Trial step:       0.341349619660
             Q1:     -16.205621153612
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621153612
Quadratic minimum step length (  0.066994487465) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20562115361237 0.00000000000 0.00000006426 0.0670  0.726    8.00000000
      ideal mu1:      -0.544577994428
             Q0:     -16.205621153612
             G0:      -0.000000000000
   RMS gradient:       0.000000066377
     Trial step:       0.151223486323
             Q1:     -16.205621153612
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621153613
  Cubic LS coeff:       0.255243468824
Predicted energy:     -16.205621153613
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.20562115361219 0.00000000000 0.00000004978 0.2552  0.600    8.00000000
      ideal mu1:      -0.544577995617
             Q0:     -16.205621153612
             G0:      -0.000000000000
   RMS gradient:       0.000000034962
     Trial step:       0.196465791467
             Q1:     -16.205621153612
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621153612
  Cubic LS coeff:       0.158750707677
Predicted energy:     -16.205621153612
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20562115361246 0.00000000000 0.00000002622 0.1588  0.277    8.00000000
      ideal mu1:      -0.544577995414
10    -16.20562115361258 0.00000000000 0.00000002677 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00003289522541              |
           | Maximum change in energy =  0.00000123983712 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.50800594808750 |
           | Pseudopotential (local)    :      -44.75249809318507 |
           | Pseudopotential (non-local):       -1.89164446576779 |
           | Hartree                    :       18.96134620299806 |
           | Exchange-correlation       :       -3.96667999371612 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.20562115361259 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -44.75249809318501 |
           | Hartree                    :       18.96134620299801 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999976
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.84883940E-03     0.26852041E-03
               2       0.37091643E-06     0.13082523E-06
               3       0.79937376E-13     0.31641356E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.77267922E-03     0.24313333E-03
               2       0.30784463E-06     0.10769472E-06
               3       0.54979863E-13     0.21538327E-13
================================================================================
RMS gradient                =       0.00003289522541
Trial step length           =               0.045668
Gradient along search dir.  =         -0.00000792700
Functional at step 0        =     -16.20562115361258
Functional at step 1        =     -16.20561958648906
Functional predicted        =     -16.20562117059604
Selected quadratic step     =               0.004285
Conjugate gradients coeff.  =               0.209635
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99992892
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544612524192
             Q0:     -16.205621169352
             G0:      -0.000000006756
   RMS gradient:       0.000013699536
     Trial step:       0.176604313168
             Q1:     -16.205621170307
 Quadratic coef:       0.000000000239
 Linear coef   :      -0.000000001193
           Qmin:     -16.205621170844
Quadratic minimum step length (  0.441488022527) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20562116935232 0.00000000000 0.00001027465 0.4415  0.000    8.00000000
      ideal mu1:      -0.544597469763
             Q0:     -16.205621170842
             G0:      -0.000000000366
   RMS gradient:       0.000003188002
     Trial step:       0.279228739549
             Q1:     -16.205621170915
 Quadratic coef:       0.000000000029
 Linear coef   :      -0.000000000102
           Qmin:     -16.205621170932
Quadratic minimum step length (  0.492123584931) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.20562117084237 0.00000000019 0.00000239100 0.4921  0.054    8.00000000
      ideal mu1:      -0.544597303632
             Q0:     -16.205621170932
             G0:      -0.000000000021
   RMS gradient:       0.000000767701
     Trial step:       0.370695357838
             Q1:     -16.205621170939
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000008
           Qmin:     -16.205621170944
Quadratic minimum step length (  1.086684878947) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.20562117093218 0.00000000001 0.00000057578 1.0867  0.058    8.00000000
      ideal mu1:      -0.544597248685
             Q0:     -16.205621170942
             G0:      -0.000000000001
   RMS gradient:       0.000000173248
     Trial step:       0.634688143941
             Q1:     -16.205621170942
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.205621170942
Quadratic minimum step length (  0.873106939266) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.20562117094157 0.00000000000 0.00000012994 0.8731  0.051    8.00000000
      ideal mu1:      -0.544597250905
             Q0:     -16.205621170942
             G0:      -0.000000000000
   RMS gradient:       0.000000070665
     Trial step:       0.744412938324
             Q1:     -16.205621170942
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621170942
  Cubic LS coeff:       0.961762748791
Predicted energy:     -16.205621170942
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.20562117094185 0.00000000000 0.00000005300 0.9618  0.166    8.00000000
      ideal mu1:      -0.544597235434
             Q0:     -16.205621170942
             G0:      -0.000000000000
   RMS gradient:       0.000000060776
     Trial step:       0.846137479254
             Q1:     -16.205621170942
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621170942
Quadratic minimum step length (  0.048679477667) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20562117094225 0.00000000000 0.00000004558 0.0487  0.740    8.00000000
      ideal mu1:      -0.544597239124
             Q0:     -16.205621170942
             G0:      -0.000000000000
   RMS gradient:       0.000000057389
     Trial step:       0.202952039962
             Q1:     -16.205621170942
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621170942
  Cubic LS coeff:       0.312602160640
Predicted energy:     -16.205621170942
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20562117094175 0.00000000000 0.00000004304 0.3126  0.000    8.00000000
      ideal mu1:      -0.544597263766
             Q0:     -16.205621170942
             G0:      -0.000000000000
   RMS gradient:       0.000000015584
     Trial step:       0.251879427898
             Q1:     -16.205621170942
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621170942
  Cubic LS coeff:       0.359198439975
Predicted energy:     -16.205621170942
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.20562117094197 0.00000000000 0.00000001169 0.3592  0.074    8.00000000
      ideal mu1:      -0.544597267269
             Q0:     -16.205621170942
             G0:      -0.000000000000
   RMS gradient:       0.000000009212
     Trial step:       0.300790122116
             Q1:     -16.205621170942
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621170942
  Cubic LS coeff:       0.469320675804
Predicted energy:     -16.205621170942
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20562117094188 0.00000000000 0.00000000691 0.4693  0.349    8.00000000
      ideal mu1:      -0.544597264113
10    -16.20562117094203 0.00000000000 0.00000000301 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001846714917              |
           | Maximum change in energy =  0.00000014928645 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28467940E-03     0.95048492E-04
               2       0.41096437E-07     0.15772953E-07
               3       0.11147633E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26249155E-03     0.87504592E-04
               2       0.34957234E-07     0.13383909E-07
               3       0.10279813E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00001846714917
Trial step length           =               0.013989
Gradient along search dir.  =         -0.00000247378
Functional at step 0        =     -16.20562117094203
Functional at step 1        =     -16.20562098702610
Functional predicted        =     -16.20562117231207
Selected quadratic step     =               0.001108
Conjugate gradients coeff.  =               0.315162
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99997894
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544607302525
             Q0:     -16.205621172262
             G0:      -0.000000000568
   RMS gradient:       0.000003970610
     Trial step:       0.375722002798
             Q1:     -16.205621172384
 Quadratic coef:       0.000000000091
 Linear coef   :      -0.000000000213
           Qmin:     -16.205621172387
Quadratic minimum step length (  0.440766518065) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20562117226166 0.00000000000 0.00000297796 0.4408  0.000    8.00000000
      ideal mu1:      -0.544602945016
             Q0:     -16.205621172387
             G0:      -0.000000000031
   RMS gradient:       0.000000921604
     Trial step:       0.406946776537
             Q1:     -16.205621172394
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000012
           Qmin:     -16.205621172395
Quadratic minimum step length (  0.527262602015) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20562117238657 0.00000000002 0.00000069120 0.5273  0.054    8.00000000
      ideal mu1:      -0.544602888524
             Q0:     -16.205621172394
             G0:      -0.000000000002
   RMS gradient:       0.000000245394
     Trial step:       0.463214654646
             Q1:     -16.205621172395
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.205621172395
Quadratic minimum step length (  0.882606805432) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.20562117239426 0.00000000000 0.00000018405 0.8826  0.071    8.00000000
      ideal mu1:      -0.544602847363
             Q0:     -16.205621172395
             G0:      -0.000000000000
   RMS gradient:       0.000000058593
     Trial step:       0.639403164339
             Q1:     -16.205621172395
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172395
Quadratic minimum step length (  0.252455133993) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20562117239499 0.00000000000 0.00000004394 0.2525  0.057    8.00000000
      ideal mu1:      -0.544602871045
             Q0:     -16.205621172395
             G0:      -0.000000000000
   RMS gradient:       0.000000025090
     Trial step:       0.401771840139
             Q1:     -16.205621172395
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172395
Quadratic minimum step length (  0.033167636694) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20562117239499 0.00000000000 0.00000001882 0.0332  0.183    8.00000000
      ideal mu1:      -0.544602872531
             Q0:     -16.205621172395
             G0:      -0.000000000000
   RMS gradient:       0.000000022735
     Trial step:       0.115437526080
             Q1:     -16.205621172395
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172395
Quadratic minimum step length (  0.001154113954) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20562117239527 0.00000000000 0.00000001705 0.0012  0.821    8.00000000
      ideal mu1:      -0.544602872600
             Q0:     -16.205621172395
             G0:      -0.000000000000
   RMS gradient:       0.000000022618
     Trial step:       0.011542446001
             Q1:     -16.205621172395
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172395
  Cubic LS coeff:       0.016023920507
Predicted energy:     -16.205621172395
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20562117239510 0.00000000000 0.00000001696 0.0160  0.000    8.00000000
      ideal mu1:      -0.544602872969
             Q0:     -16.205621172395
             G0:      -0.000000000000
   RMS gradient:       0.000000021923
     Trial step:       0.013599824895
             Q1:     -16.205621172395
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172395
  Cubic LS coeff:       0.019013342957
Predicted energy:     -16.205621172395
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.20562117239504 0.00000000000 0.00000001644 0.0190  0.939    8.00000000
      ideal mu1:      -0.544602873794
             Q0:     -16.205621172395
             G0:      -0.000000000000
   RMS gradient:       0.000000020372
     Trial step:       0.016080364886
             Q1:     -16.205621172395
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172395
  Cubic LS coeff:       0.019275755105
Predicted energy:     -16.205621172395
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20562117239514 0.00000000000 0.00000001528 0.0193  0.864    8.00000000
      ideal mu1:      -0.544602874890
10    -16.20562117239513 0.00000000000 0.00000001375 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001138319679              |
           | Maximum change in energy =  0.00000000577648 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.86949427E-04     0.29664423E-04
               2       0.38105667E-08     0.15134971E-08
               3       0.94681380E-15     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.79105672E-04     0.26973101E-04
               2       0.31546362E-08     0.12518449E-08
               3       0.76395894E-15     0.27755576E-15
================================================================================
RMS gradient                =       0.00001138319679
Trial step length           =               0.003936
Gradient along search dir.  =         -0.00000093277
Functional at step 0        =     -16.20562117239513
Functional at step 1        =     -16.20562115581557
Functional predicted        =     -16.20562117256155
Selected quadratic step     =               0.000357
Conjugate gradients coeff.  =               0.379952
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999250
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544606423689
             Q0:     -16.205621172574
             G0:      -0.000000000070
   RMS gradient:       0.000001397272
     Trial step:       0.017605714287
             Q1:     -16.205621172575
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.205621172575
Quadratic minimum step length (  0.027622223798) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.20562117257373 0.00000000000 0.00000104795 0.0276  0.000    8.00000000
      ideal mu1:      -0.544606327762
             Q0:     -16.205621172575
             G0:      -0.000000000120
   RMS gradient:       0.000001310091
     Trial step:       0.022052414384
             Q1:     -16.205621172578
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -16.205621172599
Quadratic minimum step length (  0.390165198733) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20562117257538 0.00000000000 0.00000098257 0.3902  0.879    8.00000000
      ideal mu1:      -0.544603870087
             Q0:     -16.205621172582
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000041
   RMS gradient:       0.000001064073
     Trial step:       0.092758205247
             Q1:     -16.205621172585
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.205621172587
Quadratic minimum step length (  0.228510616763) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20562117258219 0.00000000001 0.00000079806 0.2285  0.660    8.00000000
      ideal mu1:      -0.544604453333
             Q0:     -16.205621172589
             G0:      -0.000000000009
   RMS gradient:       0.000000419120
     Trial step:       0.145589267087
             Q1:     -16.205621172589
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.205621172590
Quadratic minimum step length (  0.176717483633) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.20562117258874 0.00000000000 0.00000031434 0.1767  0.155    8.00000000
      ideal mu1:      -0.544604704873
             Q0:     -16.205621172590
             G0:      -0.000000000002
   RMS gradient:       0.000000167717
     Trial step:       0.160400027816
             Q1:     -16.205621172590
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172590
  Cubic LS coeff:       0.281779346178
Predicted energy:     -16.205621172590
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20562117258963 0.00000000000 0.00000012579 0.2818  0.160    8.00000000
      ideal mu1:      -0.544604877310
             Q0:     -16.205621172590
             G0:      -0.000000000000
   RMS gradient:       0.000000063818
     Trial step:       0.212596836677
             Q1:     -16.205621172590
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172590
Quadratic minimum step length (  0.077274416967) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20562117258996 0.00000000000 0.00000004786 0.0773  0.145    8.00000000
      ideal mu1:      -0.544604881117
             Q0:     -16.205621172590
             G0:      -0.000000000000
   RMS gradient:       0.000000055219
     Trial step:       0.128172916809
             Q1:     -16.205621172590
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172590
Quadratic minimum step length (  0.012085404436) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20562117259002 0.00000000000 0.00000004141 0.0121  0.000    8.00000000
      ideal mu1:      -0.544604880579
             Q0:     -16.205621172590
             G0:      -0.000000000000
   RMS gradient:       0.000000053789
     Trial step:       0.039357610920
             Q1:     -16.205621172590
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172590
Quadratic minimum step length (  0.005603076022) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.20562117259016 0.00000000000 0.00000004034 0.0056  0.949    8.00000000
      ideal mu1:      -0.544604880104
             Q0:     -16.205621172590
             G0:      -0.000000000000
   RMS gradient:       0.000000052520
     Trial step:       0.014850039934
             Q1:     -16.205621172590
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172590
  Cubic LS coeff:       0.033799171695
Predicted energy:     -16.205621172590
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.20562117259002 0.00000000000 0.00000003939 0.0338  0.953    8.00000000
      ideal mu1:      -0.544604875985
10    -16.20562117259004 0.00000000000 0.00000003126 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000741397843              |
           | Maximum change in energy =  0.00000000048437 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17018770E-04     0.58720958E-05
               2       0.14553747E-09     0.58855143E-10
               3       0.12524014E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11431789E-04     0.39426244E-05
               2       0.65675558E-10     0.26540437E-10
               3       0.60530689E-15     0.22204460E-15
================================================================================
RMS gradient                =       0.00000741397843
Trial step length           =               0.001185
Gradient along search dir.  =         -0.00000039791
Functional at step 0        =     -16.20562117259004
Functional at step 1        =     -16.20562117234390
Functional predicted        =     -16.20562117266751
Selected quadratic step     =               0.000389
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999463
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.544607404451
             Q0:     -16.205621172674
             G0:      -0.000000000036
   RMS gradient:       0.000001004736
     Trial step:       0.022403549928
             Q1:     -16.205621172675
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000001
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172676
  Cubic LS coeff:       0.059755286590
Predicted energy:     -16.205621172676
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.20562117267409 0.00000000000 0.00000075355 0.0598  0.000    8.00000000
      ideal mu1:      -0.544607254449
             Q0:     -16.205621172676
             G0:      -0.000000000050
   RMS gradient:       0.000000867718
     Trial step:       0.036588666915
             Q1:     -16.205621172678
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000002
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172679
  Cubic LS coeff:       0.083530068325
Predicted energy:     -16.205621172679
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.20562117267605 0.00000000000 0.00000065079 0.0835  0.746    8.00000000
      ideal mu1:      -0.544606918193
             Q0:     -16.205621172680
             G0:      -0.000000000026
   RMS gradient:       0.000000567891
     Trial step:       0.055283395765
             Q1:     -16.205621172681
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000001
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172682
  Cubic LS coeff:       0.119768102580
Predicted energy:     -16.205621172682
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.20562117267955 0.00000000000 0.00000042592 0.1198  0.428    8.00000000
      ideal mu1:      -0.544606549246
             Q0:     -16.205621172682
             G0:      -0.000000000005
   RMS gradient:       0.000000270168
     Trial step:       0.081370679086
             Q1:     -16.205621172682
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172682
Quadratic minimum step length (  0.099949823063) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.20562117268178 0.00000000000 0.00000020263 0.0999  0.226    8.00000000
      ideal mu1:      -0.544606430127
             Q0:     -16.205621172682
             G0:      -0.000000000003
   RMS gradient:       0.000000185374
     Trial step:       0.090183063694
             Q1:     -16.205621172682
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172682
Quadratic minimum step length (  0.063708498020) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.20562117268208 0.00000000000 0.00000013903 0.0637  0.471    8.00000000
      ideal mu1:      -0.544606379572
             Q0:     -16.205621172682
             G0:      -0.000000000002
   RMS gradient:       0.000000147084
     Trial step:       0.075798598502
             Q1:     -16.205621172683
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172683
  Cubic LS coeff:       0.161395516239
Predicted energy:     -16.205621172683
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.20562117268220 0.00000000000 0.00000011031 0.1614  0.630    8.00000000
      ideal mu1:      -0.544606278069
             Q0:     -16.205621172683
             G0:      -0.000000000000
   RMS gradient:       0.000000075669
     Trial step:       0.110605397406
             Q1:     -16.205621172682
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172683
Quadratic minimum step length (  0.012675017972) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.20562117268255 0.00000000000 0.00000005675 0.0127  0.000    8.00000000
      ideal mu1:      -0.544606278844
             Q0:     -16.205621172683
             G0:      -0.000000000000
   RMS gradient:       0.000000074122
     Trial step:       0.037442294267
             Q1:     -16.205621172682
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.205621172683
Quadratic minimum step length (  0.007724813988) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.20562117268252 0.00000000000 0.00000005559 0.0077  0.960    8.00000000
      ideal mu1:      -0.544606279747
             Q0:     -16.205621172683
             G0:      -0.000000000001
   RMS gradient:       0.000000072312
     Trial step:       0.017006903260
             Q1:     -16.205621172683
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.205621172683
  Cubic LS coeff:       0.026494092959
Predicted energy:     -16.205621172683
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.20562117268256 0.00000000000 0.00000005423 0.0265  0.952    8.00000000
      ideal mu1:      -0.544606284160
10    -16.20562117268253 0.00000000000 0.00000004771 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000132347792              |
           | Maximum change in energy =  0.00000000006497 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.50777447322071 |
           | Pseudopotential (local)    :      -44.75217337079542 |
           | Pseudopotential (non-local):       -1.89154527474817 |
           | Hartree                    :       18.96110577280660 |
           | Exchange-correlation       :       -3.96663202113708 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.20562117268253 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -44.75217337079557 |
           | Hartree                    :       18.96110577280663 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999999
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.03438014191800    -15.63215094452120   0.113043    -16.11577503358418
   2     0.00906613445742    -16.12626960970371   0.165731    -16.17692396296283
   3     0.00458367797817    -16.18062626153291   0.196026    -16.19651617137062
   4     0.00281353529006    -16.19741762177092   0.196342    -16.20336790890013
   5     0.00163490812540    -16.20349567935101   0.141641    -16.20486600583217
   6     0.00095400879159    -16.20486827562017   0.182523    -16.20547042905706
   7     0.00051523105938    -16.20546763107894   0.156442    -16.20561712083525
   8     0.00014477091275    -16.20561698624185   0.047764    -16.20562060457249
   9     0.00007184580541    -16.20562070575322   0.023604    -16.20562114675251
  10     0.00003289522541    -16.20562115361258   0.004285    -16.20562117059604
  11     0.00001846714917    -16.20562117094203   0.001108    -16.20562117231207
  12     0.00001138319679    -16.20562117239513   0.000357    -16.20562117256155
  13     0.00000741397843    -16.20562117259004   0.000389    -16.20562117266751
  14     0.00000132347792    -16.20562117268253  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.306424461 Eh
                 Mid-gap level:      -0.091083605 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.090579323   1.0000000
                            2    -0.468723997   1.0000000
                            3    -0.374825982   1.0000000
                            4    -0.244295835   1.0000000
                        .......   --- gap ---   .........
                            5     0.062128626   0.0000000
                            6     0.174007791   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.61024568  -0.09273700  -0.10356684 *
*    H       2     -1.14062160   0.89805673  -1.11312877 *
*    H       3     -1.10116918  -0.76761582   1.24688127 *
*                                                        *
**********************************************************
TOTAL:             -0.63154510   0.03770391   0.03018565
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.59116692  -0.03276937  -0.05686571 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.59116692  -0.03276937  -0.05686571
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00790290  -0.00070745   0.00192977 *
*    H       2      0.00028312   0.00060159  -0.00027516 *
*    H       3      0.00031706  -0.00057192   0.00048625 *
*                                                        *
**********************************************************
TOTAL:              0.00850308  -0.00067778   0.00214087
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01062504   0.00141892  -0.00817973 *
*    H       2     -0.01062504   0.00141892  -0.00817973 *
*    H       3     -0.01062504   0.00141892  -0.00817973 *
*                                                        *
**********************************************************
TOTAL:             -0.03187511   0.00425676  -0.02453919

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.08080883   0.00529795  -0.01581703 *
*    H       2      0.03964619  -0.03346314   0.03493389 *
*    H       3      0.04116264   0.02816519  -0.01911686 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     475.001s on      3 node(s)                                    
TOTAL TIME:       475.003s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    56        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    27        0.00s   0.001%  ------ ||
|| sparse_init                          :     1        0.00s   0.001%  ------ ||
|| restart_kernel_write                 :    16        0.00s   0.001%  ------ ||
|| restart_ngwfs_tightbox_output        :    13        0.00s   0.001%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    27        0.00s   0.001%  ------ ||
|| eigenstates_calculate                :     1        0.00s   0.001%  ------ ||
|| sparse_hotelling_invert              :    27        0.01s   0.002%  ------ ||
|| ngwf_gradient_coeffs                 :    14        0.01s   0.002%  ------ ||
|| basis_dot_function_with_box          :  2193        0.02s   0.003%  ------ ||
|| integrals_grad                       :     1        0.02s   0.004%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.02s   0.004%  ------ ||
|| basis_add_function_to_box            :  4440        0.03s   0.007%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.05s   0.011%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.05s   0.011%  ------ ||
|| pseudo_make_structure_factor         :     1        0.08s   0.017%  ------ ||
|| lnv_gradient_norm                    :   140        0.08s   0.018%  ------ ||
|| kernel_fix                           :   140        0.10s   0.020%  ------ ||
|| density_initial_guess_real           :     1        0.10s   0.021%  ------ ||
|| kernel_purify                        :   456        0.11s   0.024%  ------ ||
|| basis_copy_function_to_box           :  1012        0.12s   0.026%  ------ ||
|| sparse_trace                         :  3907        0.14s   0.030%  ------ ||
|| fourier_apply_box_pair               :    93        0.15s   0.032%  13.986 ||
|| density_batch_row_sums               :   314        0.17s   0.037%  ------ ||
|| sparse_product                       :  4932        0.21s   0.044%  ------ ||
|| integrals_kinetic                    :    27        0.23s   0.048%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.28s   0.059%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.33s   0.070%  ------ ||
|| projectors_gradient_batch            :    14        0.38s   0.080%  ------ ||
|| projectors_func_ovlp_box             :    27        0.46s   0.096%  ------ ||
|| forces_calculate                     :     1        0.48s   0.100%  ------ ||
|| projectors_init_fftbox_recip         :    44        0.51s   0.108%  ------ ||
|| integrals_locpot_mat_els_batch       :   151        1.17s   0.246%  ------ ||
|| properties_calculate                 :     1        1.55s   0.326%  ------ ||
|| ngwf_gradient_batch                  :    14        2.38s   0.500%  ------ ||
|| ngwf_gradient_lnv                    :    14        2.69s   0.567%  ------ ||
|| cell_grid_extract_box                :   688        3.23s   0.679%  ------ ||
|| hamiltonian_energy_components        :     3        5.10s   1.074%  ------ ||
|| cell_grid_deposit_box                :  1257        9.61s   2.022%  ------ ||
|| density_fftbox_deposit_to_cell       :  1256        9.61s   2.024%  ------ ||
|| fourier_apply_box                    :  2336        9.99s   2.104%  25.979 ||
|| density_fftbox_interpolate_multiply  :  1256       10.13s   2.132%  ------ ||
|| potential_apply_to_ngwf_batch        :   151       10.88s   2.291%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       11.27s   2.374%  ------ ||
|| integrals_locpot_dbl_grid            :   151       12.16s   2.561%  ------ ||
|| density_batch_interp_deposit         :   314       20.62s   4.340%  ------ ||
|| density_on_dbl_grid                  :   314       23.37s   4.921%  ------ ||
|| hartree_on_grid                      :   314       66.62s  14.024%  ------ ||
|| fourier_apply_cell_forward           :  1571      139.02s  29.267%   5.911 ||
|| fourier_apply_cell_backward          :  1571      182.77s  38.478%   4.496 ||
|| xc_energy_potential                  :   314      344.66s  72.559%  ------ ||
|| lnv_denskernel_optimise_cg           :    14      432.00s  90.948%  ------ ||
|| ngwf_cg_optimise                     :     1      459.46s  96.727%  ------ ||
|| total_time                           :     1      475.00s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 16:57 (-0000)

