 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 16:43 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 7.34979884490644      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:   96 x  96 x  96
                              FFT-box:   39 x  39 x  39
                                  PPD:    6 x   6 x   1
Grid space d1=  0.984232454687a0 (KE cutoff=   7.84167Eh = 213.38274eV)
Grid space d2=  0.984232454687a0 (KE cutoff=   7.84167Eh = 213.38274eV)
Grid space d3=  0.984232454687a0 (KE cutoff=   7.84167Eh = 213.38274eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:     96    96    96
          Real-space ('12') slabs/node (min max mean):     32    32    32
         Recip-space ('23') slabs/node (min max mean):     16    17    16
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    192   192   192
          Real-space ('12') slabs/node (min max mean):     64    64    64
         Recip-space ('23') slabs/node (min max mean):     32    33    32
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1204      5348
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  451    0.0133333333    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   17    1   44.0987930694
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 4549.9704995968   -7.1200026340   10.1554888223   -2.4512395511
  2 1808.7342836076   -3.1441020922   13.3512011158   -3.1747184438
  3  932.9820426824   -2.9483262236   13.5591117497   -3.2264900415
  4  477.6718769012   -2.9069723777   13.6037862258   -3.2393298944
  5  240.9210952582   -2.8934568284   13.6185137541   -3.2441987773
  6  117.8120525020   -2.8875578177   13.6249705405   -3.2464992701
  7   53.7955565919   -2.8847081647   13.6280959121   -3.2476565662
  8   20.5070202097   -2.8832915332   13.6296511902   -3.2482473394
  9    3.1969927670   -2.8825813854   13.6304313374   -3.2485499519
 10   -5.8042175396   -2.8822243866   13.6308237161   -3.2487051244
 11  -10.4848453702   -2.8820447150   13.6310212782   -3.2487847420
 12  -12.9187712273   -2.8819542414   13.6311208012   -3.2488256157
 13  -14.1844124254   -2.8819086713   13.6311709499   -3.2488466111
 14  -14.8425457517   -2.8818857152   13.6311962232   -3.2488574019
 15  -15.1847750463   -2.8818741500   13.6312089613   -3.2488629513
 16  -15.3627342687   -2.8818683232   13.6312153818   -3.2488658069
 17  -15.4552730626   -2.8818653875   13.6312186183   -3.2488672772
 18  -15.5033932364   -2.8818639084   13.6312202497   -3.2488680347
 19  -15.5284157283   -2.8818631632   13.6312210721   -3.2488684252
 20  -15.5414274254   -2.8818627877   13.6312214867   -3.2488686267
 21  -15.5481935088   -2.8818625985   13.6312216958   -3.2488687307
 22  -15.5517118728   -2.8818625032   13.6312218011   -3.2488687844
 23  -15.5535414225   -2.8818624552   13.6312218543   -3.2488688122
 24  -15.5544927885   -2.8818624310   13.6312218810   -3.2488688265
 25  -15.5549874990   -2.8818624188   13.6312218946   -3.2488688340
 26  -15.5552447486   -2.8818624126   13.6312219014   -3.2488688378
 27  -15.5553785184   -2.8818624095   13.6312219048   -3.2488688398
 28  -15.5554480787   -2.8818624080   13.6312219065   -3.2488688408
 29  -15.5554842501   -2.8818624072   13.6312219074   -3.2488688414
 30  -15.5555030592   -2.8818624068   13.6312219078   -3.2488688417
 31  -15.5555128400   -2.8818624066   13.6312219081   -3.2488688418
 32  -15.5555179260   -2.8818624065   13.6312219082   -3.2488688419
 33  -15.5555205707   -2.8818624064   13.6312219082   -3.2488688419
 34  -15.5555219460   -2.8818624064   13.6312219083   -3.2488688419
 35  -15.5555226611   -2.8818624064   13.6312219083   -3.2488688419
 36  -15.5555230330   -2.8818624064   13.6312219083   -3.2488688419
 37  -15.5555232263   -2.8818624064   13.6312219083   -3.2488688419
 38  -15.5555233269   -2.8818624064   13.6312219083   -3.2488688419
 39  -15.5555233792   -2.8818624064   13.6312219083   -3.2488688420
Atom SCF converged after  39 iterations to a total energy of    -15.55552338

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  451    0.0133333333    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   17    0   44.0987930694
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  759.7185199794   -0.2254493580    0.2820969117   -0.2424203380
  2  303.6293018603   -0.2112351658    0.3031897290   -0.2589030263
  3  157.6748151084   -0.2047374150    0.3114419821   -0.2660350289
  4   81.7783116817   -0.2012764413    0.3157668793   -0.2698734827
  5   42.3123553874   -0.1995418291    0.3179229848   -0.2718232732
  6   21.7902292008   -0.1986938916    0.3189725590   -0.2727889274
  7   11.1188166252   -0.1982839634    0.3194776263   -0.2732618695
  8    5.5697271962   -0.1980867305    0.3197193626   -0.2734925108
  9    2.6842212708   -0.1979919845    0.3198348065   -0.2736049111
 10    1.1837671698   -0.1979464650    0.3198899095   -0.2736597586
 11    0.4035347911   -0.1979245717    0.3199162218   -0.2736865873
 12   -0.0021845587   -0.1979140239    0.3199287981   -0.2736997515
 13   -0.2131580784   -0.1979089317    0.3199348167   -0.2737062338
 14   -0.3228641404   -0.1979064676    0.3199377011   -0.2737094381
 15   -0.3799112610   -0.1979052723    0.3199390856   -0.2737110285
 16   -0.4095757748   -0.1979046910    0.3199397511   -0.2737118210
 17   -0.4250013412   -0.1979044075    0.3199400716   -0.2737122176
 18   -0.4330226524   -0.1979042689    0.3199402262   -0.2737124169
 19   -0.4371937463   -0.1979042009    0.3199403008   -0.2737125175
 20   -0.4393627230   -0.1979041675    0.3199403369   -0.2737125685
 21   -0.4404905958   -0.1979041510    0.3199403544   -0.2737125944
 22   -0.4410770927   -0.1979041429    0.3199403629   -0.2737126076
 23   -0.4413820729   -0.1979041388    0.3199403670   -0.2737126144
 24   -0.4415406636   -0.1979041368    0.3199403690   -0.2737126179
 25   -0.4416231313   -0.1979041358    0.3199403700   -0.2737126197
 26   -0.4416660149   -0.1979041353    0.3199403705   -0.2737126207
 27   -0.4416883146   -0.1979041351    0.3199403707   -0.2737126211
 28   -0.4416999105   -0.1979041350    0.3199403708   -0.2737126214
 29   -0.4417059404   -0.1979041349    0.3199403709   -0.2737126215
 30   -0.4417090760   -0.1979041349    0.3199403709   -0.2737126216
 31   -0.4417107066   -0.1979041349    0.3199403709   -0.2737126216
 32   -0.4417115544   -0.1979041349    0.3199403709   -0.2737126216
 33   -0.4417119954   -0.1979041348    0.3199403709   -0.2737126217
 34   -0.4417122246   -0.1979041348    0.3199403709   -0.2737126217
 35   -0.4417123439   -0.1979041348    0.3199403709   -0.2737126217
 36   -0.4417124058   -0.1979041348    0.3199403709   -0.2737126217
Atom SCF converged after  36 iterations to a total energy of     -0.44171241
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20233507E+01     0.90184060E+00
               2       0.18088683E+01     0.81656238E+00
               3       0.15619809E+01     0.67670350E+00
               4       0.13203083E+01     0.48845850E+00
               5       0.10985796E+01     0.41440397E+00
               6       0.83509442E+00     0.32280826E+00
               7       0.49684879E+00     0.20043976E+00
               8       0.18034495E+00     0.77820627E-01
               9       0.25576056E-01     0.11845319E-01
              10       0.58856365E-03     0.28061918E-03
              11       0.34158166E-06     0.16244108E-06
              12       0.11659214E-12     0.55511151E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -0.98664479023034    0.5860595
               2          -1.08184745970786    0.5746358
               3          -1.20351575186456    0.5563415
               4          -1.34491719755668    0.5319132
               5          -1.48118152901681    0.5095266
               6          -1.57325736348961    0.5002055
               7          -1.60701744504970    0.4998786
               8          -1.61167270709593    0.4999993
               9          -1.61178323197163    0.5000001
              10          -1.61178329920627    0.6938494
              11          -1.61178329920629    0.6938494
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999997]
Closest occupancy to 0.5:     0.99999999999999
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -15.227605093126=    -15.227605093126+      0.000000000000
    Trial step:       1.000000000000
            G0:      -7.810812796170
WARNING: minimum value of charge density: -0.0885
      Q1=E1+P1:     208.462683004742=    -22.054721919220+    230.517404923962
Quadratic term:    -231.501100894039
   Linear term:      -7.810812796170
  Optimal step:       0.016869925815
 Predicted min:     -15.293489009338
    !!! Quadratic minimum step length accepted !!!
 1    -15.22760509312616 0.46579718990 0.08396139777 0.0169  0.000    8.00000000
      Q0=E0+P0:     -15.350172374161=    -15.359055073018+      0.008882698858
    Trial step:       0.129884278551
            G0:      -0.037302578030
      Q1=E1+P1:     -15.354934339321=    -15.363689995030+      0.008755655709
Quadratic term:      -0.000083053275
   Linear term:      -0.004845018435
  Optimal step:       3.788482303835
    !!! Quadratic fit may be unreliable; taking second trial step !!!
WARNING: minimum value of charge density: -0.0007
      Q2=E2+P2:     -15.398658916301=    -15.470493179692+      0.071834263391
Quadratic term:      -0.092833614613
   Linear term:      -0.141320156754
  Optimal step:       2.883594026079
 2    -15.35905507301822 0.39912835532 0.08057153338 2.8836 -0.852    8.00000000
WARNING: minimum value of charge density: -0.0006
      Q0=E0+P0:     -15.407780350625=    -15.448358324924+      0.040577974299
    Trial step:       3.305214809849
            G0:      -5.379113494371
WARNING: minimum value of charge density: -0.8189
      Q1=E1+P1:    9870.513071260830=    -22.067294702759+   9892.580365963588
Quadratic term:   -9903.699977196909
   Linear term:     -17.779125585454
  Optimal step:       0.002966761378
    !!! Quadratic fit may be unreliable; taking second trial step !!!
WARNING: minimum value of charge density: -0.0006
      Q2=E2+P2:     -15.423521162035=    -15.466227321386+      0.042706159351
Quadratic term:      -0.000217734756
   Linear term:      -0.015958546165
  Optimal step:       0.108722188829
 3    -15.44835832492394 0.38666833883 0.02533878344 0.1087  2.491    8.00000000
WARNING: minimum value of charge density: -0.0016

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.089634136101
   Final penalty energy   :       0.484846038243
   RMS occupancy error    :       0.142133
   Occupancy bounds       : [-0.153, 1.215]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.142133 (step -0.3113 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.011562 (step -0.4867 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000333 (step -0.5006 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.559113023332
             Q0:     -15.303110196547
             G0:      -0.010556646478
   RMS gradient:       0.017124257063
     Trial step:       0.500000000000
             Q1:     -15.304412589603
 Quadratic coef:       0.003975930183
 Linear coef   :      -0.005278323239
           Qmin:     -15.304862031648
Quadratic minimum step length (  0.331892349482) accepted
    Initial Ne1:       7.99999886
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000318 (step -0.4992 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -15.30311019654658 0.00000000000 0.01284318611 0.3319  0.000    8.00000000
      ideal mu1:      -0.558989258867
             Q0:     -15.304861575648
             G0:      -0.000891854870
   RMS gradient:       0.004971219728
     Trial step:       0.407364915943
             Q1:     -15.305066467518
 Quadratic coef:       0.000158418514
 Linear coef   :      -0.000363310384
           Qmin:     -15.305069875852
Quadratic minimum step length (  0.467116816593) accepted
    Initial Ne1:       8.00000046
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000113 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.30486157564802 0.00021897939 0.00372841492 0.4671  0.084    8.00000000
      ideal mu1:      -0.555390543786
             Q0:     -15.305070121245
             G0:      -0.000077569731
   RMS gradient:       0.001467105192
     Trial step:       0.436218984831
             Q1:     -15.305086333706
 Quadratic coef:       0.000017624929
 Linear coef   :      -0.000033837389
           Qmin:     -15.305086362005
Quadratic minimum step length (  0.418739614719) accepted
    Initial Ne1:       8.00000007
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.30507012124515 0.00002829030 0.00110032892 0.4187  0.087    8.00000000
      ideal mu1:      -0.556294947805
             Q0:     -15.305086365794
             G0:      -0.000001553931
   RMS gradient:       0.000207740863
     Trial step:       0.427389950328
             Q1:     -15.305086790636
 Quadratic coef:       0.000000239293
 Linear coef   :      -0.000000664135
           Qmin:     -15.305086826605
Quadratic minimum step length (  0.593090569878) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.30508636579359 0.00000222465 0.00015580565 0.5931  0.020    8.00000000
      ideal mu1:      -0.556305466025
             Q0:     -15.305086826609
             G0:      -0.000000433530
   RMS gradient:       0.000109738061
     Trial step:       0.503468915823
             Q1:     -15.305086902993
 Quadratic coef:       0.000000141885
 Linear coef   :      -0.000000218269
           Qmin:     -15.305086910553
Quadratic minimum step length (  0.387255246229) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.30508682660933 0.00000005888 0.00008230355 0.3873  0.279    8.00000000
      ideal mu1:      -0.556287747655
             Q0:     -15.305086910553
             G0:      -0.000000019401
   RMS gradient:       0.000023214593
     Trial step:       0.441555182243
             Q1:     -15.305086915455
 Quadratic coef:       0.000000003665
 Linear coef   :      -0.000000008567
           Qmin:     -15.305086915559
Quadratic minimum step length (  0.516109519863) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.30508691055286 0.00000001349 0.00001741094 0.5161  0.045    8.00000000
      ideal mu1:      -0.556287087755
             Q0:     -15.305086915560
             G0:      -0.000000000384
   RMS gradient:       0.000003265568
     Trial step:       0.477379129310
             Q1:     -15.305086915663
 Quadratic coef:       0.000000000079
 Linear coef   :      -0.000000000183
           Qmin:     -15.305086915665
Quadratic minimum step length (  0.551080600743) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.30508691555961 0.00000000066 0.00000244918 0.5511  0.000    8.00000000
      ideal mu1:      -0.556288383258
             Q0:     -15.305086915666
             G0:      -0.000000000052
   RMS gradient:       0.000001204650
     Trial step:       0.512907766915
             Q1:     -15.305086915672
 Quadratic coef:       0.000000000021
 Linear coef   :      -0.000000000027
           Qmin:     -15.305086915674
Quadratic minimum step length (  0.334211066588) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.30508691566553 0.00000000001 0.00000090349 0.3342  0.136    8.00000000
      ideal mu1:      -0.556287869267
             Q0:     -15.305086915674
             G0:      -0.000000000003
   RMS gradient:       0.000000271786
     Trial step:       0.414028322512
             Q1:     -15.305086915675
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -15.305086915675
Quadratic minimum step length (  0.463430488569) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.30508691567418 0.00000000000 0.00000020384 0.4634  0.051    8.00000000
      ideal mu1:      -0.556287818034
10    -15.30508691567494 0.00000000000 0.00000004449 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.04644463014359              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17879465E+00     0.12588350E+00
               2       0.21864689E-01     0.16541380E-01
               3       0.36343602E-03     0.29107636E-03
               4       0.11627116E-06     0.93911263E-07
               5       0.13034474E-13     0.10547119E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54581499E-01     0.36456057E-01
               2       0.20042142E-02     0.14299971E-02
               3       0.29747622E-05     0.22441504E-05
               4       0.75266074E-11     0.57585048E-11
               5       0.95154749E-15     0.55511151E-15
================================================================================
RMS gradient                =       0.04644463014359
Trial step length           =               0.122474
Gradient along search dir.  =        -12.28254829228
Functional at step 0        =     -15.30508691567494
Functional at step 1        =     -15.78715970602103
Functional predicted        =     -15.85851513521323
Selected quadratic step     =               0.090116
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.25529696
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.026991 (step -0.4568 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000895 (step -0.5000 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.566451365955
             Q0:     -15.841039837940
             G0:      -0.118824519733
   RMS gradient:       0.057451554406
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000253 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -15.84103983794017 0.00000000000 0.04308866580 0.1000  0.000    8.00000000
      ideal mu1:      -0.555563944709
             Q0:     -15.851505905928
             G0:      -0.122321560089
   RMS gradient:       0.043914000912
     Trial step:       0.438033500754
             Q1:     -15.857092984670
 Quadratic coef:       0.047993862442
 Linear coef   :      -0.053580941183
           Qmin:     -15.866460512163
Quadratic minimum step length (  0.244513006937) accepted
    Initial Ne1:       8.00000027
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003502 (step -0.4928 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000011 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.85150590592799 0.00074265325 0.03293550016 0.2445  0.584    8.00000000
      ideal mu1:      -0.517936800990
             Q0:     -15.866492124315
             G0:      -0.005420204303
   RMS gradient:       0.012129646076
     Trial step:       0.327268832015
             Q1:     -15.867658591926
 Quadratic coef:       0.000607396320
 Linear coef   :      -0.001773863932
           Qmin:     -15.867787239688
Quadratic minimum step length (  0.477884338268) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001175 (step -0.4976 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.86649212431451 0.00329757140 0.00909723454 0.4779  0.076    8.00000000
      ideal mu1:      -0.520012695541
             Q0:     -15.867805568934
             G0:      -0.000933736394
   RMS gradient:       0.005050991090
     Trial step:       0.395470162241
             Q1:     -15.867982372599
 Quadratic coef:       0.000192461219
 Linear coef   :      -0.000369264883
           Qmin:     -15.867982691051
Quadratic minimum step length (  0.379383556468) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000225 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.86780556893402 0.00020309482 0.00378824332 0.3794  0.173    8.00000000
      ideal mu1:      -0.522361928900
             Q0:     -15.867983528885
             G0:      -0.000058088685
   RMS gradient:       0.001267257661
     Trial step:       0.387343357537
             Q1:     -15.867995622229
 Quadratic coef:       0.000010406922
 Linear coef   :      -0.000022500266
           Qmin:     -15.867995690549
Quadratic minimum step length (  0.418727470605) accepted
    Initial Ne1:       8.00000023
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000020 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.86798352888499 0.00002735078 0.00095044320 0.4187  0.063    8.00000000
      ideal mu1:      -0.522398171647
             Q0:     -15.867995696592
             G0:      -0.000014716426
   RMS gradient:       0.000639291254
     Trial step:       0.402729815580
             Q1:     -15.867999065324
 Quadratic coef:       0.000002558012
 Linear coef   :      -0.000005926744
           Qmin:     -15.867999129560
Quadratic minimum step length (  0.466549078213) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.86799569659210 0.00000164701 0.00047946844 0.4665  0.254    8.00000000
      ideal mu1:      -0.522523379084
             Q0:     -15.867999130388
             G0:      -0.000001068737
   RMS gradient:       0.000172299526
     Trial step:       0.433466520308
             Q1:     -15.867999350183
 Quadratic coef:       0.000000243466
 Linear coef   :      -0.000000463262
           Qmin:     -15.867999350758
Quadratic minimum step length (  0.412394350882) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.86799913038777 0.00000054807 0.00012922464 0.4124  0.000    8.00000000
      ideal mu1:      -0.522471677825
             Q0:     -15.867999350757
             G0:      -0.000000074329
   RMS gradient:       0.000045438196
     Trial step:       0.422799177236
             Q1:     -15.867999368471
 Quadratic coef:       0.000000013712
 Linear coef   :      -0.000000031426
           Qmin:     -15.867999368763
Quadratic minimum step length (  0.484505032373) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.86799935075703 0.00000002755 0.00003407865 0.4845  0.070    8.00000000
      ideal mu1:      -0.522446043529
             Q0:     -15.867999368764
             G0:      -0.000000010788
   RMS gradient:       0.000017311172
     Trial step:       0.452601733375
             Q1:     -15.867999371144
 Quadratic coef:       0.000000002502
 Linear coef   :      -0.000000004883
           Qmin:     -15.867999371145
Quadratic minimum step length (  0.441568386479) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.86799936876356 0.00000000241 0.00001298338 0.4416  0.145    8.00000000
      ideal mu1:      -0.522459598993
10    -15.86799937114540 0.00000000034 0.00000169917 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01271435820904              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44403093E-01     0.30789634E-01
               2       0.12877583E-02     0.95686476E-03
               3       0.11845800E-05     0.93473893E-06
               4       0.11268193E-11     0.90782937E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11423781E-01     0.79840146E-02
               2       0.84381269E-04     0.63687021E-04
               3       0.50638500E-08     0.40747031E-08
               4       0.10782505E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.01271435820904
Trial step length           =               0.105057
Gradient along search dir.  =         -0.93855910895
Functional at step 0        =     -15.86799937114540
Functional at step 1        =     -15.92596191578778
Functional predicted        =     -15.92780795557566
Selected quadratic step     =               0.127448
Conjugate gradients coeff.  =               0.074941
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.08488216
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.008065 (step -0.4862 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000071 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.543207083394
             Q0:     -15.927187356778
             G0:      -0.020511283187
   RMS gradient:       0.023869601302
     Trial step:       0.447051022954
             Q1:     -15.932134285082
 Quadratic coef:       0.004222661826
 Linear coef   :      -0.009169590131
           Qmin:     -15.932165341437
Quadratic minimum step length (  0.485389881645) accepted
    Initial Ne1:       7.99999975
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001060 (step -0.4977 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.92718735677754 0.00000000000 0.01790220015 0.4854  0.000    8.00000000
      ideal mu1:      -0.520915615015
             Q0:     -15.932180443410
             G0:      -0.001447039546
   RMS gradient:       0.006310137446
     Trial step:       0.465826194112
             Q1:     -15.932564911389
 Quadratic coef:       0.000289600945
 Linear coef   :      -0.000674068924
           Qmin:     -15.932572680489
Quadratic minimum step length (  0.542123509919) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000237 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.93218044340977 0.00062224808 0.00473260308 0.5421  0.070    8.00000000
      ideal mu1:      -0.524024931912
             Q0:     -15.932573358224
             G0:      -0.000215832872
   RMS gradient:       0.002446660965
     Trial step:       0.502528935848
             Q1:     -15.932615927686
 Quadratic coef:       0.000065892802
 Linear coef   :      -0.000108462264
           Qmin:     -15.932617991562
Quadratic minimum step length (  0.413591656072) accepted
    Initial Ne1:       8.00000043
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000044 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.93257335822415 0.00005288462 0.00183499570 0.4136  0.150    8.00000000
      ideal mu1:      -0.523489006394
             Q0:     -15.932618020999
             G0:      -0.000003941708
   RMS gradient:       0.000330749658
     Trial step:       0.455896671189
             Q1:     -15.932619297615
 Quadratic coef:       0.000000520395
 Linear coef   :      -0.000001797011
           Qmin:     -15.932619572344
Quadratic minimum step length (  0.787143752003) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.93261802099907 0.00000649963 0.00024806224 0.7871  0.018    8.00000000
      ideal mu1:      -0.523571406821
             Q0:     -15.932619572367
             G0:      -0.000000311296
   RMS gradient:       0.000092990857
     Trial step:       0.599046088616
             Q1:     -15.932619598238
 Quadratic coef:       0.000000160610
 Linear coef   :      -0.000000186481
           Qmin:     -15.932619626496
Quadratic minimum step length (  0.347769738616) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.93261957236676 0.00000019822 0.00006974314 0.3478  0.079    8.00000000
      ideal mu1:      -0.523540651973
             Q0:     -15.932619626495
             G0:      -0.000000008286
   RMS gradient:       0.000015171586
     Trial step:       0.456431924450
             Q1:     -15.932619629129
 Quadratic coef:       0.000000001149
 Linear coef   :      -0.000000003782
           Qmin:     -15.932619629609
Quadratic minimum step length (  0.751506797091) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.93261962649541 0.00000000731 0.00001137869 0.7515  0.027    8.00000000
      ideal mu1:      -0.523534541510
             Q0:     -15.932619629609
             G0:      -0.000000001548
   RMS gradient:       0.000006556430
     Trial step:       0.585672001749
             Q1:     -15.932619629995
 Quadratic coef:       0.000000000520
 Linear coef   :      -0.000000000906
           Qmin:     -15.932619630003
Quadratic minimum step length (  0.510277143670) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.93261962960862 0.00000000040 0.00000491732 0.5103  0.000    8.00000000
      ideal mu1:      -0.523537454137
             Q0:     -15.932619630004
             G0:      -0.000000000184
   RMS gradient:       0.000002261892
     Trial step:       0.546676354144
             Q1:     -15.932619630063
 Quadratic coef:       0.000000000041
 Linear coef   :      -0.000000000101
           Qmin:     -15.932619630066
Quadratic minimum step length (  0.674784427376) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.93261963000354 0.00000000005 0.00000169642 0.6748  0.119    8.00000000
      ideal mu1:      -0.523538293986
             Q0:     -15.932619630066
             G0:      -0.000000000052
   RMS gradient:       0.000001199255
     Trial step:       0.607362075364
             Q1:     -15.932619630075
 Quadratic coef:       0.000000000022
 Linear coef   :      -0.000000000031
           Qmin:     -15.932619630077
Quadratic minimum step length (  0.430595142325) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.93261963006555 0.00000000001 0.00000089944 0.4306  0.281    8.00000000
      ideal mu1:      -0.523537373895
10    -15.93261963007648 0.00000000000 0.00000008684 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00627621391956              |
           | Maximum change in energy =  0.18763748515682 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.34862862E-01     0.18703191E-01
               2       0.78294743E-03     0.41811548E-03
               3       0.41686088E-06     0.23136704E-06
               4       0.13168931E-12     0.74384943E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13621226E-01     0.72358354E-02
               2       0.11837459E-03     0.62198015E-04
               3       0.94829761E-08     0.51371709E-08
               4       0.63683124E-15     0.27755576E-15
================================================================================
RMS gradient                =       0.00627621391956
Trial step length           =               0.115712
Gradient along search dir.  =         -0.24010271964
Functional at step 0        =     -15.93261963007648
Functional at step 1        =     -15.94992144442186
Functional predicted        =     -15.95103118542890
Selected quadratic step     =               0.153364
Conjugate gradients coeff.  =               0.243673
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.04563753
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004323 (step -0.4929 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.552448295393
             Q0:     -15.950777785190
             G0:      -0.005533873069
   RMS gradient:       0.012398334419
     Trial step:       0.511397261710
             Q1:     -15.951964618212
 Quadratic coef:       0.001643174512
 Linear coef   :      -0.002830007534
           Qmin:     -15.951996301936
Quadratic minimum step length (  0.440384783558) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000222 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.95077778518955 0.00000000000 0.00929875079 0.4404  0.000    8.00000000
      ideal mu1:      -0.539879348261
             Q0:     -15.951996242120
             G0:      -0.000371792871
   RMS gradient:       0.003210439647
     Trial step:       0.474564613525
             Q1:     -15.952082785599
 Quadratic coef:       0.000089896261
 Linear coef   :      -0.000176439740
           Qmin:     -15.952082816860
Quadratic minimum step length (  0.465714904222) accepted
    Initial Ne1:       8.00000014
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000048 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.95199624211969 0.00015231459 0.00240782963 0.4657  0.067    8.00000000
      ideal mu1:      -0.540288337076
             Q0:     -15.952082849343
             G0:      -0.000040874187
   RMS gradient:       0.001064969257
     Trial step:       0.470118935520
             Q1:     -15.952095050156
 Quadratic coef:       0.000007014917
 Linear coef   :      -0.000019215729
           Qmin:     -15.952096008597
Quadratic minimum step length (  0.643890638582) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000013 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.95208284934323 0.00001156765 0.00079872695 0.6439  0.110    8.00000000
      ideal mu1:      -0.540297371047
             Q0:     -15.952096011399
             G0:      -0.000000506298
   RMS gradient:       0.000118575694
     Trial step:       0.550186497110
             Q1:     -15.952096202056
 Quadratic coef:       0.000000087901
 Linear coef   :      -0.000000278558
           Qmin:     -15.952096232087
Quadratic minimum step length (  0.871771277716) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.95209601139863 0.00000184035 0.00008893177 0.8718  0.012    8.00000000
      ideal mu1:      -0.540319375993
             Q0:     -15.952096232087
             G0:      -0.000000185359
   RMS gradient:       0.000071755855
     Trial step:       0.692558145983
             Q1:     -15.952096257809
 Quadratic coef:       0.000000102649
 Linear coef   :      -0.000000128372
           Qmin:     -15.952096272221
Quadratic minimum step length (  0.433051073581) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.95209623208653 0.00000002798 0.00005381689 0.4331  0.366    8.00000000
      ideal mu1:      -0.540309127090
             Q0:     -15.952096272221
             G0:      -0.000000003928
   RMS gradient:       0.000010444995
     Trial step:       0.547643176379
             Q1:     -15.952096273651
 Quadratic coef:       0.000000000721
 Linear coef   :      -0.000000002151
           Qmin:     -15.952096273824
Quadratic minimum step length (  0.816349326425) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.95209627222132 0.00000000688 0.00000783375 0.8163  0.021    8.00000000
      ideal mu1:      -0.540306978365
             Q0:     -15.952096273824
             G0:      -0.000000000383
   RMS gradient:       0.000003259740
     Trial step:       0.668631541403
             Q1:     -15.952096273942
 Quadratic coef:       0.000000000138
 Linear coef   :      -0.000000000256
           Qmin:     -15.952096273942
Quadratic minimum step length (  0.619296864579) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.95209627382392 0.00000000021 0.00000244481 0.6193  0.000    8.00000000
      ideal mu1:      -0.540307816918
             Q0:     -15.952096273943
             G0:      -0.000000000044
   RMS gradient:       0.000001103230
     Trial step:       0.643491582812
             Q1:     -15.952096273955
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000028
           Qmin:     -15.952096273955
Quadratic minimum step length (  0.563109534680) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -15.95209627394255 0.00000000001 0.00000082742 0.5631  0.115    8.00000000
      ideal mu1:      -0.540308159144
             Q0:     -15.952096273955
             G0:      -0.000000000009
   RMS gradient:       0.000000511147
     Trial step:       0.601960335709
             Q1:     -15.952096273957
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000006
           Qmin:     -15.952096273957
Quadratic minimum step length (  0.498525157926) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.95209627395483 0.00000000000 0.00000038336 0.4985  0.215    8.00000000
      ideal mu1:      -0.540307796700
10    -15.95209627395707 0.00000000000 0.00000008408 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00391397524374              |
           | Maximum change in energy =  0.02154008631036 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.33282333E-01     0.15076083E-01
               2       0.71504796E-03     0.31456084E-03
               3       0.34359405E-06     0.15715236E-06
               4       0.88171620E-13     0.44686477E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.50448639E-02     0.22159783E-02
               2       0.16347687E-04     0.68782471E-05
               3       0.17918999E-09     0.79393880E-10
               4       0.95170016E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00391397524374
Trial step length           =               0.133214
Gradient along search dir.  =         -0.09247236109
Functional at step 0        =     -15.95209627395707
Functional at step 1        =     -15.95896422154282
Functional predicted        =     -15.95905634839565
Selected quadratic step     =               0.150533
Conjugate gradients coeff.  =               0.388902
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02417879
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002419 (step -0.4961 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.560726123425
             Q0:     -15.958973840810
             G0:      -0.001024363969
   RMS gradient:       0.005334281086
     Trial step:       0.547806874204
             Q1:     -15.959184136164
 Quadratic coef:       0.000350858270
 Linear coef   :      -0.000561153624
           Qmin:     -15.959198214451
Quadratic minimum step length (  0.438074058778) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000040 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.95897384081035 0.00000000000 0.00400071081 0.4381  0.000    8.00000000
      ideal mu1:      -0.555273267975
             Q0:     -15.959198136561
             G0:      -0.000067128993
   RMS gradient:       0.001365127530
     Trial step:       0.489877516129
             Q1:     -15.959213889873
 Quadratic coef:       0.000017131672
 Linear coef   :      -0.000032884984
           Qmin:     -15.959213917598
Quadratic minimum step length (  0.470170535443) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.95919813656072 0.00002804671 0.00102384565 0.4702  0.065    8.00000000
      ideal mu1:      -0.555281502196
             Q0:     -15.959213918266
             G0:      -0.000005528907
   RMS gradient:       0.000391809841
     Trial step:       0.479922883451
             Q1:     -15.959215692475
 Quadratic coef:       0.000000879240
 Linear coef   :      -0.000002653449
           Qmin:     -15.959215920219
Quadratic minimum step length (  0.724176882861) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.95921391826586 0.00000210293 0.00029385738 0.7242  0.082    8.00000000
      ideal mu1:      -0.555291658495
             Q0:     -15.959215920295
             G0:      -0.000000046561
   RMS gradient:       0.000035962231
     Trial step:       0.589532914901
             Q1:     -15.959215937837
 Quadratic coef:       0.000000009907
 Linear coef   :      -0.000000027449
           Qmin:     -15.959215939307
Quadratic minimum step length (  0.816687763164) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.95921592029470 0.00000027233 0.00002697167 0.8167  0.008    8.00000000
      ideal mu1:      -0.555294710851
             Q0:     -15.959215939308
             G0:      -0.000000024749
   RMS gradient:       0.000026219632
     Trial step:       0.693876298472
             Q1:     -15.959215945479
 Quadratic coef:       0.000000011002
 Linear coef   :      -0.000000017173
           Qmin:     -15.959215946009
Quadratic minimum step length (  0.541542441087) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.95921593930773 0.00000000240 0.00001966472 0.5415  0.532    8.00000000
      ideal mu1:      -0.555293480928
             Q0:     -15.959215946009
             G0:      -0.000000000331
   RMS gradient:       0.000003032569
     Trial step:       0.612995484883
             Q1:     -15.959215946117
 Quadratic coef:       0.000000000095
 Linear coef   :      -0.000000000203
           Qmin:     -15.959215946118
Quadratic minimum step length (  0.656632311286) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.95921594600903 0.00000000129 0.00000227443 0.6566  0.013    8.00000000
      ideal mu1:      -0.555293224507
             Q0:     -15.959215946118
             G0:      -0.000000000005
   RMS gradient:       0.000000376735
     Trial step:       0.634438840273
             Q1:     -15.959215946120
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -15.959215946120
Quadratic minimum step length (  1.006761850471) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.95921594611765 0.00000000001 0.00000028255 1.0068  0.000    8.00000000
      ideal mu1:      -0.555293328206
             Q0:     -15.959215946120
             G0:      -0.000000000001
   RMS gradient:       0.000000139798
     Trial step:       0.799205118129
             Q1:     -15.959215946120
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000000
           Qmin:     -15.959215946120
Quadratic minimum step length (  0.377924321672) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.95921594612026 0.00000000000 0.00000010485 0.3779  0.138    8.00000000
      ideal mu1:      -0.555293319188
             Q0:     -15.959215946120
             G0:      -0.000000000000
   RMS gradient:       0.000000055388
     Trial step:       0.549580796740
             Q1:     -15.959215946120
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.959215946120
Quadratic minimum step length (  0.187329925779) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.95921594612026 0.00000000000 0.00000004154 0.1873  0.157    8.00000000
      ideal mu1:      -0.555293308129
10    -15.95921594612031 0.00000000000 0.00000002708 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00232068166525              |
           | Maximum change in energy =  0.00649221462686 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.02358213421925 |
           | Pseudopotential (local)    :      -44.14276117389384 |
           | Pseudopotential (non-local):       -1.48678105679551 |
           | Hartree                    :       18.61009553752653 |
           | Exchange-correlation       :       -3.89920063514756 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.95921594612030 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -44.14276117389368 |
           | Hartree                    :       18.61009553752656 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999995
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.53601071E-02     0.18995984E-02
               2       0.16715065E-04     0.61651357E-05
               3       0.18731688E-09     0.77426177E-10
               4       0.78807465E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12610166E-02     0.42322475E-03
               2       0.98070859E-06     0.34983742E-06
               3       0.64425435E-12     0.25734970E-12
================================================================================
RMS gradient                =       0.00232068166525
Trial step length           =               0.141609
Gradient along search dir.  =         -0.03066539795
Functional at step 0        =     -15.95921594612031
Functional at step 1        =     -15.96082955515915
Functional predicted        =     -15.96094350764827
Selected quadratic step     =               0.112672
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99731730
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000301 (step -0.5005 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.555787913735
             Q0:     -15.960942444432
             G0:      -0.000013237339
   RMS gradient:       0.000606385910
     Trial step:       0.320862789776
             Q1:     -15.960945231859
 Quadratic coef:       0.000001459942
 Linear coef   :      -0.000004247370
           Qmin:     -15.960945533621
Quadratic minimum step length (  0.466738746217) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96094244443160 0.00000000000 0.00045478943 0.4667  0.000    8.00000000
      ideal mu1:      -0.556426806050
             Q0:     -15.960945533385
             G0:      -0.000001333219
   RMS gradient:       0.000192461051
     Trial step:       0.386987204191
             Q1:     -15.960945866224
 Quadratic coef:       0.000000183100
 Linear coef   :      -0.000000515939
           Qmin:     -15.960945896839
Quadratic minimum step length (  0.545227116882) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.96094553338511 0.00000038615 0.00014434579 0.5452  0.101    8.00000000
      ideal mu1:      -0.556414841802
             Q0:     -15.960945896831
             G0:      -0.000000178998
   RMS gradient:       0.000070515744
     Trial step:       0.459342919409
             Q1:     -15.960945950978
 Quadratic coef:       0.000000028074
 Linear coef   :      -0.000000082222
           Qmin:     -15.960945957032
Quadratic minimum step length (  0.672647542451) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.96094589683100 0.00000005000 0.00005288681 0.6726  0.134    8.00000000
      ideal mu1:      -0.556402676431
             Q0:     -15.960945957033
             G0:      -0.000000002290
   RMS gradient:       0.000007976167
     Trial step:       0.555855993835
             Q1:     -15.960945957910
 Quadratic coef:       0.000000000396
 Linear coef   :      -0.000000001273
           Qmin:     -15.960945958056
Quadratic minimum step length (  0.893307233070) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.96094595703254 0.00000000864 0.00000598213 0.8933  0.013    8.00000000
      ideal mu1:      -0.556402239380
             Q0:     -15.960945958055
             G0:      -0.000000000427
   RMS gradient:       0.000003442828
     Trial step:       0.704663167647
             Q1:     -15.960945958088
 Quadratic coef:       0.000000000268
 Linear coef   :      -0.000000000301
           Qmin:     -15.960945958139
Quadratic minimum step length (  0.394817390342) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.96094595805526 0.00000000013 0.00000258212 0.3948  0.186    8.00000000
      ideal mu1:      -0.556402108917
             Q0:     -15.960945958139
             G0:      -0.000000000012
   RMS gradient:       0.000000588588
     Trial step:       0.527459261859
             Q1:     -15.960945958144
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000007
           Qmin:     -15.960945958147
Quadratic minimum step length (  1.145954085779) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.96094595813937 0.00000000001 0.00000044144 1.1460  0.029    8.00000000
      ideal mu1:      -0.556402098715
             Q0:     -15.960945958147
             G0:      -0.000000000001
   RMS gradient:       0.000000175356
     Trial step:       0.777460028689
             Q1:     -15.960945958147
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -15.960945958147
Quadratic minimum step length (  0.539654442021) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.96094595814667 0.00000000000 0.00000013152 0.5397  0.000    8.00000000
      ideal mu1:      -0.556402115153
             Q0:     -15.960945958147
             G0:      -0.000000000000
   RMS gradient:       0.000000045496
     Trial step:       0.647734326692
             Q1:     -15.960945958147
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.960945958147
Quadratic minimum step length (  0.094354153204) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96094595814706 0.00000000000 0.00000003412 0.0944  0.067    8.00000000
      ideal mu1:      -0.556402115755
             Q0:     -15.960945958147
             G0:      -0.000000000000
   RMS gradient:       0.000000040117
     Trial step:       0.247217361640
             Q1:     -15.960945958147
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.960945958147
  Cubic LS coeff:       0.324852744176
Predicted energy:     -15.960945958147
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.96094595814703 0.00000000000 0.00000003009 0.3249  0.778    8.00000000
      ideal mu1:      -0.556402118475
10    -15.96094595814708 0.00000000000 0.00000001418 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00135957220811              |
           | Maximum change in energy =  0.00237322405441 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.64946049E-02     0.21993620E-02
               2       0.25172941E-04     0.88583146E-05
               3       0.43003511E-09     0.17110291E-09
               4       0.95586673E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11072093E-02     0.37219045E-03
               2       0.76488171E-06     0.28332313E-06
               3       0.39785988E-12     0.15237811E-12
================================================================================
RMS gradient                =       0.00135957220811
Trial step length           =               0.126314
Gradient along search dir.  =         -0.01053724156
Functional at step 0        =     -15.96094595814708
Functional at step 1        =     -15.96169126857954
Functional predicted        =     -15.96170214319450
Selected quadratic step     =               0.143526
Conjugate gradients coeff.  =               0.343221
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99587773
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000472 (step -0.5010 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.558542999404
             Q0:     -15.961698910585
             G0:      -0.000002222484
   RMS gradient:       0.000248466604
     Trial step:       0.283388846529
             Q1:     -15.961699402529
 Quadratic coef:       0.000000137883
 Linear coef   :      -0.000000629827
           Qmin:     -15.961699629822
Quadratic minimum step length (  0.647236993252) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96169891058474 0.00000000000 0.00018634995 0.6472  0.000    8.00000000
      ideal mu1:      -0.558632704163
             Q0:     -15.961699629762
             G0:      -0.000000398409
   RMS gradient:       0.000105207677
     Trial step:       0.428275314428
             Q1:     -15.961699741808
 Quadratic coef:       0.000000058583
 Linear coef   :      -0.000000170629
           Qmin:     -15.961699754005
Quadratic minimum step length (  0.623694760298) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.96169962976200 0.00000008990 0.00007890576 0.6237  0.179    8.00000000
      ideal mu1:      -0.558689580374
             Q0:     -15.961699754003
             G0:      -0.000000071761
   RMS gradient:       0.000044648186
     Trial step:       0.516829826513
             Q1:     -15.961699772035
 Quadratic coef:       0.000000019057
 Linear coef   :      -0.000000037088
           Qmin:     -15.961699772049
Quadratic minimum step length (  0.502934057351) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.96169975400308 0.00000001831 0.00003348614 0.5029  0.180    8.00000000
      ideal mu1:      -0.558648037872
             Q0:     -15.961699772049
             G0:      -0.000000000697
   RMS gradient:       0.000004398824
     Trial step:       0.509834602207
             Q1:     -15.961699772330
 Quadratic coef:       0.000000000074
 Linear coef   :      -0.000000000355
           Qmin:     -15.961699772473
Quadratic minimum step length (  1.217681829239) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -15.96169977204886 0.00000000273 0.00000329912 1.2177  0.010    8.00000000
      ideal mu1:      -0.558647757159
             Q0:     -15.961699772474
             G0:      -0.000000000086
   RMS gradient:       0.000001546913
     Trial step:       0.787918987603
             Q1:     -15.961699772486
 Quadratic coef:       0.000000000057
 Linear coef   :      -0.000000000068
           Qmin:     -15.961699772495
Quadratic minimum step length (  0.474877491595) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.96169977247449 0.00000000005 0.00000116018 0.4749  0.124    8.00000000
      ideal mu1:      -0.558647907604
             Q0:     -15.961699772495
             G0:      -0.000000000015
   RMS gradient:       0.000000649688
     Trial step:       0.611690274905
             Q1:     -15.961699772500
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000009
           Qmin:     -15.961699772500
Quadratic minimum step length (  0.702881314163) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.96169977249495 0.00000000000 0.00000048727 0.7029  0.176    8.00000000
      ideal mu1:      -0.558647947200
             Q0:     -15.961699772501
             G0:      -0.000000000000
   RMS gradient:       0.000000097875
     Trial step:       0.655702420528
             Q1:     -15.961699772501
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961699772501
Quadratic minimum step length (  0.851725733306) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.96169977250057 0.00000000000 0.00000007341 0.8517  0.000    8.00000000
      ideal mu1:      -0.558647966184
             Q0:     -15.961699772501
             G0:      -0.000000000000
   RMS gradient:       0.000000026551
     Trial step:       0.747314274556
             Q1:     -15.961699772501
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961699772501
Quadratic minimum step length (  0.021548692420) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96169977250087 0.00000000000 0.00000001991 0.0215  0.074    8.00000000
      ideal mu1:      -0.558647966184
             Q0:     -15.961699772501
             G0:      -0.000000000000
   RMS gradient:       0.000000025875
     Trial step:       0.126900139651
             Q1:     -15.961699772501
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961699772500
  Cubic LS coeff:       0.131076839112
Predicted energy:     -15.961699772501
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.96169977250057 0.00000000000 0.00000001941 0.1311  0.950    8.00000000
      ideal mu1:      -0.558647965972
10    -15.96169977250064 0.00000000000 0.00000001279 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00076218479757              |
           | Maximum change in energy =  0.00057667067559 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.69143842E-02     0.23241661E-02
               2       0.28856671E-04     0.10490951E-04
               3       0.57270065E-09     0.22892233E-09
               4       0.63315590E-15     0.27755576E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14293963E-03     0.46871471E-04
               2       0.12673907E-07     0.44321341E-08
               3       0.90877914E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00076218479757
Trial step length           =               0.134646
Gradient along search dir.  =         -0.00329439441
Functional at step 0        =     -15.96169977250064
Functional at step 1        =     -15.96191773063881
Functional predicted        =     -15.96191779564533
Selected quadratic step     =               0.132360
Conjugate gradients coeff.  =               0.314279
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99635436
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000428 (step -0.5010 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.561427017624
             Q0:     -15.961915385167
             G0:      -0.000020376947
   RMS gradient:       0.000752347198
     Trial step:       0.128971582871
             Q1:     -15.961917639801
 Quadratic coef:       0.000000373413
 Linear coef   :      -0.000002628047
           Qmin:     -15.961920009158
Quadratic minimum step length (  0.453845276229) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96191538516694 0.00000000000 0.00056426040 0.4538  0.000    8.00000000
      ideal mu1:      -0.560638276943
             Q0:     -15.961920010203
             G0:      -0.000001546215
   RMS gradient:       0.000207204818
     Trial step:       0.241936238819
             Q1:     -15.961920297071
 Quadratic coef:       0.000000087217
 Linear coef   :      -0.000000374085
           Qmin:     -15.961920411329
Quadratic minimum step length (  0.518849572680) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.96192001020275 0.00000057800 0.00015540361 0.5188  0.076    8.00000000
      ideal mu1:      -0.560620931817
             Q0:     -15.961920411360
             G0:      -0.000000145416
   RMS gradient:       0.000063551127
     Trial step:       0.354300034049
             Q1:     -15.961920451239
 Quadratic coef:       0.000000011642
 Linear coef   :      -0.000000051521
           Qmin:     -15.961920468361
Quadratic minimum step length (  0.783972933462) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.96192041135962 0.00000005396 0.00004766335 0.7840  0.094    8.00000000
      ideal mu1:      -0.560626520387
             Q0:     -15.961920468362
             G0:      -0.000000002731
   RMS gradient:       0.000008710007
     Trial step:       0.527030964004
             Q1:     -15.961920469476
 Quadratic coef:       0.000000000325
 Linear coef   :      -0.000000001439
           Qmin:     -15.961920469956
Quadratic minimum step length (  1.167581157648) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.96192046836180 0.00000000785 0.00000653250 1.1676  0.019    8.00000000
      ideal mu1:      -0.560626906776
             Q0:     -15.961920469957
             G0:      -0.000000001128
   RMS gradient:       0.000005595519
     Trial step:       0.784443384234
             Q1:     -15.961920470017
 Quadratic coef:       0.000000000826
 Linear coef   :      -0.000000000885
           Qmin:     -15.961920470194
Quadratic minimum step length (  0.420328394823) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -15.96192046995737 0.00000000020 0.00000419664 0.4203  0.413    8.00000000
      ideal mu1:      -0.560626997558
             Q0:     -15.961920470194
             G0:      -0.000000000008
   RMS gradient:       0.000000469685
     Trial step:       0.574215837925
             Q1:     -15.961920470198
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000005
           Qmin:     -15.961920470199
Quadratic minimum step length (  1.048336939473) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.96192047019445 0.00000000004 0.00000035226 1.0483  0.007    8.00000000
      ideal mu1:      -0.560626933921
             Q0:     -15.961920470198
             G0:      -0.000000000000
   RMS gradient:       0.000000113413
     Trial step:       0.775868335562
             Q1:     -15.961920470199
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961920470198
  Cubic LS coeff:       0.993216798466
Predicted energy:     -15.961920470199
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.96192047019831 0.00000000000 0.00000008506 0.9932  0.000    8.00000000
      ideal mu1:      -0.560626963352
             Q0:     -15.961920470199
             G0:      -0.000000000000
   RMS gradient:       0.000000058996
     Trial step:       0.877841366238
             Q1:     -15.961920470199
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961920470199
Quadratic minimum step length (  1.478754552647) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96192047019860 0.00000000000 0.00000004425 1.4788  0.271    8.00000000
      ideal mu1:      -0.560626931768
             Q0:     -15.961920470198
             G0:      -0.000000000000
   RMS gradient:       0.000000068049
     Trial step:       1.139347145003
             Q1:     -15.961920470199
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961920470198
  Cubic LS coeff:       1.239672516878
Predicted energy:     -15.961920470199
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.96192047019849 0.00000000000 0.00000005104 1.2397  1.330    8.00000000
      ideal mu1:      -0.560626939593
10    -15.96192047019846 0.00000000000 0.00000007005 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00024564763646              |
           | Maximum change in energy =  0.00025127145119 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36446124E-02     0.12777592E-02
               2       0.73601438E-05     0.31211797E-05
               3       0.36023074E-10     0.16504464E-10
               4       0.97352134E-15     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26281516E-02     0.91034536E-03
               2       0.38947411E-05     0.16128607E-05
               3       0.10127000E-10     0.45242698E-11
               4       0.71900956E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00024564763646
Trial step length           =               0.133498
Gradient along search dir.  =         -0.00034751101
Functional at step 0        =     -15.96192047019846
Functional at step 1        =     -15.96189452800136
Functional predicted        =     -15.96192790865102
Selected quadratic step     =               0.042810
Conjugate gradients coeff.  =               0.103873
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99911164
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000121 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.561178052150
             Q0:     -15.961927742530
             G0:      -0.000001861666
   RMS gradient:       0.000227404778
     Trial step:       1.188451657764
             Q1:     -15.961927177608
 Quadratic coef:       0.000002777421
 Linear coef   :      -0.000002212500
           Qmin:     -15.961928183150
Quadratic minimum step length (  0.473361527743) accepted
    Initial Ne1:       8.00000005
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96192774252970 0.00000000000 0.00017055358 0.4734  0.000    8.00000000
      ideal mu1:      -0.560933755944
             Q0:     -15.961928183083
             G0:      -0.000000113413
   RMS gradient:       0.000056130826
     Trial step:       0.750044860237
             Q1:     -15.961928198847
 Quadratic coef:       0.000000069301
 Linear coef   :      -0.000000085065
           Qmin:     -15.961928209187
Quadratic minimum step length (  0.460328746248) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.96192818308308 0.00000005508 0.00004209812 0.4603  0.061    8.00000000
      ideal mu1:      -0.560935596909
             Q0:     -15.961928209187
             G0:      -0.000000007825
   RMS gradient:       0.000014743536
     Trial step:       0.587594426575
             Q1:     -15.961928212157
 Quadratic coef:       0.000000001628
 Linear coef   :      -0.000000004598
           Qmin:     -15.961928212434
Quadratic minimum step length (  0.829926078118) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -15.96192820918669 0.00000000346 0.00001105765 0.8299  0.069    8.00000000
      ideal mu1:      -0.560934546741
             Q0:     -15.961928212434
             G0:      -0.000000000061
   RMS gradient:       0.000001304030
     Trial step:       0.698326526756
             Q1:     -15.961928212461
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000043
           Qmin:     -15.961928212464
Quadratic minimum step length (  0.962137819783) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.96192821243423 0.00000000044 0.00000097802 0.9621  0.008    8.00000000
      ideal mu1:      -0.560934567226
             Q0:     -15.961928212464
             G0:      -0.000000000038
   RMS gradient:       0.000001020692
     Trial step:       0.819686746233
             Q1:     -15.961928212471
 Quadratic coef:       0.000000000024
 Linear coef   :      -0.000000000031
           Qmin:     -15.961928212474
Quadratic minimum step length (  0.529633974875) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -15.96192821246374 0.00000000000 0.00000076552 0.5296  0.613    8.00000000
      ideal mu1:      -0.560934588274
             Q0:     -15.961928212474
             G0:      -0.000000000000
   RMS gradient:       0.000000053976
     Trial step:       0.658888419658
             Q1:     -15.961928212474
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928212474
  Cubic LS coeff:       0.822472410872
Predicted energy:     -15.961928212474
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -15.96192821247374 0.00000000000 0.00000004048 0.8225  0.003    8.00000000
      ideal mu1:      -0.560934589158
             Q0:     -15.961928212474
             G0:      -0.000000000000
   RMS gradient:       0.000000017103
     Trial step:       0.736150492095
             Q1:     -15.961928212474
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928212474
  Cubic LS coeff:       1.606134712620
Predicted energy:     -15.961928212474
WARNING in lnv_denskernel_optimise_cg: setting cubic step to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.96192821247379 0.00000000000 0.00000001283 0.1500  0.000    8.00000000
      ideal mu1:      -0.560934588940
             Q0:     -15.961928212474
             G0:      -0.000000000000
   RMS gradient:       0.000000013631
     Trial step:       0.332298922379
             Q1:     -15.961928212474
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928212474
  Cubic LS coeff:       0.454157429974
Predicted energy:     -15.961928212474
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96192821247372 0.00000000000 0.00000001022 0.4542  0.635    8.00000000
      ideal mu1:      -0.560934587979
             Q0:     -15.961928212474
             G0:      -0.000000000000
   RMS gradient:       0.000000009652
     Trial step:       0.388479117290
             Q1:     -15.961928212474
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928212474
Quadratic minimum step length (  0.001078940844) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -15.96192821247394 0.00000000000 0.00000000724 0.0011  0.501    8.00000000
      ideal mu1:      -0.560934587978
10    -15.96192821247411 0.00000000000 0.00000000723 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006348443736              |
           | Maximum change in energy =  0.00007356589927 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12940590E-02     0.51488166E-03
               2       0.80997153E-06     0.37166144E-06
               3       0.39651130E-12     0.20172752E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11858291E-02     0.46671967E-03
               2       0.68320631E-06     0.31254226E-06
               3       0.28334612E-12     0.14399593E-12
================================================================================
RMS gradient                =       0.00006348443736
Trial step length           =               0.075598
Gradient along search dir.  =         -0.00002294838
Functional at step 0        =     -15.96192821247411
Functional at step 1        =     -15.96192054672679
Functional predicted        =     -15.96192829251414
Selected quadratic step     =               0.006976
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99987012
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.560997412701
             Q0:     -15.961928289425
             G0:      -0.000000026581
   RMS gradient:       0.000027172930
     Trial step:       0.020473055136
             Q1:     -15.961928289957
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000544
           Qmin:     -15.961928295702
Quadratic minimum step length (  0.472294051897) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96192828942497 0.00000000000 0.00002037970 0.4723  0.000    8.00000000
      ideal mu1:      -0.560968390168
             Q0:     -15.961928295730
             G0:      -0.000000001514
   RMS gradient:       0.000006470817
     Trial step:       0.098332609876
             Q1:     -15.961928295863
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000149
           Qmin:     -15.961928296075
Quadratic minimum step length (  0.455582526448) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.96192829572979 0.00000000078 0.00000485311 0.4556  0.057    8.00000000
      ideal mu1:      -0.560968582238
             Q0:     -15.961928296071
             G0:      -0.000000000093
   RMS gradient:       0.000001615798
     Trial step:       0.211656842175
             Q1:     -15.961928296088
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000020
           Qmin:     -15.961928296109
Quadratic minimum step length (  0.813010140458) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -15.96192829607120 0.00000000005 0.00000121185 0.8130  0.062    8.00000000
      ideal mu1:      -0.560968365687
             Q0:     -15.961928296110
             G0:      -0.000000000001
   RMS gradient:       0.000000174562
     Trial step:       0.414824250720
             Q1:     -15.961928296111
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296111
Quadratic minimum step length (  1.284233978371) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.96192829611049 0.00000000000 0.00000013092 1.2842  0.012    8.00000000
      ideal mu1:      -0.560968549626
             Q0:     -15.961928296111
             G0:      -0.000000000001
   RMS gradient:       0.000000222619
     Trial step:       0.729884509924
             Q1:     -15.961928296111
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -15.961928296111
Quadratic minimum step length (  0.355952933225) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.96192829611061 0.00000000000 0.00000016696 0.3560  1.626    8.00000000
      ideal mu1:      -0.560968513080
             Q0:     -15.961928296111
             G0:      -0.000000000001
   RMS gradient:       0.000000156979
     Trial step:       0.509710243396
             Q1:     -15.961928296111
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296111
Quadratic minimum step length (  0.185279191182) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.96192829611099 0.00000000000 0.00000011773 0.1853  0.497    8.00000000
      ideal mu1:      -0.560968460093
             Q0:     -15.961928296111
             G0:      -0.000000000000
   RMS gradient:       0.000000093237
     Trial step:       0.307308805005
             Q1:     -15.961928296111
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296111
Quadratic minimum step length (  0.058999066187) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.96192829611105 0.00000000000 0.00000006993 0.0590  0.000    8.00000000
      ideal mu1:      -0.560968454389
             Q0:     -15.961928296111
             G0:      -0.000000000001
   RMS gradient:       0.000000086002
     Trial step:       0.134651151226
             Q1:     -15.961928296111
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296111
Quadratic minimum step length (  0.326347105639) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96192829611090 0.00000000000 0.00000006450 0.3263  0.851    8.00000000
      ideal mu1:      -0.560968400537
             Q0:     -15.961928296111
             G0:      -0.000000000000
   RMS gradient:       0.000000045405
     Trial step:       0.209625889321
             Q1:     -15.961928296111
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296111
Quadratic minimum step length (  0.041619631974) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.96192829611101 0.00000000000 0.00000003405 0.0416  0.279    8.00000000
      ideal mu1:      -0.560968400646
10    -15.96192829611102 0.00000000000 0.00000003225 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000296227274              |
           | Maximum change in energy =  0.00000258075855 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.01057003900183 |
           | Pseudopotential (local)    :      -44.09045250671563 |
           | Pseudopotential (non-local):       -1.49134018826248 |
           | Hartree                    :       18.56481283145894 |
           | Exchange-correlation       :       -3.89136771956452 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.96192829611102 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -44.09045250671571 |
           | Hartree                    :       18.56481283145896 |
           --------------------------------------------------------
           Integrated density           :        8.00000000000008
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36260932E-03     0.15949315E-03
               2       0.61136705E-07     0.28285257E-07
               3       0.24469538E-14     0.14432899E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36231007E-03     0.15939851E-03
               2       0.61033036E-07     0.28232714E-07
               3       0.23452998E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.35321983E-06     0.16161019E-06
               2       0.57113479E-13     0.28421709E-13
================================================================================
RMS gradient                =       0.00000296227274
Trial step length           =               0.022964
Gradient along search dir.  =         -0.00000005169
Functional at step 0        =     -15.96192829611102
Functional at step 1        =     -15.96192751962460
Rejected quadratic step     =               0.000018
Functional at new step 1    =     -15.96192829611334
Functional predicted        =     -15.96192829611087
Selected quadratic step     =              -0.000006
Conjugate gradients coeff.  =               0.002177
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000010
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.560968351107
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000056139
     Trial step:       0.093405312300
             Q1:     -15.961928296110
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296110
  Cubic LS coeff:       0.131818393466
Predicted energy:     -15.961928296110
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96192829611008 0.00000000000 0.00000004210 0.1318  0.000    8.00000000
      ideal mu1:      -0.560968363822
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000043329
     Trial step:       0.110961877275
             Q1:     -15.961928296110
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296110
Quadratic minimum step length (  0.037512536274) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -15.96192829611034 0.00000000000 0.00000003250 0.0375  0.596    8.00000000
      ideal mu1:      -0.560968368464
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000038949
     Trial step:       0.064517140717
             Q1:     -15.961928296110
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296110
  Cubic LS coeff:       0.068942360405
Predicted energy:     -15.961928296110
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -15.96192829611021 0.00000000000 0.00000002921 0.0689  0.808    8.00000000
      ideal mu1:      -0.560968379179
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000029839
     Trial step:       0.066693057867
             Q1:     -15.961928296110
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296110
Quadratic minimum step length (  0.002212815017) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.96192829611033 0.00000000000 0.00000002238 0.0022  0.587    8.00000000
      ideal mu1:      -0.560968379449
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000029623
     Trial step:       0.012148226207
             Q1:     -15.961928296110
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296110
Quadratic minimum step length (  0.000107263373) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -15.96192829611043 0.00000000000 0.00000002222 0.0001  0.986    8.00000000
      ideal mu1:      -0.560968379465
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000029609
     Trial step:       0.001141516411
             Q1:     -15.961928296110
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296110
Quadratic minimum step length (  0.000002435878) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.96192829611044 0.00000000000 0.00000002221 0.0000  0.999    8.00000000
      ideal mu1:      -0.560968379465
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000029609
     Trial step:       0.000052731347
             Q1:     -15.961928296110
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296110
  Cubic LS coeff:       0.000061034978
Predicted energy:     -15.961928296110
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -15.96192829611043 0.00000000000 0.00000002221 0.0001  0.000    8.00000000
      ideal mu1:      -0.560968379467
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000029607
     Trial step:       0.000056731443
             Q1:     -15.961928296110
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296110
Quadratic minimum step length (  0.000000000841) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96192829611045 0.00000000000 0.00000002221 0.0000  1.000    8.00000000
      ideal mu1:      -0.560968379467
             Q0:     -15.961928296110
             G0:      -0.000000000000
   RMS gradient:       0.000000029607
     Trial step:       0.000000218402
             Q1:     -15.961928296111
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296110
  Cubic LS coeff:       0.000000274044
Predicted energy:     -15.961928296111
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.96192829611045 0.00000000000 0.00000002221 0.0000  1.000    8.00000000
      ideal mu1:      -0.560968379467
10    -15.96192829611047 0.00000000000 0.00000002221 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000341945949              |
           | Maximum change in energy =  0.00000002787897 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.88285338E-03     0.36853072E-03
               2       0.37007281E-06     0.17019119E-06
               3       0.81347164E-13     0.41411319E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.88228970E-03     0.36852311E-03
               2       0.36954274E-06     0.16989286E-06
               3       0.80723168E-13     0.41411319E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.52685432E-06     0.24106348E-06
               2       0.12709466E-12     0.62616579E-13
================================================================================
RMS gradient                =       0.00000341945949
Trial step length           =               0.022964
Gradient along search dir.  =         -0.00000015647
Functional at step 0        =     -15.96192829611047
Functional at step 1        =     -15.96192406727085
Rejected quadratic step     =               0.000010
Functional at new step 1    =     -15.96192829611347
Functional predicted        =     -15.96192829611008
Selected quadratic step     =              -0.000005
Conjugate gradients coeff.  =               1.332493
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000022
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.560968275276
             Q0:     -15.961928296108
             G0:      -0.000000000000
   RMS gradient:       0.000000065122
     Trial step:       0.000000244646
             Q1:     -15.961928296108
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:       0.000000317891
Predicted energy:     -15.961928296108
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -15.96192829610759 0.00000000000 0.00000004884 0.0000  0.000    8.00000000
      ideal mu1:      -0.560968275276
             Q0:     -15.961928296108
             G0:      -0.000000000000
   RMS gradient:       0.000000065122
     Trial step:       0.000000278874
             Q1:     -15.961928296108
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:      -0.022677387085
Predicted energy:     -15.961939743048
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -15.96192829610763 0.00000000000 0.00000004884-0.0227  1.000    8.00000000
      ideal mu1:      -0.560968269314
             Q0:     -15.961928296108
             G0:      -0.000000000001
   RMS gradient:       0.000000070495
     Trial step:       0.000000278874
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296108
Quadratic minimum step length (  0.000000000000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -15.96192829610756-0.00000000000 0.00000005287 0.0000  1.172    8.00000000
      ideal mu1:      -0.560968269314
             Q0:     -15.961928296108
             G0:      -0.000000000001
   RMS gradient:       0.000000070495
     Trial step:       0.000000000372
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -15.961928296108
Quadratic minimum step length (  0.000000000000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -15.96192829610756 0.00000000000 0.00000005287 0.0000  1.000    8.00000000
      ideal mu1:      -0.560968269314
             Q0:     -15.961928296108
             G0:      -0.000000000001
   RMS gradient:       0.000000070495
     Trial step:       0.000000000000
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:      -0.006149619390
Predicted energy: ********************
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -15.96192829610756 0.00000000000 0.00000005287-0.0061  1.000    8.00000000
      ideal mu1:      -0.560968264750
             Q0:     -15.961928296108
             G0:      -0.000000000001
   RMS gradient:       0.000000074632
     Trial step:       0.000000000000
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.961928296108
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -15.96192829610751-0.00000000000 0.00000005597 0.0000  1.121    8.00000000
      ideal mu1:      -0.560968264750
             Q0:     -15.961928296108
             G0:      -0.000000000000
   RMS gradient:       0.000000074632
     Trial step:       0.000000000000
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.961928296108
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -15.96192829610752 0.00000000000 0.00000005597 0.0000  0.000    8.00000000
      ideal mu1:      -0.560968264750
             Q0:     -15.961928296108
             G0:      -0.000000000000
   RMS gradient:       0.000000074632
     Trial step:       0.000000000000
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.961928296108
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -15.96192829610752 0.00000000000 0.00000005597 0.0000  1.000    8.00000000
      ideal mu1:      -0.560968264750
             Q0:     -15.961928296108
             G0:      -0.000000000001
   RMS gradient:       0.000000074632
     Trial step:       0.000000000000
             Q1:     -15.961928296108
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
  Quadratic term too small: proceeding to cubic fit
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -15.961928296108
  Cubic LS coeff:       0.000000000000
Predicted energy:     -15.961928296108
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -15.96192829610752 0.00000000000 0.00000005597 0.0000  1.000    8.00000000
      ideal mu1:      -0.560968264750
10    -15.96192829610752 0.00000000000 0.00000005597 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000437125921              |
           | Maximum change in energy =  0.00000000000099 / atom  |
           | Criteria satisfied:                                  |
           | -> Energy change per atom lower than set threshold.  |
           | -> Maximum degree of convergence for applied level   |
           |    of density kernel truncation has been reached.    | 
           ========================================================
WARNING: No kernel truncation, yet energy has risen on last 2 iterations.
WARNING: This most likely indicates, a problem with the density kernel.
WARNING: Either kernel occupation numbers may be unreliable, or
WARNING: requested NGWF gradient tolerance may be unachievable.

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.01057105344423 |
           | Pseudopotential (local)    :      -44.09045406135509 |
           | Pseudopotential (non-local):       -1.49134058238687 |
           | Hartree                    :       18.56481398390282 |
           | Exchange-correlation       :       -3.89136793768345 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -15.96192829610752 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -44.09045406135517 |
           | Hartree                    :       18.56481398390272 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999990
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.04644463014359    -15.30508691567494   0.090116    -15.85851513521323
   2     0.01271435820904    -15.86799937114540   0.127448    -15.92780795557566
   3     0.00627621391956    -15.93261963007648   0.153364    -15.95103118542890
   4     0.00391397524374    -15.95209627395707   0.150533    -15.95905634839565
   5     0.00232068166525    -15.95921594612031   0.112672    -15.96094350764827
   6     0.00135957220811    -15.96094595814708   0.143526    -15.96170214319450
   7     0.00076218479757    -15.96169977250064   0.132360    -15.96191779564533
   8     0.00024564763646    -15.96192047019846   0.042810    -15.96192790865102
   9     0.00006348443736    -15.96192821247411   0.006976    -15.96192829251414
  10     0.00000296227274    -15.96192829611102  -0.000006    -15.96192829611087
  11     0.00000341945949    -15.96192829611047  -0.000005    -15.96192829611008
  12     0.00000437125921    -15.96192829610752  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.303430529 Eh
                 Mid-gap level:      -0.088849708 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.152402493   1.0000000
                            2    -0.468356398   1.0000000
                            3    -0.382549196   1.0000000
                            4    -0.240564972   1.0000000
                        .......   --- gap ---   .........
                            5     0.062865557   0.0000000
                            6     0.181360045   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.65185619  -0.09436798  -0.11327026 *
*    H       2     -1.11854351   0.88383251  -1.09790426 *
*    H       3     -1.08295767  -0.75798503   1.22974831 *
*                                                        *
**********************************************************
TOTAL:             -0.54964500   0.03147950   0.01857379
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.51294413  -0.02862441  -0.05930465 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.51294413  -0.02862441  -0.05930465
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00851861  -0.00048026   0.00348579 *
*    H       2      0.00025407   0.00075768  -0.00033629 *
*    H       3      0.00060060  -0.00053165   0.00050797 *
*                                                        *
**********************************************************
TOTAL:              0.00937328  -0.00025423   0.00365747
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00910920   0.00086695  -0.01235780 *
*    H       2     -0.00910920   0.00086695  -0.01235780 *
*    H       3     -0.00910920   0.00086695  -0.01235780 *
*                                                        *
**********************************************************
TOTAL:             -0.02732759   0.00260086  -0.03707339

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.11832124   0.00859109  -0.02222531 *
*    H       2      0.06017938  -0.04697930   0.05427534 *
*    H       3      0.05814185   0.03838820  -0.03205004 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000  -0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     394.907s on      3 node(s)                                    
TOTAL TIME:       394.908s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    48        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.001%  ------ ||
|| pseudopotentials_nonlocal_mat        :    25        0.00s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    25        0.00s   0.001%  ------ ||
|| restart_ngwfs_tightbox_output        :    11        0.00s   0.001%  ------ ||
|| restart_kernel_write                 :    14        0.00s   0.001%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.001%  ------ ||
|| eigenstates_calculate                :     1        0.00s   0.001%  ------ ||
|| sparse_hotelling_invert              :    25        0.01s   0.002%  ------ ||
|| ngwf_gradient_coeffs                 :    12        0.01s   0.002%  ------ ||
|| integrals_grad                       :     1        0.01s   0.003%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.01s   0.003%  ------ ||
|| basis_dot_function_with_box          :  1927        0.01s   0.003%  ------ ||
|| basis_add_function_to_box            :  3840        0.03s   0.006%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.03s   0.009%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.04s   0.009%  ------ ||
|| pseudo_make_structure_factor         :     1        0.07s   0.016%  ------ ||
|| fourier_apply_box_pair               :    82        0.07s   0.018%  16.344 ||
|| basis_copy_function_to_box           :   880        0.07s   0.018%  ------ ||
|| lnv_gradient_norm                    :   120        0.07s   0.018%  ------ ||
|| density_initial_guess_real           :     1        0.08s   0.020%  ------ ||
|| kernel_fix                           :   120        0.09s   0.022%  ------ ||
|| kernel_purify                        :   390        0.10s   0.025%  ------ ||
|| sparse_trace                         :  3452        0.11s   0.027%  ------ ||
|| integrals_kinetic                    :    25        0.12s   0.031%  ------ ||
|| density_batch_row_sums               :   272        0.12s   0.031%  ------ ||
|| sparse_product                       :  4304        0.18s   0.046%  ------ ||
|| projectors_gradient_batch            :    12        0.19s   0.048%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.22s   0.055%  ------ ||
|| projectors_func_ovlp_box             :    25        0.27s   0.069%  ------ ||
|| projectors_init_fftbox_recip         :    40        0.30s   0.076%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.31s   0.078%  ------ ||
|| forces_calculate                     :     1        0.41s   0.103%  ------ ||
|| integrals_locpot_mat_els_batch       :   131        0.64s   0.163%  ------ ||
|| ngwf_gradient_batch                  :    12        1.28s   0.324%  ------ ||
|| properties_calculate                 :     1        1.43s   0.363%  ------ ||
|| ngwf_gradient_lnv                    :    12        1.48s   0.375%  ------ ||
|| cell_grid_extract_box                :   596        1.76s   0.444%  ------ ||
|| hamiltonian_energy_components        :     3        4.63s   1.174%  ------ ||
|| cell_grid_deposit_box                :  1089        5.36s   1.358%  ------ ||
|| density_fftbox_deposit_to_cell       :  1088        5.37s   1.359%  ------ ||
|| fourier_apply_box                    :  2028        5.48s   1.387%  25.866 ||
|| density_fftbox_interpolate_multiply  :  1088        5.54s   1.403%  ------ ||
|| potential_apply_to_ngwf_batch        :   131        6.03s   1.526%  ------ ||
|| integrals_locpot_dbl_grid            :   131        6.69s   1.695%  ------ ||
|| density_batch_interp_deposit         :   272       11.39s   2.884%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       12.28s   3.108%  ------ ||
|| density_on_dbl_grid                  :   272       13.24s   3.354%  ------ ||
|| hartree_on_grid                      :   272       56.38s  14.277%  ------ ||
|| fourier_apply_cell_backward          :  1361      118.55s  30.021%   4.654 ||
|| fourier_apply_cell_forward           :  1361      176.77s  44.763%   3.122 ||
|| xc_energy_potential                  :   272      299.67s  75.885%  ------ ||
|| lnv_denskernel_optimise_cg           :    12      354.41s  89.746%  ------ ||
|| ngwf_cg_optimise                     :     1      378.79s  95.918%  ------ ||
|| total_time                           :     1      394.91s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 16:49 (-0000)

