 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 23:09 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 7.5                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   63 x  63 x  63
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):     88    88    88
         Recip-space ('23') slabs/node (min max mean):     44    45    44
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1844     12436
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  797    0.0094221106    7.5000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   31    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1   -9.6858120265   -7.1215576683   10.1554500691   -2.4512393152
  2  -15.2607215100   -3.1699830246   13.3432400702   -3.1729506849
  3  -15.5226130663   -3.0498171082   13.4730933038   -3.2096441449
  4  -15.5412857985   -3.0635564842   13.4589520444   -3.2100305306
  5  -15.5650814237   -3.0579709550   13.4651908321   -3.2130754421
  6  -15.5715313429   -3.0580892438   13.4651635450   -3.2137550426
  7  -15.5747249954   -3.0577771364   13.4655387656   -3.2141277036
  8  -15.5758951846   -3.0577573562   13.4655763328   -3.2142552575
  9  -15.5763895725   -3.0577425523   13.4655988592   -3.2143096666
 10  -15.5765848221   -3.0577430708   13.4656010064   -3.2143305257
 11  -15.5766645869   -3.0577439766   13.4656011370   -3.2143389776
 12  -15.5766966994   -3.0577449472   13.4656005458   -3.2143423247
 13  -15.5767097390   -3.0577455025   13.4656001342   -3.2143436707
 14  -15.5767150202   -3.0577458016   13.4655998885   -3.2143442103
 15  -15.5767171650   -3.0577459485   13.4655997619   -3.2143444278
 16  -15.5767180362   -3.0577460182   13.4655996997   -3.2143445156
 17  -15.5767183906   -3.0577460503   13.4655996705   -3.2143445512
 18  -15.5767185348   -3.0577460648   13.4655996572   -3.2143445656
 19  -15.5767185936   -3.0577460712   13.4655996512   -3.2143445715
Atom SCF converged after  19 iterations to a total energy of    -15.57671859

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20313439E+01     0.84998474E+00
               2       0.18163349E+01     0.72703070E+00
               3       0.15675252E+01     0.56704189E+00
               4       0.13270798E+01     0.49044648E+00
               5       0.11252132E+01     0.42328296E+00
               6       0.88510101E+00     0.33332642E+00
               7       0.55405431E+00     0.20816700E+00
               8       0.21734447E+00     0.81234677E-01
               9       0.33573607E-01     0.12394571E-01
              10       0.81290306E-03     0.31227987E-03
              11       0.50078000E-06     0.21119720E-06
              12       0.21350116E-12     0.96589403E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.74038690783901    0.5867727
               2          -1.81792421513084    0.5763439
               3          -1.91756362852710    0.5600792
               4          -2.03369808738304    0.5388740
               5          -2.14483421183664    0.5189496
               6          -2.21797870686146    0.5066225
               7          -2.24365269726359    0.5008365
               8          -2.24695992732909    0.5000067
               9          -2.24702489283531    0.5000005
              10          -2.24702491991366    0.9274778
              11          -2.24702491991367    0.9274778
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999994]
Closest occupancy to 0.5:     0.99999999999999
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.456071986745=    -16.456071986745+      0.000000000000
    Trial step:       1.000000000000
            G0:      -3.944049282913
WARNING: minimum value of charge density: -0.0861
      Q1=E1+P1:      55.446586108810=    -20.317337764688+     75.763923873498
Quadratic term:     -75.846707378468
   Linear term:      -3.944049282913
  Optimal step:       0.026000135136
 Predicted min:     -16.507344893915
    !!! Quadratic minimum step length accepted !!!
 1    -16.45607198674549 0.33099384364 0.03545330086 0.0260  0.000    8.00000000
      Q0=E0+P0:     -16.547424371541=    -16.558529095629+      0.011104724089
    Trial step:       0.161245574004
            G0:      -0.024212274732
      Q1=E1+P1:     -16.551201379550=    -16.562483040094+      0.011281660544
Quadratic term:      -0.000127114128
   Linear term:      -0.003904122137
  Optimal step:       2.476209467652
 Predicted min:     -16.577401703504
    !!! Quadratic minimum step length accepted !!!
 2    -16.55852909562948 0.25687416159 0.03670551790 2.4762 -0.769    8.00000000
      Q0=E0+P0:     -16.572763873177=    -16.600638572689+      0.027874699511
    Trial step:       0.631884338282
            G0:      -2.245471253457
WARNING: minimum value of charge density: -0.0007
      Q1=E1+P1:      -6.998175592030=    -18.426372021466+     11.428196429436
Quadratic term:     -10.993466398269
   Linear term:      -1.418878117122
  Optimal step:       0.040777259313
 Predicted min:     -16.618545954968
    !!! Quadratic minimum step length accepted !!!
 3    -16.60063857268852 0.25082703375 0.03112109129 0.0408  3.119    8.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.721969516368
   Final penalty energy   :       0.077268018590
   RMS occupancy error    :       0.056741
   Occupancy bounds       : [-0.070, 1.078]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.056741 (step -0.4135 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002004 (step -0.4995 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.554896866184
             Q0:     -16.465500727201
             G0:      -0.054576543446
   RMS gradient:       0.038936038521
     Trial step:       0.500000000000
             Q1:     -16.470814751775
 Quadratic coef:       0.021974247149
 Linear coef   :      -0.027288271723
           Qmin:     -16.473972573455
Quadratic minimum step length (  0.310457413382) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001107 (step -0.4978 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.46550072720070 0.00000000000 0.02920202885 0.3105  0.000    8.00000000
      ideal mu1:      -0.518840175741
             Q0:     -16.473970521494
             G0:      -0.000391510125
   RMS gradient:       0.003291151996
     Trial step:       0.393990744423
             Q1:     -16.474080574231
 Quadratic coef:       0.000044198629
 Linear coef   :      -0.000154251366
           Qmin:     -16.474105104198
Quadratic minimum step length (  0.687505612078) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000069 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.47397052149416 0.00105898078 0.00246836400 0.6875  0.007    8.00000000
      ideal mu1:      -0.518028569846
             Q0:     -16.474105163783
             G0:      -0.000046686999
   RMS gradient:       0.001138468646
     Trial step:       0.520452541446
             Q1:     -16.474119450262
 Quadratic coef:       0.000010011888
 Linear coef   :      -0.000024298367
           Qmin:     -16.474119906523
Quadratic minimum step length (  0.631556555133) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.47410516378321 0.00001701000 0.00085385149 0.6316  0.120    8.00000000
      ideal mu1:      -0.519029790943
             Q0:     -16.474119904942
             G0:      -0.000001187430
   RMS gradient:       0.000181704802
     Trial step:       0.573319469568
             Q1:     -16.474119996416
 Quadratic coef:       0.000000589303
 Linear coef   :      -0.000000680777
           Qmin:     -16.474120101554
Quadratic minimum step length (  0.331156083636) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.47411990494183 0.00000206764 0.00013627860 0.3312  0.025    8.00000000
      ideal mu1:      -0.518881489662
             Q0:     -16.474120101548
             G0:      -0.000000042127
   RMS gradient:       0.000034207962
     Trial step:       0.435727242911
             Q1:     -16.474120116016
 Quadratic coef:       0.000000003888
 Linear coef   :      -0.000000018356
           Qmin:     -16.474120123215
Quadratic minimum step length (  1.028627879410) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.47412010154844 0.00000002526 0.00002565597 1.0286  0.035    8.00000000
      ideal mu1:      -0.518881356187
             Q0:     -16.474120123213
             G0:      -0.000000003498
   RMS gradient:       0.000009858040
     Trial step:       0.669478296793
             Q1:     -16.474120123956
 Quadratic coef:       0.000000001599
 Linear coef   :      -0.000000002342
           Qmin:     -16.474120124070
Quadratic minimum step length (  0.490289888721) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.47412012321261 0.00000000281 0.00000739353 0.4903  0.083    8.00000000
      ideal mu1:      -0.518884597293
             Q0:     -16.474120124070
             G0:      -0.000000000343
   RMS gradient:       0.000003087038
     Trial step:       0.572920971545
             Q1:     -16.474120124136
 Quadratic coef:       0.000000000131
 Linear coef   :      -0.000000000197
           Qmin:     -16.474120124144
Quadratic minimum step length (  0.431331364621) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.47412012407003 0.00000000012 0.00000231528 0.4313  0.000    8.00000000
      ideal mu1:      -0.518883270068
             Q0:     -16.474120124144
             G0:      -0.000000000032
   RMS gradient:       0.000000941602
     Trial step:       0.497110434890
             Q1:     -16.474120124153
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000016
           Qmin:     -16.474120124153
Quadratic minimum step length (  0.539443200394) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.47412012414399 0.00000000001 0.00000070620 0.5394  0.093    8.00000000
      ideal mu1:      -0.518883871015
             Q0:     -16.474120124153
             G0:      -0.000000000002
   RMS gradient:       0.000000262153
     Trial step:       0.517844420600
             Q1:     -16.474120124153
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.474120124153
Quadratic minimum step length (  0.534127858048) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.47412012415280 0.00000000000 0.00000019661 0.5341  0.078    8.00000000
      ideal mu1:      -0.518883680302
10    -16.47412012415335 0.00000000000 0.00000009390 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00936479100831              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22016939E-01     0.14278020E-01
               2       0.28066984E-03     0.19497694E-03
               3       0.49235974E-07     0.36517076E-07
               4       0.17787229E-14     0.14432899E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28378834E-01     0.17781526E-01
               2       0.46115897E-03     0.30073014E-03
               3       0.12986466E-06     0.85918193E-07
               4       0.10277909E-13     0.67723605E-14
================================================================================
RMS gradient                =       0.00936479100831
Trial step length           =               0.122474
Gradient along search dir.  =         -2.12293721240
Functional at step 0        =     -16.47412012415335
Functional at step 1        =     -16.66940622266897
Functional predicted        =     -16.73525813582438
Selected quadratic step     =               0.246016
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.12011754
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010200 (step -0.4829 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000067 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.528996549103
             Q0:     -16.735134019119
             G0:      -0.024196828807
   RMS gradient:       0.025925549821
     Trial step:       0.525923122877
             Q1:     -16.740521107832
 Quadratic coef:       0.007338583056
 Linear coef   :      -0.012725671770
           Qmin:     -16.740650844395
Quadratic minimum step length (  0.455995727423) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001042 (step -0.4980 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.73513401911885 0.00000000000 0.01944416239 0.4560  0.000    8.00000000
      ideal mu1:      -0.501831946128
             Q0:     -16.740654977920
             G0:      -0.001649299124
   RMS gradient:       0.006742578011
     Trial step:       0.489712871982
             Q1:     -16.741031246212
 Quadratic coef:       0.000431414719
 Linear coef   :      -0.000807683011
           Qmin:     -16.741033008512
Quadratic minimum step length (  0.458413620991) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000209 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.74065497792043 0.00068960316 0.00505693351 0.4584  0.068    8.00000000
      ideal mu1:      -0.505826307836
             Q0:     -16.741033621919
             G0:      -0.000217981202
   RMS gradient:       0.002458365160
     Trial step:       0.473804865838
             Q1:     -16.741099529830
 Quadratic coef:       0.000037372643
 Linear coef   :      -0.000103280554
           Qmin:     -16.741104976739
Quadratic minimum step length (  0.654687834130) accepted
    Initial Ne1:       8.00000009
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000075 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.74103362191874 0.00005078805 0.00184377385 0.6547  0.133    8.00000000
      ideal mu1:      -0.504903514329
             Q0:     -16.741105061901
             G0:      -0.000001538989
   RMS gradient:       0.000206598291
     Trial step:       0.556950878818
             Q1:     -16.741105551583
 Quadratic coef:       0.000000367460
 Linear coef   :      -0.000000857141
           Qmin:     -16.741105561746
Quadratic minimum step length (  0.649575513974) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.74110506190108 0.00001021805 0.00015494872 0.6496  0.007    8.00000000
      ideal mu1:      -0.505092926893
             Q0:     -16.741105561746
             G0:      -0.000000506624
   RMS gradient:       0.000118632895
     Trial step:       0.601482878697
             Q1:     -16.741105695530
 Quadratic coef:       0.000000170942
 Linear coef   :      -0.000000304726
           Qmin:     -16.741105697549
Quadratic minimum step length (  0.536108848831) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.74110556174609 0.00000006308 0.00008897467 0.5361  0.330    8.00000000
      ideal mu1:      -0.505005568264
             Q0:     -16.741105697549
             G0:      -0.000000018988
   RMS gradient:       0.000022965703
     Trial step:       0.567855874047
             Q1:     -16.741105701786
 Quadratic coef:       0.000000006545
 Linear coef   :      -0.000000010782
           Qmin:     -16.741105701990
Quadratic minimum step length (  0.467751070850) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.74110569754890 0.00000002263 0.00001722428 0.4678  0.037    8.00000000
      ideal mu1:      -0.505014048733
             Q0:     -16.741105701990
             G0:      -0.000000001714
   RMS gradient:       0.000006899794
     Trial step:       0.515378689096
             Q1:     -16.741105702408
 Quadratic coef:       0.000000000465
 Linear coef   :      -0.000000000883
           Qmin:     -16.741105702409
Quadratic minimum step length (  0.489169039714) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.74110570198979 0.00000000058 0.00000517485 0.4892  0.000    8.00000000
      ideal mu1:      -0.505009803858
             Q0:     -16.741105702409
             G0:      -0.000000000284
   RMS gradient:       0.000002811173
     Trial step:       0.502102876345
             Q1:     -16.741105702487
 Quadratic coef:       0.000000000065
 Linear coef   :      -0.000000000143
           Qmin:     -16.741105702487
Quadratic minimum step length (  0.551838837310) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.74110570240884 0.00000000005 0.00000210838 0.5518  0.166    8.00000000
      ideal mu1:      -0.505011739215
             Q0:     -16.741105702488
             G0:      -0.000000000013
   RMS gradient:       0.000000605263
     Trial step:       0.526383764465
             Q1:     -16.741105702490
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000007
           Qmin:     -16.741105702490
Quadratic minimum step length (  0.435107235848) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.74110570248751 0.00000000001 0.00000045395 0.4351  0.046    8.00000000
      ideal mu1:      -0.505011382675
10    -16.74110570249032 0.00000000000 0.00000016303 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00257604958412              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11451791E-01     0.62954820E-02
               2       0.78556125E-04     0.45945878E-04
               3       0.41658574E-08     0.26048395E-08
               4       0.10799722E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15674326E-01     0.88179471E-02
               2       0.14296620E-03     0.84358336E-04
               3       0.13131321E-07     0.82229963E-08
               4       0.87783652E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00257604958412
Trial step length           =               0.173582
Gradient along search dir.  =         -0.16426430834
Functional at step 0        =     -16.74110570249032
Functional at step 1        =     -16.76298205289309
Functional predicted        =     -16.77173002099297
Selected quadratic step     =               0.372866
Conjugate gradients coeff.  =               0.075668
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05273932
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004354 (step -0.4924 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514941323165
             Q0:     -16.771493394234
             G0:      -0.006858965819
   RMS gradient:       0.013803145594
     Trial step:       0.478574325211
             Q1:     -16.772778516456
 Quadratic coef:       0.001997402716
 Linear coef   :      -0.003282524938
           Qmin:     -16.772842016858
Quadratic minimum step length (  0.393243722119) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000228 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77149339423422 0.00000000000 0.01035235918 0.3932  0.000    8.00000000
      ideal mu1:      -0.499597174323
             Q0:     -16.772841691556
             G0:      -0.000369170208
   RMS gradient:       0.003199402166
     Trial step:       0.433816031235
             Q1:     -16.772927452527
 Quadratic coef:       0.000074390983
 Linear coef   :      -0.000160151954
           Qmin:     -16.772927886977
Quadratic minimum step length (  0.466968459984) accepted
    Initial Ne1:       8.00000022
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000042 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77284169155554 0.00016857783 0.00239955198 0.4670  0.054    8.00000000
      ideal mu1:      -0.500159614887
             Q0:     -16.772927919145
             G0:      -0.000015634242
   RMS gradient:       0.000658685307
     Trial step:       0.450087107150
             Q1:     -16.772933025816
 Quadratic coef:       0.000001930100
 Linear coef   :      -0.000007036771
           Qmin:     -16.772934332821
Quadratic minimum step length (  0.820465230674) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77292791914510 0.00001137174 0.00049401398 0.8205  0.042    8.00000000
      ideal mu1:      -0.500052157186
             Q0:     -16.772934333676
             G0:      -0.000000011136
   RMS gradient:       0.000017586280
     Trial step:       0.607684804970
             Q1:     -16.772934336359
 Quadratic coef:       0.000000004084
 Linear coef   :      -0.000000006767
           Qmin:     -16.772934336479
Quadratic minimum step length (  0.503455686060) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77293433367618 0.00000083838 0.00001318971 0.5035  0.001    8.00000000
      ideal mu1:      -0.500068362342
             Q0:     -16.772934336480
             G0:      -0.000000002632
   RMS gradient:       0.000008550915
     Trial step:       0.553120574915
             Q1:     -16.772934337325
 Quadratic coef:       0.000000000610
 Linear coef   :      -0.000000001456
           Qmin:     -16.772934337348
Quadratic minimum step length (  0.659850922838) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77293433647967 0.00000000035 0.00000641319 0.6599  0.236    8.00000000
      ideal mu1:      -0.500063093634
             Q0:     -16.772934337348
             G0:      -0.000000000094
   RMS gradient:       0.000001619177
     Trial step:       0.604133364249
             Q1:     -16.772934337364
 Quadratic coef:       0.000000000041
 Linear coef   :      -0.000000000057
           Qmin:     -16.772934337368
Quadratic minimum step length (  0.418489906250) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77293433734807 0.00000000013 0.00000121438 0.4185  0.036    8.00000000
      ideal mu1:      -0.500063532391
             Q0:     -16.772934337368
             G0:      -0.000000000004
   RMS gradient:       0.000000323643
     Trial step:       0.502815786314
             Q1:     -16.772934337369
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.772934337369
Quadratic minimum step length (  0.944874609468) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77293433736763 0.00000000000 0.00000024273 0.9449  0.000    8.00000000
      ideal mu1:      -0.500063216679
             Q0:     -16.772934337368
             G0:      -0.000000000001
   RMS gradient:       0.000000296560
     Trial step:       0.689273436111
             Q1:     -16.772934337368
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.772934337368
Quadratic minimum step length (  0.444490889860) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77293433736816 0.00000000000 0.00000022242 0.4445  0.840    8.00000000
      ideal mu1:      -0.500063302861
             Q0:     -16.772934337368
             G0:      -0.000000000002
   RMS gradient:       0.000000212254
     Trial step:       0.553512206707
             Q1:     -16.772934337369
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.772934337369
Quadratic minimum step length (  0.526371758070) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77293433736838 0.00000000000 0.00000015919 0.5264  0.512    8.00000000
      ideal mu1:      -0.500063467777
10    -16.77293433736899 0.00000000000 0.00000011805 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00114996697056              |
           | Maximum change in energy =  0.08899519277899 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11838646E-01     0.49108194E-02
               2       0.90106219E-04     0.36731621E-04
               3       0.61760893E-08     0.26139150E-08
               4       0.82966243E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.55808764E-02     0.23080845E-02
               2       0.19728176E-04     0.78719821E-05
               3       0.28722462E-09     0.11899526E-09
               4       0.74260278E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00114996697056
Trial step length           =               0.254407
Gradient along search dir.  =         -0.03329907902
Functional at step 0        =     -16.77293433736899
Functional at step 1        =     -16.77841016390249
Functional predicted        =     -16.77892349330963
Selected quadratic step     =               0.359719
Conjugate gradients coeff.  =               0.199279
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02038610
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001701 (step -0.4969 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511911050061
             Q0:     -16.778886576312
             G0:      -0.001196665193
   RMS gradient:       0.005765474813
     Trial step:       0.539771426956
             Q1:     -16.779065939922
 Quadratic coef:       0.000466562068
 Linear coef   :      -0.000645925679
           Qmin:     -16.779110137126
Quadratic minimum step length (  0.373639703428) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000034 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77888657631152 0.00000000000 0.00432410611 0.3736  0.000    8.00000000
      ideal mu1:      -0.505567613816
             Q0:     -16.779109988619
             G0:      -0.000045659698
   RMS gradient:       0.001126081052
     Trial step:       0.449088004612
             Q1:     -16.779121729439
 Quadratic coef:       0.000008764403
 Linear coef   :      -0.000020505223
           Qmin:     -16.779121982139
Quadratic minimum step length (  0.525343793645) accepted
    Initial Ne1:       7.99999991
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77910998861904 0.00002794510 0.00084456078 0.5253  0.038    8.00000000
      ideal mu1:      -0.505503601654
             Q0:     -16.779121983869
             G0:      -0.000002142311
   RMS gradient:       0.000243882307
     Trial step:       0.485721726942
             Q1:     -16.779122724392
 Quadratic coef:       0.000000300044
 Linear coef   :      -0.000001040567
           Qmin:     -16.779122886053
Quadratic minimum step length (  0.842253105439) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77912198386868 0.00000155668 0.00018291173 0.8423  0.047    8.00000000
      ideal mu1:      -0.505488005148
             Q0:     -16.779122886074
             G0:      -0.000000003716
   RMS gradient:       0.000010159901
     Trial step:       0.639609750470
             Q1:     -16.779122887573
 Quadratic coef:       0.000000000877
 Linear coef   :      -0.000000002377
           Qmin:     -16.779122887683
Quadratic minimum step length (  0.866355839421) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77912288607359 0.00000011832 0.00000761993 0.8664  0.002    8.00000000
      ideal mu1:      -0.505489541541
             Q0:     -16.779122887683
             G0:      -0.000000001046
   RMS gradient:       0.000005391232
     Trial step:       0.744398846231
             Q1:     -16.779122887892
 Quadratic coef:       0.000000000570
 Linear coef   :      -0.000000000779
           Qmin:     -16.779122887949
Quadratic minimum step length (  0.508512845794) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77912288768292 0.00000000020 0.00000404342 0.5085  0.282    8.00000000
      ideal mu1:      -0.505488687579
             Q0:     -16.779122887949
             G0:      -0.000000000022
   RMS gradient:       0.000000779187
     Trial step:       0.615253098897
             Q1:     -16.779122887957
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000013
           Qmin:     -16.779122887957
Quadratic minimum step length (  0.714426575070) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77912288794899 0.00000000004 0.00000058439 0.7144  0.021    8.00000000
      ideal mu1:      -0.505489023079
             Q0:     -16.779122887957
             G0:      -0.000000000002
   RMS gradient:       0.000000228609
     Trial step:       0.662988057393
             Q1:     -16.779122887957
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.779122887957
Quadratic minimum step length (  0.348469714773) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77912288795713 0.00000000000 0.00000017146 0.3485  0.000    8.00000000
      ideal mu1:      -0.505488853255
             Q0:     -16.779122887957
             G0:      -0.000000000000
   RMS gradient:       0.000000087120
     Trial step:       0.480657111940
             Q1:     -16.779122887957
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779122887957
Quadratic minimum step length (  0.243608479715) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77912288795717 0.00000000000 0.00000006534 0.2436  0.145    8.00000000
      ideal mu1:      -0.505488841315
             Q0:     -16.779122887957
             G0:      -0.000000000000
   RMS gradient:       0.000000063501
     Trial step:       0.342187300033
             Q1:     -16.779122887957
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779122887957
Quadratic minimum step length (  0.082073554746) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77912288795734 0.00000000000 0.00000004763 0.0821  0.531    8.00000000
      ideal mu1:      -0.505488843949
10    -16.77912288795754 0.00000000000 0.00000004020 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00063127438244              |
           | Maximum change in energy =  0.01060954495956 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12127946E-01     0.42028218E-02
               2       0.10027105E-03     0.35393942E-04
               3       0.77056459E-08     0.29889683E-08
               4       0.11316971E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54988407E-02     0.19991939E-02
               2       0.20216528E-04     0.68841616E-05
               3       0.29963793E-09     0.11132142E-09
               4       0.91353126E-15     0.66613381E-15
================================================================================
RMS gradient                =       0.00063127438244
Trial step length           =               0.302514
Gradient along search dir.  =         -0.00997941558
Functional at step 0        =     -16.77912288795754
Functional at step 1        =     -16.78105490671988
Functional predicted        =     -16.78121918809645
Selected quadratic step     =               0.420125
Conjugate gradients coeff.  =               0.301346
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00873724
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000722 (step -0.4984 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514301819973
             Q0:     -16.781210359319
             G0:      -0.000285867593
   RMS gradient:       0.002817936565
     Trial step:       0.167584390987
             Q1:     -16.781248413929
 Quadratic coef:       0.000009852337
 Linear coef   :      -0.000047906947
           Qmin:     -16.781268596150
Quadratic minimum step length (  0.407439195035) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78121035931931 0.00000000000 0.00211345242 0.4074  0.000    8.00000000
      ideal mu1:      -0.511051733972
             Q0:     -16.781268631636
             G0:      -0.000015588035
   RMS gradient:       0.000657654497
     Trial step:       0.261305280016
             Q1:     -16.781271689492
 Quadratic coef:       0.000001015380
 Linear coef   :      -0.000004073236
           Qmin:     -16.781272716622
Quadratic minimum step length (  0.524118130510) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78126863163565 0.00000727960 0.00049324087 0.5241  0.054    8.00000000
      ideal mu1:      -0.511102107258
             Q0:     -16.781272717382
             G0:      -0.000000933950
   RMS gradient:       0.000161039146
     Trial step:       0.370074093736
             Q1:     -16.781272986776
 Quadratic coef:       0.000000076236
 Linear coef   :      -0.000000345631
           Qmin:     -16.781273109126
Quadratic minimum step length (  0.838896388889) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78127271738200 0.00000053898 0.00012077936 0.8389  0.060    8.00000000
      ideal mu1:      -0.511088177581
             Q0:     -16.781273109129
             G0:      -0.000000000799
   RMS gradient:       0.000004710742
     Trial step:       0.557183830397
             Q1:     -16.781273109352
 Quadratic coef:       0.000000000222
 Linear coef   :      -0.000000000445
           Qmin:     -16.781273109352
Quadratic minimum step length (  0.558293573646) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78127310912899 0.00000005209 0.00000353306 0.5583  0.001    8.00000000
      ideal mu1:      -0.511088218637
             Q0:     -16.781273109352
             G0:      -0.000000000170
   RMS gradient:       0.000002174291
     Trial step:       0.557738426012
             Q1:     -16.781273109414
 Quadratic coef:       0.000000000033
 Linear coef   :      -0.000000000095
           Qmin:     -16.781273109421
Quadratic minimum step length (  0.809202783175) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78127310935220 0.00000000003 0.00000163072 0.8092  0.213    8.00000000
      ideal mu1:      -0.511088288632
             Q0:     -16.781273109421
             G0:      -0.000000000007
   RMS gradient:       0.000000443666
     Trial step:       0.671806137671
             Q1:     -16.781273109424
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.781273109424
Quadratic minimum step length (  0.725035677069) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78127310942130 0.00000000001 0.00000033275 0.7250  0.042    8.00000000
      ideal mu1:      -0.511088225125
             Q0:     -16.781273109424
             G0:      -0.000000000000
   RMS gradient:       0.000000061595
     Trial step:       0.697913617782
             Q1:     -16.781273109424
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.781273109424
Quadratic minimum step length (  0.292588808113) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78127310942400 0.00000000000 0.00000004620 0.2926  0.000    8.00000000
      ideal mu1:      -0.511088248746
             Q0:     -16.781273109424
             G0:      -0.000000000000
   RMS gradient:       0.000000037237
     Trial step:       0.451886837154
             Q1:     -16.781273109424
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.781273109424
Quadratic minimum step length (  0.056372634292) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.78127310942395 0.00000000000 0.00000002793 0.0564  0.365    8.00000000
      ideal mu1:      -0.511088251312
             Q0:     -16.781273109424
             G0:      -0.000000000000
   RMS gradient:       0.000000033373
     Trial step:       0.159605925368
             Q1:     -16.781273109424
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.781273109424
Quadratic minimum step length (  0.031320676582) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.78127310942387 0.00000000000 0.00000002503 0.0313  0.803    8.00000000
      ideal mu1:      -0.511088252745
10    -16.78127310942378 0.00000000000 0.00000002288 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00038071918338              |
           | Maximum change in energy =  0.00206285019618 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.89203805113887 |
           | Pseudopotential (local)    :      -46.12742737282067 |
           | Pseudopotential (non-local):       -3.20237561157935 |
           | Hartree                    :       19.85363323570909 |
           | Exchange-correlation       :       -4.13299065984255 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.78127310942378 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.12742737282154 |
           | Hartree                    :       19.85363323570947 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999783
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56377147E-02     0.19609360E-02
               2       0.22689859E-04     0.84556266E-05
               3       0.43789142E-09     0.17253013E-09
               4       0.71296135E-15     0.33306691E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.62220067E-03     0.20694648E-03
               2       0.27384751E-06     0.98494285E-07
               3       0.61821370E-13     0.23647750E-13
================================================================================
RMS gradient                =       0.00038071918338
Trial step length           =               0.356502
Gradient along search dir.  =         -0.00350873437
Functional at step 0        =     -16.78127310942378
Functional at step 1        =     -16.78182915429923
Functional predicted        =     -16.78183608422124
Selected quadratic step     =               0.320899
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99855755
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000161 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511933534346
             Q0:     -16.781835894283
             G0:      -0.000002320408
   RMS gradient:       0.000253881402
     Trial step:       0.070703363208
             Q1:     -16.781836047836
 Quadratic coef:       0.000000010508
 Linear coef   :      -0.000000164061
           Qmin:     -16.781836534634
Quadratic minimum step length (  0.551929369831) accepted
    Initial Ne1:       7.99999961
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78183589428341 0.00000000000 0.00019041103 0.5519  0.000    8.00000000
      ideal mu1:      -0.511667340970
             Q0:     -16.781836534766
             G0:      -0.000000145724
   RMS gradient:       0.000063613026
     Trial step:       0.197543065433
             Q1:     -16.781836558363
 Quadratic coef:       0.000000005189
 Linear coef   :      -0.000000028787
           Qmin:     -16.781836574688
Quadratic minimum step length (  0.547915225022) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78183653476596 0.00000008004 0.00004770977 0.5479  0.063    8.00000000
      ideal mu1:      -0.511710631397
             Q0:     -16.781836574687
             G0:      -0.000000027752
   RMS gradient:       0.000027765166
     Trial step:       0.328993697733
             Q1:     -16.781836581386
 Quadratic coef:       0.000000002431
 Linear coef   :      -0.000000009130
           Qmin:     -16.781836583259
Quadratic minimum step length (  0.617703867208) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78183657468732 0.00000000531 0.00002082387 0.6177  0.191    8.00000000
      ideal mu1:      -0.511697730322
             Q0:     -16.781836583258
             G0:      -0.000000000140
   RMS gradient:       0.000001974646
     Trial step:       0.450800043674
             Q1:     -16.781836583288
 Quadratic coef:       0.000000000033
 Linear coef   :      -0.000000000063
           Qmin:     -16.781836583288
Quadratic minimum step length (  0.427230833199) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78183658325782 0.00000000129 0.00000148098 0.4272  0.005    8.00000000
      ideal mu1:      -0.511698220214
             Q0:     -16.781836583288
             G0:      -0.000000000007
   RMS gradient:       0.000000451186
     Trial step:       0.438857241327
             Q1:     -16.781836583290
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.781836583290
Quadratic minimum step length (  0.623445088998) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78183658328814 0.00000000000 0.00000033839 0.6234  0.052    8.00000000
      ideal mu1:      -0.511698198892
             Q0:     -16.781836583291
             G0:      -0.000000000002
   RMS gradient:       0.000000175266
     Trial step:       0.523071115506
             Q1:     -16.781836583292
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.781836583292
Quadratic minimum step length (  0.516751536658) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.78183658329123 0.00000000000 0.00000013145 0.5168  0.151    8.00000000
      ideal mu1:      -0.511698179726
             Q0:     -16.781836583292
             G0:      -0.000000000000
   RMS gradient:       0.000000077263
     Trial step:       0.519901724097
             Q1:     -16.781836583292
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.781836583292
Quadratic minimum step length (  0.681259172872) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78183658329166 0.00000000000 0.00000005795 0.6813  0.000    8.00000000
      ideal mu1:      -0.511698195547
             Q0:     -16.781836583292
             G0:      -0.000000000000
   RMS gradient:       0.000000038915
     Trial step:       0.595136806569
             Q1:     -16.781836583292
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.781836583292
  Cubic LS coeff:       2.347366863845
Predicted energy:     -16.781836583292
WARNING in lnv_denskernel_optimise_cg: setting cubic step to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.78183658329177 0.00000000000 0.00000002919 0.1500  0.254    8.00000000
      ideal mu1:      -0.511698193630
             Q0:     -16.781836583292
             G0:      -0.000000000000
   RMS gradient:       0.000000030779
     Trial step:       0.298781727998
             Q1:     -16.781836583292
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.781836583292
  Cubic LS coeff:       0.598304683457
Predicted energy:     -16.781836583292
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78183658329174 0.00000000000 0.00000002308 0.5983  0.626    8.00000000
      ideal mu1:      -0.511698181148
10    -16.78183658329187 0.00000000000 0.00000001815 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00025309231615              |
           | Maximum change in energy =  0.00071674048875 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.79258855E-02     0.26106925E-02
               2       0.43776259E-04     0.15341928E-04
               3       0.15478519E-08     0.58705678E-09
               4       0.76637724E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.33546956E-02     0.11789993E-02
               2       0.76957918E-05     0.27770688E-05
               3       0.45273348E-10     0.16299295E-10
               4       0.78697855E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00025309231615
Trial step length           =               0.338232
Gradient along search dir.  =         -0.00155175215
Functional at step 0        =     -16.78183658329187
Functional at step 1        =     -16.78216712220058
Functional predicted        =     -16.78219099746045
Selected quadratic step     =               0.456792
Conjugate gradients coeff.  =               0.441925
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99798366
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000227 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514217910776
             Q0:     -16.782190406097
             G0:      -0.000009940443
   RMS gradient:       0.000525474464
     Trial step:       0.422803154189
             Q1:     -16.782192578365
 Quadratic coef:       0.000002030583
 Linear coef   :      -0.000004202851
           Qmin:     -16.782192580837
Quadratic minimum step length (  0.437553839163) accepted
    Initial Ne1:       7.99999960
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78219040609709 0.00000000000 0.00039410575 0.4376  0.000    8.00000000
      ideal mu1:      -0.513583038749
             Q0:     -16.782192580858
             G0:      -0.000000674241
   RMS gradient:       0.000136844665
     Trial step:       0.430115267488
             Q1:     -16.782192760361
 Quadratic coef:       0.000000110498
 Linear coef   :      -0.000000290001
           Qmin:     -16.782192771134
Quadratic minimum step length (  0.564415479923) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78219258085755 0.00000027184 0.00010263350 0.5644  0.068    8.00000000
      ideal mu1:      -0.513598763736
             Q0:     -16.782192771137
             G0:      -0.000000058035
   RMS gradient:       0.000040149692
     Trial step:       0.492710579470
             Q1:     -16.782192791097
 Quadratic coef:       0.000000008634
 Linear coef   :      -0.000000028594
           Qmin:     -16.782192794811
Quadratic minimum step length (  0.815845546379) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78219277113726 0.00000002540 0.00003011227 0.8158  0.086    8.00000000
      ideal mu1:      -0.513596429648
             Q0:     -16.782192794813
             G0:      -0.000000000040
   RMS gradient:       0.000001047463
     Trial step:       0.634015561255
             Q1:     -16.782192794827
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000025
           Qmin:     -16.782192794828
Quadratic minimum step length (  0.755990231535) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78219279481271 0.00000000323 0.00000078560 0.7560  0.001    8.00000000
      ideal mu1:      -0.513596534793
             Q0:     -16.782192794827
             G0:      -0.000000000012
   RMS gradient:       0.000000569723
     Trial step:       0.692321869473
             Q1:     -16.782192794831
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000008
           Qmin:     -16.782192794831
Quadratic minimum step length (  0.635745992673) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78219279482745 0.00000000000 0.00000042729 0.6357  0.296    8.00000000
      ideal mu1:      -0.513596511987
             Q0:     -16.782192794831
             G0:      -0.000000000000
   RMS gradient:       0.000000048742
     Trial step:       0.663431122391
             Q1:     -16.782192794831
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782192794831
Quadratic minimum step length (  0.412257747980) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78219279483101 0.00000000000 0.00000003656 0.4123  0.007    8.00000000
      ideal mu1:      -0.513596519383
             Q0:     -16.782192794831
             G0:      -0.000000000000
   RMS gradient:       0.000000019380
     Trial step:       0.522976692078
             Q1:     -16.782192794831
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782192794831
  Cubic LS coeff:       0.789732742939
Predicted energy:     -16.782192794831
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78219279483094 0.00000000000 0.00000001453 0.7897  0.000    8.00000000
      ideal mu1:      -0.513596516378
             Q0:     -16.782192794831
             G0:      -0.000000000000
   RMS gradient:       0.000000005248
     Trial step:       0.642659954819
             Q1:     -16.782192794831
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782192794831
  Cubic LS coeff:       0.904040801688
Predicted energy:     -16.782192794831
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.78219279483113 0.00000000000 0.00000000394 0.9040  0.073    8.00000000
      ideal mu1:      -0.513596519044
             Q0:     -16.782192794831
             G0:      -0.000000000000
   RMS gradient:       0.000000002444
     Trial step:       0.762227538709
             Q1:     -16.782192794831
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782192794831
Quadratic minimum step length (  0.000689408941) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78219279483119 0.00000000000 0.00000000183 0.0007  0.217    8.00000000
      ideal mu1:      -0.513596519041
10    -16.78219279483115 0.00000000000 0.00000000183 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00017239058942              |
           | Maximum change in energy =  0.00018782462270 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11010334E-01     0.38111491E-02
               2       0.82487010E-04     0.29428558E-04
               3       0.51476219E-08     0.18327473E-08
               4       0.93785499E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63061467E-03     0.23198945E-03
               2       0.26734981E-06     0.10074364E-06
               3       0.51830863E-13     0.18207658E-13
================================================================================
RMS gradient                =       0.00017239058942
Trial step length           =               0.393067
Gradient along search dir.  =         -0.00072265146
Functional at step 0        =     -16.78219279483115
Functional at step 1        =     -16.78232747376200
Functional predicted        =     -16.78232783507579
Selected quadratic step     =               0.373735
Conjugate gradients coeff.  =               0.463948
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99869945
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000130 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.516016109363
             Q0:     -16.782327733211
             G0:      -0.000017126628
   RMS gradient:       0.000689738837
     Trial step:       0.022923491879
             Q1:     -16.782328114632
 Quadratic coef:       0.000000011181
 Linear coef   :      -0.000000392602
           Qmin:     -16.782331179647
Quadratic minimum step length (  0.402465245550) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78232773321117 0.00000000000 0.00051730408 0.4025  0.000    8.00000000
      ideal mu1:      -0.515218181361
             Q0:     -16.782331180611
             G0:      -0.000000617325
   RMS gradient:       0.000130921802
     Trial step:       0.096051594406
             Q1:     -16.782331235054
 Quadratic coef:       0.000000004852
 Linear coef   :      -0.000000059295
           Qmin:     -16.782331361779
Quadratic minimum step length (  0.586944678561) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78233118061091 0.00000043080 0.00009819135 0.5869  0.036    8.00000000
      ideal mu1:      -0.515194301141
             Q0:     -16.782331361799
             G0:      -0.000000036400
   RMS gradient:       0.000031795479
     Trial step:       0.237438354534
             Q1:     -16.782331369305
 Quadratic coef:       0.000000001136
 Linear coef   :      -0.000000008643
           Qmin:     -16.782331378231
Quadratic minimum step length (  0.902833799209) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78233136179891 0.00000002347 0.00002384661 0.9028  0.059    8.00000000
      ideal mu1:      -0.515193002979
             Q0:     -16.782331378237
             G0:      -0.000000000005
   RMS gradient:       0.000000365247
     Trial step:       0.462998241576
             Q1:     -16.782331378238
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.782331378238
Quadratic minimum step length (  0.407155502250) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78233137823677 0.00000000218 0.00000027394 0.4072  0.000    8.00000000
      ideal mu1:      -0.515192865149
             Q0:     -16.782331378238
             G0:      -0.000000000001
   RMS gradient:       0.000000131851
     Trial step:       0.434180010583
             Q1:     -16.782331378238
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782331378238
Quadratic minimum step length (  0.151309095425) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78233137823800 0.00000000000 0.00000009889 0.1513  0.130    8.00000000
      ideal mu1:      -0.515192864622
             Q0:     -16.782331378238
             G0:      -0.000000000001
   RMS gradient:       0.000000107577
     Trial step:       0.256311109109
             Q1:     -16.782331378238
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782331378238
Quadratic minimum step length (  0.537161620303) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.78233137823801 0.00000000000 0.00000008068 0.5372  0.666    8.00000000
      ideal mu1:      -0.515192886014
             Q0:     -16.782331378238
             G0:      -0.000000000000
   RMS gradient:       0.000000043788
     Trial step:       0.371053218111
             Q1:     -16.782331378238
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782331378238
Quadratic minimum step length (  0.030397901779) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78233137823821 0.00000000000 0.00000003284 0.0304  0.000    8.00000000
      ideal mu1:      -0.515192885518
             Q0:     -16.782331378238
             G0:      -0.000000000000
   RMS gradient:       0.000000041603
     Trial step:       0.106203763017
             Q1:     -16.782331378238
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782331378238
  Cubic LS coeff:       0.174132525572
Predicted energy:     -16.782331378238
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78233137823808 0.00000000000 0.00000003120 0.1741  0.903    8.00000000
      ideal mu1:      -0.515192880353
             Q0:     -16.782331378238
             G0:      -0.000000000000
   RMS gradient:       0.000000020056
     Trial step:       0.135990916901
             Q1:     -16.782331378238
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782331378238
Quadratic minimum step length (  0.000703288689) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78233137823834 0.00000000000 0.00000001504 0.0007  0.232    8.00000000
      ideal mu1:      -0.515192880348
10    -16.78233137823812 0.00000000000 0.00000001502 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00008253059172              |
           | Maximum change in energy =  0.00011873717976 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.67092377E-02     0.21944016E-02
               2       0.30974306E-04     0.10658823E-04
               3       0.74791021E-09     0.27143318E-09
               4       0.86102294E-15     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22593168E-02     0.77500351E-03
               2       0.34829680E-05     0.12458863E-05
               3       0.91968166E-11     0.32487207E-11
               4       0.68069303E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00008253059172
Trial step length           =               0.383280
Gradient along search dir.  =         -0.00016916342
Functional at step 0        =     -16.78233137823812
Functional at step 1        =     -16.78234954586654
Functional predicted        =     -16.78235389746155
Selected quadratic step     =               0.266242
Conjugate gradients coeff.  =               0.229194
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99913694
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000090 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.516102186053
             Q0:     -16.782353844620
             G0:      -0.000006330879
   RMS gradient:       0.000419353979
     Trial step:       0.009779615212
             Q1:     -16.782353905810
 Quadratic coef:       0.000000000723
 Linear coef   :      -0.000000061914
           Qmin:     -16.782355169823
Quadratic minimum step length (  0.418647396445) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78235384461961 0.00000000000 0.00031451548 0.4186  0.000    8.00000000
      ideal mu1:      -0.515605397525
             Q0:     -16.782355170991
             G0:      -0.000000258816
   RMS gradient:       0.000084748484
     Trial step:       0.063986017587
             Q1:     -16.782355186578
 Quadratic coef:       0.000000000974
 Linear coef   :      -0.000000016561
           Qmin:     -16.782355241373
Quadratic minimum step length (  0.543879015752) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78235517099113 0.00000016565 0.00006356136 0.5439  0.041    8.00000000
      ideal mu1:      -0.515598626862
             Q0:     -16.782355241399
             G0:      -0.000000009955
   RMS gradient:       0.000016626142
     Trial step:       0.186549329312
             Q1:     -16.782355243077
 Quadratic coef:       0.000000000179
 Linear coef   :      -0.000000001857
           Qmin:     -16.782355246215
Quadratic minimum step length (  0.967417225667) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78235524139903 0.00000000917 0.00001246961 0.9674  0.038    8.00000000
      ideal mu1:      -0.515596401565
             Q0:     -16.782355246213
             G0:      -0.000000000006
   RMS gradient:       0.000000406765
     Trial step:       0.424818825634
             Q1:     -16.782355246214
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.782355246214
Quadratic minimum step length (  0.373421742836) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78235524621296 0.00000000063 0.00000030507 0.3734  0.001    8.00000000
      ideal mu1:      -0.515596271472
             Q0:     -16.782355246214
             G0:      -0.000000000001
   RMS gradient:       0.000000129529
     Trial step:       0.398292086612
             Q1:     -16.782355246214
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782355246214
  Cubic LS coeff:       0.638591691901
Predicted energy:     -16.782355246214
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78235524621397 0.00000000000 0.00000009715 0.6386  0.101    8.00000000
      ideal mu1:      -0.515596254957
             Q0:     -16.782355246214
             G0:      -0.000000000000
   RMS gradient:       0.000000088183
     Trial step:       0.504327292004
             Q1:     -16.782355246215
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782355246214
  Cubic LS coeff:       0.735134153843
Predicted energy:     -16.782355246215
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.78235524621412 0.00000000000 0.00000006614 0.7351  0.463    8.00000000
      ideal mu1:      -0.515596289065
             Q0:     -16.782355246214
             G0:      -0.000000000000
   RMS gradient:       0.000000032196
     Trial step:       0.608890973055
             Q1:     -16.782355246214
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782355246214
Quadratic minimum step length (  0.139079865255) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.78235524621442 0.00000000000 0.00000002415 0.1391  0.000    8.00000000
      ideal mu1:      -0.515596284749
             Q0:     -16.782355246214
             G0:      -0.000000000000
   RMS gradient:       0.000000026392
     Trial step:       0.291005969849
             Q1:     -16.782355246214
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782355246214
Quadratic minimum step length (  0.045214582497) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78235524621441 0.00000000000 0.00000001979 0.0452  0.672    8.00000000
      ideal mu1:      -0.515596282926
             Q0:     -16.782355246214
             G0:      -0.000000000000
   RMS gradient:       0.000000023742
     Trial step:       0.114707076638
             Q1:     -16.782355246214
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782355246214
Quadratic minimum step length (  0.019741532165) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78235524621436 0.00000000000 0.00000001781 0.0197  0.809    8.00000000
      ideal mu1:      -0.515596281994
10    -16.78235524621424 0.00000000000 0.00000001671 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00004120235414              |
           | Maximum change in energy =  0.00004619446899 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.24927146E-02     0.86409665E-03
               2       0.45125506E-05     0.16373191E-05
               3       0.18028205E-10     0.68186290E-11
               4       0.11174007E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.37260974E-03     0.12341346E-03
               2       0.99615170E-07     0.34844813E-07
               3       0.84072625E-14     0.29976022E-14
================================================================================
RMS gradient                =       0.00004120235414
Trial step length           =               0.319445
Gradient along search dir.  =         -0.00004109463
Functional at step 0        =     -16.78235524621424
Functional at step 1        =     -16.78236257537973
Functional predicted        =     -16.78236267642234
Selected quadratic step     =               0.361615
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99884510
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000120 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515967037646
             Q0:     -16.782362541861
             G0:      -0.000002422440
   RMS gradient:       0.000259403165
     Trial step:       0.047586693970
             Q1:     -16.782362651079
 Quadratic coef:       0.000000006057
 Linear coef   :      -0.000000115276
           Qmin:     -16.782363090300
Quadratic minimum step length (  0.452798986412) accepted
    Initial Ne1:       8.00000005
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78236254186059 0.00000000000 0.00019455237 0.4528  0.000    8.00000000
      ideal mu1:      -0.515650382843
             Q0:     -16.782363090374
             G0:      -0.000000120993
   RMS gradient:       0.000057967614
     Trial step:       0.146789668562
             Q1:     -16.782363105503
 Quadratic coef:       0.000000002632
 Linear coef   :      -0.000000017761
           Qmin:     -16.782363120333
Quadratic minimum step length (  0.495204024143) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78236309037442 0.00000006855 0.00004347571 0.4952  0.050    8.00000000
      ideal mu1:      -0.515658348318
             Q0:     -16.782363120332
             G0:      -0.000000003120
   RMS gradient:       0.000009310154
     Trial step:       0.269612378378
             Q1:     -16.782363121063
 Quadratic coef:       0.000000000110
 Linear coef   :      -0.000000000841
           Qmin:     -16.782363121934
Quadratic minimum step length (  1.026956017767) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78236312033217 0.00000000393 0.00000698262 1.0270  0.026    8.00000000
      ideal mu1:      -0.515656253830
             Q0:     -16.782363121932
             G0:      -0.000000000007
   RMS gradient:       0.000000443574
     Trial step:       0.526193932347
             Q1:     -16.782363121935
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.782363121935
Quadratic minimum step length (  0.770069313477) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78236312193237 0.00000000021 0.00000033268 0.7701  0.002    8.00000000
      ideal mu1:      -0.515656306238
             Q0:     -16.782363121935
             G0:      -0.000000000002
   RMS gradient:       0.000000259900
     Trial step:       0.636557774470
             Q1:     -16.782363121935
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.782363121935
Quadratic minimum step length (  0.521032110414) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78236312193487 0.00000000000 0.00000019493 0.5210  0.343    8.00000000
      ideal mu1:      -0.515656311675
             Q0:     -16.782363121936
             G0:      -0.000000000000
   RMS gradient:       0.000000053124
     Trial step:       0.575905409449
             Q1:     -16.782363121936
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782363121936
Quadratic minimum step length (  0.258709180924) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78236312193569 0.00000000000 0.00000003984 0.2587  0.042    8.00000000
      ideal mu1:      -0.515656311582
             Q0:     -16.782363121936
             G0:      -0.000000000000
   RMS gradient:       0.000000019205
     Trial step:       0.385994840339
             Q1:     -16.782363121936
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782363121936
Quadratic minimum step length (  0.010708008065) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78236312193561 0.00000000000 0.00000001440 0.0107  0.000    8.00000000
      ideal mu1:      -0.515656311591
             Q0:     -16.782363121936
             G0:      -0.000000000000
   RMS gradient:       0.000000018829
     Trial step:       0.064290247031
             Q1:     -16.782363121935
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782363121936
Quadratic minimum step length (  0.000198687789) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78236312193568 0.00000000000 0.00000001412 0.0002  0.961    8.00000000
      ideal mu1:      -0.515656311591
             Q0:     -16.782363121936
             G0:      -0.000000000000
   RMS gradient:       0.000000018815
     Trial step:       0.003574029526
             Q1:     -16.782363121936
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782363121936
  Cubic LS coeff:       0.005902892795
Predicted energy:     -16.782363121936
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78236312193557 0.00000000000 0.00000001411 0.0059  0.999    8.00000000
      ideal mu1:      -0.515656311606
10    -16.78236312193557 0.00000000000 0.00000001366 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001997510124              |
           | Maximum change in energy =  0.00000795599204 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87580172940765 |
           | Pseudopotential (local)    :      -46.08342986945267 |
           | Pseudopotential (non-local):       -3.20019692625040 |
           | Hartree                    :       19.81601980124281 |
           | Exchange-correlation       :       -4.12640710485381 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.78236312193557 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08342986945321 |
           | Hartree                    :       19.81601980124317 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999863
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.102279E-04
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19185595E-02     0.70888931E-03
               2       0.27585165E-05     0.10367166E-05
               3       0.71941656E-11     0.27494257E-11
               4       0.71317330E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.58262304E-03     0.22019522E-03
               2       0.24948216E-06     0.95460728E-07
               3       0.58972874E-13     0.23092639E-13
================================================================================
RMS gradient                =       0.00001997510124
Trial step length           =               0.339876
Gradient along search dir.  =         -0.00000965871
Functional at step 0        =     -16.78236312193557
Functional at step 1        =     -16.78236395144997
Functional predicted        =     -16.78236422012655
Selected quadratic step     =               0.227399
Conjugate gradients coeff.  =              -0.235036
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00078020
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000075 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515467407044
             Q0:     -16.782364157446
             G0:      -0.000000367077
   RMS gradient:       0.000100978104
     Trial step:       0.004593159386
             Q1:     -16.782364159123
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000001686
           Qmin:     -16.782364237558
Quadratic minimum step length (  0.436486894448) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78236415744589 0.00000000000 0.00007573358 0.4365  0.000    8.00000000
      ideal mu1:      -0.515588957003
             Q0:     -16.782364237230
             G0:      -0.000000016143
   RMS gradient:       0.000021219406
     Trial step:       0.044775594646
             Q1:     -16.782364237920
 Quadratic coef:       0.000000000033
 Linear coef   :      -0.000000000723
           Qmin:     -16.782364241217
Quadratic minimum step length (  0.493961451880) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78236423723000 0.00000001001 0.00001591455 0.4940  0.044    8.00000000
      ideal mu1:      -0.515587104503
             Q0:     -16.782364241240
             G0:      -0.000000000240
   RMS gradient:       0.000002575503
     Trial step:       0.148719258135
             Q1:     -16.782364241273
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000036
           Qmin:     -16.782364241373
Quadratic minimum step length (  1.114003716406) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78236424123957 0.00000000052 0.00000193163 1.1140  0.015    8.00000000
      ideal mu1:      -0.515587568300
             Q0:     -16.782364241370
             G0:      -0.000000000002
   RMS gradient:       0.000000260456
     Trial step:       0.407030473385
             Q1:     -16.782364241370
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.782364241370
Quadratic minimum step length (  0.438367610214) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.78236424136957 0.00000000002 0.00000019534 0.4384  0.010    8.00000000
      ideal mu1:      -0.515587617043
             Q0:     -16.782364241370
             G0:      -0.000000000001
   RMS gradient:       0.000000112791
     Trial step:       0.422408541464
             Q1:     -16.782364241370
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782364241370
  Cubic LS coeff:       0.685656971680
Predicted energy:     -16.782364241370
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78236424137004 0.00000000000 0.00000008459 0.6857  0.188    8.00000000
      ideal mu1:      -0.515587566368
             Q0:     -16.782364241370
             G0:      -0.000000000000
   RMS gradient:       0.000000051732
     Trial step:       0.538170383199
             Q1:     -16.782364241370
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782364241370
Quadratic minimum step length (  0.070656784478) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78236424137048 0.00000000000 0.00000003880 0.0707  0.210    8.00000000
      ideal mu1:      -0.515587563342
             Q0:     -16.782364241370
             G0:      -0.000000000000
   RMS gradient:       0.000000043999
     Trial step:       0.195000996864
             Q1:     -16.782364241370
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782364241370
  Cubic LS coeff:       0.202171958330
Predicted energy:     -16.782364241370
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78236424137040 0.00000000000 0.00000003300 0.2022  0.000    8.00000000
      ideal mu1:      -0.515587559346
             Q0:     -16.782364241371
             G0:      -0.000000000000
   RMS gradient:       0.000000025763
     Trial step:       0.198554107014
             Q1:     -16.782364241370
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782364241371
Quadratic minimum step length (  0.005633651539) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78236424137056 0.00000000000 0.00000001932 0.0056  0.343    8.00000000
      ideal mu1:      -0.515587559271
             Q0:     -16.782364241370
             G0:      -0.000000000000
   RMS gradient:       0.000000025334
     Trial step:       0.033445248551
             Q1:     -16.782364241370
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782364241370
  Cubic LS coeff:       0.048327227218
Predicted energy:     -16.782364241371
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78236424137043 0.00000000000 0.00000001900 0.0483  0.967    8.00000000
      ideal mu1:      -0.515587558337
10    -16.78236424137041 0.00000000000 0.00000001479 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000915947644              |
           | Maximum change in energy =  0.00000262524044 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.24606108E-02     0.84674508E-03
               2       0.44803621E-05     0.16006019E-05
               3       0.18191403E-10     0.67251760E-11
               4       0.73730003E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23761726E-02     0.81622271E-03
               2       0.41743880E-05     0.14892658E-05
               3       0.15772857E-10     0.58264227E-11
               4       0.72293181E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16896749E-06     0.60586793E-07
               2       0.21382241E-13     0.77854390E-14
================================================================================
RMS gradient                =       0.00000915947644
Trial step length           =               0.278007
Gradient along search dir.  =         -0.00000199058
Functional at step 0        =     -16.78236424137041
Functional at step 1        =     -16.78235733191947
Rejected quadratic step     =               0.010308
Functional at new step 1    =     -16.78236425165071
Functional predicted        =     -16.78236425165075
Selected quadratic step     =               0.010329
Conjugate gradients coeff.  =              -0.210263
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99995785
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515598849487
             Q0:     -16.782364251473
             G0:      -0.000000001247
   RMS gradient:       0.000005885764
     Trial step:       0.040203434257
             Q1:     -16.782364251521
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000050
           Qmin:     -16.782364251747
Quadratic minimum step length (  0.439148820118) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.78236425147287 0.00000000000 0.00000441432 0.4391  0.000    8.00000000
      ideal mu1:      -0.515591659464
             Q0:     -16.782364251740
             G0:      -0.000000000054
   RMS gradient:       0.000001239036
     Trial step:       0.132873212946
             Q1:     -16.782364251747
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000007
           Qmin:     -16.782364251755
Quadratic minimum step length (  0.530152647304) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78236425174035 0.00000000003 0.00000092928 0.5302  0.044    8.00000000
      ideal mu1:      -0.515591873028
             Q0:     -16.782364251754
             G0:      -0.000000000001
   RMS gradient:       0.000000187432
     Trial step:       0.265411163291
             Q1:     -16.782364251754
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782364251754
Quadratic minimum step length (  0.176847853947) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78236425175380 0.00000000000 0.00000014057 0.1768  0.023    8.00000000
      ideal mu1:      -0.515591849576
             Q0:     -16.782364251754
             G0:      -0.000000000001
   RMS gradient:       0.000000144908
     Trial step:       0.216650397280
             Q1:     -16.782364251754
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782364251754
  Cubic LS coeff:       0.286459764134
Predicted energy:     -16.782364251754
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78236425175387 0.00000000000 0.00000010868 0.2865  0.598    8.00000000
      ideal mu1:      -0.515591805262
             Q0:     -16.782364251754
             G0:      -0.000000000000
   RMS gradient:       0.000000067733
     Trial step:       0.249121700589
             Q1:     -16.782364251754
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782364251754
Quadratic minimum step length (  0.043979085448) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78236425175420 0.00000000000 0.00000005080 0.0440  0.218    8.00000000
      ideal mu1:      -0.515591806260
             Q0:     -16.782364251754
             G0:      -0.000000000000
   RMS gradient:       0.000000063201
     Trial step:       0.104671603394
             Q1:     -16.782364251754
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782364251754
Quadratic minimum step length (  0.006495898934) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78236425175439 0.00000000000 0.00000004740 0.0065  0.871    8.00000000
      ideal mu1:      -0.515591806738
             Q0:     -16.782364251754
             G0:      -0.000000000000
   RMS gradient:       0.000000062163
     Trial step:       0.026075585457
             Q1:     -16.782364251754
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782364251754
  Cubic LS coeff:       0.024480044177
Predicted energy:     -16.782364251754
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78236425175421 0.00000000000 0.00000004662 0.0245  0.000    8.00000000
      ideal mu1:      -0.515591808020
             Q0:     -16.782364251754
             G0:      -0.000000000000
   RMS gradient:       0.000000060457
     Trial step:       0.025265222816
             Q1:     -16.782364251754
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.782364251754
Quadratic minimum step length (  0.005829084625) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78236425175429 0.00000000000 0.00000004534 0.0058  0.946    8.00000000
      ideal mu1:      -0.515591808593
             Q0:     -16.782364251754
             G0:      -0.000000000000
   RMS gradient:       0.000000059685
     Trial step:       0.012135613782
             Q1:     -16.782364251754
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.782364251754
  Cubic LS coeff:       0.016641890643
Predicted energy:     -16.782364251754
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78236425175422 0.00000000000 0.00000004476 0.0166  0.975    8.00000000
      ideal mu1:      -0.515591810967
10    -16.78236425175428 0.00000000000 0.00000004235 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000111513624              |
           | Maximum change in energy =  0.00000037314494 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87624605510745 |
           | Pseudopotential (local)    :      -46.08409358231460 |
           | Pseudopotential (non-local):       -3.20042950563702 |
           | Hartree                    :       19.81656505658196 |
           | Exchange-correlation       :       -4.12650152346291 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.78236425175428 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08409358231569 |
           | Hartree                    :       19.81656505658243 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999888
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.00936479100831    -16.47412012415335   0.246016    -16.73525813582438
   2     0.00257604958412    -16.74110570249032   0.372866    -16.77173002099297
   3     0.00114996697056    -16.77293433736899   0.359719    -16.77892349330963
   4     0.00063127438244    -16.77912288795754   0.420125    -16.78121918809645
   5     0.00038071918338    -16.78127310942378   0.320899    -16.78183608422124
   6     0.00025309231615    -16.78183658329187   0.456792    -16.78219099746045
   7     0.00017239058942    -16.78219279483115   0.373735    -16.78232783507579
   8     0.00008253059172    -16.78233137823812   0.266242    -16.78235389746155
   9     0.00004120235414    -16.78235524621424   0.361615    -16.78236267642234
  10     0.00001997510124    -16.78236312193557   0.227399    -16.78236422012655
  11     0.00000915947644    -16.78236424137041   0.010329    -16.78236425165075
  12     0.00000111513624    -16.78236425175428  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.316327703 Eh
                 Mid-gap level:      -0.103611615 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.969096014   1.0000000
                            2    -0.472113259   1.0000000
                            3    -0.359382504   1.0000000
                            4    -0.261775467   1.0000000
                        .......   --- gap ---   .........
                            5     0.054552236   0.0000000
                            6     0.143287266   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49760899  -0.08670943  -0.08438299 *
*    H       2     -1.16906180   0.92216007  -1.13144145 *
*    H       3     -1.12897034  -0.78729059   1.26734603 *
*                                                        *
**********************************************************
TOTAL:             -0.80042316   0.04816004   0.05152159
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77755881  -0.04444790  -0.02762846 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77755881  -0.04444790  -0.02762846
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00320506  -0.00025334  -0.00186185 *
*    H       2      0.00019945  -0.00000714   0.00002740 *
*    H       3      0.00019894  -0.00001906  -0.00008953 *
*                                                        *
**********************************************************
TOTAL:              0.00360346  -0.00027954  -0.00192398
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00642029   0.00114420   0.00732305 *
*    H       2     -0.00642029   0.00114420   0.00732305 *
*    H       3     -0.00642029   0.00114420   0.00732305 *
*                                                        *
**********************************************************
TOTAL:             -0.01926088   0.00343260   0.02196915

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01595620   0.00037582   0.01330967 *
*    H       2      0.00691757  -0.00969381   0.00142100 *
*    H       3      0.00903863   0.00931799  -0.01473067 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000  -0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1329.267s on      3 node(s)                                    
TOTAL TIME:      1329.269s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    48        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    24        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    14        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.000%  ------ ||
|| integrals_brappd_ketppd              :    24        0.01s   0.001%  ------ ||
|| restart_ngwfs_tightbox_output        :    11        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    12        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    24        0.01s   0.001%  ------ ||
|| basis_dot_function_with_box          :  1914        0.05s   0.004%  ------ ||
|| integrals_grad                       :     1        0.08s   0.006%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.08s   0.006%  ------ ||
|| lnv_gradient_norm                    :   120        0.08s   0.006%  ------ ||
|| kernel_fix                           :   120        0.09s   0.007%  ------ ||
|| basis_add_function_to_box            :  3768        0.10s   0.007%  ------ ||
|| kernel_purify                        :   386        0.10s   0.008%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.16s   0.012%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.16s   0.012%  ------ ||
|| sparse_trace                         :  3324        0.16s   0.012%  ------ ||
|| sparse_product                       :  4218        0.19s   0.015%  ------ ||
|| pseudo_make_structure_factor         :     1        0.21s   0.016%  ------ ||
|| density_initial_guess_real           :     1        0.22s   0.017%  ------ ||
|| basis_copy_function_to_box           :   866        0.49s   0.037%  ------ ||
|| density_batch_row_sums               :   266        0.58s   0.044%  ------ ||
|| fourier_apply_box_pair               :    81        0.59s   0.045%   9.199 ||
|| pseudopotentials_local_on_grid       :     1        0.71s   0.054%  ------ ||
|| integrals_kinetic                    :    24        0.89s   0.067%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.91s   0.068%  ------ ||
|| projectors_func_ovlp_box             :    24        1.31s   0.098%  ------ ||
|| projectors_init_fftbox_recip         :    39        1.31s   0.099%  ------ ||
|| forces_calculate                     :     1        1.40s   0.106%  ------ ||
|| projectors_gradient_batch            :    12        1.41s   0.106%  ------ ||
|| integrals_locpot_mat_els_batch       :   131        4.17s   0.314%  ------ ||
|| properties_calculate                 :     1        5.37s   0.404%  ------ ||
|| ngwf_gradient_batch                  :    12        8.73s   0.657%  ------ ||
|| ngwf_gradient_lnv                    :    12        9.52s   0.716%  ------ ||
|| cell_grid_extract_box                :   596       11.08s   0.834%  ------ ||
|| hamiltonian_energy_components        :     3       16.36s   1.231%  ------ ||
|| cell_grid_deposit_box                :  1065       33.58s   2.526%  ------ ||
|| density_fftbox_deposit_to_cell       :  1064       33.59s   2.527%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       34.67s   2.608%  ------ ||
|| density_fftbox_interpolate_multiply  :  1064       36.31s   2.731%  ------ ||
|| fourier_apply_box                    :  2001       37.07s   2.788%  17.693 ||
|| potential_apply_to_ngwf_batch        :   131       39.48s   2.970%  ------ ||
|| integrals_locpot_dbl_grid            :   131       43.71s   3.289%  ------ ||
|| density_batch_interp_deposit         :   266       73.96s   5.564%  ------ ||
|| density_on_dbl_grid                  :   266       83.74s   6.300%  ------ ||
|| hartree_on_grid                      :   266      200.32s  15.070%  ------ ||
|| fourier_apply_cell_backward          :  1331      462.05s  34.760%   3.214 ||
|| fourier_apply_cell_forward           :  1331      496.61s  37.360%   2.990 ||
|| xc_energy_potential                  :   266      932.30s  70.137%  ------ ||
|| lnv_denskernel_optimise_cg           :    12     1194.65s  89.873%  ------ ||
|| ngwf_cg_optimise                     :     1     1281.38s  96.398%  ------ ||
|| total_time                           :     1     1329.27s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 23:31 (-0000)

