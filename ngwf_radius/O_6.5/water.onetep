 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 22:21 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.5                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   63 x  63 x  63
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):     88    88    88
         Recip-space ('23') slabs/node (min max mean):     44    45    44
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1844     10420
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  691    0.0094202899    6.5000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   27    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1  156.2426390831   -7.1212636752   10.1554501077   -2.4512393265
  2   51.1696719455   -3.1612488651   13.3454313402   -3.1734343107
  3   19.0614273493   -3.0196987269   13.4967140353   -3.2127847843
  4    2.4317574328   -2.9948006489   13.5238763439   -3.2220205520
  5   -6.2092391494   -2.9867662716   13.5327577923   -3.2257938465
  6  -10.7019445083   -2.9831831724   13.5367421658   -3.2276658894
  7  -13.0380780209   -2.9814547785   13.5386699930   -3.2286255684
  8  -14.2528554859   -2.9806076529   13.5396170470   -3.2291193456
  9  -14.8845378525   -2.9801909005   13.5400839642   -3.2293734592
 10  -15.2130128371   -2.9799856775   13.5403143939   -3.2295042670
 11  -15.3838203172   -2.9798846187   13.5404281278   -3.2295716384
 12  -15.4726406285   -2.9798348778   13.5404842464   -3.2296063629
 13  -15.5188274853   -2.9798104145   13.5405119206   -3.2296242758
 14  -15.5428448404   -2.9797983949   13.5405255577   -3.2296335247
 15  -15.5553339817   -2.9797924959   13.5405322719   -3.2296383047
 16  -15.5618284049   -2.9797896045   13.5405355743   -3.2296407774
 17  -15.5652055459   -2.9797881894   13.5405371969   -3.2296420579
 18  -15.5669616830   -2.9797874978   13.5405379933   -3.2296427216
 19  -15.5678748879   -2.9797871604   13.5405383836   -3.2296430659
 20  -15.5683497622   -2.9797869961   13.5405385746   -3.2296432448
 21  -15.5685967012   -2.9797869162   13.5405386680   -3.2296433378
 22  -15.5687251119   -2.9797868775   13.5405387135   -3.2296433862
 23  -15.5687918869   -2.9797868588   13.5405387357   -3.2296434114
 24  -15.5688266106   -2.9797868498   13.5405387465   -3.2296434245
 25  -15.5688446674   -2.9797868454   13.5405387517   -3.2296434314
 26  -15.5688540572   -2.9797868434   13.5405387542   -3.2296434349
 27  -15.5688589400   -2.9797868424   13.5405387555   -3.2296434368
 28  -15.5688614791   -2.9797868419   13.5405387561   -3.2296434378
 29  -15.5688627995   -2.9797868417   13.5405387563   -3.2296434383
 30  -15.5688634861   -2.9797868416   13.5405387565   -3.2296434386
 31  -15.5688638432   -2.9797868415   13.5405387565   -3.2296434387
 32  -15.5688640288   -2.9797868415   13.5405387566   -3.2296434388
 33  -15.5688641254   -2.9797868415   13.5405387566   -3.2296434388
Atom SCF converged after  33 iterations to a total energy of    -15.56886413

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20293201E+01     0.84909120E+00
               2       0.18135011E+01     0.72545309E+00
               3       0.15631101E+01     0.56588595E+00
               4       0.13204872E+01     0.48890674E+00
               5       0.11152007E+01     0.41998445E+00
               6       0.86973512E+00     0.32761837E+00
               7       0.53515953E+00     0.20080613E+00
               8       0.20303245E+00     0.75517088E-01
               9       0.29443746E-01     0.10947230E-01
              10       0.63654161E-03     0.25778015E-03
              11       0.32277265E-06     0.14295493E-06
              12       0.95206550E-13     0.43853809E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.70399210069051    0.5868893
               2          -1.77986982980034    0.5764589
               3          -1.87744750536211    0.5601004
               4          -1.99148344069067    0.5385853
               5          -2.10134695042951    0.5182419
               6          -2.17465290104275    0.5060855
               7          -2.20097334907950    0.5007755
               8          -2.20450075146115    0.5000063
               9          -2.20457609610323    0.5000002
              10          -2.20457613339282    0.7839971
              11          -2.20457613339283    0.7839971
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999997]
Closest occupancy to 0.5:     0.99999999999999
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.455182186058=    -16.455182186058+      0.000000000000
    Trial step:       1.000000000000
            G0:      -3.892091601417
WARNING: minimum value of charge density: -0.0755
      Q1=E1+P1:      54.141652930691=    -20.256569715020+     74.398222645711
Quadratic term:     -74.488926718167
   Linear term:      -3.892091601417
  Optimal step:       0.026125303269
 Predicted min:     -16.506023222778
    !!! Quadratic minimum step length accepted !!!
 1    -16.45518218605847 0.32880641051 0.03432886821 0.0261  0.000    8.00000000
      Q0=E0+P0:     -16.545695935969=    -16.556770894786+      0.011074958817
    Trial step:       0.161633236895
            G0:      -0.022998485297
      Q1=E1+P1:     -16.549290982897=    -16.560539263906+      0.011248281009
Quadratic term:      -0.000122272694
   Linear term:      -0.003717319622
  Optimal step:       2.456977031898
 Predicted min:     -16.573949311041
    !!! Quadratic minimum step length accepted !!!
 2    -16.55677089478607 0.25471030851 0.03556410426 2.4570 -0.768    8.00000000
      Q0=E0+P0:     -16.569703516515=    -16.596747014219+      0.027043497704
    Trial step:       0.630181839347
            G0:      -2.219800000026
WARNING: minimum value of charge density: -0.0009
      Q1=E1+P1:      -7.232528342583=    -18.397045290020+     11.164516947437
Quadratic term:     -10.736052820931
   Linear term:      -1.398877646998
  Optimal step:       0.041055465324
 Predicted min:     -16.615270977478
    !!! Quadratic minimum step length accepted !!!
 3    -16.59674701421938 0.24935259913 0.02975518003 0.0411  3.236    8.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.717423162877
   Final penalty energy   :       0.076237432968
   RMS occupancy error    :       0.056361
   Occupancy bounds       : [-0.069, 1.078]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.056361 (step -0.4140 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002045 (step -0.4995 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.542391183514
             Q0:     -16.464290397465
             G0:      -0.050722005937
   RMS gradient:       0.037535910930
     Trial step:       0.500000000000
             Q1:     -16.469369668907
 Quadratic coef:       0.020281731526
 Linear coef   :      -0.025361002968
           Qmin:     -16.472218473906
Quadratic minimum step length (  0.312608947317) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001043 (step -0.4979 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.46429039746503 0.00000000000 0.02815193316 0.3126  0.000    8.00000000
      ideal mu1:      -0.507338448069
             Q0:     -16.472215795721
             G0:      -0.000381001575
   RMS gradient:       0.003246994223
     Trial step:       0.395353605850
             Q1:     -16.472324454350
 Quadratic coef:       0.000041971718
 Linear coef   :      -0.000150630347
           Qmin:     -16.472350943283
Quadratic minimum step length (  0.709433088788) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000071 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.47221579572129 0.00099100956 0.00243524567 0.7094  0.007    8.00000000
      ideal mu1:      -0.506613637034
             Q0:     -16.472351004053
             G0:      -0.000046202566
   RMS gradient:       0.001132540423
     Trial step:       0.529600726738
             Q1:     -16.472365080147
 Quadratic coef:       0.000010392819
 Linear coef   :      -0.000024468912
           Qmin:     -16.472365406491
Quadratic minimum step length (  0.623447509157) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000015 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.47235100405343 0.00001708387 0.00084940532 0.6234  0.122    8.00000000
      ideal mu1:      -0.507611607768
             Q0:     -16.472365405607
             G0:      -0.000001022675
   RMS gradient:       0.000168624784
     Trial step:       0.574611393842
             Q1:     -16.472365493981
 Quadratic coef:       0.000000499267
 Linear coef   :      -0.000000587641
           Qmin:     -16.472365578521
Quadratic minimum step length (  0.338160866273) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.47236540560708 0.00000202358 0.00012646859 0.3382  0.022    8.00000000
      ideal mu1:      -0.507471157834
             Q0:     -16.472365578517
             G0:      -0.000000048971
   RMS gradient:       0.000036882451
     Trial step:       0.440807312453
             Q1:     -16.472365595532
 Quadratic coef:       0.000000004572
 Linear coef   :      -0.000000021587
           Qmin:     -16.472365603999
Quadratic minimum step length (  1.040697928362) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.47236557851678 0.00000002213 0.00002766184 1.0407  0.048    8.00000000
      ideal mu1:      -0.507472969309
             Q0:     -16.472365603998
             G0:      -0.000000003613
   RMS gradient:       0.000010017546
     Trial step:       0.677308834193
             Q1:     -16.472365604802
 Quadratic coef:       0.000000001643
 Linear coef   :      -0.000000002447
           Qmin:     -16.472365604909
Quadratic minimum step length (  0.504362906078) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.47236560399797 0.00000000334 0.00000751316 0.5044  0.074    8.00000000
      ideal mu1:      -0.507475814425
             Q0:     -16.472365604909
             G0:      -0.000000000359
   RMS gradient:       0.000003159233
     Trial step:       0.584473653748
             Q1:     -16.472365604976
 Quadratic coef:       0.000000000143
 Linear coef   :      -0.000000000210
           Qmin:     -16.472365604986
Quadratic minimum step length (  0.429970647957) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.47236560490921 0.00000000012 0.00000236942 0.4300  0.000    8.00000000
      ideal mu1:      -0.507474575569
             Q0:     -16.472365604986
             G0:      -0.000000000033
   RMS gradient:       0.000000957888
     Trial step:       0.501304813079
             Q1:     -16.472365604996
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000017
           Qmin:     -16.472365604996
Quadratic minimum step length (  0.573235598253) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.47236560498646 0.00000000001 0.00000071842 0.5732  0.092    8.00000000
      ideal mu1:      -0.507475150204
             Q0:     -16.472365604996
             G0:      -0.000000000003
   RMS gradient:       0.000000283285
     Trial step:       0.536065074811
             Q1:     -16.472365604996
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.472365604997
Quadratic minimum step length (  0.488036584965) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.47236560499579 0.00000000000 0.00000021246 0.4880  0.087    8.00000000
      ideal mu1:      -0.507474964165
10    -16.47236560499659 0.00000000000 0.00000009630 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01094877551658              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21653100E-01     0.14097858E-01
               2       0.27365400E-03     0.19078649E-03
               3       0.47136188E-07     0.35125772E-07
               4       0.16404306E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28030399E-01     0.17631910E-01
               2       0.45317458E-03     0.29679965E-03
               3       0.12631502E-06     0.84150124E-07
               4       0.98556563E-14     0.66613381E-14
================================================================================
RMS gradient                =       0.01094877551658
Trial step length           =               0.122474
Gradient along search dir.  =         -2.09542697926
Functional at step 0        =     -16.47236560499659
Functional at step 1        =     -16.66525583680225
Functional predicted        =     -16.73066454461378
Selected quadratic step     =               0.246536
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.11922410
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010161 (step -0.4830 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000067 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.518658493079
             Q0:     -16.730512588962
             G0:      -0.023366521202
   RMS gradient:       0.025476852894
     Trial step:       0.511487407890
             Q1:     -16.735817851220
 Quadratic coef:       0.006646419103
 Linear coef   :      -0.011951681361
           Qmin:     -16.735885508016
Quadratic minimum step length (  0.459881811904) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001023 (step -0.4981 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.73051258896219 0.00000000000 0.01910763967 0.4599  0.000    8.00000000
      ideal mu1:      -0.491661232295
             Q0:     -16.735891340344
             G0:      -0.001579281061
   RMS gradient:       0.006596553961
     Trial step:       0.484998717428
             Q1:     -16.736256254946
 Quadratic coef:       0.000401034687
 Linear coef   :      -0.000765949289
           Qmin:     -16.736257068255
Quadratic minimum step length (  0.463157470761) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000204 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.73589134034365 0.00067161488 0.00494741547 0.4632  0.067    8.00000000
      ideal mu1:      -0.495600793713
             Q0:     -16.736257640128
             G0:      -0.000215222449
   RMS gradient:       0.002442854794
     Trial step:       0.473952296425
             Q1:     -16.736322988700
 Quadratic coef:       0.000036656602
 Linear coef   :      -0.000102005174
           Qmin:     -16.736328603167
Quadratic minimum step length (  0.659439011687) accepted
    Initial Ne1:       8.00000009
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000076 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.73625764012787 0.00004912541 0.00183214107 0.6594  0.137    8.00000000
      ideal mu1:      -0.494654796021
             Q0:     -16.736328688604
             G0:      -0.000001670558
   RMS gradient:       0.000215245635
     Trial step:       0.559055126031
             Q1:     -16.736329234344
 Quadratic coef:       0.000000388195
 Linear coef   :      -0.000000933934
           Qmin:     -16.736329250328
Quadratic minimum step length (  0.672498267338) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.73632868860432 0.00001020195 0.00016143422 0.6725  0.008    8.00000000
      ideal mu1:      -0.494852332429
             Q0:     -16.736329250327
             G0:      -0.000000561194
   RMS gradient:       0.000124859236
     Trial step:       0.613158709962
             Q1:     -16.736329396751
 Quadratic coef:       0.000000197677
 Linear coef   :      -0.000000344101
           Qmin:     -16.736329400073
Quadratic minimum step length (  0.533669494953) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.73632925032676 0.00000007095 0.00009364443 0.5337  0.336    8.00000000
      ideal mu1:      -0.494759611994
             Q0:     -16.736329400073
             G0:      -0.000000020943
   RMS gradient:       0.000024118687
     Trial step:       0.572035050562
             Q1:     -16.736329404779
 Quadratic coef:       0.000000007274
 Linear coef   :      -0.000000011980
           Qmin:     -16.736329405006
Quadratic minimum step length (  0.471086680628) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.73632940007275 0.00000002509 0.00001808902 0.4711  0.037    8.00000000
      ideal mu1:      -0.494768723141
             Q0:     -16.736329405006
             G0:      -0.000000001924
   RMS gradient:       0.000007310761
     Trial step:       0.519112794267
             Q1:     -16.736329405479
 Quadratic coef:       0.000000000526
 Linear coef   :      -0.000000000999
           Qmin:     -16.736329405480
Quadratic minimum step length (  0.493059439380) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.73632940500562 0.00000000065 0.00000548307 0.4931  0.000    8.00000000
      ideal mu1:      -0.494764108805
             Q0:     -16.736329405480
             G0:      -0.000000000328
   RMS gradient:       0.000003018810
     Trial step:       0.505918435439
             Q1:     -16.736329405571
 Quadratic coef:       0.000000000075
 Linear coef   :      -0.000000000166
           Qmin:     -16.736329405572
Quadratic minimum step length (  0.559892946469) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.73632940547981 0.00000000006 0.00000226411 0.5599  0.171    8.00000000
      ideal mu1:      -0.494766230433
             Q0:     -16.736329405572
             G0:      -0.000000000015
   RMS gradient:       0.000000657410
     Trial step:       0.532221911885
             Q1:     -16.736329405575
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000008
           Qmin:     -16.736329405575
Quadratic minimum step length (  0.436036528637) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.73632940557172 0.00000000001 0.00000049306 0.4360  0.047    8.00000000
      ideal mu1:      -0.494765843595
10    -16.73632940557509 0.00000000000 0.00000017817 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00300535265403              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11475776E-01     0.62630415E-02
               2       0.78494591E-04     0.45730665E-04
               3       0.41326583E-08     0.25822162E-08
               4       0.81135693E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15852668E-01     0.88480229E-02
               2       0.14549606E-03     0.85555420E-04
               3       0.13575457E-07     0.85036505E-08
               4       0.69705884E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00300535265403
Trial step length           =               0.173765
Gradient along search dir.  =         -0.16139147615
Functional at step 0        =     -16.73632940557509
Functional at step 1        =     -16.75789151047247
Functional predicted        =     -16.76666201677466
Selected quadratic step     =               0.375889
Conjugate gradients coeff.  =               0.075346
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05244864
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004407 (step -0.4923 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000017 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.507281186210
             Q0:     -16.766416756631
             G0:      -0.006550197028
   RMS gradient:       0.013488881253
     Trial step:       0.481734568952
             Q1:     -16.767655128511
 Quadratic coef:       0.001917084462
 Linear coef   :      -0.003155456342
           Qmin:     -16.767715200299
Quadratic minimum step length (  0.396459423343) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000221 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.76641675663074 0.00000000000 0.01011666092 0.3965  0.000    8.00000000
      ideal mu1:      -0.492069258742
             Q0:     -16.767714864331
             G0:      -0.000354434443
   RMS gradient:       0.003134929183
     Trial step:       0.437021978178
             Q1:     -16.767797902026
 Quadratic coef:       0.000071857947
 Linear coef   :      -0.000154895641
           Qmin:     -16.767798336866
Quadratic minimum step length (  0.471018188118) accepted
    Initial Ne1:       8.00000020
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000041 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.76771486433130 0.00016230546 0.00235119721 0.4710  0.054    8.00000000
      ideal mu1:      -0.492601984141
             Q0:     -16.767798367562
             G0:      -0.000015470581
   RMS gradient:       0.000655228238
     Trial step:       0.453701774659
             Q1:     -16.767803465332
 Quadratic coef:       0.000001921260
 Linear coef   :      -0.000007019030
           Qmin:     -16.767804778302
Quadratic minimum step length (  0.828765251635) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.76779836756155 0.00001101531 0.00049142118 0.8288  0.044    8.00000000
      ideal mu1:      -0.492492225658
             Q0:     -16.767804779171
             G0:      -0.000000013066
   RMS gradient:       0.000019049167
     Trial step:       0.613198389954
             Q1:     -16.767804782670
 Quadratic coef:       0.000000004512
 Linear coef   :      -0.000000008012
           Qmin:     -16.767804782727
Quadratic minimum step length (  0.544392797909) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.76780477917065 0.00000083910 0.00001428688 0.5444  0.001    8.00000000
      ideal mu1:      -0.492510004991
             Q0:     -16.767804782727
             G0:      -0.000000003569
   RMS gradient:       0.000009956368
     Trial step:       0.577772262384
             Q1:     -16.767804783846
 Quadratic coef:       0.000000000943
 Linear coef   :      -0.000000002062
           Qmin:     -16.767804783854
Quadratic minimum step length (  0.631419529999) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.76780478272727 0.00000000045 0.00000746728 0.6314  0.273    8.00000000
      ideal mu1:      -0.492503509296
             Q0:     -16.767804783854
             G0:      -0.000000000101
   RMS gradient:       0.000001671603
     Trial step:       0.604000571491
             Q1:     -16.767804783871
 Quadratic coef:       0.000000000044
 Linear coef   :      -0.000000000061
           Qmin:     -16.767804783875
Quadratic minimum step length (  0.418133997370) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.76780478385408 0.00000000018 0.00000125370 0.4181  0.028    8.00000000
      ideal mu1:      -0.492503965671
             Q0:     -16.767804783875
             G0:      -0.000000000004
   RMS gradient:       0.000000329297
     Trial step:       0.502546687752
             Q1:     -16.767804783876
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.767804783876
Quadratic minimum step length (  0.485149104831) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.76780478387540 0.00000000000 0.00000024697 0.4851  0.000    8.00000000
      ideal mu1:      -0.492503793875
             Q0:     -16.767804783876
             G0:      -0.000000000001
   RMS gradient:       0.000000126310
     Trial step:       0.493771278730
             Q1:     -16.767804783877
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.767804783877
Quadratic minimum step length (  0.591655765581) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.76780478387633 0.00000000000 0.00000009473 0.5917  0.147    8.00000000
      ideal mu1:      -0.492503811936
             Q0:     -16.767804783876
             G0:      -0.000000000000
   RMS gradient:       0.000000050496
     Trial step:       0.540502196054
             Q1:     -16.767804783877
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.767804783876
  Cubic LS coeff:       0.676796020409
Predicted energy:     -16.767804783877
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.76780478387639 0.00000000000 0.00000003787 0.6768  0.160    8.00000000
      ideal mu1:      -0.492503820800
10    -16.76780478387664 0.00000000000 0.00000001375 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00142003314914              |
           | Maximum change in energy =  0.08798793352617 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12590606E-01     0.51695786E-02
               2       0.10052153E-03     0.40800468E-04
               3       0.74561838E-08     0.31650079E-08
               4       0.75057817E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.75932409E-02     0.30894919E-02
               2       0.35898667E-04     0.14134996E-04
               3       0.92008263E-09     0.37702763E-09
               4       0.77262507E-15     0.33306691E-15
================================================================================
RMS gradient                =       0.00142003314914
Trial step length           =               0.255571
Gradient along search dir.  =         -0.03660129791
Functional at step 0        =     -16.76780478387664
Functional at step 1        =     -16.77409022487267
Functional predicted        =     -16.77493314382559
Selected quadratic step     =               0.389514
Conjugate gradients coeff.  =               0.223258
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02316688
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002012 (step -0.4962 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.508448971611
             Q0:     -16.774877173374
             G0:      -0.001504466749
   RMS gradient:       0.006464576012
     Trial step:       0.604822069134
             Q1:     -16.775057576982
 Quadratic coef:       0.000729531084
 Linear coef   :      -0.000909934692
           Qmin:     -16.775160910819
Quadratic minimum step length (  0.377193374780) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000044 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77487717337369 0.00000000000 0.00484843201 0.3772  0.000    8.00000000
      ideal mu1:      -0.501251756501
             Q0:     -16.775160604607
             G0:      -0.000057256323
   RMS gradient:       0.001261167034
     Trial step:       0.477634669385
             Q1:     -16.775175668443
 Quadratic coef:       0.000012283769
 Linear coef   :      -0.000027347605
           Qmin:     -16.775175825740
Quadratic minimum step length (  0.531683890870) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77516060460719 0.00003546718 0.00094587528 0.5317  0.038    8.00000000
      ideal mu1:      -0.501161001443
             Q0:     -16.775175827863
             G0:      -0.000002746482
   RMS gradient:       0.000276130584
     Trial step:       0.503935173840
             Q1:     -16.775176801596
 Quadratic coef:       0.000000410316
 Linear coef   :      -0.000001384049
           Qmin:     -16.775176995007
Quadratic minimum step length (  0.849918971876) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77517582786335 0.00000197495 0.00020709794 0.8499  0.048    8.00000000
      ideal mu1:      -0.501141154897
             Q0:     -16.775176995041
             G0:      -0.000000003527
   RMS gradient:       0.000009897574
     Trial step:       0.654449436429
             Q1:     -16.775176996447
 Quadratic coef:       0.000000000902
 Linear coef   :      -0.000000002308
           Qmin:     -16.775176996517
Quadratic minimum step length (  0.837023023624) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77517699504133 0.00000015323 0.00000742318 0.8370  0.001    8.00000000
      ideal mu1:      -0.501144840588
             Q0:     -16.775176996518
             G0:      -0.000000001087
   RMS gradient:       0.000005494959
     Trial step:       0.740127857933
             Q1:     -16.775176996756
 Quadratic coef:       0.000000000567
 Linear coef   :      -0.000000000805
           Qmin:     -16.775176996804
Quadratic minimum step length (  0.525341145597) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77517699651804 0.00000000018 0.00000412122 0.5253  0.308    8.00000000
      ideal mu1:      -0.501142442245
             Q0:     -16.775176996803
             G0:      -0.000000000034
   RMS gradient:       0.000000965190
     Trial step:       0.623554020735
             Q1:     -16.775176996814
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000021
           Qmin:     -16.775176996814
Quadratic minimum step length (  0.612947961821) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77517699680340 0.00000000005 0.00000072389 0.6129  0.031    8.00000000
      ideal mu1:      -0.501143139034
             Q0:     -16.775176996814
             G0:      -0.000000000005
   RMS gradient:       0.000000384803
     Trial step:       0.618228247571
             Q1:     -16.775176996815
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000003
           Qmin:     -16.775176996815
Quadratic minimum step length (  0.413765531380) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77517699681376 0.00000000000 0.00000028860 0.4138  0.000    8.00000000
      ideal mu1:      -0.501142814239
             Q0:     -16.775176996815
             G0:      -0.000000000001
   RMS gradient:       0.000000129605
     Trial step:       0.505768266472
             Q1:     -16.775176996815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.775176996815
Quadratic minimum step length (  0.535081729699) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77517699681486 0.00000000000 0.00000009720 0.5351  0.113    8.00000000
      ideal mu1:      -0.501142862577
             Q0:     -16.775176996815
             G0:      -0.000000000000
   RMS gradient:       0.000000050446
     Trial step:       0.520218568345
             Q1:     -16.775176996815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.775176996815
Quadratic minimum step length (  2.343631055946) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77517699681497 0.00000000000 0.00000003783 2.3436  0.151    8.00000000
      ideal mu1:      -0.501142986075
10    -16.77517699681487 0.00000000000 0.00000013779 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00085048139058              |
           | Maximum change in energy =  0.01049179276718 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14271130E-01     0.49510339E-02
               2       0.13565507E-03     0.46689248E-04
               3       0.13449408E-07     0.51262539E-08
               4       0.77394093E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54981726E-02     0.20245423E-02
               2       0.19797208E-04     0.69453880E-05
               3       0.27491948E-09     0.99041969E-10
               4       0.99465111E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00085048139058
Trial step length           =               0.315513
Gradient along search dir.  =         -0.01308503306
Functional at step 0        =     -16.77517699681487
Functional at step 1        =     -16.77775516994086
Functional predicted        =     -16.77792553367843
Selected quadratic step     =               0.420104
Conjugate gradients coeff.  =               0.358701
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01052279
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000953 (step -0.4978 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513487385334
             Q0:     -16.777910607994
             G0:      -0.000368454836
   RMS gradient:       0.003199196237
     Trial step:       1.104174077152
             Q1:     -16.777761260474
 Quadratic coef:       0.000556185798
 Linear coef   :      -0.000406838279
           Qmin:     -16.777985006417
Quadratic minimum step length (  0.403840121909) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77791060799381 0.00000000000 0.00239939718 0.4038  0.000    8.00000000
      ideal mu1:      -0.509775137184
             Q0:     -16.777984850512
             G0:      -0.000018158420
   RMS gradient:       0.000710738864
     Trial step:       0.667764774397
             Q1:     -16.777989457721
 Quadratic coef:       0.000007518344
 Linear coef   :      -0.000012125553
           Qmin:     -16.777989739522
Quadratic minimum step length (  0.538484086025) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77798485051183 0.00000929980 0.00053305415 0.5385  0.049    8.00000000
      ideal mu1:      -0.509787336071
             Q0:     -16.777989739132
             G0:      -0.000001065300
   RMS gradient:       0.000172010402
     Trial step:       0.599650485050
             Q1:     -16.777990153334
 Quadratic coef:       0.000000224605
 Linear coef   :      -0.000000638807
           Qmin:     -16.777990193346
Quadratic minimum step length (  0.852745758203) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77798973913153 0.00000064043 0.00012900780 0.8527  0.059    8.00000000
      ideal mu1:      -0.509770749621
             Q0:     -16.777990193353
             G0:      -0.000000001376
   RMS gradient:       0.000006181788
     Trial step:       0.715086992981
             Q1:     -16.777990193699
 Quadratic coef:       0.000000000638
 Linear coef   :      -0.000000000984
           Qmin:     -16.777990193733
Quadratic minimum step length (  0.551468255934) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77799019335329 0.00000006026 0.00000463634 0.5515  0.001    8.00000000
      ideal mu1:      -0.509773740280
             Q0:     -16.777990193733
             G0:      -0.000000000321
   RMS gradient:       0.000002985796
     Trial step:       0.627971159259
             Q1:     -16.777990193857
 Quadratic coef:       0.000000000077
 Linear coef   :      -0.000000000202
           Qmin:     -16.777990193865
Quadratic minimum step length (  0.824179695837) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77799019373250 0.00000000005 0.00000223935 0.8242  0.233    8.00000000
      ideal mu1:      -0.509772218262
             Q0:     -16.777990193865
             G0:      -0.000000000017
   RMS gradient:       0.000000690089
     Trial step:       0.719417180106
             Q1:     -16.777990193869
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000012
           Qmin:     -16.777990193869
Quadratic minimum step length (  0.497392227075) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77799019386523 0.00000000002 0.00000051757 0.4974  0.053    8.00000000
      ideal mu1:      -0.509772796880
             Q0:     -16.777990193869
             G0:      -0.000000000002
   RMS gradient:       0.000000262054
     Trial step:       0.598191034210
             Q1:     -16.777990193870
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777990193870
Quadratic minimum step length (  0.736691925883) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77799019386914 0.00000000000 0.00000019654 0.7367  0.000    8.00000000
      ideal mu1:      -0.509772510562
             Q0:     -16.777990193870
             G0:      -0.000000000001
   RMS gradient:       0.000000189439
     Trial step:       0.663839216255
             Q1:     -16.777990193870
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777990193870
Quadratic minimum step length (  0.386621144683) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77799019386977 0.00000000000 0.00000014208 0.3866  0.523    8.00000000
      ideal mu1:      -0.509772604008
             Q0:     -16.777990193870
             G0:      -0.000000000000
   RMS gradient:       0.000000094876
     Trial step:       0.506610577934
             Q1:     -16.777990193870
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777990193870
Quadratic minimum step length (  0.452034143387) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77799019387001 0.00000000000 0.00000007116 0.4520  0.251    8.00000000
      ideal mu1:      -0.509772713080
10    -16.77799019387024 0.00000000000 0.00000004514 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00049463321830              |
           | Maximum change in energy =  0.00245740431274 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.89131594974745 |
           | Pseudopotential (local)    :      -46.13685602273704 |
           | Pseudopotential (non-local):       -3.19522488692052 |
           | Hartree                    :       19.86133092686746 |
           | Exchange-correlation       :       -4.13440540879842 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77799019387024 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.13685602273744 |
           | Hartree                    :       19.86133092686793 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999696
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.55983388E-02     0.19608911E-02
               2       0.21603813E-04     0.80574897E-05
               3       0.38387818E-09     0.15315402E-09
               4       0.89368316E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.91526703E-03     0.30646902E-03
               2       0.57609873E-06     0.20727721E-06
               3       0.26542678E-12     0.10344503E-12
================================================================================
RMS gradient                =       0.00049463321830
Trial step length           =               0.364072
Gradient along search dir.  =         -0.00427669212
Functional at step 0        =     -16.77799019387024
Functional at step 1        =     -16.77863214791899
Functional predicted        =     -16.77865252658255
Selected quadratic step     =               0.309741
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99848938
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000164 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.510486771228
             Q0:     -16.778652351376
             G0:      -0.000000381471
   RMS gradient:       0.000102938851
     Trial step:       0.478544959880
             Q1:     -16.778652452237
 Quadratic coef:       0.000000081690
 Linear coef   :      -0.000000182551
           Qmin:     -16.778652453362
Quadratic minimum step length (  0.534697792343) accepted
    Initial Ne1:       7.99999962
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77865235137628 0.00000000000 0.00007720409 0.5347  0.000    8.00000000
      ideal mu1:      -0.510530231257
             Q0:     -16.778652453362
             G0:      -0.000000068931
   RMS gradient:       0.000043757635
     Trial step:       0.505842795328
             Q1:     -16.778652474134
 Quadratic coef:       0.000000014097
 Linear coef   :      -0.000000034868
           Qmin:     -16.778652474924
Quadratic minimum step length (  0.625597060499) accepted
    Initial Ne1:       7.99999992
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77865245336244 0.00000001275 0.00003281823 0.6256  0.181    8.00000000
      ideal mu1:      -0.510483613811
             Q0:     -16.778652474924
             G0:      -0.000000004912
   RMS gradient:       0.000011680850
     Trial step:       0.562542234709
             Q1:     -16.778652476295
 Quadratic coef:       0.000000001392
 Linear coef   :      -0.000000002763
           Qmin:     -16.778652476295
Quadratic minimum step length (  0.558245885048) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77865247492397 0.00000000318 0.00000876064 0.5582  0.071    8.00000000
      ideal mu1:      -0.510493087472
             Q0:     -16.778652476295
             G0:      -0.000000000139
   RMS gradient:       0.000001962354
     Trial step:       0.560389942533
             Q1:     -16.778652476325
 Quadratic coef:       0.000000000048
 Linear coef   :      -0.000000000078
           Qmin:     -16.778652476327
Quadratic minimum step length (  0.457161861235) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77865247629498 0.00000000019 0.00000147177 0.4572  0.028    8.00000000
      ideal mu1:      -0.510492899731
             Q0:     -16.778652476327
             G0:      -0.000000000007
   RMS gradient:       0.000000431587
     Trial step:       0.506151073442
             Q1:     -16.778652476329
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.778652476329
Quadratic minimum step length (  0.773914779778) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77865247632668 0.00000000000 0.00000032369 0.7739  0.048    8.00000000
      ideal mu1:      -0.510492855898
             Q0:     -16.778652476330
             G0:      -0.000000000000
   RMS gradient:       0.000000103815
     Trial step:       0.625873626651
             Q1:     -16.778652476330
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.778652476330
Quadratic minimum step length (  0.352640704265) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77865247632958 0.00000000000 0.00000007786 0.3526  0.058    8.00000000
      ideal mu1:      -0.510492858955
             Q0:     -16.778652476330
             G0:      -0.000000000000
   RMS gradient:       0.000000065507
     Trial step:       0.469796249967
             Q1:     -16.778652476330
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.778652476330
Quadratic minimum step length (  0.533172116164) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77865247632963 0.00000000000 0.00000004913 0.5332  0.000    8.00000000
      ideal mu1:      -0.510492862914
             Q0:     -16.778652476330
             G0:      -0.000000000000
   RMS gradient:       0.000000031600
     Trial step:       0.500482028410
             Q1:     -16.778652476330
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.778652476330
Quadratic minimum step length (  0.048457724004) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77865247632962 0.00000000000 0.00000002370 0.0485  0.233    8.00000000
      ideal mu1:      -0.510492863158
             Q0:     -16.778652476330
             G0:      -0.000000000000
   RMS gradient:       0.000000029653
     Trial step:       0.155731242857
             Q1:     -16.778652476330
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.778652476329
  Cubic LS coeff:       0.149945825738
Predicted energy:     -16.778652476330
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77865247632957 0.00000000000 0.00000002224 0.1499  0.881    8.00000000
      ideal mu1:      -0.510492864260
10    -16.77865247632947 0.00000000000 0.00000001556 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00030600105581              |
           | Maximum change in energy =  0.00093773235179 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.71393915E-02     0.23852187E-02
               2       0.34300553E-04     0.11973667E-04
               3       0.91072670E-09     0.34909214E-09
               4       0.10380031E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15669557E-02     0.52367676E-03
               2       0.16406537E-05     0.58982270E-06
               3       0.19871302E-11     0.72242212E-12
================================================================================
RMS gradient                =       0.00030600105581
Trial step length           =               0.335809
Gradient along search dir.  =         -0.00163642466
Functional at step 0        =     -16.77865247632947
Functional at step 1        =     -16.77897069739033
Functional predicted        =     -16.77897886228911
Selected quadratic step     =               0.398901
Conjugate gradients coeff.  =               0.382718
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99775691
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000242 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512507002637
             Q0:     -16.778978346247
             G0:      -0.000001287156
   RMS gradient:       0.000189088194
     Trial step:       0.152811157326
             Q1:     -16.778978509176
 Quadratic coef:       0.000000033763
 Linear coef   :      -0.000000196692
           Qmin:     -16.778978632716
Quadratic minimum step length (  0.445118948725) accepted
    Initial Ne1:       7.99999974
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77897834624693 0.00000000000 0.00014181593 0.4451  0.000    8.00000000
      ideal mu1:      -0.512279132955
             Q0:     -16.778978632734
             G0:      -0.000000144360
   RMS gradient:       0.000063320915
     Trial step:       0.260804796164
             Q1:     -16.778978663751
 Quadratic coef:       0.000000006633
 Linear coef   :      -0.000000037650
           Qmin:     -16.778978686163
Quadratic minimum step length (  0.740210970127) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77897863273419 0.00000003581 0.00004749069 0.7402  0.112    8.00000000
      ideal mu1:      -0.512283566644
             Q0:     -16.778978686165
             G0:      -0.000000011657
   RMS gradient:       0.000017993893
     Trial step:       0.439375205471
             Q1:     -16.778978689515
 Quadratic coef:       0.000000001771
 Linear coef   :      -0.000000005122
           Qmin:     -16.778978689867
Quadratic minimum step length (  0.635252552204) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77897868616459 0.00000000743 0.00001349542 0.6353  0.081    8.00000000
      ideal mu1:      -0.512288761141
             Q0:     -16.778978689867
             G0:      -0.000000000059
   RMS gradient:       0.000001282321
     Trial step:       0.528312616403
             Q1:     -16.778978689891
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000031
           Qmin:     -16.778978689898
Quadratic minimum step length (  1.046447954770) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77897868986719 0.00000000050 0.00000096174 1.0464  0.005    8.00000000
      ideal mu1:      -0.512288802121
             Q0:     -16.778978689898
             G0:      -0.000000000007
   RMS gradient:       0.000000431953
     Trial step:       0.743539949777
             Q1:     -16.778978689899
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000005
           Qmin:     -16.778978689900
Quadratic minimum step length (  0.500393046822) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77897868989798 0.00000000000 0.00000032396 0.5004  0.113    8.00000000
      ideal mu1:      -0.512288804176
             Q0:     -16.778978689899
             G0:      -0.000000000001
   RMS gradient:       0.000000126319
     Trial step:       0.609969032741
             Q1:     -16.778978689900
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.778978689900
Quadratic minimum step length (  2.577142973059) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77897868989931 0.00000000000 0.00000009474 2.5771  0.086    8.00000000
      ideal mu1:      -0.512288836290
             Q0:     -16.778978689898
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.716E+01) too large - resetting
             G0:      -0.000000000004
   RMS gradient:       0.000000338048
     Trial step:       1.253785231414
             Q1:     -16.778978689899
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000005
           Qmin:     -16.778978689900
Quadratic minimum step length (  0.692133064601) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77897868989830 0.00000000000 0.00000025354 0.6921  0.000    8.00000000
      ideal mu1:      -0.512288809009
             Q0:     -16.778978689900
             G0:      -0.000000000000
   RMS gradient:       0.000000102667
     Trial step:       0.931550435870
             Q1:     -16.778978689900
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.778978689900
Quadratic minimum step length (  0.578749239657) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77897868989960 0.00000000000 0.00000007700 0.5787  0.092    8.00000000
      ideal mu1:      -0.512288810864
             Q0:     -16.778978689900
             G0:      -0.000000000000
   RMS gradient:       0.000000037878
     Trial step:       0.734257520535
             Q1:     -16.778978689900
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.778978689900
Quadratic minimum step length (  1.650315013682) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77897868989952 0.00000000000 0.00000002841 1.6503  0.136    8.00000000
      ideal mu1:      -0.512288813188
10    -16.77897868989968 0.00000000000 0.00000002880 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00017094534448              |
           | Maximum change in energy =  0.00022076081974 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.75286264E-02     0.24109938E-02
               2       0.37468859E-04     0.13008069E-04
               3       0.10257704E-08     0.37433340E-09
               4       0.97713043E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13849671E-02     0.46571939E-03
               2       0.12638820E-05     0.46043288E-06
               3       0.11312429E-11     0.39424020E-12
================================================================================
RMS gradient                =       0.00017094534448
Trial step length           =               0.365998
Gradient along search dir.  =         -0.00051029243
Functional at step 0        =     -16.77897868989968
Functional at step 1        =     -16.77905378320247
Functional predicted        =     -16.77905677869839
Selected quadratic step     =               0.306055
Conjugate gradients coeff.  =               0.312082
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99850896
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000140 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513896814598
             Q0:     -16.779056643996
             G0:      -0.000004694101
   RMS gradient:       0.000361097917
     Trial step:       1.100797987847
             Q1:     -16.779054505004
 Quadratic coef:       0.000007306250
 Linear coef   :      -0.000005167257
           Qmin:     -16.779057557616
Quadratic minimum step length (  0.389263084193) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77905664399624 0.00000000000 0.00027082340 0.3893  0.000    8.00000000
      ideal mu1:      -0.513490097128
             Q0:     -16.779057557356
             G0:      -0.000000124141
   RMS gradient:       0.000058728749
     Trial step:       0.654599129103
             Q1:     -16.779057596302
 Quadratic coef:       0.000000042316
 Linear coef   :      -0.000000081262
           Qmin:     -16.779057596369
Quadratic minimum step length (  0.628530355480) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77905755735587 0.00000011420 0.00004404656 0.6285  0.026    8.00000000
      ideal mu1:      -0.513471773710
             Q0:     -16.779057596369
             G0:      -0.000000008783
   RMS gradient:       0.000015619606
     Trial step:       0.641432321693
             Q1:     -16.779057599947
 Quadratic coef:       0.000000002055
 Linear coef   :      -0.000000005634
           Qmin:     -16.779057600230
Quadratic minimum step length (  0.879111401718) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77905759636879 0.00000000500 0.00001171470 0.8791  0.071    8.00000000
      ideal mu1:      -0.513472218046
             Q0:     -16.779057600229
             G0:      -0.000000000028
   RMS gradient:       0.000000874322
     Trial step:       0.750926406135
             Q1:     -16.779057600239
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000021
           Qmin:     -16.779057600239
Quadratic minimum step length (  0.767501387398) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77905760022889 0.00000000052 0.00000065574 0.7675  0.003    8.00000000
      ideal mu1:      -0.513472357415
             Q0:     -16.779057600239
             G0:      -0.000000000009
   RMS gradient:       0.000000512610
     Trial step:       0.759168662777
             Q1:     -16.779057600243
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000007
           Qmin:     -16.779057600243
Quadratic minimum step length (  0.700553814307) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77905760023944 0.00000000000 0.00000038446 0.7006  0.344    8.00000000
      ideal mu1:      -0.513472288543
             Q0:     -16.779057600242
             G0:      -0.000000000000
   RMS gradient:       0.000000089278
     Trial step:       0.729272584437
             Q1:     -16.779057600242
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779057600243
Quadratic minimum step length (  0.380940196986) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77905760024248 0.00000000000 0.00000006696 0.3809  0.030    8.00000000
      ideal mu1:      -0.513472307144
             Q0:     -16.779057600243
             G0:      -0.000000000000
   RMS gradient:       0.000000049428
     Trial step:       0.527076125405
             Q1:     -16.779057600243
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779057600243
  Cubic LS coeff:       0.653731910663
Predicted energy:     -16.779057600243
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77905760024257 0.00000000000 0.00000003707 0.6537  0.000    8.00000000
      ideal mu1:      -0.513472308820
             Q0:     -16.779057600243
             G0:      -0.000000000000
   RMS gradient:       0.000000016378
     Trial step:       0.586997855640
             Q1:     -16.779057600243
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779057600243
  Cubic LS coeff:       0.674134125173
Predicted energy:     -16.779057600243
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77905760024262 0.00000000000 0.00000001228 0.6741  0.110    8.00000000
      ideal mu1:      -0.513472308328
             Q0:     -16.779057600243
             G0:      -0.000000000000
   RMS gradient:       0.000000004703
     Trial step:       0.629059048015
             Q1:     -16.779057600242
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779057600243
Quadratic minimum step length (  0.001353204113) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77905760024262 0.00000000000 0.00000000353 0.0014  0.082    8.00000000
      ideal mu1:      -0.513472308329
10    -16.77905760024275 0.00000000000 0.00000000352 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006193929095              |
           | Maximum change in energy =  0.00010873785674 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.43091546E-02     0.14569306E-02
               2       0.12260437E-04     0.42139551E-05
               3       0.11302534E-09     0.43048357E-10
               4       0.60548711E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20426857E-02     0.67229530E-03
               2       0.27542370E-05     0.92597033E-06
               3       0.55951507E-11     0.20854429E-11
               4       0.88509670E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00006193929095
Trial step length           =               0.334687
Gradient along search dir.  =         -0.00006775563
Functional at step 0        =     -16.77905760024275
Functional at step 1        =     -16.77905987096999
Functional predicted        =     -16.77906390033196
Selected quadratic step     =               0.185965
Conjugate gradients coeff.  =               0.131286
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99928624
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000067 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514034880114
             Q0:     -16.779063872265
             G0:      -0.000001681666
   RMS gradient:       0.000216131799
     Trial step:       0.029176108224
             Q1:     -16.779063919566
 Quadratic coef:       0.000000001763
 Linear coef   :      -0.000000049064
           Qmin:     -16.779064213538
Quadratic minimum step length (  0.405874560208) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77906387226507 0.00000000000 0.00016209885 0.4059  0.000    8.00000000
      ideal mu1:      -0.513782562799
             Q0:     -16.779064213566
             G0:      -0.000000056017
   RMS gradient:       0.000039443758
     Trial step:       0.108820219142
             Q1:     -16.779064219052
 Quadratic coef:       0.000000000610
 Linear coef   :      -0.000000006096
           Qmin:     -16.779064228804
Quadratic minimum step length (  0.544055835593) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77906421356587 0.00000004266 0.00002958282 0.5441  0.033    8.00000000
      ideal mu1:      -0.513776604440
             Q0:     -16.779064228802
             G0:      -0.000000001619
   RMS gradient:       0.000006705822
     Trial step:       0.243319286647
             Q1:     -16.779064229147
 Quadratic coef:       0.000000000049
 Linear coef   :      -0.000000000394
           Qmin:     -16.779064229599
Quadratic minimum step length (  0.985478495966) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77906422880153 0.00000000197 0.00000502937 0.9855  0.029    8.00000000
      ideal mu1:      -0.513775590950
             Q0:     -16.779064229603
             G0:      -0.000000000003
   RMS gradient:       0.000000292436
     Trial step:       0.489679410068
             Q1:     -16.779064229605
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.779064229605
Quadratic minimum step length (  1.148230899202) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77906422960333 0.00000000010 0.00000021933 1.1482  0.002    8.00000000
      ideal mu1:      -0.513775576061
             Q0:     -16.779064229605
             G0:      -0.000000000001
   RMS gradient:       0.000000150056
     Trial step:       0.749843336533
             Q1:     -16.779064229605
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.779064229606
Quadratic minimum step length (  2.704299474080) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77906422960476 0.00000000000 0.00000011254 2.7043  0.263    8.00000000
      ideal mu1:      -0.513775663920
             Q0:     -16.779064229602
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.171E+02) too large - resetting
             G0:      -0.000000000014
   RMS gradient:       0.000000620550
     Trial step:       1.424008757217
             Q1:     -16.779064229589
 Quadratic coef:       0.000000000033
 Linear coef   :      -0.000000000020
           Qmin:     -16.779064229605
Quadratic minimum step length (  0.428869659491) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77906422960185 0.00000000000 0.00000046541 0.4289  0.000    8.00000000
      ideal mu1:      -0.513775573947
             Q0:     -16.779064229605
             G0:      -0.000000000001
   RMS gradient:       0.000000124212
     Trial step:       0.781482022070
             Q1:     -16.779064229605
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779064229605
Quadratic minimum step length (  0.994053327324) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77906422960480 0.00000000000 0.00000009316 0.9941  0.040    8.00000000
      ideal mu1:      -0.513775610411
             Q0:     -16.779064229605
             G0:      -0.000000000000
   RMS gradient:       0.000000035630
     Trial step:       0.881382325829
             Q1:     -16.779064229605
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779064229605
  Cubic LS coeff:       1.171549758029
Predicted energy:     -16.779064229605
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77906422960515 0.00000000000 0.00000002672 1.1715  0.082    8.00000000
      ideal mu1:      -0.513775552814
             Q0:     -16.779064229605
             G0:      -0.000000000000
   RMS gradient:       0.000000038928
     Trial step:       1.016161035740
             Q1:     -16.779064229605
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779064229605
  Cubic LS coeff:       1.148372767554
Predicted energy:     -16.779064229605
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77906422960515 0.00000000000 0.00000002920 1.1484  1.194    8.00000000
      ideal mu1:      -0.513775596168
10    -16.77906422960506 0.00000000000 0.00000003330 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00003879083358              |
           | Maximum change in energy =  0.00002630344769 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21505468E-02     0.76880909E-03
               2       0.30699467E-05     0.11182785E-05
               3       0.75608230E-11     0.29920094E-11
               4       0.78290162E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21124511E-03     0.73291776E-04
               2       0.29678439E-07     0.10533687E-07
               3       0.94898765E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00003879083358
Trial step length           =               0.249480
Gradient along search dir.  =         -0.00002630266
Functional at step 0        =     -16.77906422960506
Functional at step 1        =     -16.77906718107666
Functional predicted        =     -16.77906721115072
Selected quadratic step     =               0.226711
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99921448
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000074 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514178775934
             Q0:     -16.779067169857
             G0:      -0.000001103866
   RMS gradient:       0.000175108369
     Trial step:       1.080246111260
             Q1:     -16.779066829405
 Quadratic coef:       0.000001532899
 Linear coef   :      -0.000001192447
           Qmin:     -16.779067401759
Quadratic minimum step length (  0.420163251567) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77906716985737 0.00000000000 0.00013133127 0.4202  0.000    8.00000000
      ideal mu1:      -0.513970503914
             Q0:     -16.779067401730
             G0:      -0.000000042549
   RMS gradient:       0.000034380681
     Trial step:       0.673705958560
             Q1:     -16.779067411700
 Quadratic coef:       0.000000018695
 Linear coef   :      -0.000000028666
           Qmin:     -16.779067412718
Quadratic minimum step length (  0.516496971937) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77906740172961 0.00000002899 0.00002578551 0.5165  0.039    8.00000000
      ideal mu1:      -0.513969073130
             Q0:     -16.779067412718
             G0:      -0.000000000729
   RMS gradient:       0.000004499328
     Trial step:       0.589887351596
             Q1:     -16.779067413028
 Quadratic coef:       0.000000000120
 Linear coef   :      -0.000000000430
           Qmin:     -16.779067413105
Quadratic minimum step length (  1.061029376254) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77906741271793 0.00000000143 0.00000337450 1.0610  0.017    8.00000000
      ideal mu1:      -0.513968225233
             Q0:     -16.779067413104
             G0:      -0.000000000005
   RMS gradient:       0.000000383386
     Trial step:       0.791130715321
             Q1:     -16.779067413107
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.779067413107
Quadratic minimum step length (  1.032628934758) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77906741310407 0.00000000005 0.00000028754 1.0326  0.007    8.00000000
      ideal mu1:      -0.513968279034
             Q0:     -16.779067413107
             G0:      -0.000000000001
   RMS gradient:       0.000000150806
     Trial step:       0.903849803793
             Q1:     -16.779067413107
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.779067413107
Quadratic minimum step length (  0.765776575870) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77906741310684 0.00000000000 0.00000011310 0.7658  0.155    8.00000000
      ideal mu1:      -0.513968268821
             Q0:     -16.779067413107
             G0:      -0.000000000000
   RMS gradient:       0.000000088365
     Trial step:       0.831953729392
             Q1:     -16.779067413107
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067413107
Quadratic minimum step length (  0.965425769333) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77906741310707 0.00000000000 0.00000006627 0.9654  0.343    8.00000000
      ideal mu1:      -0.513968289967
             Q0:     -16.779067413107
             G0:      -0.000000000000
   RMS gradient:       0.000000047006
     Trial step:       0.896208440737
             Q1:     -16.779067413107
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067413107
Quadratic minimum step length (  0.499529052052) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77906741310716 0.00000000000 0.00000003525 0.4995  0.000    8.00000000
      ideal mu1:      -0.513968278037
             Q0:     -16.779067413107
             G0:      -0.000000000000
   RMS gradient:       0.000000020599
     Trial step:       0.669090541588
             Q1:     -16.779067413107
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067413107
Quadratic minimum step length (  0.054208445578) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77906741310716 0.00000000000 0.00000001545 0.0542  0.192    8.00000000
      ideal mu1:      -0.513968278002
             Q0:     -16.779067413107
             G0:      -0.000000000000
   RMS gradient:       0.000000019345
     Trial step:       0.190447783423
             Q1:     -16.779067413107
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067413107
Quadratic minimum step length (  0.001704959814) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77906741310728 0.00000000000 0.00000001451 0.0017  0.882    8.00000000
      ideal mu1:      -0.513968278007
10    -16.77906741310715 0.00000000000 0.00000001446 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001354365553              |
           | Maximum change in energy =  0.00000220978743 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87571105810839 |
           | Pseudopotential (local)    :      -46.09507206139330 |
           | Pseudopotential (non-local):       -3.19413029470136 |
           | Hartree                    :       19.82680843440613 |
           | Exchange-correlation       :       -4.12823379749785 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77906741310715 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.09507206139427 |
           | Hartree                    :       19.82680843440653 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999697
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22302972E-02     0.78769694E-03
               2       0.33336443E-05     0.12065179E-05
               3       0.90561181E-11     0.35413200E-11
               4       0.62553276E-15     0.22204460E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18426575E-02     0.64651476E-03
               2       0.22757220E-05     0.81893759E-06
               3       0.41989398E-11     0.16354695E-11
               4       0.95837682E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00001354365553
Trial step length           =               0.237823
Gradient along search dir.  =         -0.00000342102
Functional at step 0        =     -16.77906741310715
Functional at step 1        =     -16.77906604039698
Functional predicted        =     -16.77906748879881
Selected quadratic step     =               0.044251
Conjugate gradients coeff.  =               0.121903
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99981933
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514041408467
             Q0:     -16.779067486532
             G0:      -0.000000031989
   RMS gradient:       0.000029809110
     Trial step:       0.018019595371
             Q1:     -16.779067487096
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000576
           Qmin:     -16.779067493224
Quadratic minimum step length (  0.418386318933) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77906748653211 0.00000000000 0.00002235683 0.4184  0.000    8.00000000
      ideal mu1:      -0.514006284741
             Q0:     -16.779067493274
             G0:      -0.000000001221
   RMS gradient:       0.000005802950
     Trial step:       0.086828291335
             Q1:     -16.779067493372
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000106
           Qmin:     -16.779067493590
Quadratic minimum step length (  0.517152874804) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77906749327437 0.00000000084 0.00000435221 0.5172  0.038    8.00000000
      ideal mu1:      -0.514005864377
             Q0:     -16.779067493589
             G0:      -0.000000000016
   RMS gradient:       0.000000672298
     Trial step:       0.211904460732
             Q1:     -16.779067493592
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -16.779067493613
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  3.009222772937)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77906749358869 0.00000000004 0.00000050422 0.1500  0.000    8.00000000
      ideal mu1:      -0.514005871389
             Q0:     -16.779067493591
             G0:      -0.000000000023
   RMS gradient:       0.000000582678
     Trial step:       0.178285358652
             Q1:     -16.779067493594
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.779067493597
Quadratic minimum step length (  0.480349839846) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77906749359107 0.00000000000 0.00000043701 0.4803  0.751    8.00000000
      ideal mu1:      -0.514005903260
             Q0:     -16.779067493598
             G0:      -0.000000000001
   RMS gradient:       0.000000143972
     Trial step:       0.292642005658
             Q1:     -16.779067493598
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067493598
  Cubic LS coeff:       0.560392026171
Predicted energy:     -16.779067493598
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77906749359750 0.00000000000 0.00000010798 0.5604  0.061    8.00000000
      ideal mu1:      -0.514005873141
             Q0:     -16.779067493598
             G0:      -0.000000000000
   RMS gradient:       0.000000052766
     Trial step:       0.404962030928
             Q1:     -16.779067493598
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067493598
  Cubic LS coeff:       0.594896513273
Predicted energy:     -16.779067493598
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77906749359783 0.00000000000 0.00000003957 0.5949  0.134    8.00000000
      ideal mu1:      -0.514005858633
             Q0:     -16.779067493598
             G0:      -0.000000000000
   RMS gradient:       0.000000018957
     Trial step:       0.490826344247
             Q1:     -16.779067493598
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067493598
Quadratic minimum step length (  0.012503870005) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77906749359811 0.00000000000 0.00000001422 0.0125  0.129    8.00000000
      ideal mu1:      -0.514005858667
             Q0:     -16.779067493598
             G0:      -0.000000000000
   RMS gradient:       0.000000018707
     Trial step:       0.078340467216
             Q1:     -16.779067493598
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067493598
Quadratic minimum step length (  0.000464790902) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77906749359814 0.00000000000 0.00000001403 0.0005  0.974    8.00000000
      ideal mu1:      -0.514005858671
             Q0:     -16.779067493598
             G0:      -0.000000000000
   RMS gradient:       0.000000018691
     Trial step:       0.006034230394
             Q1:     -16.779067493598
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067493598
Quadratic minimum step length (  0.000000870932) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77906749359823 0.00000000000 0.00000001402 0.0000  0.000    8.00000000
      ideal mu1:      -0.514005858671
10    -16.77906749359828 0.00000000000 0.00000001402 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000498635777              |
           | Maximum change in energy =  0.00000106116736 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.463465E-06
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.72854932E-03     0.27177537E-03
               2       0.35326933E-06     0.13374872E-06
               3       0.10653577E-12     0.42840731E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66860064E-03     0.24969333E-03
               2       0.29746550E-06     0.11272224E-06
               3       0.75473810E-13     0.30253577E-13
================================================================================
RMS gradient                =       0.00000498635777
Trial step length           =               0.102586
Gradient along search dir.  =         -0.00000043462
Functional at step 0        =     -16.77906749359828
Functional at step 1        =     -16.77906725970088
Functional predicted        =     -16.77906749538285
Selected quadratic step     =               0.008212
Conjugate gradients coeff.  =              -0.135549
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00003026
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513994507708
             Q0:     -16.779067495302
             G0:      -0.000000000748
   RMS gradient:       0.000004557595
     Trial step:       0.000072494161
             Q1:     -16.779067495302
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067495302
  Cubic LS coeff:       0.000096462291
Predicted energy:     -16.779067495302
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77906749530161 0.00000000000 0.00000341820 0.0001  0.000    8.00000000
      ideal mu1:      -0.513994508945
             Q0:     -16.779067495302
             G0:      -0.000000001495
   RMS gradient:       0.000004556552
     Trial step:       0.000083623878
             Q1:     -16.779067495302
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067495302
Quadratic minimum step length (  0.000035879147) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77906749530166 0.00000000000 0.00000341741 0.0000  1.000    8.00000000
      ideal mu1:      -0.513994509864
             Q0:     -16.779067495302
             G0:      -0.000000002241
   RMS gradient:       0.000004555777
     Trial step:       0.000054775482
             Q1:     -16.779067495302
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067495302
  Cubic LS coeff:       0.000067821259
Predicted energy:     -16.779067495302
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77906749530166 0.00000000000 0.00000341683 0.0001  1.000    8.00000000
      ideal mu1:      -0.513994512470
             Q0:     -16.779067495302
             G0:      -0.000000002984
   RMS gradient:       0.000004553580
     Trial step:       0.000060950325
             Q1:     -16.779067495302
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067495302
  Cubic LS coeff:       0.000112179225
Predicted energy:     -16.779067495302
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77906749530177 0.00000000000 0.00000341518 0.0001  0.999    8.00000000
      ideal mu1:      -0.513994518212
             Q0:     -16.779067495302
             G0:      -0.000000003720
   RMS gradient:       0.000004548737
     Trial step:       0.000082688332
             Q1:     -16.779067495302
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067495304
Quadratic minimum step length (  0.000894844706) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77906749530209 0.00000000000 0.00000341155 0.0009  0.998    8.00000000
      ideal mu1:      -0.513994575363
             Q0:     -16.779067495305
             G0:      -0.000000004332
   RMS gradient:       0.000004500550
     Trial step:       0.000272016941
             Q1:     -16.779067495307
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000001
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067495308
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77906749530547 0.00000000000 0.00000337541 0.1500  0.979    8.00000000
      ideal mu1:      -0.514005850845
             Q0:     -16.779067495269
             G0:      -0.000000001029
   RMS gradient:       0.000005347181
     Trial step:       0.006387686681
             Q1:     -16.779067495275
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000007
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067495282
  Cubic LS coeff:       0.026706486461
Predicted energy:     -16.779067495288
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77906749526884 0.00000000024 0.00000401039 0.0267  0.000    8.00000000
      ideal mu1:      -0.514005447997
             Q0:     -16.779067495295
             G0:      -0.000000001716
   RMS gradient:       0.000004970709
     Trial step:       0.013061112811
             Q1:     -16.779067495317
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000022
           Qmin:     -16.779067495447
Quadratic minimum step length (  0.176853470742) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77906749529532 0.00000000000 0.00000372803 0.1769  0.864    8.00000000
      ideal mu1:      -0.514000659925
             Q0:     -16.779067495462
             G0:      -0.000000000020
   RMS gradient:       0.000000680617
     Trial step:       0.048061451625
             Q1:     -16.779067495463
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.779067495463
Quadratic minimum step length (  0.058863431369) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77906749546234 0.00000000004 0.00000051046 0.0589  0.019    8.00000000
      ideal mu1:      -0.514000534860
10    -16.77906749546338 0.00000000000 0.00000043721 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000269413807              |
           | Maximum change in energy =  0.00000002683038 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27972085E-03     0.10250008E-03
               2       0.52319147E-07     0.19533435E-07
               3       0.22941945E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26701177E-03     0.97819120E-04
               2       0.47672520E-07     0.17794905E-07
               3       0.20430112E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.52333672E-06     0.19264010E-06
               2       0.18309622E-12     0.68722805E-13
================================================================================
RMS gradient                =       0.00000269413807
Trial step length           =               0.029025
Gradient along search dir.  =         -0.00000011849
Functional at step 0        =     -16.77906749546338
Functional at step 1        =     -16.77906746138437
Rejected quadratic step     =               0.001330
Functional at new step 1    =     -16.77906749554533
Functional predicted        =     -16.77906749554545
Selected quadratic step     =               0.001385
Conjugate gradients coeff.  =              -0.291926
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999341
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514003017507
             Q0:     -16.779067495542
             G0:      -0.000000000085
   RMS gradient:       0.000001536593
     Trial step:       0.053188927036
             Q1:     -16.779067495546
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000005
           Qmin:     -16.779067495561
Quadratic minimum step length (  0.439523347701) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77906749554196 0.00000000000 0.00000115245 0.4395  0.000    8.00000000
      ideal mu1:      -0.514001205078
             Q0:     -16.779067495561
             G0:      -0.000000000004
   RMS gradient:       0.000000325080
     Trial step:       0.152897924353
             Q1:     -16.779067495562
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.779067495565
Quadratic minimum step length (  1.833068381673) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77906749556094 0.00000000000 0.00000024381 1.8331  0.045    8.00000000
      ideal mu1:      -0.514001262082
             Q0:     -16.779067495554
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.804E+01) too large - resetting
             G0:      -0.000000000031
   RMS gradient:       0.000000921634
     Trial step:       0.529407546938
             Q1:     -16.779067495561
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000016
           Qmin:     -16.779067495561
Quadratic minimum step length (  0.463912877583) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77906749555440 0.00000000000 0.00000069123 0.4639  0.000    8.00000000
      ideal mu1:      -0.514000984243
             Q0:     -16.779067495562
             G0:      -0.000000000001
   RMS gradient:       0.000000199943
     Trial step:       0.495579437138
             Q1:     -16.779067495562
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.779067495562
Quadratic minimum step length (  0.284112745429) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77906749556161 0.00000000000 0.00000014996 0.2841  0.047    8.00000000
      ideal mu1:      -0.514001132526
             Q0:     -16.779067495562
             G0:      -0.000000000000
   RMS gradient:       0.000000074442
     Trial step:       0.375233839710
             Q1:     -16.779067495562
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067495562
Quadratic minimum step length (  0.073541849264) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77906749556173 0.00000000000 0.00000005583 0.0735  0.139    8.00000000
      ideal mu1:      -0.514001152878
             Q0:     -16.779067495562
             G0:      -0.000000000000
   RMS gradient:       0.000000057539
     Trial step:       0.166118603651
             Q1:     -16.779067495562
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067495562
Quadratic minimum step length (  0.019121635754) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77906749556199 0.00000000000 0.00000004315 0.0191  0.597    8.00000000
      ideal mu1:      -0.514001159015
             Q0:     -16.779067495562
             G0:      -0.000000000000
   RMS gradient:       0.000000052482
     Trial step:       0.056360087216
             Q1:     -16.779067495562
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779067495562
  Cubic LS coeff:       0.063659715667
Predicted energy:     -16.779067495562
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77906749556177 0.00000000000 0.00000003936 0.0637  0.832    8.00000000
      ideal mu1:      -0.514001184983
             Q0:     -16.779067495562
             G0:      -0.000000000000
   RMS gradient:       0.000000031511
     Trial step:       0.059898807394
             Q1:     -16.779067495562
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067495562
Quadratic minimum step length (  0.000958021947) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77906749556194 0.00000000000 0.00000002363 0.0010  0.360    8.00000000
      ideal mu1:      -0.514001185199
             Q0:     -16.779067495562
             G0:      -0.000000000000
   RMS gradient:       0.000000031339
     Trial step:       0.007575247330
             Q1:     -16.779067495562
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779067495562
Quadratic minimum step length (  0.000004680944) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77906749556203 0.00000000000 0.00000002350 0.0000  0.000    8.00000000
      ideal mu1:      -0.514001185199
10    -16.77906749556202 0.00000000000 0.00000002350 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000071462827              |
           | Maximum change in energy =  0.00000000062170 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87550809770838 |
           | Pseudopotential (local)    :      -46.09475180368712 |
           | Pseudopotential (non-local):       -3.19401828955904 |
           | Hartree                    :       19.82653028000781 |
           | Exchange-correlation       :       -4.12818502800288 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77906749556202 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.09475180368779 |
           | Hartree                    :       19.82653028000822 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999709
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01094877551658    -16.47236560499659   0.246536    -16.73066454461378
   2     0.00300535265403    -16.73632940557509   0.375889    -16.76666201677466
   3     0.00142003314914    -16.76780478387664   0.389514    -16.77493314382559
   4     0.00085048139058    -16.77517699681487   0.420104    -16.77792553367843
   5     0.00049463321830    -16.77799019387024   0.309741    -16.77865252658255
   6     0.00030600105581    -16.77865247632947   0.398901    -16.77897886228911
   7     0.00017094534448    -16.77897868989968   0.306055    -16.77905677869839
   8     0.00006193929095    -16.77905760024275   0.185965    -16.77906390033196
   9     0.00003879083358    -16.77906422960506   0.226711    -16.77906721115072
  10     0.00001354365553    -16.77906741310715   0.044251    -16.77906748879881
  11     0.00000498635777    -16.77906749359828   0.008212    -16.77906749538285
  12     0.00000269413807    -16.77906749546338   0.001385    -16.77906749554545
  13     0.00000071462827    -16.77906749556202  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.315266086 Eh
                 Mid-gap level:      -0.102040178 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.967883253   1.0000000
                            2    -0.470656940   1.0000000
                            3    -0.357791328   1.0000000
                            4    -0.259673220   1.0000000
                        .......   --- gap ---   .........
                            5     0.055592865   0.0000000
                            6     0.143907458   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49622192  -0.08652598  -0.08369422 *
*    H       2     -1.16887410   0.92212699  -1.13127799 *
*    H       3     -1.12873392  -0.78712517   1.26720099 *
*                                                        *
**********************************************************
TOTAL:             -0.80138611   0.04847584   0.05222878
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77385867  -0.04395574  -0.02379865 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77385867  -0.04395574  -0.02379865
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00471310  -0.00079502  -0.00253888 *
*    H       2      0.00018660   0.00008142  -0.00012711 *
*    H       3      0.00017633  -0.00013075   0.00000370 *
*                                                        *
**********************************************************
TOTAL:              0.00507604  -0.00084435  -0.00266230
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00748380   0.00122525   0.00858928 *
*    H       2     -0.00748380   0.00122525   0.00858928 *
*    H       3     -0.00748380   0.00122525   0.00858928 *
*                                                        *
**********************************************************
TOTAL:             -0.02245140   0.00367575   0.02576784

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01847187   0.00042870   0.01588499 *
*    H       2      0.00815593  -0.00971938   0.00016371 *
*    H       3      0.01031594   0.00929068  -0.01604870 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1432.860s on      3 node(s)                                    
TOTAL TIME:      1432.862s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    52        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    26        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    15        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    12        0.01s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    26        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    13        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    26        0.01s   0.001%  ------ ||
|| basis_dot_function_with_box          :  2060        0.04s   0.003%  ------ ||
|| basis_add_function_to_box            :  4056        0.08s   0.006%  ------ ||
|| integrals_grad                       :     1        0.09s   0.006%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.09s   0.006%  ------ ||
|| lnv_gradient_norm                    :   130        0.09s   0.006%  ------ ||
|| kernel_fix                           :   130        0.09s   0.007%  ------ ||
|| kernel_purify                        :   417        0.11s   0.008%  ------ ||
|| sparse_trace                         :  3561        0.17s   0.012%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.19s   0.013%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.19s   0.013%  ------ ||
|| sparse_product                       :  4528        0.21s   0.015%  ------ ||
|| density_initial_guess_real           :     1        0.24s   0.017%  ------ ||
|| pseudo_make_structure_factor         :     1        0.25s   0.017%  ------ ||
|| basis_copy_function_to_box           :   932        0.52s   0.037%  ------ ||
|| density_batch_row_sums               :   286        0.55s   0.038%  ------ ||
|| fourier_apply_box_pair               :    88        0.64s   0.045%   9.280 ||
|| pseudopotentials_local_on_grid       :     1        0.75s   0.052%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.93s   0.065%  ------ ||
|| integrals_kinetic                    :    26        0.96s   0.067%  ------ ||
|| projectors_init_fftbox_recip         :    42        1.42s   0.099%  ------ ||
|| projectors_func_ovlp_box             :    26        1.42s   0.099%  ------ ||
|| forces_calculate                     :     1        1.47s   0.103%  ------ ||
|| projectors_gradient_batch            :    13        1.48s   0.104%  ------ ||
|| integrals_locpot_mat_els_batch       :   141        4.49s   0.313%  ------ ||
|| properties_calculate                 :     1        5.02s   0.350%  ------ ||
|| ngwf_gradient_batch                  :    13        9.23s   0.644%  ------ ||
|| ngwf_gradient_lnv                    :    13       10.08s   0.703%  ------ ||
|| cell_grid_extract_box                :   642       11.95s   0.834%  ------ ||
|| hamiltonian_energy_components        :     3       17.19s   1.200%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       34.59s   2.414%  ------ ||
|| cell_grid_deposit_box                :  1145       36.06s   2.517%  ------ ||
|| density_fftbox_deposit_to_cell       :  1144       36.07s   2.518%  ------ ||
|| density_fftbox_interpolate_multiply  :  1144       38.70s   2.701%  ------ ||
|| fourier_apply_box                    :  2154       39.69s   2.770%  17.783 ||
|| potential_apply_to_ngwf_batch        :   141       42.45s   2.963%  ------ ||
|| integrals_locpot_dbl_grid            :   141       47.01s   3.281%  ------ ||
|| density_batch_interp_deposit         :   286       79.18s   5.526%  ------ ||
|| density_on_dbl_grid                  :   286       89.36s   6.237%  ------ ||
|| hartree_on_grid                      :   286      216.43s  15.104%  ------ ||
|| fourier_apply_cell_backward          :  1431      500.14s  34.905%   3.192 ||
|| fourier_apply_cell_forward           :  1431      535.12s  37.346%   2.984 ||
|| xc_energy_potential                  :   286     1005.56s  70.179%  ------ ||
|| lnv_denskernel_optimise_cg           :    13     1292.88s  90.231%  ------ ||
|| ngwf_cg_optimise                     :     1     1385.25s  96.677%  ------ ||
|| total_time                           :     1     1432.86s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 22:45 (-0000)

