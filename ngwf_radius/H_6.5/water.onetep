 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 20:55 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.5                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   63 x  63 x  63
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):     88    88    88
         Recip-space ('23') slabs/node (min max mean):     44    45    44
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       2044      9740
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3216.4518354715   -7.1202816974   10.1554512533   -2.4512395525
  2 1275.3268459984   -3.1443812453   13.3511488054   -3.1747088977
  3  655.6100215422   -2.9485004107   13.5591716205   -3.2265097030
  4  333.4383110991   -2.9071229743   13.6038731329   -3.2393597159
  5  165.9195334793   -2.8936012298   13.6186080893   -3.2442341554
  6   78.8111333398   -2.8876998472   13.6250676297   -3.2465384671
  7   33.5149711848   -2.8848489821   13.6281943061   -3.2476984221
  8    9.9610079041   -2.8834315976   13.6297503547   -3.2482910000
  9   -2.2870418903   -2.8827209226   13.6305310368   -3.2485948083
 10   -8.6560240825   -2.8823635388   13.6309238114   -3.2487507577
 11  -11.9678934703   -2.8821835875   13.6311216658   -3.2488308715
 12  -13.6900650503   -2.8820929160   13.6312213986   -3.2488720574
 13  -14.5855940943   -2.8820472100   13.6312716928   -3.2488932467
 14  -15.0512691430   -2.8820241631   13.6312970640   -3.2489041566
 15  -15.2934201584   -2.8820125389   13.6313098662   -3.2489097782
 16  -15.4193386906   -2.8820066745   13.6313163278   -3.2489126774
 17  -15.4848163341   -2.8820037152   13.6313195901   -3.2489141737
 18  -15.5188647147   -2.8820022215   13.6313212375   -3.2489149466
 19  -15.5365698769   -2.8820014674   13.6313220696   -3.2489153462
 20  -15.5457765642   -2.8820010866   13.6313224901   -3.2489155530
 21  -15.5505640434   -2.8820008943   13.6313227026   -3.2489156600
 22  -15.5530535338   -2.8820007971   13.6313228100   -3.2489157156
 23  -15.5543480695   -2.8820007479   13.6313228644   -3.2489157443
 24  -15.5550212284   -2.8820007231   13.6313228919   -3.2489157593
 25  -15.5553712713   -2.8820007105   13.6313229058   -3.2489157671
 26  -15.5555532937   -2.8820007042   13.6313229129   -3.2489157711
 27  -15.5556479455   -2.8820007009   13.6313229164   -3.2489157732
 28  -15.5556971644   -2.8820006993   13.6313229182   -3.2489157743
 29  -15.5557227583   -2.8820006985   13.6313229191   -3.2489157749
 30  -15.5557360672   -2.8820006981   13.6313229196   -3.2489157752
 31  -15.5557429878   -2.8820006979   13.6313229199   -3.2489157753
 32  -15.5557465865   -2.8820006978   13.6313229200   -3.2489157754
 33  -15.5557484578   -2.8820006977   13.6313229200   -3.2489157755
 34  -15.5557494309   -2.8820006977   13.6313229201   -3.2489157755
 35  -15.5557499369   -2.8820006977   13.6313229201   -3.2489157755
 36  -15.5557502000   -2.8820006976   13.6313229201   -3.2489157755
 37  -15.5557503369   -2.8820006976   13.6313229201   -3.2489157755
 38  -15.5557504080   -2.8820006976   13.6313229201   -3.2489157755
Atom SCF converged after  38 iterations to a total energy of    -15.55575041

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  691    0.0094202899    6.5000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   27    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1   27.4022615684   -0.2329108132    0.2820958363   -0.2424203204
  2   10.6984909760   -0.2240313206    0.2969062819   -0.2539448712
  3    5.3473505840   -0.2194404695    0.3028736033   -0.2593536682
  4    2.5643763144   -0.2169639787    0.3059863980   -0.2623076982
  5    1.1173368878   -0.2157304612    0.3075158886   -0.2638120473
  6    0.3649858412   -0.2151363727    0.3082453932   -0.2645551341
  7   -0.0261758202   -0.2148547457    0.3085879697   -0.2649173558
  8   -0.2295517091   -0.2147222560    0.3087475031   -0.2650930996
  9   -0.3352955578   -0.2146601393    0.3088214538   -0.2651783639
 10   -0.3902781274   -0.2146310480    0.3088556430   -0.2652198382
 11   -0.4188678207   -0.2146174203    0.3088714238   -0.2652400958
 12   -0.4337342984   -0.2146110298    0.3088786990   -0.2652500407
 13   -0.4414650209   -0.2146080288    0.3088820491   -0.2652549503
 14   -0.4454851939   -0.2146066170    0.3088835896   -0.2652573884
 15   -0.4475758436   -0.2146059517    0.3088842967   -0.2652586063
 16   -0.4486630927   -0.2146056375    0.3088846205   -0.2652592184
 17   -0.4492285339   -0.2146054890    0.3088847681   -0.2652595278
 18   -0.4495226075   -0.2146054186    0.3088848352   -0.2652596850
 19   -0.4496755521   -0.2146053853    0.3088848654   -0.2652597654
 20   -0.4497550988   -0.2146053694    0.3088848789   -0.2652598067
 21   -0.4497964720   -0.2146053619    0.3088848848   -0.2652598280
 22   -0.4498179911   -0.2146053584    0.3088848874   -0.2652598390
 23   -0.4498291839   -0.2146053567    0.3088848885   -0.2652598447
 24   -0.4498350058   -0.2146053559    0.3088848889   -0.2652598477
 25   -0.4498380341   -0.2146053555    0.3088848891   -0.2652598493
 26   -0.4498396093   -0.2146053553    0.3088848891   -0.2652598501
 27   -0.4498404287   -0.2146053552    0.3088848891   -0.2652598506
 28   -0.4498408549   -0.2146053552    0.3088848891   -0.2652598508
 29   -0.4498410767   -0.2146053552    0.3088848891   -0.2652598509
 30   -0.4498411920   -0.2146053552    0.3088848891   -0.2652598510
 31   -0.4498412520   -0.2146053552    0.3088848891   -0.2652598510
Atom SCF converged after  31 iterations to a total energy of     -0.44984125
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20311564E+01     0.85009261E+00
               2       0.18167340E+01     0.72651774E+00
               3       0.15631031E+01     0.57017061E+00
               4       0.13126322E+01     0.49336934E+00
               5       0.10989101E+01     0.42122322E+00
               6       0.84417798E+00     0.32490391E+00
               7       0.50405329E+00     0.19496444E+00
               8       0.17995469E+00     0.70250295E-01
               9       0.23050425E-01     0.91396236E-02
              10       0.38530691E-03     0.15590281E-03
              11       0.11438524E-06     0.46599297E-07
              12       0.11387333E-13     0.45519144E-14
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.71172598130195    0.5874197
               2          -1.78288801247862    0.5774105
               3          -1.87448382142310    0.5618111
               4          -1.98190168080630    0.5416593
               5          -2.08658016862535    0.5230737
               6          -2.15921594035481    0.5103985
               7          -2.18892307955410    0.5017803
               8          -2.19438100663133    0.5000264
               9          -2.19458738407296    0.5000000
              10          -2.19458768839309    0.5011253
              11          -2.19458768839376    0.5011253
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.454102512840=    -16.454102512840+      0.000000000000
    Trial step:       1.000000000000
            G0:      -3.753021726825
WARNING: minimum value of charge density: -0.0516
      Q1=E1+P1:      50.787833449065=    -20.088740042892+     70.876573491957
Quadratic term:     -70.994957688730
   Linear term:      -3.753021726825
  Optimal step:       0.026431607603
 Predicted min:     -16.503701711644
    !!! Quadratic minimum step length accepted !!!
 1    -16.45410251283990 0.32287862042 0.03253688512 0.0264  0.000    8.00000000
      Q0=E0+P0:     -16.542246119637=    -16.553190859367+      0.010944739730
    Trial step:       0.162578004671
            G0:      -0.021340657737
      Q1=E1+P1:     -16.545598325855=    -16.556716430428+      0.011118104573
Quadratic term:      -0.000117315336
   Linear term:      -0.003469521553
  Optimal step:       2.404067160316
 Predicted min:     -16.567898306859
    !!! Quadratic minimum step length accepted !!!
 2    -16.55319085936728 0.24905216430 0.03377362414 2.4041 -0.765    8.00000000
      Q0=E0+P0:     -16.564301002719=    -16.590068493493+      0.025767490774
    Trial step:       0.625178728061
            G0:      -2.136944509912
WARNING: minimum value of charge density: -0.0013
      Q1=E1+P1:      -7.900485855865=    -18.309757670873+     10.409271815008
Quadratic term:      -9.999787397498
   Linear term:      -1.335972250644
  Optimal step:       0.041761959489
 Predicted min:     -16.608922497745
    !!! Quadratic minimum step length accepted !!!
 3    -16.59006849349317 0.24458309259 0.02747074427 0.0418  3.353    8.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.708335654116
   Final penalty energy   :       0.074378951707
   RMS occupancy error    :       0.055670
   Occupancy bounds       : [-0.068, 1.079]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.055670 (step -0.4145 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002172 (step -0.4996 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000011 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.530638638453
             Q0:     -16.462636035472
             G0:      -0.044743216737
   RMS gradient:       0.035254320751
     Trial step:       0.500000000000
             Q1:     -16.467537829366
 Quadratic coef:       0.017469814475
 Linear coef   :      -0.022371608369
           Qmin:     -16.469798230321
Quadratic minimum step length (  0.320146622058) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000969 (step -0.4981 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.46263603547229 0.00000000000 0.02644074052 0.3201  0.000    8.00000000
      ideal mu1:      -0.496868974046
             Q0:     -16.469794199928
             G0:      -0.000381534855
   RMS gradient:       0.003249337180
     Trial step:       0.400091628292
             Q1:     -16.469910065262
 Quadratic coef:       0.000036783567
 Linear coef   :      -0.000152648901
           Qmin:     -16.469952570152
Quadratic minimum step length (  0.830174344629) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000090 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.46979419992831 0.00089527436 0.00243700288 0.8302  0.008    8.00000000
      ideal mu1:      -0.496644846255
             Q0:     -16.469952639890
             G0:      -0.000045112893
   RMS gradient:       0.001119144607
     Trial step:       0.576320922150
             Q1:     -16.469965508265
 Quadratic coef:       0.000013131129
 Linear coef   :      -0.000025999504
           Qmin:     -16.469965509580
Quadratic minimum step length (  0.570554842635) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000015 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.46995263988986 0.00002003853 0.00083935846 0.5706  0.119    8.00000000
      ideal mu1:      -0.497699444672
             Q0:     -16.469965512516
             G0:      -0.000000910468
   RMS gradient:       0.000159072041
     Trial step:       0.573430634902
             Q1:     -16.469965620606
 Quadratic coef:       0.000000414000
 Linear coef   :      -0.000000522090
           Qmin:     -16.469965677116
Quadratic minimum step length (  0.361572729751) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.46996551251606 0.00000180335 0.00011930403 0.3616  0.020    8.00000000
      ideal mu1:      -0.497564233376
             Q0:     -16.469965677113
             G0:      -0.000000070898
   RMS gradient:       0.000044377780
     Trial step:       0.455342596277
             Q1:     -16.469965702702
 Quadratic coef:       0.000000006693
 Linear coef   :      -0.000000032283
           Qmin:     -16.469965716040
Quadratic minimum step length (  1.098110051647) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.46996567711268 0.00000002103 0.00003328333 1.0981  0.078    8.00000000
      ideal mu1:      -0.497570176148
             Q0:     -16.469965716041
             G0:      -0.000000005197
   RMS gradient:       0.000012014842
     Trial step:       0.707118294145
             Q1:     -16.469965717228
 Quadratic coef:       0.000000002488
 Linear coef   :      -0.000000003675
           Qmin:     -16.469965717398
Quadratic minimum step length (  0.522174151416) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.46996571604100 0.00000000525 0.00000901113 0.5222  0.073    8.00000000
      ideal mu1:      -0.497571734344
             Q0:     -16.469965717398
             G0:      -0.000000000553
   RMS gradient:       0.000003918958
     Trial step:       0.607650306670
             Q1:     -16.469965717503
 Quadratic coef:       0.000000000231
 Linear coef   :      -0.000000000336
           Qmin:     -16.469965717520
Quadratic minimum step length (  0.442447812712) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.46996571739772 0.00000000018 0.00000293922 0.4424  0.000    8.00000000
      ideal mu1:      -0.497570800078
             Q0:     -16.469965717520
             G0:      -0.000000000051
   RMS gradient:       0.000001194102
     Trial step:       0.518510895816
             Q1:     -16.469965717535
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000027
           Qmin:     -16.469965717536
Quadratic minimum step length (  0.605822727366) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.46996571752025 0.00000000002 0.00000089558 0.6058  0.093    8.00000000
      ideal mu1:      -0.497571358776
             Q0:     -16.469965717536
             G0:      -0.000000000004
   RMS gradient:       0.000000322239
     Trial step:       0.560469165139
             Q1:     -16.469965717537
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.469965717537
Quadratic minimum step length (  0.592150556950) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.46996571753598 0.00000000000 0.00000024168 0.5922  0.073    8.00000000
      ideal mu1:      -0.497571152843
10    -16.46996571753720 0.00000000000 0.00000011046 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01130646319198              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21212539E-01     0.13785989E-01
               2       0.26621900E-03     0.18428050E-03
               3       0.45104478E-07     0.33112966E-07
               4       0.15571425E-14     0.12212453E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27179785E-01     0.16995573E-01
               2       0.43079291E-03     0.27820886E-03
               3       0.11603278E-06     0.74903989E-07
               4       0.84243024E-14     0.54400928E-14
================================================================================
RMS gradient                =       0.01130646319198
Trial step length           =               0.122474
Gradient along search dir.  =         -2.06340265008
Functional at step 0        =     -16.46996571753720
Functional at step 1        =     -16.65958312964824
Functional predicted        =     -16.72300742726157
Selected quadratic step     =               0.245266
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.11748393
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010156 (step -0.4831 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000065 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511633030742
             Q0:     -16.722855605920
             G0:      -0.024095350580
   RMS gradient:       0.025871128578
     Trial step:       0.576092117886
             Q1:     -16.728197285569
 Quadratic coef:       0.008539461898
 Linear coef   :      -0.013881141547
           Qmin:     -16.728496654880
Quadratic minimum step length (  0.468227174524) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001094 (step -0.4979 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.72285560591968 0.00000000000 0.01940334642 0.4682  0.000    8.00000000
      ideal mu1:      -0.482744615677
             Q0:     -16.728495860316
             G0:      -0.001745924593
   RMS gradient:       0.006938995109
     Trial step:       0.519366907517
             Q1:     -16.728922947480
 Quadratic coef:       0.000479688293
 Linear coef   :      -0.000906775457
           Qmin:     -16.728924389499
Quadratic minimum step length (  0.490890826137) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000248 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.72849586031638 0.00070513112 0.00520424633 0.4909  0.072    8.00000000
      ideal mu1:      -0.486852968863
             Q0:     -16.728925195534
             G0:      -0.000259158066
   RMS gradient:       0.002680007089
     Trial step:       0.504928163504
             Q1:     -16.729007002908
 Quadratic coef:       0.000049048833
 Linear coef   :      -0.000130856206
           Qmin:     -16.729012472569
Quadratic minimum step length (  0.673542878731) accepted
    Initial Ne1:       8.00000016
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000097 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.72892519553405 0.00005777660 0.00201000528 0.6735  0.149    8.00000000
      ideal mu1:      -0.485735752317
             Q0:     -16.729012605701
             G0:      -0.000002017391
   RMS gradient:       0.000236485326
     Trial step:       0.583173017893
             Q1:     -16.729013316594
 Quadratic coef:       0.000000465595
 Linear coef   :      -0.000001176488
           Qmin:     -16.729013348903
Quadratic minimum step length (  0.736794840636) accepted
    Initial Ne1:       8.00000008
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.72901260570114 0.00001269844 0.00017736399 0.7368  0.008    8.00000000
      ideal mu1:      -0.485963689650
             Q0:     -16.729013348895
             G0:      -0.000000772895
   RMS gradient:       0.000146531662
     Trial step:       0.655498947964
             Q1:     -16.729013547154
 Quadratic coef:       0.000000308373
 Linear coef   :      -0.000000506632
           Qmin:     -16.729013556984
Quadratic minimum step length (  0.538466108351) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.72901334889490 0.00000009393 0.00010989875 0.5385  0.384    8.00000000
      ideal mu1:      -0.485847678028
             Q0:     -16.729013556982
             G0:      -0.000000026894
   RMS gradient:       0.000027331749
     Trial step:       0.594107707018
             Q1:     -16.729013563883
 Quadratic coef:       0.000000009077
 Linear coef   :      -0.000000015978
           Qmin:     -16.729013564014
Quadratic minimum step length (  0.522926972637) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.72901355698179 0.00000003613 0.00002049881 0.5229  0.035    8.00000000
      ideal mu1:      -0.485858481768
             Q0:     -16.729013564014
             G0:      -0.000000003164
   RMS gradient:       0.000009375507
     Trial step:       0.557382224915
             Q1:     -16.729013564756
 Quadratic coef:       0.000000001022
 Linear coef   :      -0.000000001764
           Qmin:     -16.729013564775
Quadratic minimum step length (  0.481192515382) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.72901356401359 0.00000000092 0.00000703163 0.4812  0.000    8.00000000
      ideal mu1:      -0.485853043113
             Q0:     -16.729013564775
             G0:      -0.000000000502
   RMS gradient:       0.000003735647
     Trial step:       0.517888168272
             Q1:     -16.729013564924
 Quadratic coef:       0.000000000111
 Linear coef   :      -0.000000000260
           Qmin:     -16.729013564927
Quadratic minimum step length (  0.604815678000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.72901356477494 0.00000000010 0.00000280174 0.6048  0.159    8.00000000
      ideal mu1:      -0.485855879914
             Q0:     -16.729013564927
             G0:      -0.000000000025
   RMS gradient:       0.000000835861
     Trial step:       0.559666761227
             Q1:     -16.729013564932
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000014
           Qmin:     -16.729013564933
Quadratic minimum step length (  0.456990047420) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.72901356492682 0.00000000002 0.00000062690 0.4570  0.050    8.00000000
      ideal mu1:      -0.485855234507
10    -16.72901356493255 0.00000000000 0.00000023342 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00314513821198              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11593022E-01     0.62922204E-02
               2       0.80262315E-04     0.46485234E-04
               3       0.43120296E-08     0.26754980E-08
               4       0.10581326E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18240601E-01     0.10060298E-01
               2       0.19267975E-03     0.11190286E-03
               3       0.23621063E-07     0.14652585E-07
               4       0.91019026E-15     0.66613381E-15
================================================================================
RMS gradient                =       0.00314513821198
Trial step length           =               0.173317
Gradient along search dir.  =         -0.16349068328
Functional at step 0        =     -16.72901356493255
Functional at step 1        =     -16.75120797149178
Functional predicted        =     -16.76169834697692
Selected quadratic step     =               0.399837
Conjugate gradients coeff.  =               0.077380
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05811526
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.005018 (step -0.4914 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000019 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.503761892564
             Q0:     -16.761383724966
             G0:      -0.008473588659
   RMS gradient:       0.015342016254
     Trial step:       0.505729314705
             Q1:     -16.763015380771
 Quadratic coef:       0.002653686380
 Linear coef   :      -0.004285342185
           Qmin:     -16.763113786003
Quadratic minimum step length (  0.408341992305) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000303 (step -0.4994 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.76138372496557 0.00000000000 0.01150651216 0.4083  0.000    8.00000000
      ideal mu1:      -0.485834088648
             Q0:     -16.763113163218
             G0:      -0.000468647882
   RMS gradient:       0.003604046468
     Trial step:       0.454434281204
             Q1:     -16.763228526482
 Quadratic coef:       0.000097606399
 Linear coef   :      -0.000212969663
           Qmin:     -16.763229334078
Quadratic minimum step length (  0.495770340672) accepted
    Initial Ne1:       8.00000036
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000059 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.76311316321836 0.00021625763 0.00270303553 0.4958  0.055    8.00000000
      ideal mu1:      -0.486424259348
             Q0:     -16.763229396007
             G0:      -0.000026331614
   RMS gradient:       0.000854673716
     Trial step:       0.474652544927
             Q1:     -16.763238395000
 Quadratic coef:       0.000003499375
 Linear coef   :      -0.000012498368
           Qmin:     -16.763240555800
Quadratic minimum step length (  0.847634550476) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.76322939600706 0.00001535311 0.00064100529 0.8476  0.056    8.00000000
      ideal mu1:      -0.486263501328
             Q0:     -16.763240558364
             G0:      -0.000000021013
   RMS gradient:       0.000024155892
     Trial step:       0.634296379110
             Q1:     -16.763240563691
 Quadratic coef:       0.000000008002
 Linear coef   :      -0.000000013329
           Qmin:     -16.763240563915
Quadratic minimum step length (  0.528273377320) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.76324055836440 0.00000147983 0.00001811692 0.5283  0.001    8.00000000
      ideal mu1:      -0.486287366892
             Q0:     -16.763240563915
             G0:      -0.000000005458
   RMS gradient:       0.000012312605
     Trial step:       0.578862583360
             Q1:     -16.763240565796
 Quadratic coef:       0.000000001278
 Linear coef   :      -0.000000003159
           Qmin:     -16.763240565867
Quadratic minimum step length (  0.715357369955) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.76324056391489 0.00000000069 0.00000923445 0.7154  0.260    8.00000000
      ideal mu1:      -0.486279565509
             Q0:     -16.763240565867
             G0:      -0.000000000205
   RMS gradient:       0.000002386505
     Trial step:       0.643501060758
             Q1:     -16.763240565910
 Quadratic coef:       0.000000000089
 Linear coef   :      -0.000000000132
           Qmin:     -16.763240565916
Quadratic minimum step length (  0.478744477227) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.76324056586692 0.00000000031 0.00000178988 0.4787  0.038    8.00000000
      ideal mu1:      -0.486280150860
             Q0:     -16.763240565916
             G0:      -0.000000000019
   RMS gradient:       0.000000729147
     Trial step:       0.555042862244
             Q1:     -16.763240565922
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000011
           Qmin:     -16.763240565922
Quadratic minimum step length (  0.599597674935) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.76324056591596 0.00000000001 0.00000054686 0.5996  0.000    8.00000000
      ideal mu1:      -0.486279756615
             Q0:     -16.763240565922
             G0:      -0.000000000005
   RMS gradient:       0.000000365270
     Trial step:       0.576890292595
             Q1:     -16.763240565923
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.763240565923
Quadratic minimum step length (  0.663863077093) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.76324056592183 0.00000000000 0.00000027395 0.6639  0.251    8.00000000
      ideal mu1:      -0.486279925422
             Q0:     -16.763240565924
             G0:      -0.000000000000
   RMS gradient:       0.000000099534
     Trial step:       0.618850680526
             Q1:     -16.763240565924
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.763240565924
Quadratic minimum step length (  0.612615653328) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.76324056592371 0.00000000000 0.00000007465 0.6126  0.074    8.00000000
      ideal mu1:      -0.486279883081
10    -16.76324056592381 0.00000000000 0.00000002775 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00164680709485              |
           | Maximum change in energy =  0.08634928246511 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13912856E-01     0.58515696E-02
               2       0.12065054E-03     0.50355478E-04
               3       0.10750506E-07     0.46328579E-08
               4       0.85276101E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.82270438E-02     0.34465916E-02
               2       0.41092025E-04     0.16881185E-04
               3       0.12064370E-08     0.50860527E-09
               4       0.69541126E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00164680709485
Trial step length           =               0.263246
Gradient along search dir.  =         -0.04585456236
Functional at step 0        =     -16.76324056592381
Functional at step 1        =     -16.77131851905764
Functional predicted        =     -16.77236320586516
Selected quadratic step     =               0.397895
Conjugate gradients coeff.  =               0.274161
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02906378
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002523 (step -0.4955 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.508427822557
             Q0:     -16.772274925099
             G0:      -0.002289671353
   RMS gradient:       0.007975085079
     Trial step:       0.615725274747
             Q1:     -16.772571875706
 Quadratic coef:       0.001112857916
 Linear coef   :      -0.001409808523
           Qmin:     -16.772721424163
Quadratic minimum step length (  0.390011486299) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000071 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77227492509914 0.00000000000 0.00598131381 0.3900  0.000    8.00000000
      ideal mu1:      -0.499269867821
             Q0:     -16.772720805763
             G0:      -0.000092112187
   RMS gradient:       0.001599561609
     Trial step:       0.490040742751
             Q1:     -16.772746226643
 Quadratic coef:       0.000019717844
 Linear coef   :      -0.000045138724
           Qmin:     -16.772746639019
Quadratic minimum step length (  0.560908538667) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77272080576281 0.00005581238 0.00119967121 0.5609  0.040    8.00000000
      ideal mu1:      -0.499133157958
             Q0:     -16.772746645406
             G0:      -0.000005619711
   RMS gradient:       0.000394928692
     Trial step:       0.524278587112
             Q1:     -16.772748694555
 Quadratic coef:       0.000000897145
 Linear coef   :      -0.000002946294
           Qmin:     -16.772749064370
Quadratic minimum step length (  0.860885532313) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77274664540643 0.00000335915 0.00029619652 0.8609  0.061    8.00000000
      ideal mu1:      -0.499106868022
             Q0:     -16.772749064501
             G0:      -0.000000003971
   RMS gradient:       0.000010502341
     Trial step:       0.671821293609
             Q1:     -16.772749066124
 Quadratic coef:       0.000000001046
 Linear coef   :      -0.000000002668
           Qmin:     -16.772749066203
Quadratic minimum step length (  0.857157037534) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77274906450138 0.00000032179 0.00000787676 0.8572  0.001    8.00000000
      ideal mu1:      -0.499112152557
             Q0:     -16.772749066203
             G0:      -0.000000001403
   RMS gradient:       0.000006243925
     Trial step:       0.758851994649
             Q1:     -16.772749066535
 Quadratic coef:       0.000000000733
 Linear coef   :      -0.000000001065
           Qmin:     -16.772749066590
Quadratic minimum step length (  0.551036962405) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77274906620300 0.00000000021 0.00000468294 0.5510  0.353    8.00000000
      ideal mu1:      -0.499108562671
             Q0:     -16.772749066590
             G0:      -0.000000000060
   RMS gradient:       0.000001290469
     Trial step:       0.646649439840
             Q1:     -16.772749066609
 Quadratic coef:       0.000000000019
 Linear coef   :      -0.000000000039
           Qmin:     -16.772749066609
Quadratic minimum step length (  0.646275245372) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77274906658990 0.00000000007 0.00000096785 0.6463  0.043    8.00000000
      ideal mu1:      -0.499109452232
             Q0:     -16.772749066609
             G0:      -0.000000000009
   RMS gradient:       0.000000489777
     Trial step:       0.646462315532
             Q1:     -16.772749066611
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000006
           Qmin:     -16.772749066611
Quadratic minimum step length (  0.438239884840) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77274906660920 0.00000000000 0.00000036733 0.4382  0.000    8.00000000
      ideal mu1:      -0.499109064812
             Q0:     -16.772749066611
             G0:      -0.000000000001
   RMS gradient:       0.000000158703
     Trial step:       0.532264568341
             Q1:     -16.772749066611
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.772749066611
  Cubic LS coeff:       0.767589568419
Predicted energy:     -16.772749066612
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77274906661090 0.00000000000 0.00000011903 0.7676  0.105    8.00000000
      ideal mu1:      -0.499109173684
             Q0:     -16.772749066612
             G0:      -0.000000000000
   RMS gradient:       0.000000043711
     Trial step:       0.639187554868
             Q1:     -16.772749066611
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.772749066612
Quadratic minimum step length (  0.142037131114) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77274906661153 0.00000000000 0.00000003278 0.1420  0.076    8.00000000
      ideal mu1:      -0.499109165166
10    -16.77274906661141 0.00000000000 0.00000002368 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00096732866977              |
           | Maximum change in energy =  0.01140900033042 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14060870E-01     0.50022468E-02
               2       0.12928760E-03     0.45655494E-04
               3       0.12140987E-07     0.47430744E-08
               4       0.89322318E-15     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.37117319E-02     0.13420826E-02
               2       0.88508108E-05     0.29981322E-05
               3       0.54957975E-10     0.20492372E-10
               4       0.91294228E-15     0.66613381E-15
================================================================================
RMS gradient                =       0.00096732866977
Trial step length           =               0.323642
Gradient along search dir.  =         -0.01575080128
Functional at step 0        =     -16.77274906661141
Functional at step 1        =     -16.77577607079725
Functional predicted        =     -16.77588650539655
Selected quadratic step     =               0.398385
Conjugate gradients coeff.  =               0.345035
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01208519
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001075 (step -0.4976 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512968916428
             Q0:     -16.775869129843
             G0:      -0.000339841788
   RMS gradient:       0.003072466381
     Trial step:       0.301311079347
             Q1:     -16.775933924278
 Quadratic coef:       0.000037603661
 Linear coef   :      -0.000102398096
           Qmin:     -16.775938839613
Quadratic minimum step length (  0.410248368696) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77586912984298 0.00000000000 0.00230434979 0.4102  0.000    8.00000000
      ideal mu1:      -0.509330658827
             Q0:     -16.775938863752
             G0:      -0.000017396960
   RMS gradient:       0.000694820247
     Trial step:       0.351585521278
             Q1:     -16.775943171615
 Quadratic coef:       0.000001808657
 Linear coef   :      -0.000006116519
           Qmin:     -16.775944034967
Quadratic minimum step length (  0.594496340027) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77593886375248 0.00000871372 0.00052111518 0.5945  0.051    8.00000000
      ideal mu1:      -0.509290141783
             Q0:     -16.775944036260
             G0:      -0.000001404613
   RMS gradient:       0.000197473893
     Trial step:       0.457183011064
             Q1:     -16.775944502200
 Quadratic coef:       0.000000176226
 Linear coef   :      -0.000000642165
           Qmin:     -16.775944621271
Quadratic minimum step length (  0.832985451314) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77594403626019 0.00000068006 0.00014810542 0.8330  0.081    8.00000000
      ideal mu1:      -0.509288275706
             Q0:     -16.775944621280
             G0:      -0.000000001471
   RMS gradient:       0.000006392156
     Trial step:       0.617111656675
             Q1:     -16.775944621727
 Quadratic coef:       0.000000000461
 Linear coef   :      -0.000000000908
           Qmin:     -16.775944621727
Quadratic minimum step length (  0.607682557520) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77594462128000 0.00000007938 0.00000479412 0.6077  0.001    8.00000000
      ideal mu1:      -0.509287703332
             Q0:     -16.775944621727
             G0:      -0.000000000390
   RMS gradient:       0.000003289832
     Trial step:       0.612378959309
             Q1:     -16.775944621878
 Quadratic coef:       0.000000000088
 Linear coef   :      -0.000000000239
           Qmin:     -16.775944621889
Quadratic minimum step length (  0.831302654674) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77594462172682 0.00000000006 0.00000246737 0.8313  0.265    8.00000000
      ideal mu1:      -0.509288119038
             Q0:     -16.775944621889
             G0:      -0.000000000016
   RMS gradient:       0.000000660322
     Trial step:       0.713492995439
             Q1:     -16.775944621895
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000011
           Qmin:     -16.775944621895
Quadratic minimum step length (  0.749602404494) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77594462188885 0.00000000003 0.00000049524 0.7496  0.040    8.00000000
      ideal mu1:      -0.509287852538
             Q0:     -16.775944621895
             G0:      -0.000000000001
   RMS gradient:       0.000000166678
     Trial step:       0.731324869651
             Q1:     -16.775944621895
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.775944621895
Quadratic minimum step length (  0.392091178409) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77594462189502 0.00000000000 0.00000012501 0.3921  0.000    8.00000000
      ideal mu1:      -0.509288003674
             Q0:     -16.775944621895
             G0:      -0.000000000000
   RMS gradient:       0.000000050106
     Trial step:       0.535486722470
             Q1:     -16.775944621895
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.775944621895
Quadratic minimum step length (  0.218301944755) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77594462189493 0.00000000000 0.00000003758 0.2183  0.090    8.00000000
      ideal mu1:      -0.509288003674
             Q0:     -16.775944621895
             G0:      -0.000000000000
   RMS gradient:       0.000000037267
     Trial step:       0.341903192301
             Q1:     -16.775944621895
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.775944621895
  Cubic LS coeff:       0.461979273765
Predicted energy:     -16.775944621895
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77594462189490 0.00000000000 0.00000002795 0.4620  0.553    8.00000000
      ideal mu1:      -0.509287987879
10    -16.77594462189501 0.00000000000 0.00000000489 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00051301695911              |
           | Maximum change in energy =  0.00316950022920 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88921557436792 |
           | Pseudopotential (local)    :      -46.13837684927944 |
           | Pseudopotential (non-local):       -3.19121176079421 |
           | Hartree                    :       19.86325885928655 |
           | Exchange-correlation       :       -4.13467969344667 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77594462189501 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.13837684927974 |
           | Hartree                    :       19.86325885928676 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999612
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.48473642E-02     0.17378133E-02
               2       0.14811692E-04     0.55981223E-05
               3       0.16402682E-09     0.68038158E-10
               4       0.10015605E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.73689425E-03     0.25236623E-03
               2       0.34618266E-06     0.12604490E-06
               3       0.87135649E-13     0.35027536E-13
================================================================================
RMS gradient                =       0.00051301695911
Trial step length           =               0.359074
Gradient along search dir.  =         -0.00424809169
Functional at step 0        =     -16.77594462189501
Functional at step 1        =     -16.77658327317935
Functional predicted        =     -16.77660062401687
Selected quadratic step     =               0.308846
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99838700
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000198 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.509479612158
             Q0:     -16.776600354006
             G0:      -0.000002454238
   RMS gradient:       0.000261100109
     Trial step:       0.397431992267
             Q1:     -16.776600869380
 Quadratic coef:       0.000000460018
 Linear coef   :      -0.000000975393
           Qmin:     -16.776600871045
Quadratic minimum step length (  0.421344243429) accepted
    Initial Ne1:       7.99999946
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77660035400603 0.00000000000 0.00019582501 0.4213  0.000    8.00000000
      ideal mu1:      -0.509781241959
             Q0:     -16.776600871043
             G0:      -0.000000119091
   RMS gradient:       0.000057517659
     Trial step:       0.409213492075
             Q1:     -16.776600901435
 Quadratic coef:       0.000000018341
 Linear coef   :      -0.000000048734
           Qmin:     -16.776600903415
Quadratic minimum step length (  0.543649622084) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77660087104295 0.00000006463 0.00004313824 0.5436  0.049    8.00000000
      ideal mu1:      -0.509771110535
             Q0:     -16.776600903415
             G0:      -0.000000006468
   RMS gradient:       0.000013403852
     Trial step:       0.471665941444
             Q1:     -16.776600905670
 Quadratic coef:       0.000000000795
 Linear coef   :      -0.000000003051
           Qmin:     -16.776600906340
Quadratic minimum step length (  0.904492042945) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77660090341494 0.00000000424 0.00001005289 0.9045  0.054    8.00000000
      ideal mu1:      -0.509765695037
             Q0:     -16.776600906341
             G0:      -0.000000000113
   RMS gradient:       0.000001768803
     Trial step:       0.653160080657
             Q1:     -16.776600906358
 Quadratic coef:       0.000000000057
 Linear coef   :      -0.000000000074
           Qmin:     -16.776600906365
Quadratic minimum step length (  0.421286466800) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77660090634097 0.00000000039 0.00000132660 0.4213  0.017    8.00000000
      ideal mu1:      -0.509765397501
             Q0:     -16.776600906365
             G0:      -0.000000000002
   RMS gradient:       0.000000244056
     Trial step:       0.524564107269
             Q1:     -16.776600906366
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.776600906366
Quadratic minimum step length (  1.000760159287) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77660090636471 0.00000000000 0.00000018304 1.0008  0.019    8.00000000
      ideal mu1:      -0.509765407884
             Q0:     -16.776600906366
             G0:      -0.000000000000
   RMS gradient:       0.000000073031
     Trial step:       0.724543207508
             Q1:     -16.776600906366
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776600906366
  Cubic LS coeff:       0.925944876857
Predicted energy:     -16.776600906366
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77660090636559 0.00000000000 0.00000005477 0.9259  0.090    8.00000000
      ideal mu1:      -0.509765404318
             Q0:     -16.776600906366
             G0:      -0.000000000000
   RMS gradient:       0.000000018232
     Trial step:       0.819076962839
             Q1:     -16.776600906365
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776600906366
Quadratic minimum step length (  0.011769447381) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77660090636580 0.00000000000 0.00000001367 0.0118  0.000    8.00000000
      ideal mu1:      -0.509765404377
             Q0:     -16.776600906366
             G0:      -0.000000000000
   RMS gradient:       0.000000017882
     Trial step:       0.098183925440
             Q1:     -16.776600906366
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776600906366
Quadratic minimum step length (  0.000461748971) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77660090636583 0.00000000000 0.00000001341 0.0005  0.962    8.00000000
      ideal mu1:      -0.509765404381
             Q0:     -16.776600906366
             G0:      -0.000000000000
   RMS gradient:       0.000000017856
     Trial step:       0.006733225564
             Q1:     -16.776600906366
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776600906366
  Cubic LS coeff:       0.009771990563
Predicted energy:     -16.776600906366
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77660090636556 0.00000000000 0.00000001339 0.0098  0.997    8.00000000
      ideal mu1:      -0.509765404523
10    -16.77660090636570 0.00000000000 0.00000001276 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00028653138907              |
           | Maximum change in energy =  0.00106518509453 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56870889E-02     0.19497039E-02
               2       0.20414612E-04     0.72062936E-05
               3       0.30195955E-09     0.11857296E-09
               4       0.10695557E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21039276E-03     0.68217883E-04
               2       0.28176365E-07     0.96752752E-08
               3       0.88145502E-15     0.33306691E-15
================================================================================
RMS gradient                =       0.00028653138907
Trial step length           =               0.333014
Gradient along search dir.  =         -0.00132559664
Functional at step 0        =     -16.77660090636570
Functional at step 1        =     -16.77681408359145
Functional predicted        =     -16.77681433291211
Selected quadratic step     =               0.322008
Conjugate gradients coeff.  =               0.311947
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99796147
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000240 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.510935620613
             Q0:     -16.776813894115
             G0:      -0.000000411331
   RMS gradient:       0.000106891825
     Trial step:       0.008111536024
             Q1:     -16.776813897428
 Quadratic coef:       0.000000000024
 Linear coef   :      -0.000000003337
           Qmin:     -16.776814010567
Quadratic minimum step length (  0.566221108497) accepted
    Initial Ne1:       7.99999958
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77681389411524 0.00000000000 0.00008016856 0.5662  0.000    8.00000000
      ideal mu1:      -0.510976321316
             Q0:     -16.776814011558
             G0:      -0.000000009285
   RMS gradient:       0.000015992092
     Trial step:       0.067771106818
             Q1:     -16.776814012152
 Quadratic coef:       0.000000000034
 Linear coef   :      -0.000000000629
           Qmin:     -16.776814014436
Quadratic minimum step length (  0.620024709403) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77681401155757 0.00000001456 0.00001199407 0.6200  0.022    8.00000000
      ideal mu1:      -0.510992302676
             Q0:     -16.776814014471
             G0:      -0.000000002798
   RMS gradient:       0.000008762225
     Trial step:       0.204987221091
             Q1:     -16.776814014959
 Quadratic coef:       0.000000000085
 Linear coef   :      -0.000000000573
           Qmin:     -16.776814015440
Quadratic minimum step length (  0.692764004209) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77681401447072 0.00000000037 0.00000657167 0.6928  0.300    8.00000000
      ideal mu1:      -0.510983381231
             Q0:     -16.776814015440
             G0:      -0.000000000034
   RMS gradient:       0.000000969890
     Trial step:       0.376839180679
             Q1:     -16.776814015450
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000013
           Qmin:     -16.776814015458
Quadratic minimum step length (  1.056517565797) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77681401543987 0.00000000016 0.00000072742 1.0565  0.012    8.00000000
      ideal mu1:      -0.510983485068
             Q0:     -16.776814015458
             G0:      -0.000000000007
   RMS gradient:       0.000000457860
     Trial step:       0.630981151753
             Q1:     -16.776814015459
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000005
           Qmin:     -16.776814015459
Quadratic minimum step length (  0.503337456185) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77681401545751 0.00000000000 0.00000034339 0.5033  0.223    8.00000000
      ideal mu1:      -0.510983463129
             Q0:     -16.776814015459
             G0:      -0.000000000000
   RMS gradient:       0.000000112965
     Trial step:       0.563556960585
             Q1:     -16.776814015460
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776814015459
  Cubic LS coeff:       0.723948282295
Predicted energy:     -16.776814015460
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77681401545926 0.00000000000 0.00000008472 0.7239  0.061    8.00000000
      ideal mu1:      -0.510983571930
             Q0:     -16.776814015459
             G0:      -0.000000000000
   RMS gradient:       0.000000045030
     Trial step:       0.638737891150
             Q1:     -16.776814015459
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776814015459
Quadratic minimum step length (  0.089177630686) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77681401545945 0.00000000000 0.00000003377 0.0892  0.000    8.00000000
      ideal mu1:      -0.510983565550
             Q0:     -16.776814015459
             G0:      -0.000000000000
   RMS gradient:       0.000000038538
     Trial step:       0.238665313278
             Q1:     -16.776814015459
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776814015459
Quadratic minimum step length (  0.009937251832) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77681401545944 0.00000000000 0.00000002890 0.0099  0.732    8.00000000
      ideal mu1:      -0.510983564448
             Q0:     -16.776814015459
             G0:      -0.000000000000
   RMS gradient:       0.000000037409
     Trial step:       0.048699869831
             Q1:     -16.776814015459
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776814015459
Quadratic minimum step length (  0.009416809326) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77681401545942 0.00000000000 0.00000002806 0.0094  0.942    8.00000000
      ideal mu1:      -0.510983562934
10    -16.77681401545934 0.00000000000 0.00000002689 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00011705601926              |
           | Maximum change in energy =  0.00021876149023 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44471686E-02     0.15170652E-02
               2       0.12271332E-04     0.42001220E-05
               3       0.10647866E-09     0.40785278E-10
               4       0.10010463E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15062741E-02     0.49747261E-03
               2       0.14189770E-05     0.47109897E-06
               3       0.13973657E-11     0.51884885E-12
================================================================================
RMS gradient                =       0.00011705601926
Trial step length           =               0.327465
Gradient along search dir.  =         -0.00022077195
Functional at step 0        =     -16.77681401545934
Functional at step 1        =     -16.77683356439042
Functional predicted        =     -16.77683878778180
Selected quadratic step     =               0.224415
Conjugate gradients coeff.  =               0.166895
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99878285
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000122 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511923638661
             Q0:     -16.776838658186
             G0:      -0.000001301443
   RMS gradient:       0.000190134697
     Trial step:       0.021414887074
             Q1:     -16.776838685252
 Quadratic coef:       0.000000000804
 Linear coef   :      -0.000000027870
           Qmin:     -16.776838899597
Quadratic minimum step length (  0.370989340206) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77683865818576 0.00000000000 0.00014260100 0.3710  0.000    8.00000000
      ideal mu1:      -0.511728944571
             Q0:     -16.776838899756
             G0:      -0.000000003780
   RMS gradient:       0.000010242888
     Trial step:       0.089133017599
             Q1:     -16.776838900070
 Quadratic coef:       0.000000000023
 Linear coef   :      -0.000000000337
           Qmin:     -16.776838901000
Quadratic minimum step length (  0.658374120720) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77683889975576 0.00000003018 0.00000768217 0.6584  0.003    8.00000000
      ideal mu1:      -0.511722505331
             Q0:     -16.776838901005
             G0:      -0.000000000303
   RMS gradient:       0.000002893934
     Trial step:       0.242245478985
             Q1:     -16.776838901070
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000073
           Qmin:     -16.776838901167
Quadratic minimum step length (  1.072658950640) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77683890100483 0.00000000016 0.00000217045 1.0727  0.080    8.00000000
      ideal mu1:      -0.511723200071
             Q0:     -16.776838901167
             G0:      -0.000000000021
   RMS gradient:       0.000000763376
     Trial step:       0.509751685907
             Q1:     -16.776838901173
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000011
           Qmin:     -16.776838901173
Quadratic minimum step length (  0.593231236283) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77683890116706 0.00000000002 0.00000057253 0.5932  0.070    8.00000000
      ideal mu1:      -0.511723047582
             Q0:     -16.776838901174
             G0:      -0.000000000004
   RMS gradient:       0.000000337436
     Trial step:       0.549909649695
             Q1:     -16.776838901174
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.776838901174
Quadratic minimum step length (  0.472744654757) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77683890117355 0.00000000000 0.00000025308 0.4727  0.195    8.00000000
      ideal mu1:      -0.511723128079
             Q0:     -16.776838901174
             G0:      -0.000000000001
   RMS gradient:       0.000000128708
     Trial step:       0.509869441615
             Q1:     -16.776838901175
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776838901176
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  3.275007157967)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77683890117446 0.00000000000 0.00000009653 0.1500  0.000    8.00000000
      ideal mu1:      -0.511723136104
             Q0:     -16.776838901175
             G0:      -0.000000000001
   RMS gradient:       0.000000089665
     Trial step:       0.276550928840
             Q1:     -16.776838901175
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776838901175
  Cubic LS coeff:       0.441411089791
Predicted energy:     -16.776838901175
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77683890117452 0.00000000000 0.00000006725 0.4414  0.485    8.00000000
      ideal mu1:      -0.511723152013
             Q0:     -16.776838901175
             G0:      -0.000000000000
   RMS gradient:       0.000000062751
     Trial step:       0.349388962164
             Q1:     -16.776838901175
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776838901175
  Cubic LS coeff:       0.518116419044
Predicted energy:     -16.776838901175
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77683890117462 0.00000000000 0.00000004706 0.5181  0.490    8.00000000
      ideal mu1:      -0.511723149520
             Q0:     -16.776838901175
             G0:      -0.000000000000
   RMS gradient:       0.000000052907
     Trial step:       0.425469338413
             Q1:     -16.776838901175
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776838901175
  Cubic LS coeff:       0.439937087602
Predicted energy:     -16.776838901175
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77683890117473 0.00000000000 0.00000003968 0.4399  0.711    8.00000000
      ideal mu1:      -0.511723147677
10    -16.77683890117484 0.00000000000 0.00000003097 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002766344344              |
           | Maximum change in energy =  0.00007103636455 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.124082E-04
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20389409E-02     0.77610349E-03
               2       0.23642071E-05     0.97217298E-06
               3       0.42139371E-11     0.18564039E-11
               4       0.89611007E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15369122E-02     0.58882455E-03
               2       0.13320224E-05     0.55629783E-06
               3       0.13458047E-11     0.59974248E-12
================================================================================
RMS gradient                =       0.00002766344344
Trial step length           =               0.271087
Gradient along search dir.  =         -0.00001235216
Functional at step 0        =     -16.77683890117484
Functional at step 1        =     -16.77683504850445
Functional predicted        =     -16.77683929043479
Selected quadratic step     =               0.063027
Conjugate gradients coeff.  =              -0.055850
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00025164
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000026 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511549320327
             Q0:     -16.776839283992
             G0:      -0.000000101565
   RMS gradient:       0.000053115538
     Trial step:       0.432642741307
             Q1:     -16.776839302931
 Quadratic coef:       0.000000025002
 Linear coef   :      -0.000000043942
           Qmin:     -16.776839303299
Quadratic minimum step length (  0.380187208554) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77683928399179 0.00000000000 0.00003983665 0.3802  0.000    8.00000000
      ideal mu1:      -0.511607402381
             Q0:     -16.776839303299
             G0:      -0.000000001139
   RMS gradient:       0.000005624605
     Trial step:       0.405567794726
             Q1:     -16.776839303594
 Quadratic coef:       0.000000000166
 Linear coef   :      -0.000000000462
           Qmin:     -16.776839303619
Quadratic minimum step length (  0.562574274936) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77683930329900 0.00000000241 0.00000421845 0.5626  0.011    8.00000000
      ideal mu1:      -0.511609647386
             Q0:     -16.776839303620
             G0:      -0.000000000015
   RMS gradient:       0.000000639470
     Trial step:       0.477663069595
             Q1:     -16.776839303625
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000007
           Qmin:     -16.776839303628
Quadratic minimum step length (  1.124652111265) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77683930361988 0.00000000004 0.00000047960 1.1247  0.013    8.00000000
      ideal mu1:      -0.511609698616
             Q0:     -16.776839303629
             G0:      -0.000000000001
   RMS gradient:       0.000000113912
     Trial step:       0.732942548699
             Q1:     -16.776839303629
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839303629
Quadratic minimum step length (  0.743512002956) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77683930362886 0.00000000000 0.00000008543 0.7435  0.032    8.00000000
      ideal mu1:      -0.511609689022
             Q0:     -16.776839303629
             G0:      -0.000000000000
   RMS gradient:       0.000000055998
     Trial step:       0.738208359770
             Q1:     -16.776839303629
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839303629
  Cubic LS coeff:       0.953163725498
Predicted energy:     -16.776839303630
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77683930362921 0.00000000000 0.00000004200 0.9532  0.242    8.00000000
      ideal mu1:      -0.511609673849
             Q0:     -16.776839303629
             G0:      -0.000000000000
   RMS gradient:       0.000000026962
     Trial step:       0.838828606089
             Q1:     -16.776839303629
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839303629
Quadratic minimum step length (  0.039792017813) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77683930362943 0.00000000000 0.00000002022 0.0398  0.232    8.00000000
      ideal mu1:      -0.511609674576
             Q0:     -16.776839303629
             G0:      -0.000000000000
   RMS gradient:       0.000000025191
     Trial step:       0.182698338349
             Q1:     -16.776839303629
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839303629
  Cubic LS coeff:       0.232062673537
Predicted energy:     -16.776839303630
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77683930362926 0.00000000000 0.00000001889 0.2321  0.000    8.00000000
      ideal mu1:      -0.511609679240
             Q0:     -16.776839303629
             G0:      -0.000000000000
   RMS gradient:       0.000000012344
     Trial step:       0.205906446835
             Q1:     -16.776839303629
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839303629
Quadratic minimum step length (  0.005359860656) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77683930362938 0.00000000000 0.00000000926 0.0054  0.240    8.00000000
      ideal mu1:      -0.511609679311
             Q0:     -16.776839303629
             G0:      -0.000000000000
   RMS gradient:       0.000000012150
     Trial step:       0.033220925081
             Q1:     -16.776839303629
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839303629
  Cubic LS coeff:       0.045667273667
Predicted energy:     -16.776839303629
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77683930362920 0.00000000000 0.00000000911 0.0457  0.969    8.00000000
      ideal mu1:      -0.511609680273
10    -16.77683930362930 0.00000000000 0.00000000717 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001176294282              |
           | Maximum change in energy =  0.00000829523850 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13359241E-02     0.48656765E-03
               2       0.10626859E-05     0.39600386E-06
               3       0.82028717E-12     0.33373304E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12706029E-02     0.46234701E-03
               2       0.96168713E-06     0.35770512E-06
               3       0.67087808E-12     0.27236546E-12
================================================================================
RMS gradient                =       0.00001176294282
Trial step length           =               0.130713
Gradient along search dir.  =         -0.00000215716
Functional at step 0        =     -16.77683930362930
Functional at step 1        =     -16.77683678777311
Functional predicted        =     -16.77683931073356
Selected quadratic step     =               0.006587
Conjugate gradients coeff.  =              -0.180809
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99996892
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511632172421
             Q0:     -16.776839310654
             G0:      -0.000000001667
   RMS gradient:       0.000006804816
     Trial step:       0.038950084430
             Q1:     -16.776839310716
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000065
           Qmin:     -16.776839310983
Quadratic minimum step length (  0.394598449022) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77683931065416 0.00000000000 0.00000510361 0.3946  0.000    8.00000000
      ideal mu1:      -0.511624448435
             Q0:     -16.776839310970
             G0:      -0.000000000022
   RMS gradient:       0.000000790235
     Trial step:       0.123974363904
             Q1:     -16.776839310973
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -16.776839310991
Quadratic minimum step length (  1.948882881038) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77683931097029 0.00000000004 0.00000059268 1.9489  0.013    8.00000000
      ideal mu1:      -0.511624778257
             Q0:     -16.776839310935
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.788E+01) too large - resetting
             G0:      -0.000000000177
   RMS gradient:       0.000002217672
     Trial step:       0.491539942935
             Q1:     -16.776839310974
 Quadratic coef:       0.000000000048
 Linear coef   :      -0.000000000087
           Qmin:     -16.776839310974
Quadratic minimum step length (  0.450021678266) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77683931093466 0.00000000000 0.00000166325 0.4500  0.000    8.00000000
      ideal mu1:      -0.511623846443
             Q0:     -16.776839310974
             G0:      -0.000000000008
   RMS gradient:       0.000000482379
     Trial step:       0.470322899777
             Q1:     -16.776839310976
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.776839310976
Quadratic minimum step length (  0.448709321492) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77683931097438 0.00000000000 0.00000036178 0.4487  0.047    8.00000000
      ideal mu1:      -0.511624398928
             Q0:     -16.776839310976
             G0:      -0.000000000000
   RMS gradient:       0.000000043731
     Trial step:       0.459389017327
             Q1:     -16.776839310976
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310976
Quadratic minimum step length (  0.267699377974) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77683931097627 0.00000000000 0.00000003280 0.2677  0.008    8.00000000
      ideal mu1:      -0.511624417418
             Q0:     -16.776839310976
             G0:      -0.000000000000
   RMS gradient:       0.000000030893
     Trial step:       0.350682412143
             Q1:     -16.776839310976
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839310976
  Cubic LS coeff:       1.139231643668
Predicted energy:     -16.776839310976
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77683931097609 0.00000000000 0.00000002317 1.1392  0.499    8.00000000
      ideal mu1:      -0.511624477089
             Q0:     -16.776839310976
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000040237
     Trial step:       0.632066848356
             Q1:     -16.776839310976
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310976
Quadratic minimum step length (  0.074478406271) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77683931097640 0.00000000000 0.00000003018 0.0745  1.696    8.00000000
      ideal mu1:      -0.511624469326
             Q0:     -16.776839310976
             G0:      -0.000000000000
   RMS gradient:       0.000000034230
     Trial step:       0.216968503527
             Q1:     -16.776839310976
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310976
Quadratic minimum step length (  0.006798116033) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77683931097638 0.00000000000 0.00000002567 0.0068  0.724    8.00000000
      ideal mu1:      -0.511624468232
             Q0:     -16.776839310976
             G0:      -0.000000000000
   RMS gradient:       0.000000033394
     Trial step:       0.038405430118
             Q1:     -16.776839310976
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310976
Quadratic minimum step length (  0.000333342815) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77683931097641 0.00000000000 0.00000002505 0.0003  0.000    8.00000000
      ideal mu1:      -0.511624468205
10    -16.77683931097644 0.00000000000 0.00000002503 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000215371338              |
           | Maximum change in energy =  0.00000013415149 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88271546534249 |
           | Pseudopotential (local)    :      -46.11646344863747 |
           | Pseudopotential (non-local):       -3.19182860342637 |
           | Hartree                    :       19.84433261106864 |
           | Exchange-correlation       :       -4.13144458329457 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77683931097644 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11646344863762 |
           | Hartree                    :       19.84433261106885 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999647
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.25595971E-03     0.94343031E-04
               2       0.38665466E-07     0.14756294E-07
               3       0.16809590E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.25329576E-03     0.93356928E-04
               2       0.37864132E-07     0.14449146E-07
               3       0.95710964E-15     0.43021142E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.34599897E-07     0.12796009E-07
               2       0.12086496E-14     0.58395129E-15
================================================================================
RMS gradient                =       0.00000215371338
Trial step length           =               0.029342
Gradient along search dir.  =         -0.00000007724
Functional at step 0        =     -16.77683931097644
Functional at step 1        =     -16.77683920388799
Rejected quadratic step     =               0.000304
Functional at new step 1    =     -16.77683931098803
Functional predicted        =     -16.77683931098803
Selected quadratic step     =               0.000300
Conjugate gradients coeff.  =               0.033523
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999875
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511625371259
             Q0:     -16.776839310988
             G0:      -0.000000000003
   RMS gradient:       0.000000300439
     Trial step:       0.003578012602
             Q1:     -16.776839310988
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839310988
  Cubic LS coeff:       0.006930144168
Predicted energy:     -16.776839310988
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77683931098791 0.00000000000 0.00000022533 0.0069  0.000    8.00000000
      ideal mu1:      -0.511625365238
             Q0:     -16.776839310988
             G0:      -0.000000000006
   RMS gradient:       0.000000295021
     Trial step:       0.004979572589
             Q1:     -16.776839310988
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839310988
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77683931098802 0.00000000000 0.00000022127 0.1500  0.964    8.00000000
      ideal mu1:      -0.511625111570
             Q0:     -16.776839310989
             G0:      -0.000000000000
   RMS gradient:       0.000000073124
     Trial step:       0.027330127850
             Q1:     -16.776839310989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310989
Quadratic minimum step length (  0.007330313568) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77683931098884 0.00000000000 0.00000005484 0.0073  0.061    8.00000000
      ideal mu1:      -0.511625109332
             Q0:     -16.776839310989
             G0:      -0.000000000000
   RMS gradient:       0.000000071359
     Trial step:       0.014154095061
             Q1:     -16.776839310989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310989
Quadratic minimum step length (  0.001133410086) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77683931098863 0.00000000000 0.00000005352 0.0011  0.952    8.00000000
      ideal mu1:      -0.511625108781
             Q0:     -16.776839310989
             G0:      -0.000000000001
   RMS gradient:       0.000000070923
     Trial step:       0.004005295757
             Q1:     -16.776839310989
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776839310989
  Cubic LS coeff:       0.005179660308
Predicted energy:     -16.776839310989
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77683931098862 0.00000000000 0.00000005319 0.0052  0.988    8.00000000
      ideal mu1:      -0.511625105283
             Q0:     -16.776839310989
             G0:      -0.000000000001
   RMS gradient:       0.000000068160
     Trial step:       0.004554785555
             Q1:     -16.776839310989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310989
Quadratic minimum step length (  0.000086710974) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77683931098874 0.00000000000 0.00000005112 0.0001  0.924    8.00000000
      ideal mu1:      -0.511625105213
             Q0:     -16.776839310989
             G0:      -0.000000000000
   RMS gradient:       0.000000068104
     Trial step:       0.000628450390
             Q1:     -16.776839310989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310989
Quadratic minimum step length (  0.000000488484) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77683931098873 0.00000000000 0.00000005108 0.0000  0.000    8.00000000
      ideal mu1:      -0.511625105213
             Q0:     -16.776839310989
             G0:      -0.000000000000
   RMS gradient:       0.000000068104
     Trial step:       0.000017521077
             Q1:     -16.776839310989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310989
Quadratic minimum step length (  0.000000000962) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77683931098874 0.00000000000 0.00000005108 0.0000  1.000    8.00000000
      ideal mu1:      -0.511625105213
             Q0:     -16.776839310989
             G0:      -0.000000000001
   RMS gradient:       0.000000068104
     Trial step:       0.000000129820
             Q1:     -16.776839310989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776839310989
Quadratic minimum step length (  0.000000000000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77683931098873 0.00000000000 0.00000005108 0.0000  1.000    8.00000000
      ideal mu1:      -0.511625105213
10    -16.77683931098874 0.00000000000 0.00000005108 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000083863482              |
           | Maximum change in energy =  0.00000000244905 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88271162648173 |
           | Pseudopotential (local)    :      -46.11645646542475 |
           | Pseudopotential (non-local):       -3.19182735882233 |
           | Hartree                    :       19.84432720709409 |
           | Exchange-correlation       :       -4.13144356828832 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77683931098874 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11645646542502 |
           | Hartree                    :       19.84432720709414 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999636
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01130646319198    -16.46996571753720   0.245266    -16.72300742726157
   2     0.00314513821198    -16.72901356493255   0.399837    -16.76169834697692
   3     0.00164680709485    -16.76324056592381   0.397895    -16.77236320586516
   4     0.00096732866977    -16.77274906661141   0.398385    -16.77588650539655
   5     0.00051301695911    -16.77594462189501   0.308846    -16.77660062401687
   6     0.00028653138907    -16.77660090636570   0.322008    -16.77681433291211
   7     0.00011705601926    -16.77681401545934   0.224415    -16.77683878778180
   8     0.00002766344344    -16.77683890117484   0.063027    -16.77683929043479
   9     0.00001176294282    -16.77683930362930   0.006587    -16.77683931073356
  10     0.00000215371338    -16.77683931097644   0.000300    -16.77683931098803
  11     0.00000083863482    -16.77683931098874  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.310269159 Eh
                 Mid-gap level:      -0.101490616 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.965607208   1.0000000
                            2    -0.468641098   1.0000000
                            3    -0.355626920   1.0000000
                            4    -0.256625195   1.0000000
                        .......   --- gap ---   .........
                            5     0.053643964   0.0000000
                            6     0.146682813   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49654683  -0.08643510  -0.08348444 *
*    H       2     -1.16893609   0.92211664  -1.13158823 *
*    H       3     -1.12874913  -0.78715830   1.26749575 *
*                                                        *
**********************************************************
TOTAL:             -0.80113839   0.04852324   0.05242308
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77429390  -0.04384598  -0.02350412 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77429390  -0.04384598  -0.02350412
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00336967  -0.00039995  -0.00226607 *
*    H       2      0.00002032   0.00024999  -0.00031221 *
*    H       3      0.00006478  -0.00022940   0.00018935 *
*                                                        *
**********************************************************
TOTAL:              0.00345477  -0.00037935  -0.00238893
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00779657   0.00143264   0.00884334 *
*    H       2     -0.00779657   0.00143264   0.00884334 *
*    H       3     -0.00779657   0.00143264   0.00884334 *
*                                                        *
**********************************************************
TOTAL:             -0.02338972   0.00429791   0.02653003

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01874238   0.00081703   0.01640805 *
*    H       2      0.00824042  -0.00976854  -0.00058569 *
*    H       3      0.01050196   0.00895151  -0.01582236 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000  -0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1234.758s on      3 node(s)                                    
TOTAL TIME:      1234.759s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    44        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    22        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    13        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.000%  ------ ||
|| integrals_brappd_ketppd              :    22        0.01s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    10        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    22        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    11        0.01s   0.001%  ------ ||
|| basis_dot_function_with_box          :  1768        0.03s   0.003%  ------ ||
|| basis_add_function_to_box            :  3492        0.07s   0.006%  ------ ||
|| lnv_gradient_norm                    :   110        0.07s   0.006%  ------ ||
|| kernel_fix                           :   110        0.08s   0.007%  ------ ||
|| integrals_grad                       :     1        0.08s   0.007%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.08s   0.007%  ------ ||
|| kernel_purify                        :   356        0.10s   0.008%  ------ ||
|| sparse_product                       :  3882        0.18s   0.015%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.19s   0.015%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.19s   0.015%  ------ ||
|| pseudo_make_structure_factor         :     1        0.19s   0.015%  ------ ||
|| sparse_trace                         :  3077        0.23s   0.019%  ------ ||
|| density_initial_guess_real           :     1        0.24s   0.020%  ------ ||
|| basis_copy_function_to_box           :   802        0.43s   0.035%  ------ ||
|| density_batch_row_sums               :   247        0.46s   0.037%  ------ ||
|| fourier_apply_box_pair               :    74        0.54s   0.044%   9.241 ||
|| pseudopotentials_local_on_grid       :     1        0.75s   0.060%  ------ ||
|| integrals_kinetic                    :    22        0.80s   0.065%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.92s   0.074%  ------ ||
|| projectors_func_ovlp_box             :    22        1.18s   0.096%  ------ ||
|| projectors_init_fftbox_recip         :    36        1.21s   0.098%  ------ ||
|| projectors_gradient_batch            :    11        1.27s   0.103%  ------ ||
|| forces_calculate                     :     1        1.43s   0.116%  ------ ||
|| integrals_locpot_mat_els_batch       :   121        3.74s   0.303%  ------ ||
|| properties_calculate                 :     1        5.29s   0.428%  ------ ||
|| ngwf_gradient_batch                  :    11        7.92s   0.641%  ------ ||
|| ngwf_gradient_lnv                    :    11        8.64s   0.699%  ------ ||
|| cell_grid_extract_box                :   550       10.17s   0.823%  ------ ||
|| hamiltonian_energy_components        :     3       16.48s   1.334%  ------ ||
|| cell_grid_deposit_box                :   989       30.72s   2.488%  ------ ||
|| density_fftbox_deposit_to_cell       :   988       30.73s   2.489%  ------ ||
|| density_fftbox_interpolate_multiply  :   988       32.97s   2.670%  ------ ||
|| fourier_apply_box                    :  1853       33.64s   2.724%  18.056 ||
|| penalty_denskernel_optimise_cg       :     1       35.22s   2.852%  ------ ||
|| potential_apply_to_ngwf_batch        :   121       35.78s   2.898%  ------ ||
|| integrals_locpot_dbl_grid            :   121       39.60s   3.207%  ------ ||
|| density_batch_interp_deposit         :   247       67.46s   5.463%  ------ ||
|| density_on_dbl_grid                  :   247       76.42s   6.189%  ------ ||
|| hartree_on_grid                      :   247      185.48s  15.022%  ------ ||
|| fourier_apply_cell_backward          :  1236      431.31s  34.930%   3.197 ||
|| fourier_apply_cell_forward           :  1236      461.44s  37.371%   2.989 ||
|| xc_energy_potential                  :   247      868.71s  70.355%  ------ ||
|| lnv_denskernel_optimise_cg           :    11     1107.28s  89.676%  ------ ||
|| ngwf_cg_optimise                     :     1     1186.66s  96.105%  ------ ||
|| total_time                           :     1     1234.76s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 21:16 (-0000)

