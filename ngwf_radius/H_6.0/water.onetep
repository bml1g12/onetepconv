 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 20:35 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   55 x  55 x  55
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):     88    88    88
         Recip-space ('23') slabs/node (min max mean):     44    45    44
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1844      9332
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3216.4518354715   -7.1202816974   10.1554512533   -2.4512395525
  2 1275.3268459984   -3.1443812453   13.3511488054   -3.1747088977
  3  655.6100215422   -2.9485004107   13.5591716205   -3.2265097030
  4  333.4383110991   -2.9071229743   13.6038731329   -3.2393597159
  5  165.9195334793   -2.8936012298   13.6186080893   -3.2442341554
  6   78.8111333398   -2.8876998472   13.6250676297   -3.2465384671
  7   33.5149711848   -2.8848489821   13.6281943061   -3.2476984221
  8    9.9610079041   -2.8834315976   13.6297503547   -3.2482910000
  9   -2.2870418903   -2.8827209226   13.6305310368   -3.2485948083
 10   -8.6560240825   -2.8823635388   13.6309238114   -3.2487507577
 11  -11.9678934703   -2.8821835875   13.6311216658   -3.2488308715
 12  -13.6900650503   -2.8820929160   13.6312213986   -3.2488720574
 13  -14.5855940943   -2.8820472100   13.6312716928   -3.2488932467
 14  -15.0512691430   -2.8820241631   13.6312970640   -3.2489041566
 15  -15.2934201584   -2.8820125389   13.6313098662   -3.2489097782
 16  -15.4193386906   -2.8820066745   13.6313163278   -3.2489126774
 17  -15.4848163341   -2.8820037152   13.6313195901   -3.2489141737
 18  -15.5188647147   -2.8820022215   13.6313212375   -3.2489149466
 19  -15.5365698769   -2.8820014674   13.6313220696   -3.2489153462
 20  -15.5457765642   -2.8820010866   13.6313224901   -3.2489155530
 21  -15.5505640434   -2.8820008943   13.6313227026   -3.2489156600
 22  -15.5530535338   -2.8820007971   13.6313228100   -3.2489157156
 23  -15.5543480695   -2.8820007479   13.6313228644   -3.2489157443
 24  -15.5550212284   -2.8820007231   13.6313228919   -3.2489157593
 25  -15.5553712713   -2.8820007105   13.6313229058   -3.2489157671
 26  -15.5555532937   -2.8820007042   13.6313229129   -3.2489157711
 27  -15.5556479455   -2.8820007009   13.6313229164   -3.2489157732
 28  -15.5556971644   -2.8820006993   13.6313229182   -3.2489157743
 29  -15.5557227583   -2.8820006985   13.6313229191   -3.2489157749
 30  -15.5557360672   -2.8820006981   13.6313229196   -3.2489157752
 31  -15.5557429878   -2.8820006979   13.6313229199   -3.2489157753
 32  -15.5557465865   -2.8820006978   13.6313229200   -3.2489157754
 33  -15.5557484578   -2.8820006977   13.6313229200   -3.2489157755
 34  -15.5557494309   -2.8820006977   13.6313229201   -3.2489157755
 35  -15.5557499369   -2.8820006977   13.6313229201   -3.2489157755
 36  -15.5557502000   -2.8820006976   13.6313229201   -3.2489157755
 37  -15.5557503369   -2.8820006976   13.6313229201   -3.2489157755
 38  -15.5557504080   -2.8820006976   13.6313229201   -3.2489157755
Atom SCF converged after  38 iterations to a total energy of    -15.55575041

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20263811E+01     0.84775437E+00
               2       0.18092654E+01     0.72311140E+00
               3       0.15565124E+01     0.56415276E+00
               4       0.13106779E+01     0.48647279E+00
               5       0.11002939E+01     0.41503160E+00
               6       0.84706645E+00     0.31926435E+00
               7       0.50786220E+00     0.19033615E+00
               8       0.18317757E+00     0.67764972E-01
               9       0.24131650E-01     0.93227001E-02
              10       0.43749313E-03     0.18541571E-03
              11       0.16038734E-06     0.73351553E-07
              12       0.24486453E-13     0.11546319E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.66019451247260    0.5869478
               2          -1.73441749362210    0.5764987
               3          -1.82990261388721    0.5600115
               4          -1.94169898776652    0.5381769
               5          -2.05001042256876    0.5174802
               6          -2.12325720305152    0.5055453
               7          -2.15028721986259    0.5007096
               8          -2.15411476025495    0.5000059
               9          -2.15420612023091    0.5000000
              10          -2.15420617666294    0.5701207
              11          -2.15420617666296    0.5701207
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999999]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.455386543396=    -16.455386543396+      0.000000000000
    Trial step:       1.000000000000
            G0:      -3.849855529982
WARNING: minimum value of charge density: -0.0632
      Q1=E1+P1:      53.124877778293=    -20.203673429512+     73.328551207806
Quadratic term:     -73.430119851672
   Linear term:      -3.849855529982
  Optimal step:       0.026214416766
 Predicted min:     -16.505847402073
    !!! Quadratic minimum step length accepted !!!
 1    -16.45538654339614 0.32701747872 0.03240132357 0.0262  0.000    8.00000000
      Q0=E0+P0:     -16.545158202033=    -16.556208071428+      0.011049869394
    Trial step:       0.161908667978
            G0:      -0.020958189454
      Q1=E1+P1:     -16.548438517141=    -16.559655429842+      0.011216912701
Quadratic term:      -0.000112997430
   Linear term:      -0.003393312538
  Optimal step:       2.431058437436
 Predicted min:     -16.570633493686
    !!! Quadratic minimum step length accepted !!!
 2    -16.55620807142758 0.25287448332 0.03361934085 2.4311 -0.767    8.00000000
      Q0=E0+P0:     -16.566978893114=    -16.592740604849+      0.025761711735
    Trial step:       0.627383003739
            G0:      -2.207343160820
WARNING: minimum value of charge density: -0.0015
      Q1=E1+P1:      -7.458564249920=    -18.373787065655+     10.915222815735
Quadratic term:     -10.493264225713
   Linear term:      -1.384849582519
  Optimal step:       0.041399466940
 Predicted min:     -16.612670308220
    !!! Quadratic minimum step length accepted !!!
 3    -16.59274060484895 0.24858159590 0.02768596290 0.0414  3.463    8.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.713483574039
   Final penalty energy   :       0.074965511652
   RMS occupancy error    :       0.055889
   Occupancy bounds       : [-0.068, 1.078]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.055889 (step -0.4145 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002100 (step -0.4996 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.528463615443
             Q0:     -16.463789091198
             G0:      -0.045064142429
   RMS gradient:       0.035380527613
     Trial step:       0.500000000000
             Q1:     -16.468461829588
 Quadratic coef:       0.017859332825
 Linear coef   :      -0.022532071215
           Qmin:     -16.470895938892
Quadratic minimum step length (  0.315410315645) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000942 (step -0.4981 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.46378909119842 0.00000000000 0.02653539567 0.3154  0.000    8.00000000
      ideal mu1:      -0.495094266183
             Q0:     -16.470892600351
             G0:      -0.000365636636
   RMS gradient:       0.003181383428
     Trial step:       0.397121087104
             Q1:     -16.470998325450
 Quadratic coef:       0.000039476920
 Linear coef   :      -0.000145202018
           Qmin:     -16.471026119039
Quadratic minimum step length (  0.730335389490) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000071 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.47089260035141 0.00088835596 0.00238603757 0.7303  0.008    8.00000000
      ideal mu1:      -0.494502210259
             Q0:     -16.471026178231
             G0:      -0.000044731802
   RMS gradient:       0.001114375147
     Trial step:       0.538545804760
             Q1:     -16.471039747371
 Quadratic coef:       0.000010520985
 Linear coef   :      -0.000024090124
           Qmin:     -16.471039968150
Quadratic minimum step length (  0.616559946300) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000015 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.47102617823112 0.00001688244 0.00083578136 0.6166  0.123    8.00000000
      ideal mu1:      -0.495472181309
             Q0:     -16.471039967870
             G0:      -0.000000785070
   RMS gradient:       0.000147739615
     Trial step:       0.576234129901
             Q1:     -16.471040050152
 Quadratic coef:       0.000000370102
 Linear coef   :      -0.000000452384
           Qmin:     -16.471040106110
Quadratic minimum step length (  0.352171860127) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.47103996787018 0.00000193930 0.00011080471 0.3522  0.018    8.00000000
      ideal mu1:      -0.495344441879
             Q0:     -16.471040106107
             G0:      -0.000000059173
   RMS gradient:       0.000040542415
     Trial step:       0.450481348555
             Q1:     -16.471040126977
 Quadratic coef:       0.000000005786
 Linear coef   :      -0.000000026656
           Qmin:     -16.471040136807
Quadratic minimum step length (  1.037645344163) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.47104010610699 0.00000001761 0.00003040681 1.0376  0.075    8.00000000
      ideal mu1:      -0.495349872566
             Q0:     -16.471040136808
             G0:      -0.000000003551
   RMS gradient:       0.000009931635
     Trial step:       0.683695746630
             Q1:     -16.471040137673
 Quadratic coef:       0.000000001562
 Linear coef   :      -0.000000002428
           Qmin:     -16.471040137751
Quadratic minimum step length (  0.531199742576) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.47104013680787 0.00000000413 0.00000744873 0.5312  0.060    8.00000000
      ideal mu1:      -0.495352149715
             Q0:     -16.471040137751
             G0:      -0.000000000354
   RMS gradient:       0.000003134473
     Trial step:       0.602643347769
             Q1:     -16.471040137814
 Quadratic coef:       0.000000000150
 Linear coef   :      -0.000000000213
           Qmin:     -16.471040137827
Quadratic minimum step length (  0.427812085897) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.47104013775087 0.00000000013 0.00000235085 0.4278  0.000    8.00000000
      ideal mu1:      -0.495351063355
             Q0:     -16.471040137827
             G0:      -0.000000000032
   RMS gradient:       0.000000949963
     Trial step:       0.507757922303
             Q1:     -16.471040137837
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000016
           Qmin:     -16.471040137837
Quadratic minimum step length (  0.663860608118) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.47104013782653 0.00000000001 0.00000071247 0.6639  0.092    8.00000000
      ideal mu1:      -0.495351607983
             Q0:     -16.471040137837
             G0:      -0.000000000003
   RMS gradient:       0.000000311111
     Trial step:       0.580586326980
             Q1:     -16.471040137838
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.471040137838
Quadratic minimum step length (  0.459873414221) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.47104013783712 0.00000000000 0.00000023333 0.4599  0.107    8.00000000
      ideal mu1:      -0.495351391664
10    -16.47104013783817 0.00000000000 0.00000009728 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01183310160969              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21156512E-01     0.13857279E-01
               2       0.26423033E-03     0.18543069E-03
               3       0.44449136E-07     0.33408725E-07
               4       0.17762202E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27265309E-01     0.17246589E-01
               2       0.43286146E-03     0.28572527E-03
               3       0.11655200E-06     0.78678515E-07
               4       0.84307386E-14     0.58841820E-14
================================================================================
RMS gradient                =       0.01183310160969
Trial step length           =               0.122474
Gradient along search dir.  =         -2.07260999143
Functional at step 0        =     -16.47104013783817
Functional at step 1        =     -16.66168227340787
Functional predicted        =     -16.72592929189973
Selected quadratic step     =               0.245960
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.11718114
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010063 (step -0.4832 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000066 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.507932518020
             Q0:     -16.725766031501
             G0:      -0.022590790628
   RMS gradient:       0.025050388458
     Trial step:       0.516716766167
             Q1:     -16.730959109154
 Quadratic coef:       0.006479962625
 Linear coef   :      -0.011673040278
           Qmin:     -16.731023001226
Quadratic minimum step length (  0.465408210871) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001010 (step -0.4981 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.72576603150141 0.00000000000 0.01878779128 0.4654  0.000    8.00000000
      ideal mu1:      -0.481048656467
             Q0:     -16.731028293978
             G0:      -0.001532853341
   RMS gradient:       0.006498452017
     Trial step:       0.490391910281
             Q1:     -16.731389569610
 Quadratic coef:       0.000390423246
 Linear coef   :      -0.000751698878
           Qmin:     -16.731390113624
Quadratic minimum step length (  0.472086450378) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000205 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.73102829397767 0.00065712122 0.00487383901 0.4721  0.067    8.00000000
      ideal mu1:      -0.484998172687
             Q0:     -16.731390679843
             G0:      -0.000221179504
   RMS gradient:       0.002476454200
     Trial step:       0.481152134172
             Q1:     -16.731458089231
 Quadratic coef:       0.000039011602
 Linear coef   :      -0.000106420990
           Qmin:     -16.731463257144
Quadratic minimum step length (  0.656275105717) accepted
    Initial Ne1:       8.00000011
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000078 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.73139067984255 0.00004861723 0.00185734062 0.6563  0.145    8.00000000
      ideal mu1:      -0.483998698530
             Q0:     -16.731463347486
             G0:      -0.000001798659
   RMS gradient:       0.000223338801
     Trial step:       0.561932529508
             Q1:     -16.731463957113
 Quadratic coef:       0.000000401098
 Linear coef   :      -0.000001010725
           Qmin:     -16.731463984216
Quadratic minimum step length (  0.708005174187) accepted
    Initial Ne1:       8.00000005
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.73146334748636 0.00001051388 0.00016750410 0.7080  0.008    8.00000000
      ideal mu1:      -0.484202670634
             Q0:     -16.731463984211
             G0:      -0.000000620189
   RMS gradient:       0.000131258898
     Trial step:       0.630754420069
             Q1:     -16.731464140154
 Quadratic coef:       0.000000235244
 Linear coef   :      -0.000000391187
           Qmin:     -16.731464146837
Quadratic minimum step length (  0.524440416278) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.73146398421087 0.00000008047 0.00009844417 0.5244  0.345    8.00000000
      ideal mu1:      -0.484103545059
             Q0:     -16.731464146836
             G0:      -0.000000022318
   RMS gradient:       0.000024898016
     Trial step:       0.575146164579
             Q1:     -16.731464151993
 Quadratic coef:       0.000000007679
 Linear coef   :      -0.000000012836
           Qmin:     -16.731464152200
Quadratic minimum step length (  0.480723542124) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.73146414683596 0.00000002744 0.00001867351 0.4807  0.036    8.00000000
      ideal mu1:      -0.484113271457
             Q0:     -16.731464152200
             G0:      -0.000000002208
   RMS gradient:       0.000007831895
     Trial step:       0.525819647289
             Q1:     -16.731464152745
 Quadratic coef:       0.000000000616
 Linear coef   :      -0.000000001161
           Qmin:     -16.731464152747
Quadratic minimum step length (  0.495279285277) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.73146415220037 0.00000000070 0.00000587392 0.4953  0.000    8.00000000
      ideal mu1:      -0.484108292708
             Q0:     -16.731464152747
             G0:      -0.000000000389
   RMS gradient:       0.000003286869
     Trial step:       0.510321054920
             Q1:     -16.731464152857
 Quadratic coef:       0.000000000088
 Linear coef   :      -0.000000000198
           Qmin:     -16.731464152858
Quadratic minimum step length (  0.572516904801) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.73146415274717 0.00000000007 0.00000246515 0.5725  0.176    8.00000000
      ideal mu1:      -0.484110661553
             Q0:     -16.731464152859
             G0:      -0.000000000019
   RMS gradient:       0.000000734135
     Trial step:       0.540525143557
             Q1:     -16.731464152863
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000010
           Qmin:     -16.731464152863
Quadratic minimum step length (  0.458014943363) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.73146415285868 0.00000000002 0.00000055060 0.4580  0.050    8.00000000
      ideal mu1:      -0.484110200102
10    -16.73146415286303 0.00000000000 0.00000020922 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00325918300518              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11342144E-01     0.61539421E-02
               2       0.76524056E-04     0.44634914E-04
               3       0.39478660E-08     0.24745349E-08
               4       0.89200005E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16912010E-01     0.93495546E-02
               2       0.16451021E-03     0.96771333E-04
               3       0.17421878E-07     0.10997978E-07
               4       0.89503491E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00325918300518
Trial step length           =               0.173562
Gradient along search dir.  =         -0.16069736524
Functional at step 0        =     -16.73146415286303
Functional at step 1        =     -16.75315366286129
Functional predicted        =     -16.76282398375508
Selected quadratic step     =               0.390297
Conjugate gradients coeff.  =               0.075861
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05402759
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004665 (step -0.4917 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000020 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.500547167608
             Q0:     -16.762541719570
             G0:      -0.006797526935
   RMS gradient:       0.013741185998
     Trial step:       0.497562652349
             Q1:     -16.763831856423
 Quadratic coef:       0.002092058678
 Linear coef   :      -0.003382195531
           Qmin:     -16.763908704006
Quadratic minimum step length (  0.402200520605) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000235 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.76254171957014 0.00000000000 0.01030588947 0.4022  0.000    8.00000000
      ideal mu1:      -0.484791936045
             Q0:     -16.763908207213
             G0:      -0.000377025591
   RMS gradient:       0.003233238305
     Trial step:       0.447347692302
             Q1:     -16.763997605722
 Quadratic coef:       0.000079263019
 Linear coef   :      -0.000168661528
           Qmin:     -16.763997929732
Quadratic minimum step length (  0.475949225794) accepted
    Initial Ne1:       8.00000023
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000045 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.76390820721335 0.00017087305 0.00242492910 0.4759  0.055    8.00000000
      ideal mu1:      -0.485362969727
             Q0:     -16.763997964378
             G0:      -0.000017951520
   RMS gradient:       0.000705794103
     Trial step:       0.461426904084
             Q1:     -16.764003949689
 Quadratic coef:       0.000002298004
 Linear coef   :      -0.000008283314
           Qmin:     -16.764005428824
Quadratic minimum step length (  0.831622658599) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.76399796437830 0.00001185556 0.00052934558 0.8316  0.048    8.00000000
      ideal mu1:      -0.485237688719
             Q0:     -16.764005429986
             G0:      -0.000000017660
   RMS gradient:       0.000022145991
     Trial step:       0.619461918703
             Q1:     -16.764005434821
 Quadratic coef:       0.000000006105
 Linear coef   :      -0.000000010940
           Qmin:     -16.764005434887
Quadratic minimum step length (  0.555026756681) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.76400542998604 0.00000098104 0.00001660949 0.5550  0.001    8.00000000
      ideal mu1:      -0.485259426003
             Q0:     -16.764005434887
             G0:      -0.000000005067
   RMS gradient:       0.000011863970
     Trial step:       0.586359906222
             Q1:     -16.764005436487
 Quadratic coef:       0.000000001371
 Linear coef   :      -0.000000002971
           Qmin:     -16.764005436497
Quadratic minimum step length (  0.635233604846) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.76400543488708 0.00000000061 0.00000889798 0.6352  0.287    8.00000000
      ideal mu1:      -0.485251516265
             Q0:     -16.764005436496
             G0:      -0.000000000129
   RMS gradient:       0.000001894506
     Trial step:       0.610307723175
             Q1:     -16.764005436521
 Quadratic coef:       0.000000000055
 Linear coef   :      -0.000000000079
           Qmin:     -16.764005436525
Quadratic minimum step length (  0.441042709061) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.76400543649634 0.00000000026 0.00000142088 0.4410  0.025    8.00000000
      ideal mu1:      -0.485251903262
             Q0:     -16.764005436525
             G0:      -0.000000000007
   RMS gradient:       0.000000436219
     Trial step:       0.518817666998
             Q1:     -16.764005436527
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.764005436527
Quadratic minimum step length (  0.597944857102) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.76400543652484 0.00000000000 0.00000032716 0.5979  0.000    8.00000000
      ideal mu1:      -0.485251648858
             Q0:     -16.764005436527
             G0:      -0.000000000001
   RMS gradient:       0.000000198634
     Trial step:       0.556977877258
             Q1:     -16.764005436527
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.764005436527
Quadratic minimum step length (  0.412777352171) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.76400543652696 0.00000000000 0.00000014898 0.4128  0.207    8.00000000
      ideal mu1:      -0.485251710871
             Q0:     -16.764005436527
             G0:      -0.000000000000
   RMS gradient:       0.000000083063
     Trial step:       0.479487073228
             Q1:     -16.764005436527
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.764005436527
  Cubic LS coeff:       0.656292826049
Predicted energy:     -16.764005436527
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.76400543652720 0.00000000000 0.00000006230 0.6563  0.175    8.00000000
      ideal mu1:      -0.485251760733
10    -16.76400543652740 0.00000000000 0.00000004655 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00167369096907              |
           | Maximum change in energy =  0.08680800500829 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13600102E-01     0.55758357E-02
               2       0.11502694E-03     0.46655873E-04
               3       0.95535108E-08     0.40345318E-08
               4       0.80624215E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.86469424E-02     0.34985706E-02
               2       0.45342501E-04     0.17813349E-04
               3       0.14283458E-08     0.57839056E-09
               4       0.95552645E-15     0.55511151E-15
================================================================================
RMS gradient                =       0.00167369096907
Trial step length           =               0.260270
Gradient along search dir.  =         -0.04304528012
Functional at step 0        =     -16.76400543652740
Functional at step 1        =     -16.77158834311046
Functional predicted        =     -16.77267248770504
Selected quadratic step     =               0.402695
Conjugate gradients coeff.  =               0.263714
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02685631
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002423 (step -0.4953 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.506974518844
             Q0:     -16.772586499980
             G0:      -0.002050266548
   RMS gradient:       0.007546644854
     Trial step:       0.560966956551
             Q1:     -16.772884197015
 Quadratic coef:       0.000852434750
 Linear coef   :      -0.001150131786
           Qmin:     -16.772974448478
Quadratic minimum step length (  0.378437133868) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000060 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77258649997987 0.00000000000 0.00565998364 0.3784  0.000    8.00000000
      ideal mu1:      -0.498509808920
             Q0:     -16.772974060395
             G0:      -0.000075285430
   RMS gradient:       0.001445941928
     Trial step:       0.460750178765
             Q1:     -16.772994054206
 Quadratic coef:       0.000014693964
 Linear coef   :      -0.000034687775
           Qmin:     -16.772994532095
Quadratic minimum step length (  0.543842300150) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77297406039457 0.00004849356 0.00108445645 0.5438  0.037    8.00000000
      ideal mu1:      -0.498352522349
             Q0:     -16.772994536878
             G0:      -0.000003850460
   RMS gradient:       0.000326916709
     Trial step:       0.500575106267
             Q1:     -16.772995897406
 Quadratic coef:       0.000000566916
 Linear coef   :      -0.000001927444
           Qmin:     -16.772996175145
Quadratic minimum step length (  0.850946202539) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77299453687779 0.00000265351 0.00024518753 0.8509  0.051    8.00000000
      ideal mu1:      -0.498333287793
             Q0:     -16.772996175204
             G0:      -0.000000003676
   RMS gradient:       0.000010104281
     Trial step:       0.652658015934
             Q1:     -16.772996176624
 Quadratic coef:       0.000000000979
 Linear coef   :      -0.000000002399
           Qmin:     -16.772996176674
Quadratic minimum step length (  0.799874393420) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77299617520422 0.00000021579 0.00000757821 0.7999  0.001    8.00000000
      ideal mu1:      -0.498335240602
             Q0:     -16.772996176674
             G0:      -0.000000001187
   RMS gradient:       0.000005742129
     Trial step:       0.722526424850
             Q1:     -16.772996176995
 Quadratic coef:       0.000000000537
 Linear coef   :      -0.000000000858
           Qmin:     -16.772996177017
Quadratic minimum step length (  0.576611449122) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77299617667438 0.00000000018 0.00000430660 0.5766  0.323    8.00000000
      ideal mu1:      -0.498334029913
             Q0:     -16.772996177017
             G0:      -0.000000000032
   RMS gradient:       0.000000936009
     Trial step:       0.645458758451
             Q1:     -16.772996177028
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000020
           Qmin:     -16.772996177028
Quadratic minimum step length (  0.712302399949) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77299617701663 0.00000000006 0.00000070201 0.7123  0.027    8.00000000
      ideal mu1:      -0.498334528308
             Q0:     -16.772996177028
             G0:      -0.000000000003
   RMS gradient:       0.000000304724
     Trial step:       0.678057388952
             Q1:     -16.772996177028
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000002
           Qmin:     -16.772996177029
Quadratic minimum step length (  0.419188271996) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77299617702790 0.00000000000 0.00000022854 0.4192  0.000    8.00000000
      ideal mu1:      -0.498334235562
             Q0:     -16.772996177029
             G0:      -0.000000000000
   RMS gradient:       0.000000103115
     Trial step:       0.533135728674
             Q1:     -16.772996177029
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.772996177029
Quadratic minimum step length (  0.928175823698) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77299617702858 0.00000000000 0.00000007734 0.9282  0.115    8.00000000
      ideal mu1:      -0.498334313206
             Q0:     -16.772996177029
             G0:      -0.000000000000
   RMS gradient:       0.000000030403
     Trial step:       0.703451273441
             Q1:     -16.772996177029
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.772996177029
Quadratic minimum step length (  0.178289827875) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77299617702874 0.00000000000 0.00000002280 0.1783  0.087    8.00000000
      ideal mu1:      -0.498334303994
10    -16.77299617702863 0.00000000000 0.00000001569 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00101591031479              |
           | Maximum change in energy =  0.01084709455479 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15013515E-01     0.52468438E-02
               2       0.14665311E-03     0.49348648E-04
               3       0.15163652E-07     0.55814512E-08
               4       0.87939783E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.39818855E-02     0.14746568E-02
               2       0.10151645E-04     0.35980051E-05
               3       0.70100858E-10     0.24118194E-10
               4       0.10767399E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00101591031479
Trial step length           =               0.323743
Gradient along search dir.  =         -0.01584786506
Functional at step 0        =     -16.77299617702863
Functional at step 1        =     -16.77604210254699
Functional predicted        =     -16.77615290182349
Selected quadratic step     =               0.398379
Conjugate gradients coeff.  =               0.368434
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01224456
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001161 (step -0.4973 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512903409959
             Q0:     -16.776132918073
             G0:      -0.000386703642
   RMS gradient:       0.003277463628
     Trial step:       0.354144329984
             Q1:     -16.776208534290
 Quadratic coef:       0.000061332686
 Linear coef   :      -0.000136948902
           Qmin:     -16.776209365899
Quadratic minimum step length (  0.395381979351) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77613291807299 0.00000000000 0.00245809772 0.3954  0.000    8.00000000
      ideal mu1:      -0.509121307782
             Q0:     -16.776209377404
             G0:      -0.000016926657
   RMS gradient:       0.000685432865
     Trial step:       0.374195518633
             Q1:     -16.776213637510
 Quadratic coef:       0.000002073773
 Linear coef   :      -0.000006333879
           Qmin:     -16.776214213761
Quadratic minimum step length (  0.571448550690) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77620937740378 0.00000955598 0.00051407465 0.5714  0.044    8.00000000
      ideal mu1:      -0.509054714256
             Q0:     -16.776214214756
             G0:      -0.000001126186
   RMS gradient:       0.000176826939
     Trial step:       0.462421330388
             Q1:     -16.776214592120
 Quadratic coef:       0.000000143408
 Linear coef   :      -0.000000520772
           Qmin:     -16.776214687539
Quadratic minimum step length (  0.839617990863) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77621421475606 0.00000063144 0.00013262020 0.8396  0.067    8.00000000
      ideal mu1:      -0.509050989597
             Q0:     -16.776214687545
             G0:      -0.000000001352
   RMS gradient:       0.000006129060
     Trial step:       0.623102935599
             Q1:     -16.776214687954
 Quadratic coef:       0.000000000433
 Linear coef   :      -0.000000000843
           Qmin:     -16.776214687955
Quadratic minimum step length (  0.606529456432) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77621468754466 0.00000006324 0.00000459680 0.6065  0.001    8.00000000
      ideal mu1:      -0.509050268611
             Q0:     -16.776214687955
             G0:      -0.000000000355
   RMS gradient:       0.000003142035
     Trial step:       0.614760347477
             Q1:     -16.776214688089
 Quadratic coef:       0.000000000084
 Linear coef   :      -0.000000000218
           Qmin:     -16.776214688097
Quadratic minimum step length (  0.798539690477) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77621468795469 0.00000000005 0.00000235653 0.7985  0.263    8.00000000
      ideal mu1:      -0.509050778057
             Q0:     -16.776214688097
             G0:      -0.000000000013
   RMS gradient:       0.000000590710
     Trial step:       0.700650082132
             Q1:     -16.776214688101
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000009
           Qmin:     -16.776214688101
Quadratic minimum step length (  0.759565934605) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77621468809650 0.00000000002 0.00000044303 0.7596  0.035    8.00000000
      ideal mu1:      -0.509050451060
             Q0:     -16.776214688101
             G0:      -0.000000000001
   RMS gradient:       0.000000198372
     Trial step:       0.729513491627
             Q1:     -16.776214688101
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.776214688101
Quadratic minimum step length (  0.440274108348) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77621468810095 0.00000000000 0.00000014878 0.4403  0.000    8.00000000
      ideal mu1:      -0.509050671780
             Q0:     -16.776214688102
             G0:      -0.000000000000
   RMS gradient:       0.000000056370
     Trial step:       0.566732654833
             Q1:     -16.776214688101
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776214688102
Quadratic minimum step length (  0.108949172154) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77621468810154 0.00000000000 0.00000004228 0.1089  0.081    8.00000000
      ideal mu1:      -0.509050662307
             Q0:     -16.776214688101
             G0:      -0.000000000000
   RMS gradient:       0.000000045532
     Trial step:       0.248485519853
             Q1:     -16.776214688101
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776214688101
  Cubic LS coeff:       0.561428667705
Predicted energy:     -16.776214688101
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77621468810133 0.00000000000 0.00000003415 0.5614  0.652    8.00000000
      ideal mu1:      -0.509050574092
10    -16.77621468810138 0.00000000000 0.00000004256 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00054630433198              |
           | Maximum change in energy =  0.00299691350041 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.89084176917698 |
           | Pseudopotential (local)    :      -46.14110080250934 |
           | Pseudopotential (non-local):       -3.19231432249498 |
           | Hartree                    :       19.86553369054494 |
           | Exchange-correlation       :       -4.13502427078981 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77621468810138 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.14110080250944 |
           | Hartree                    :       19.86553369054514 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999888
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.50995499E-02     0.17465244E-02
               2       0.17050801E-04     0.62549331E-05
               3       0.22787328E-09     0.90693258E-10
               4       0.76374588E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66806929E-03     0.21803239E-03
               2       0.29401280E-06     0.10345407E-06
               3       0.65587486E-13     0.25340841E-13
================================================================================
RMS gradient                =       0.00054630433198
Trial step length           =               0.359127
Gradient along search dir.  =         -0.00441763356
Functional at step 0        =     -16.77621468810138
Functional at step 1        =     -16.77690030781329
Functional predicted        =     -16.77691316579205
Selected quadratic step     =               0.316223
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99827534
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000197 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.509336025394
             Q0:     -16.776912867617
             G0:      -0.000001544402
   RMS gradient:       0.000207123295
     Trial step:       0.373506217291
             Q1:     -16.776913177797
 Quadratic coef:       0.000000266664
 Linear coef   :      -0.000000576844
           Qmin:     -16.776913179572
Quadratic minimum step length (  0.403982016325) accepted
    Initial Ne1:       7.99999955
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77691286761669 0.00000000000 0.00015534240 0.4040  0.000    8.00000000
      ideal mu1:      -0.509558855288
             Q0:     -16.776913179570
             G0:      -0.000000091860
   RMS gradient:       0.000050515241
     Trial step:       0.388445356223
             Q1:     -16.776913205322
 Quadratic coef:       0.000000009930
 Linear coef   :      -0.000000035682
           Qmin:     -16.776913211624
Quadratic minimum step length (  0.697900495014) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77691317956969 0.00000003899 0.00003788643 0.6979  0.059    8.00000000
      ideal mu1:      -0.509546657663
             Q0:     -16.776913211624
             G0:      -0.000000009008
   RMS gradient:       0.000015818817
     Trial step:       0.520668998879
             Q1:     -16.776913214527
 Quadratic coef:       0.000000001787
 Linear coef   :      -0.000000004690
           Qmin:     -16.776913214702
Quadratic minimum step length (  0.683300433229) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77691321162408 0.00000000424 0.00001186411 0.6833  0.098    8.00000000
      ideal mu1:      -0.509539007007
             Q0:     -16.776913214702
             G0:      -0.000000000128
   RMS gradient:       0.000001887620
     Trial step:       0.596467394334
             Q1:     -16.776913214724
 Quadratic coef:       0.000000000055
 Linear coef   :      -0.000000000077
           Qmin:     -16.776913214729
Quadratic minimum step length (  0.418101676978) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77691321470225 0.00000000042 0.00000141571 0.4181  0.014    8.00000000
      ideal mu1:      -0.509538550957
             Q0:     -16.776913214729
             G0:      -0.000000000002
   RMS gradient:       0.000000228591
     Trial step:       0.499383637931
             Q1:     -16.776913214730
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.776913214730
Quadratic minimum step length (  0.400533244109) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77691321472915 0.00000000000 0.00000017144 0.4005  0.015    8.00000000
      ideal mu1:      -0.509538557821
             Q0:     -16.776913214730
             G0:      -0.000000000001
   RMS gradient:       0.000000114832
     Trial step:       0.447235674511
             Q1:     -16.776913214730
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776913214730
Quadratic minimum step length (  1.177945851422) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77691321472967 0.00000000000 0.00000008612 1.1779  0.252    8.00000000
      ideal mu1:      -0.509538581276
             Q0:     -16.776913214730
             G0:      -0.000000000001
   RMS gradient:       0.000000148514
     Trial step:       0.725823261820
             Q1:     -16.776913214730
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.776913214730
Quadratic minimum step length (  0.348354611949) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77691321472961 0.00000000000 0.00000011139 0.3484  0.000    8.00000000
      ideal mu1:      -0.509538567112
             Q0:     -16.776913214730
             G0:      -0.000000000000
   RMS gradient:       0.000000073661
     Trial step:       0.502835838734
             Q1:     -16.776913214730
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776913214730
Quadratic minimum step length (  0.104653959419) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77691321472992 0.00000000000 0.00000005525 0.1047  0.246    8.00000000
      ideal mu1:      -0.509538565222
             Q0:     -16.776913214730
             G0:      -0.000000000000
   RMS gradient:       0.000000059428
     Trial step:       0.229398695422
             Q1:     -16.776913214730
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776913214730
Quadratic minimum step length (  0.022344344493) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77691321472999 0.00000000000 0.00000004457 0.0223  0.651    8.00000000
      ideal mu1:      -0.509538564872
10    -16.77691321472980 0.00000000000 0.00000004190 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00030892375635              |
           | Maximum change in energy =  0.00107283702425 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.61613838E-02     0.20094630E-02
               2       0.24405487E-04     0.82185201E-05
               3       0.43306925E-09     0.16230617E-09
               4       0.92060811E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.40176333E-03     0.12614877E-03
               2       0.10418041E-06     0.36514867E-07
               3       0.74102907E-14     0.25673907E-14
================================================================================
RMS gradient                =       0.00030892375635
Trial step length           =               0.336993
Gradient along search dir.  =         -0.00141254663
Functional at step 0        =     -16.77691321472980
Functional at step 1        =     -16.77713660219536
Functional predicted        =     -16.77713744844267
Selected quadratic step     =               0.317489
Conjugate gradients coeff.  =               0.319767
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99792023
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000233 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.510763757478
             Q0:     -16.777137008612
             G0:      -0.000000317604
   RMS gradient:       0.000093927273
     Trial step:       0.071594437470
             Q1:     -16.777137029841
 Quadratic coef:       0.000000001510
 Linear coef   :      -0.000000022739
           Qmin:     -16.777137094240
Quadratic minimum step length (  0.539213056539) accepted
    Initial Ne1:       7.99999953
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77713700861198 0.00000000000 0.00007044513 0.5392  0.000    8.00000000
      ideal mu1:      -0.510731032315
             Q0:     -16.777137094235
             G0:      -0.000000039817
   RMS gradient:       0.000033257559
     Trial step:       0.196480674519
             Q1:     -16.777137100759
 Quadratic coef:       0.000000001299
 Linear coef   :      -0.000000007823
           Qmin:     -16.777137106016
Quadratic minimum step length (  0.591755433906) accepted
    Initial Ne1:       7.99999994
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77713709423488 0.00000001070 0.00002494317 0.5918  0.125    8.00000000
      ideal mu1:      -0.510762478894
             Q0:     -16.777137106016
             G0:      -0.000000005757
   RMS gradient:       0.000012646141
     Trial step:       0.340981681039
             Q1:     -16.777137107482
 Quadratic coef:       0.000000000496
 Linear coef   :      -0.000000001963
           Qmin:     -16.777137107956
Quadratic minimum step length (  0.674193566006) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77713710601560 0.00000000166 0.00000948461 0.6742  0.145    8.00000000
      ideal mu1:      -0.510749099427
             Q0:     -16.777137107958
             G0:      -0.000000000035
   RMS gradient:       0.000000982143
     Trial step:       0.479466010769
             Q1:     -16.777137107971
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000017
           Qmin:     -16.777137107978
Quadratic minimum step length (  1.162630641903) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77713710795774 0.00000000028 0.00000073661 1.1626  0.006    8.00000000
      ideal mu1:      -0.510749329378
             Q0:     -16.777137107978
             G0:      -0.000000000001
   RMS gradient:       0.000000166501
     Trial step:       0.746620302343
             Q1:     -16.777137107978
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777137107978
Quadratic minimum step length (  0.449645369511) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77713710797799 0.00000000000 0.00000012488 0.4496  0.029    8.00000000
      ideal mu1:      -0.510749344429
             Q0:     -16.777137107978
             G0:      -0.000000000000
   RMS gradient:       0.000000059871
     Trial step:       0.579408631047
             Q1:     -16.777137107978
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777137107978
Quadratic minimum step length (  0.191490990711) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77713710797839 0.00000000000 0.00000004490 0.1915  0.129    8.00000000
      ideal mu1:      -0.510749343801
             Q0:     -16.777137107978
             G0:      -0.000000000000
   RMS gradient:       0.000000049675
     Trial step:       0.333093879838
             Q1:     -16.777137107978
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777137107978
Quadratic minimum step length (  0.173393270131) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77713710797843 0.00000000000 0.00000003726 0.1734  0.000    8.00000000
      ideal mu1:      -0.510749342696
             Q0:     -16.777137107978
             G0:      -0.000000000000
   RMS gradient:       0.000000041470
     Trial step:       0.240325273506
             Q1:     -16.777137107978
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777137107979
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77713710797823 0.00000000000 0.00000003110 0.1500  0.697    8.00000000
      ideal mu1:      -0.510749341419
             Q0:     -16.777137107978
             G0:      -0.000000000000
   RMS gradient:       0.000000031713
     Trial step:       0.189865191718
             Q1:     -16.777137107978
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777137107978
Quadratic minimum step length (  0.086880854376) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77713710797835 0.00000000000 0.00000002378 0.0869  0.585    8.00000000
      ideal mu1:      -0.510749340853
10    -16.77713710797823 0.00000000000 0.00000001994 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00012284208255              |
           | Maximum change in energy =  0.00023284220947 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46431271E-02     0.15128373E-02
               2       0.13616190E-04     0.44537463E-05
               3       0.13051568E-09     0.47564605E-10
               4       0.68189207E-15     0.33306691E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16320842E-02     0.51339040E-03
               2       0.16913114E-05     0.57554859E-06
               3       0.19722899E-11     0.69144690E-12
================================================================================
RMS gradient                =       0.00012284208255
Trial step length           =               0.327095
Gradient along search dir.  =         -0.00022296702
Functional at step 0        =     -16.77713710797823
Functional at step 1        =     -16.77715600743532
Functional predicted        =     -16.77716171838361
Selected quadratic step     =               0.220754
Conjugate gradients coeff.  =               0.158122
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99877235
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000116 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511655188920
             Q0:     -16.777161597767
             G0:      -0.000001315216
   RMS gradient:       0.000191138077
     Trial step:       0.128435392601
             Q1:     -16.777161737213
 Quadratic coef:       0.000000029474
 Linear coef   :      -0.000000168920
           Qmin:     -16.777161839796
Quadratic minimum step length (  0.368045089612) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77716159776667 0.00000000000 0.00014335354 0.3680  0.000    8.00000000
      ideal mu1:      -0.511456746498
             Q0:     -16.777161839809
             G0:      -0.000000009203
   RMS gradient:       0.000015987880
     Trial step:       0.217416686524
             Q1:     -16.777161841502
 Quadratic coef:       0.000000000309
 Linear coef   :      -0.000000002001
           Qmin:     -16.777161843053
Quadratic minimum step length (  0.704897889504) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77716183980924 0.00000003025 0.00001199091 0.7049  0.007    8.00000000
      ideal mu1:      -0.511447477235
             Q0:     -16.777161843057
             G0:      -0.000000000850
   RMS gradient:       0.000004854582
     Trial step:       0.391479965610
             Q1:     -16.777161843313
 Quadratic coef:       0.000000000077
 Linear coef   :      -0.000000000333
           Qmin:     -16.777161843415
Quadratic minimum step length (  0.842872985131) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77716184305719 0.00000000041 0.00000364094 0.8429  0.092    8.00000000
      ideal mu1:      -0.511448431486
             Q0:     -16.777161843415
             G0:      -0.000000000009
   RMS gradient:       0.000000510396
     Trial step:       0.574428313397
             Q1:     -16.777161843419
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.777161843419
Quadratic minimum step length (  0.831396350418) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77716184341537 0.00000000005 0.00000038280 0.8314  0.011    8.00000000
      ideal mu1:      -0.511448425694
             Q0:     -16.777161843419
             G0:      -0.000000000003
   RMS gradient:       0.000000313177
     Trial step:       0.691069897576
             Q1:     -16.777161843420
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777161843420
Quadratic minimum step length (  0.562781352533) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77716184341927 0.00000000000 0.00000023488 0.5628  0.377    8.00000000
      ideal mu1:      -0.511448457828
             Q0:     -16.777161843420
             G0:      -0.000000000000
   RMS gradient:       0.000000055794
     Trial step:       0.623635511860
             Q1:     -16.777161843420
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777161843420
Quadratic minimum step length (  0.162108384732) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77716184342022 0.00000000000 0.00000004185 0.1621  0.032    8.00000000
      ideal mu1:      -0.511448456698
             Q0:     -16.777161843420
             G0:      -0.000000000000
   RMS gradient:       0.000000041328
     Trial step:       0.317956829600
             Q1:     -16.777161843420
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777161843420
Quadratic minimum step length (  0.026511345376) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77716184342033 0.00000000000 0.00000003100 0.0265  0.000    8.00000000
      ideal mu1:      -0.511448456558
             Q0:     -16.777161843420
             G0:      -0.000000000000
   RMS gradient:       0.000000039855
     Trial step:       0.091812108810
             Q1:     -16.777161843420
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777161843420
  Cubic LS coeff:       0.096809621177
Predicted energy:     -16.777161843420
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77716184342015 0.00000000000 0.00000002989 0.0968  0.930    8.00000000
      ideal mu1:      -0.511448455613
             Q0:     -16.777161843420
             G0:      -0.000000000000
   RMS gradient:       0.000000029964
     Trial step:       0.094277757045
             Q1:     -16.777161843420
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777161843420
Quadratic minimum step length (  0.002620969671) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77716184342031 0.00000000000 0.00000002247 0.0026  0.565    8.00000000
      ideal mu1:      -0.511448455593
10    -16.77716184342008 0.00000000000 0.00000002229 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002464437456              |
           | Maximum change in energy =  0.00007463108281 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26801604E-02     0.91497106E-03
               2       0.44734951E-05     0.15377823E-05
               3       0.14511106E-10     0.55655064E-11
               4       0.72396316E-15     0.33306691E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23174190E-02     0.78672963E-03
               2       0.33493232E-05     0.11447498E-05
               3       0.80984967E-11     0.30896813E-11
               4       0.10255335E-14     0.55511151E-15
================================================================================
RMS gradient                =       0.00002464437456
Trial step length           =               0.268715
Gradient along search dir.  =         -0.00000903480
Functional at step 0        =     -16.77716184342008
Functional at step 1        =     -16.77715592375720
Functional predicted        =     -16.77716201994502
Selected quadratic step     =               0.039077
Conjugate gradients coeff.  =               0.040248
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99982800
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511561005666
             Q0:     -16.777162017627
             G0:      -0.000000042282
   RMS gradient:       0.000034271142
     Trial step:       0.015719387452
             Q1:     -16.777162018278
 Quadratic coef:       0.000000000014
 Linear coef   :      -0.000000000665
           Qmin:     -16.777162025531
Quadratic minimum step length (  0.373866664660) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77716201762743 0.00000000000 0.00002570336 0.3739  0.000    8.00000000
      ideal mu1:      -0.511523779979
             Q0:     -16.777162025641
             G0:      -0.000000000648
   RMS gradient:       0.000004214737
     Trial step:       0.076661300258
             Q1:     -16.777162025688
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000050
           Qmin:     -16.777162025836
Quadratic minimum step length (  0.599245873541) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77716202564139 0.00000000099 0.00000316105 0.5992  0.015    8.00000000
      ideal mu1:      -0.511521317658
             Q0:     -16.777162025824
             G0:      -0.000000000018
   RMS gradient:       0.000000721769
     Trial step:       0.214333776712
             Q1:     -16.777162025827
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000004
           Qmin:     -16.777162025834
Quadratic minimum step length (  1.126936368852) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77716202582405 0.00000000002 0.00000054133 1.1269  0.029    8.00000000
      ideal mu1:      -0.511522117532
             Q0:     -16.777162025830
             G0:      -0.000000000005
   RMS gradient:       0.000000452189
     Trial step:       0.491467728391
             Q1:     -16.777162025831
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777162025831
Quadratic minimum step length (  0.395171087832) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77716202583044 0.00000000000 0.00000033914 0.3952  0.393    8.00000000
      ideal mu1:      -0.511521729819
             Q0:     -16.777162025831
             G0:      -0.000000000002
   RMS gradient:       0.000000207770
     Trial step:       0.440696989850
             Q1:     -16.777162025832
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777162025832
Quadratic minimum step length (  0.353555355051) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77716202583132 0.00000000000 0.00000015583 0.3536  0.211    8.00000000
      ideal mu1:      -0.511521564207
             Q0:     -16.777162025832
             G0:      -0.000000000001
   RMS gradient:       0.000000123290
     Trial step:       0.394728743210
             Q1:     -16.777162025832
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162025832
Quadratic minimum step length (  0.498998970394) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77716202583198 0.00000000000 0.00000009247 0.4990  0.352    8.00000000
      ideal mu1:      -0.511521552209
             Q0:     -16.777162025832
             G0:      -0.000000000000
   RMS gradient:       0.000000066254
     Trial step:       0.443812163473
             Q1:     -16.777162025832
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162025832
Quadratic minimum step length (  0.199120343857) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77716202583213 0.00000000000 0.00000004969 0.1991  0.000    8.00000000
      ideal mu1:      -0.511521581241
             Q0:     -16.777162025832
             G0:      -0.000000000000
   RMS gradient:       0.000000043850
     Trial step:       0.297274335587
             Q1:     -16.777162025832
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162025832
Quadratic minimum step length (  0.054683332631) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77716202583206 0.00000000000 0.00000003289 0.0547  0.438    8.00000000
      ideal mu1:      -0.511521589183
             Q0:     -16.777162025832
             G0:      -0.000000000000
   RMS gradient:       0.000000037656
     Trial step:       0.127498828919
             Q1:     -16.777162025832
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162025832
  Cubic LS coeff:       0.214550754276
Predicted energy:     -16.777162025832
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77716202583181 0.00000000000 0.00000002824 0.2146  0.737    8.00000000
      ideal mu1:      -0.511521625952
10    -16.77716202583219 0.00000000000 0.00000001157 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000877223955              |
           | Maximum change in energy =  0.00000824514728 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.88900146E-03     0.31276723E-03
               2       0.48637546E-06     0.17670999E-06
               3       0.17605315E-12     0.69944051E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.83542011E-03     0.29365296E-03
               2       0.42961930E-06     0.15583049E-06
               3       0.13747220E-12     0.54622973E-13
================================================================================
RMS gradient                =       0.00000877223955
Trial step length           =               0.102472
Gradient along search dir.  =         -0.00000113905
Functional at step 0        =     -16.77716202583219
Functional at step 1        =     -16.77716119799571
Functional predicted        =     -16.77716202943801
Selected quadratic step     =               0.006331
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99997357
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511538194667
             Q0:     -16.777162029390
             G0:      -0.000000000969
   RMS gradient:       0.000005186841
     Trial step:       0.165393379293
             Q1:     -16.777162029516
 Quadratic coef:       0.000000000035
 Linear coef   :      -0.000000000160
           Qmin:     -16.777162029576
Quadratic minimum step length (  0.383411134332) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77716202939016 0.00000000000 0.00000389013 0.3834  0.000    8.00000000
      ideal mu1:      -0.511532414429
             Q0:     -16.777162029574
             G0:      -0.000000000016
   RMS gradient:       0.000000661277
     Trial step:       0.251820696460
             Q1:     -16.777162029578
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.777162029579
Quadratic minimum step length (  0.602952905189) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77716202957447 0.00000000002 0.00000049596 0.6030  0.016    8.00000000
      ideal mu1:      -0.511532242720
             Q0:     -16.777162029579
             G0:      -0.000000000000
   RMS gradient:       0.000000114273
     Trial step:       0.389661417794
             Q1:     -16.777162029579
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029580
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  9.026668210820)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77716202957856 0.00000000000 0.00000008571 0.1500  0.000    8.00000000
      ideal mu1:      -0.511532232311
             Q0:     -16.777162029579
             G0:      -0.000000000001
   RMS gradient:       0.000000090166
     Trial step:       0.241762719767
             Q1:     -16.777162029579
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029579
Quadratic minimum step length (  0.072195162881) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77716202957885 0.00000000000 0.00000006762 0.0722  0.623    8.00000000
      ideal mu1:      -0.511532227201
             Q0:     -16.777162029579
             G0:      -0.000000000000
   RMS gradient:       0.000000073495
     Trial step:       0.132113961912
             Q1:     -16.777162029579
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029579
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77716202957859 0.00000000000 0.00000005512 0.1500  0.664    8.00000000
      ideal mu1:      -0.511532218789
             Q0:     -16.777162029579
             G0:      -0.000000000000
   RMS gradient:       0.000000040051
     Trial step:       0.140773201593
             Q1:     -16.777162029579
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029579
  Cubic LS coeff:       0.157566964889
Predicted energy:     -16.777162029579
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77716202957883 0.00000000000 0.00000003004 0.1576  0.297    8.00000000
      ideal mu1:      -0.511532220098
             Q0:     -16.777162029579
             G0:      -0.000000000000
   RMS gradient:       0.000000027669
     Trial step:       0.148933562748
             Q1:     -16.777162029579
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029579
Quadratic minimum step length (  0.010309054048) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77716202957880 0.00000000000 0.00000002075 0.0103  0.477    8.00000000
      ideal mu1:      -0.511532220401
             Q0:     -16.777162029579
             G0:      -0.000000000000
   RMS gradient:       0.000000027061
     Trial step:       0.039183722998
             Q1:     -16.777162029579
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029579
Quadratic minimum step length (  0.001469000613) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77716202957888 0.00000000000 0.00000002030 0.0015  0.957    8.00000000
      ideal mu1:      -0.511532220478
             Q0:     -16.777162029579
             G0:      -0.000000000000
   RMS gradient:       0.000000026932
     Trial step:       0.007586890871
             Q1:     -16.777162029579
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029579
  Cubic LS coeff:       0.013955967617
Predicted energy:     -16.777162029579
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77716202957868 0.00000000000 0.00000002020 0.0140  0.000    8.00000000
      ideal mu1:      -0.511532220819
10    -16.77716202957891 0.00000000000 0.00000001987 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000260496620              |
           | Maximum change in energy =  0.00000006080404 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88349316785414 |
           | Pseudopotential (local)    :      -46.11754558053205 |
           | Pseudopotential (non-local):       -3.19283271502076 |
           | Hartree                    :       19.84543026490472 |
           | Exchange-correlation       :       -4.13155641475580 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77716202957891 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11754558053218 |
           | Hartree                    :       19.84543026490496 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999842
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23409220E-03     0.83184798E-04
               2       0.33560946E-07     0.12425380E-07
               3       0.15903335E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22953803E-03     0.81559676E-04
               2       0.32267714E-07     0.11944714E-07
               3       0.10568952E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.99265965E-07     0.35402311E-07
               2       0.62183829E-14     0.24424907E-14
================================================================================
RMS gradient                =       0.00000260496620
Trial step length           =               0.025471
Gradient along search dir.  =         -0.00000010402
Functional at step 0        =     -16.77716202957891
Functional at step 1        =     -16.77716196430243
Rejected quadratic step     =               0.000497
Functional at new step 1    =     -16.77716202960530
Functional predicted        =     -16.77716202960531
Selected quadratic step     =               0.000508
Conjugate gradients coeff.  =               0.088183
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999769
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511533659377
             Q0:     -16.777162029605
             G0:      -0.000000000007
   RMS gradient:       0.000000441845
     Trial step:       0.010289917556
             Q1:     -16.777162029605
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029605
Quadratic minimum step length (  0.002909196506) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77716202960524 0.00000000000 0.00000033138 0.0029  0.000    8.00000000
      ideal mu1:      -0.511533655637
             Q0:     -16.777162029605
             G0:      -0.000000000014
   RMS gradient:       0.000000438486
     Trial step:       0.005471324538
             Q1:     -16.777162029605
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029605
  Cubic LS coeff:       0.010671658376
Predicted energy:     -16.777162029605
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77716202960491 0.00000000000 0.00000032886 0.0107  0.985    8.00000000
      ideal mu1:      -0.511533628511
             Q0:     -16.777162029605
             G0:      -0.000000000018
   RMS gradient:       0.000000414140
     Trial step:       0.007641211052
             Q1:     -16.777162029605
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029605
Quadratic minimum step length (  0.002610902011) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77716202960518 0.00000000000 0.00000031060 0.0026  0.892    8.00000000
      ideal mu1:      -0.511533619444
             Q0:     -16.777162029605
             G0:      -0.000000000023
   RMS gradient:       0.000000406013
     Trial step:       0.004466593031
             Q1:     -16.777162029605
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029605
Quadratic minimum step length (  0.003354540777) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77716202960526 0.00000000000 0.00000030451 0.0034  0.961    8.00000000
      ideal mu1:      -0.511533604281
             Q0:     -16.777162029605
             G0:      -0.000000000026
   RMS gradient:       0.000000392438
     Trial step:       0.003870835627
             Q1:     -16.777162029605
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029605
  Cubic LS coeff:       0.006044806210
Predicted energy:     -16.777162029605
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77716202960521 0.00000000000 0.00000029433 0.0060  0.934    8.00000000
      ideal mu1:      -0.511533571847
             Q0:     -16.777162029605
             G0:      -0.000000000025
   RMS gradient:       0.000000363454
     Trial step:       0.004837194563
             Q1:     -16.777162029606
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029606
  Cubic LS coeff:       0.007569840602
Predicted energy:     -16.777162029606
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77716202960534 0.00000000000 0.00000027259 0.0076  0.858    8.00000000
      ideal mu1:      -0.511533528993
             Q0:     -16.777162029606
             G0:      -0.000000000004
   RMS gradient:       0.000000325286
     Trial step:       0.006051181025
             Q1:     -16.777162029606
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777162029606
Quadratic minimum step length (  0.000327168328) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77716202960570 0.00000000000 0.00000024396 0.0003  0.000    8.00000000
      ideal mu1:      -0.511533528683
             Q0:     -16.777162029606
             G0:      -0.000000000008
   RMS gradient:       0.000000325012
     Trial step:       0.001407037590
             Q1:     -16.777162029606
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029606
  Cubic LS coeff:       0.001781496776
Predicted energy:     -16.777162029606
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77716202960561 0.00000000000 0.00000024376 0.0018  0.998    8.00000000
      ideal mu1:      -0.511533525310
             Q0:     -16.777162029606
             G0:      -0.000000000011
   RMS gradient:       0.000000322032
     Trial step:       0.001583234957
             Q1:     -16.777162029606
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777162029606
  Cubic LS coeff:       0.002158596047
Predicted energy:     -16.777162029606
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77716202960558 0.00000000000 0.00000024152 0.0022  0.982    8.00000000
      ideal mu1:      -0.511533519271
10    -16.77716202960574 0.00000000000 0.00000023752 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000057975152              |
           | Maximum change in energy =  0.00000000124891 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88348528151342 |
           | Pseudopotential (local)    :      -46.11753164276864 |
           | Pseudopotential (non-local):       -3.19282976609743 |
           | Hartree                    :       19.84541926680096 |
           | Exchange-correlation       :       -4.13155441702489 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77716202960574 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11753164276891 |
           | Hartree                    :       19.84541926680114 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999841
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01183310160969    -16.47104013783817   0.245960    -16.72592929189973
   2     0.00325918300518    -16.73146415286303   0.390297    -16.76282398375508
   3     0.00167369096907    -16.76400543652740   0.402695    -16.77267248770504
   4     0.00101591031479    -16.77299617702863   0.398379    -16.77615290182349
   5     0.00054630433198    -16.77621468810138   0.316223    -16.77691316579205
   6     0.00030892375635    -16.77691321472980   0.317489    -16.77713744844267
   7     0.00012284208255    -16.77713710797823   0.220754    -16.77716171838361
   8     0.00002464437456    -16.77716184342008   0.039077    -16.77716201994502
   9     0.00000877223955    -16.77716202583219   0.006331    -16.77716202943801
  10     0.00000260496620    -16.77716202957891   0.000508    -16.77716202960531
  11     0.00000057975152    -16.77716202960574  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.321612580 Eh
                 Mid-gap level:      -0.095857489 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.965473352   1.0000000
                            2    -0.468511699   1.0000000
                            3    -0.355485246   1.0000000
                            4    -0.256663779   1.0000000
                        .......   --- gap ---   .........
                            5     0.064948801   0.0000000
                            6     0.152493174   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49640413  -0.08645145  -0.08355283 *
*    H       2     -1.16907344   0.92224712  -1.13164604 *
*    H       3     -1.12890726  -0.78726914   1.26760825 *
*                                                        *
**********************************************************
TOTAL:             -0.80157657   0.04852652   0.05240939
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77400756  -0.04372173  -0.02335822 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77400756  -0.04372173  -0.02335822
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00418233  -0.00054690  -0.00265452 *
*    H       2      0.00016523   0.00011643  -0.00013457 *
*    H       3      0.00017698  -0.00015995   0.00000351 *
*                                                        *
**********************************************************
TOTAL:              0.00452454  -0.00059042  -0.00278558
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00768149   0.00140479   0.00875520 *
*    H       2     -0.00768149   0.00140479   0.00875520 *
*    H       3     -0.00768149   0.00140479   0.00875520 *
*                                                        *
**********************************************************
TOTAL:             -0.02304447   0.00421437   0.02626559

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01847385   0.00080582   0.01618526 *
*    H       2      0.00813291  -0.00974378  -0.00037772 *
*    H       3      0.01034094   0.00893796  -0.01580754 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000  -0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1182.899s on      3 node(s)                                    
TOTAL TIME:      1182.900s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    44        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    22        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    13        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.000%  ------ ||
|| integrals_brappd_ketppd              :    22        0.01s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    10        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    22        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    11        0.01s   0.001%  ------ ||
|| basis_dot_function_with_box          :  1768        0.03s   0.003%  ------ ||
|| integrals_grad                       :     1        0.05s   0.005%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.05s   0.005%  ------ ||
|| basis_add_function_to_box            :  3468        0.06s   0.005%  ------ ||
|| lnv_gradient_norm                    :   110        0.07s   0.006%  ------ ||
|| kernel_fix                           :   110        0.08s   0.007%  ------ ||
|| kernel_purify                        :   354        0.10s   0.008%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.12s   0.010%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.12s   0.010%  ------ ||
|| sparse_trace                         :  3066        0.14s   0.011%  ------ ||
|| pseudo_make_structure_factor         :     1        0.17s   0.014%  ------ ||
|| sparse_product                       :  3872        0.18s   0.015%  ------ ||
|| density_initial_guess_real           :     1        0.21s   0.017%  ------ ||
|| density_batch_row_sums               :   245        0.28s   0.023%  ------ ||
|| basis_copy_function_to_box           :   798        0.29s   0.025%  ------ ||
|| fourier_apply_box_pair               :    74        0.34s   0.029%   9.581 ||
|| integrals_kinetic                    :    22        0.47s   0.040%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.60s   0.051%  ------ ||
|| projectors_func_ovlp_box             :    22        0.77s   0.065%  ------ ||
|| projectors_gradient_batch            :    11        0.81s   0.069%  ------ ||
|| projectors_init_fftbox_recip         :    36        0.81s   0.069%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.90s   0.076%  ------ ||
|| forces_calculate                     :     1        1.30s   0.110%  ------ ||
|| integrals_locpot_mat_els_batch       :   121        2.51s   0.212%  ------ ||
|| properties_calculate                 :     1        4.72s   0.399%  ------ ||
|| ngwf_gradient_batch                  :    11        5.23s   0.442%  ------ ||
|| ngwf_gradient_lnv                    :    11        5.92s   0.500%  ------ ||
|| cell_grid_extract_box                :   550        6.78s   0.573%  ------ ||
|| hamiltonian_energy_components        :     3       15.62s   1.321%  ------ ||
|| cell_grid_deposit_box                :   981       20.37s   1.722%  ------ ||
|| density_fftbox_deposit_to_cell       :   980       20.38s   1.723%  ------ ||
|| density_fftbox_interpolate_multiply  :   980       21.54s   1.821%  ------ ||
|| fourier_apply_box                    :  1845       21.62s   1.828%  18.075 ||
|| potential_apply_to_ngwf_batch        :   121       23.26s   1.967%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       24.94s   2.109%  ------ ||
|| integrals_locpot_dbl_grid            :   121       25.89s   2.188%  ------ ||
|| density_batch_interp_deposit         :   245       44.33s   3.747%  ------ ||
|| density_on_dbl_grid                  :   245       51.81s   4.380%  ------ ||
|| hartree_on_grid                      :   245      183.92s  15.548%  ------ ||
|| fourier_apply_cell_backward          :  1226      421.05s  35.595%   3.249 ||
|| fourier_apply_cell_forward           :  1226      454.76s  38.445%   3.008 ||
|| xc_energy_potential                  :   245      861.61s  72.839%  ------ ||
|| lnv_denskernel_optimise_cg           :    11     1072.82s  90.694%  ------ ||
|| ngwf_cg_optimise                     :     1     1147.15s  96.978%  ------ ||
|| total_time                           :     1     1182.90s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 20:55 (-0000)

