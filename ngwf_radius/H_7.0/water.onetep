 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 21:16 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 1 7.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   63 x  63 x  63
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):     88    88    88
         Recip-space ('23') slabs/node (min max mean):     44    45    44
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       2356     10364
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3216.4518354715   -7.1202816974   10.1554512533   -2.4512395525
  2 1275.3268459984   -3.1443812453   13.3511488054   -3.1747088977
  3  655.6100215422   -2.9485004107   13.5591716205   -3.2265097030
  4  333.4383110991   -2.9071229743   13.6038731329   -3.2393597159
  5  165.9195334793   -2.8936012298   13.6186080893   -3.2442341554
  6   78.8111333398   -2.8876998472   13.6250676297   -3.2465384671
  7   33.5149711848   -2.8848489821   13.6281943061   -3.2476984221
  8    9.9610079041   -2.8834315976   13.6297503547   -3.2482910000
  9   -2.2870418903   -2.8827209226   13.6305310368   -3.2485948083
 10   -8.6560240825   -2.8823635388   13.6309238114   -3.2487507577
 11  -11.9678934703   -2.8821835875   13.6311216658   -3.2488308715
 12  -13.6900650503   -2.8820929160   13.6312213986   -3.2488720574
 13  -14.5855940943   -2.8820472100   13.6312716928   -3.2488932467
 14  -15.0512691430   -2.8820241631   13.6312970640   -3.2489041566
 15  -15.2934201584   -2.8820125389   13.6313098662   -3.2489097782
 16  -15.4193386906   -2.8820066745   13.6313163278   -3.2489126774
 17  -15.4848163341   -2.8820037152   13.6313195901   -3.2489141737
 18  -15.5188647147   -2.8820022215   13.6313212375   -3.2489149466
 19  -15.5365698769   -2.8820014674   13.6313220696   -3.2489153462
 20  -15.5457765642   -2.8820010866   13.6313224901   -3.2489155530
 21  -15.5505640434   -2.8820008943   13.6313227026   -3.2489156600
 22  -15.5530535338   -2.8820007971   13.6313228100   -3.2489157156
 23  -15.5543480695   -2.8820007479   13.6313228644   -3.2489157443
 24  -15.5550212284   -2.8820007231   13.6313228919   -3.2489157593
 25  -15.5553712713   -2.8820007105   13.6313229058   -3.2489157671
 26  -15.5555532937   -2.8820007042   13.6313229129   -3.2489157711
 27  -15.5556479455   -2.8820007009   13.6313229164   -3.2489157732
 28  -15.5556971644   -2.8820006993   13.6313229182   -3.2489157743
 29  -15.5557227583   -2.8820006985   13.6313229191   -3.2489157749
 30  -15.5557360672   -2.8820006981   13.6313229196   -3.2489157752
 31  -15.5557429878   -2.8820006979   13.6313229199   -3.2489157753
 32  -15.5557465865   -2.8820006978   13.6313229200   -3.2489157754
 33  -15.5557484578   -2.8820006977   13.6313229200   -3.2489157755
 34  -15.5557494309   -2.8820006977   13.6313229201   -3.2489157755
 35  -15.5557499369   -2.8820006977   13.6313229201   -3.2489157755
 36  -15.5557502000   -2.8820006976   13.6313229201   -3.2489157755
 37  -15.5557503369   -2.8820006976   13.6313229201   -3.2489157755
 38  -15.5557504080   -2.8820006976   13.6313229201   -3.2489157755
Atom SCF converged after  38 iterations to a total energy of    -15.55575041

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  743    0.0094339623    7.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   29    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1    0.7969497866   -0.2366611669    0.2820958379   -0.2424203193
  2    0.0538812189   -0.2313080165    0.2928169574   -0.2507426696
  3   -0.1895436177   -0.2279873646    0.2972577104   -0.2550145904
  4   -0.3166545632   -0.2261622485    0.2995698433   -0.2573933276
  5   -0.3827326249   -0.2252586999    0.3006887270   -0.2586114587
  6   -0.4170290708   -0.2248312905    0.3012095359   -0.2592129523
  7   -0.4348256948   -0.2246337795    0.3014464782   -0.2595053297
  8   -0.4440639385   -0.2245437141    0.3015526627   -0.2596467076
  9   -0.4488626017   -0.2245029852    0.3015997046   -0.2597151066
 10   -0.4513570340   -0.2244846751    0.3016203291   -0.2597483265
 11   -0.4526546589   -0.2244764836    0.3016292714   -0.2597645548
 12   -0.4533301840   -0.2244728364    0.3016330969   -0.2597725377
 13   -0.4536820931   -0.2244712214    0.3016347045   -0.2597764940
 14   -0.4538655343   -0.2244705112    0.3016353634   -0.2597784697
 15   -0.4539612142   -0.2244702018    0.3016356234   -0.2597794639
 16   -0.4540111471   -0.2244700687    0.3016357197   -0.2597799679
 17   -0.4540372193   -0.2244700125    0.3016357515   -0.2597802250
 18   -0.4540508395   -0.2244699895    0.3016357592   -0.2597803571
 19   -0.4540579581   -0.2244699804    0.3016357589   -0.2597804254
 20   -0.4540616803   -0.2244699771    0.3016357567   -0.2597804608
 21   -0.4540636274   -0.2244699760    0.3016357545   -0.2597804793
 22   -0.4540646464   -0.2244699758    0.3016357529   -0.2597804890
 23   -0.4540651799   -0.2244699759    0.3016357517   -0.2597804941
 24   -0.4540654593   -0.2244699760    0.3016357510   -0.2597804967
 25   -0.4540656057   -0.2244699761    0.3016357506   -0.2597804982
 26   -0.4540656825   -0.2244699762    0.3016357503   -0.2597804989
Atom SCF converged after  26 iterations to a total energy of     -0.45406568
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20340203E+01     0.85148713E+00
               2       0.18212267E+01     0.72855715E+00
               3       0.15669805E+01     0.57389025E+00
               4       0.13132948E+01     0.49778914E+00
               5       0.10971380E+01     0.42539981E+00
               6       0.84177178E+00     0.32891569E+00
               7       0.50288500E+00     0.19871662E+00
               8       0.18150202E+00     0.72892543E-01
               9       0.24583869E-01     0.99797099E-02
              10       0.49963918E-03     0.19766841E-03
              11       0.23587248E-06     0.87944609E-07
              12       0.55189493E-13     0.20095037E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.74820629273288    0.5877094
               2          -1.81762954266269    0.5780276
               3          -1.90696161521349    0.5631467
               4          -2.01165758083886    0.5444845
               5          -2.11371280069717    0.5279139
               6          -2.18539193823304    0.5147895
               7          -2.21677073209459    0.5029256
               8          -2.22364298965715    0.5000634
               9          -2.22399438301580    0.5000000
              10          -2.22399529879721    0.5003347
              11          -2.22399529880352    0.5003347
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [   -0.00000000000000:    0.99999999999999]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.453653065061=    -16.453653065061+      0.000000000000
    Trial step:       1.000000000000
            G0:      -3.693072646387
WARNING: minimum value of charge density: -0.0452
      Q1=E1+P1:      49.335349436128=    -20.017075914131+     69.352425350259
Quadratic term:     -69.482075147577
   Linear term:      -3.693072646387
  Optimal step:       0.026575722145
 Predicted min:     -16.502726101317
    !!! Quadratic minimum step length accepted !!!
 1    -16.45365306506120 0.32028948045 0.03294696061 0.0266  0.000    8.00000000
      Q0=E0+P0:     -16.540802620305=    -16.551682289697+      0.010879669391
    Trial step:       0.163020618773
            G0:      -0.021930279648
      Q1=E1+P1:     -16.544255945104=    -16.555314270828+      0.011058325723
Quadratic term:      -0.000121762959
   Linear term:      -0.003575087758
  Optimal step:       2.393227879290
 Predicted min:     -16.567044698632
    !!! Quadratic minimum step length accepted !!!
 2    -16.55168228969673 0.24667278351 0.03419548722 2.3932 -0.763    8.00000000
      Q0=E0+P0:     -16.563395983531=    -16.589398691657+      0.026002708127
    Trial step:       0.624616274001
            G0:      -2.089734129965
WARNING: minimum value of charge density: -0.0011
      Q1=E1+P1:      -8.151626379841=    -18.270795568673+     10.119169188832
Quadratic term:      -9.717051549602
   Linear term:      -1.305281945912
  Optimal step:       0.041952043859
 Predicted min:     -16.607230292467
    !!! Quadratic minimum step length accepted !!!
 3    -16.58939869165745 0.24187321602 0.02758143088 0.0420  3.234    8.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.705877621332
   Final penalty energy   :       0.074176363868
   RMS occupancy error    :       0.055594
   Occupancy bounds       : [-0.054, 1.079]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.055594 (step -0.4144 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002225 (step -0.4996 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.531591020636
             Q0:     -16.462399129861
             G0:      -0.045223690167
   RMS gradient:       0.035443103924
     Trial step:       0.500000000000
             Q1:     -16.467558009319
 Quadratic coef:       0.017452965625
 Linear coef   :      -0.022611845083
           Qmin:     -16.469723036139
Quadratic minimum step length (  0.323896889064) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001006 (step -0.4980 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.46239912986075 0.00000000000 0.02658232789 0.3239  0.000    8.00000000
      ideal mu1:      -0.497307078488
             Q0:     -16.469718705291
             G0:      -0.000405662375
   RMS gradient:       0.003350016773
     Trial step:       0.402428185559
             Q1:     -16.469845453482
 Quadratic coef:       0.000036501783
 Linear coef   :      -0.000163249974
           Qmin:     -16.469901234415
Quadratic minimum step length (  0.899906596172) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000111 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.46971870529146 0.00091548828 0.00251251258 0.8999  0.009    8.00000000
      ideal mu1:      -0.497432507829
             Q0:     -16.469901292442
             G0:      -0.000043017060
   RMS gradient:       0.001092986688
     Trial step:       0.601787153959
             Q1:     -16.469912831679
 Quadratic coef:       0.000014347877
 Linear coef   :      -0.000025887114
           Qmin:     -16.469912969129
Quadratic minimum step length (  0.542886324962) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.46990129244192 0.00002311185 0.00081974003 0.5429  0.106    8.00000000
      ideal mu1:      -0.498516517841
             Q0:     -16.469912973133
             G0:      -0.000001030794
   RMS gradient:       0.000169236506
     Trial step:       0.571578530407
             Q1:     -16.469913106777
 Quadratic coef:       0.000000455535
 Linear coef   :      -0.000000589179
           Qmin:     -16.469913163641
Quadratic minimum step length (  0.369633801878) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.46991297313264 0.00000161794 0.00012692738 0.3696  0.024    8.00000000
      ideal mu1:      -0.498376376662
             Q0:     -16.469913163636
             G0:      -0.000000081018
   RMS gradient:       0.000047439200
     Trial step:       0.459646326284
             Q1:     -16.469913193407
 Quadratic coef:       0.000000007469
 Linear coef   :      -0.000000037239
           Qmin:     -16.469913210056
Quadratic minimum step length (  1.145916224656) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.46991316363605 0.00000002444 0.00003557940 1.1459  0.079    8.00000000
      ideal mu1:      -0.498381815562
             Q0:     -16.469913210055
             G0:      -0.000000006767
   RMS gradient:       0.000013710412
     Trial step:       0.725752149767
             Q1:     -16.469913211529
 Quadratic coef:       0.000000003437
 Linear coef   :      -0.000000004911
           Qmin:     -16.469913211809
Quadratic minimum step length (  0.518547356293) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.46991321005456 0.00000000627 0.00001028281 0.5185  0.084    8.00000000
      ideal mu1:      -0.498382989583
             Q0:     -16.469913211809
             G0:      -0.000000000740
   RMS gradient:       0.000004532532
     Trial step:       0.613463005067
             Q1:     -16.469913211954
 Quadratic coef:       0.000000000308
 Linear coef   :      -0.000000000454
           Qmin:     -16.469913211976
Quadratic minimum step length (  0.451368334767) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.46991321180909 0.00000000024 0.00000339940 0.4514  0.000    8.00000000
      ideal mu1:      -0.498382122366
             Q0:     -16.469913211976
             G0:      -0.000000000070
   RMS gradient:       0.000001393526
     Trial step:       0.526210770545
             Q1:     -16.469913211997
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000037
           Qmin:     -16.469913211997
Quadratic minimum step length (  0.598756185585) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.46991321197596 0.00000000002 0.00000104514 0.5988  0.095    8.00000000
      ideal mu1:      -0.498382750301
             Q0:     -16.469913211997
             G0:      -0.000000000004
   RMS gradient:       0.000000349921
     Trial step:       0.561312705883
             Q1:     -16.469913211999
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.469913211999
Quadratic minimum step length (  0.774088359171) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.46991321199698 0.00000000000 0.00000026244 0.7741  0.063    8.00000000
      ideal mu1:      -0.498382507177
10    -16.46991321199869 0.00000000000 0.00000012930 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01078033059859              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21205602E-01     0.13709388E-01
               2       0.26658803E-03     0.18265366E-03
               3       0.45233611E-07     0.32615964E-07
               4       0.16070909E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27091319E-01     0.16810568E-01
               2       0.42885464E-03     0.27787339E-03
               3       0.11553142E-06     0.76476975E-07
               4       0.88331263E-14     0.61062266E-14
================================================================================
RMS gradient                =       0.01078033059859
Trial step length           =               0.122474
Gradient along search dir.  =         -2.05736348891
Functional at step 0        =     -16.46991321199869
Functional at step 1        =     -16.65887360322925
Functional predicted        =     -16.72180572730415
Selected quadratic step     =               0.244869
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.11757632
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010216 (step -0.4830 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000065 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513477036752
             Q0:     -16.721661043891
             G0:      -0.024933998817
   RMS gradient:       0.026317505168
     Trial step:       0.659170411562
             Q1:     -16.726584255710
 Quadratic coef:       0.011512542444
 Linear coef   :      -0.016435754262
           Qmin:     -16.727527124722
Quadratic minimum step length (  0.470528684453) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001145 (step -0.4978 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.72166104389138 0.00000000000 0.01973812885 0.4705  0.000    8.00000000
      ideal mu1:      -0.483366892850
             Q0:     -16.727515143208
             G0:      -0.001892154821
   RMS gradient:       0.007230271865
     Trial step:       0.556918833029
             Q1:     -16.727991709526
 Quadratic coef:       0.000577210336
 Linear coef   :      -0.001053776655
           Qmin:     -16.727996096670
Quadratic minimum step length (  0.508365866017) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000283 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.72751514320754 0.00073326010 0.00542270390 0.5084  0.075    8.00000000
      ideal mu1:      -0.487578562948
             Q0:     -16.727997139170
             G0:      -0.000291944334
   RMS gradient:       0.002843914195
     Trial step:       0.532088831732
             Q1:     -16.728091751595
 Quadratic coef:       0.000060727895
 Linear coef   :      -0.000155340320
           Qmin:     -16.728096478259
Quadratic minimum step length (  0.680534448538) accepted
    Initial Ne1:       8.00000022
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000113 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.72799713917032 0.00006495615 0.00213293560 0.6805  0.155    8.00000000
      ideal mu1:      -0.486347685282
             Q0:     -16.728096652790
             G0:      -0.000002177077
   RMS gradient:       0.000245628289
     Trial step:       0.601751426816
             Q1:     -16.728097457281
 Quadratic coef:       0.000000505568
 Linear coef   :      -0.000001310059
           Qmin:     -16.728097501467
Quadratic minimum step length (  0.779647675501) accepted
    Initial Ne1:       8.00000011
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.72809665279033 0.00001453197 0.00018422121 0.7796  0.007    8.00000000
      ideal mu1:      -0.486584346727
             Q0:     -16.728097501452
             G0:      -0.000000895862
   RMS gradient:       0.000157759918
     Trial step:       0.684948247057
             Q1:     -16.728097722527
 Quadratic coef:       0.000000392544
 Linear coef   :      -0.000000613619
           Qmin:     -16.728097741252
Quadratic minimum step length (  0.535350074498) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.72809750145219 0.00000010726 0.00011831994 0.5354  0.413    8.00000000
      ideal mu1:      -0.486454615648
             Q0:     -16.728097741247
             G0:      -0.000000029390
   RMS gradient:       0.000028571583
     Trial step:       0.605546938800
             Q1:     -16.728097749684
 Quadratic coef:       0.000000009359
 Linear coef   :      -0.000000017797
           Qmin:     -16.728097749707
Quadratic minimum step length (  0.575717632415) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.72809774124700 0.00000004250 0.00002142869 0.5757  0.033    8.00000000
      ideal mu1:      -0.486467656821
             Q0:     -16.728097749707
             G0:      -0.000000004057
   RMS gradient:       0.000010615444
     Trial step:       0.590443943082
             Q1:     -16.728097750547
 Quadratic coef:       0.000000001555
 Linear coef   :      -0.000000002395
           Qmin:     -16.728097750629
Quadratic minimum step length (  0.454647840544) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.72809774970702 0.00000000111 0.00000796158 0.4546  0.000    8.00000000
      ideal mu1:      -0.486461885225
             Q0:     -16.728097750629
             G0:      -0.000000000525
   RMS gradient:       0.000003819906
     Trial step:       0.518115878626
             Q1:     -16.728097750792
 Quadratic coef:       0.000000000109
 Linear coef   :      -0.000000000272
           Qmin:     -16.728097750799
Quadratic minimum step length (  0.646661607842) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.72809775062912 0.00000000012 0.00000286493 0.6467  0.129    8.00000000
      ideal mu1:      -0.486464993244
             Q0:     -16.728097750799
             G0:      -0.000000000030
   RMS gradient:       0.000000912781
     Trial step:       0.578831276902
             Q1:     -16.728097750805
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000017
           Qmin:     -16.728097750805
Quadratic minimum step length (  0.448164849297) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.72809775079865 0.00000000002 0.00000068459 0.4482  0.057    8.00000000
      ideal mu1:      -0.486464223679
10    -16.72809775080519 0.00000000000 0.00000023112 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00300151743611              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11626606E-01     0.62576343E-02
               2       0.80705807E-04     0.46082044E-04
               3       0.43100912E-08     0.26318258E-08
               4       0.75293910E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18780149E-01     0.10226281E-01
               2       0.20467404E-03     0.11619910E-03
               3       0.26303504E-07     0.15855777E-07
               4       0.76984518E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00300151743611
Trial step length           =               0.173177
Gradient along search dir.  =         -0.16349356555
Functional at step 0        =     -16.72809775080519
Functional at step 1        =     -16.75034537040055
Functional predicted        =     -16.76113783816096
Selected quadratic step     =               0.404176
Conjugate gradients coeff.  =               0.077521
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05969507
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.005210 (step -0.4912 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000019 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.505717061358
             Q0:     -16.760805437457
             G0:      -0.009605527848
   RMS gradient:       0.016334632472
     Trial step:       0.509324878620
             Q1:     -16.762670551535
 Quadratic coef:       0.003027220228
 Linear coef   :      -0.004892334305
           Qmin:     -16.762782080479
Quadratic minimum step length (  0.411563643952) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000348 (step -0.4993 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.76080543745725 0.00000000000 0.01225097432 0.4116  0.000    8.00000000
      ideal mu1:      -0.486434974878
             Q0:     -16.762781389737
             G0:      -0.000527034218
   RMS gradient:       0.003821455900
     Trial step:       0.457842334216
             Q1:     -16.762915622658
 Quadratic coef:       0.000107065656
 Linear coef   :      -0.000241298577
           Qmin:     -16.762917346040
Quadratic minimum step length (  0.515929698510) accepted
    Initial Ne1:       8.00000043
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000071 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.76278138973735 0.00024708038 0.00286609286 0.5159  0.055    8.00000000
      ideal mu1:      -0.486998365218
             Q0:     -16.762917438243
             G0:      -0.000034967319
   RMS gradient:       0.000984753031
     Trial step:       0.486018988782
             Q1:     -16.762929582468
 Quadratic coef:       0.000004850556
 Linear coef   :      -0.000016994781
           Qmin:     -16.762932324298
Quadratic minimum step length (  0.851426728985) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.76291743824283 0.00001796453 0.00073856477 0.8514  0.066    8.00000000
      ideal mu1:      -0.486807923824
             Q0:     -16.762932328786
             G0:      -0.000000019820
   RMS gradient:       0.000023458986
     Trial step:       0.643280310474
             Q1:     -16.762932333327
 Quadratic coef:       0.000000008209
 Linear coef   :      -0.000000012750
           Qmin:     -16.762932333737
Quadratic minimum step length (  0.499545221315) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.76293232878642 0.00000199450 0.00001759424 0.4995  0.001    8.00000000
      ideal mu1:      -0.486830650407
             Q0:     -16.762932333737
             G0:      -0.000000004338
   RMS gradient:       0.000010976824
     Trial step:       0.566875299394
             Q1:     -16.762932335302
 Quadratic coef:       0.000000000893
 Linear coef   :      -0.000000002459
           Qmin:     -16.762932335429
Quadratic minimum step length (  0.780124524926) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.76293233373689 0.00000000062 0.00000823262 0.7801  0.219    8.00000000
      ideal mu1:      -0.486824071960
             Q0:     -16.762932335429
             G0:      -0.000000000223
   RMS gradient:       0.000002487313
     Trial step:       0.665006258340
             Q1:     -16.762932335480
 Quadratic coef:       0.000000000097
 Linear coef   :      -0.000000000148
           Qmin:     -16.762932335485
Quadratic minimum step length (  0.507182971148) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.76293233542875 0.00000000026 0.00000186548 0.5072  0.051    8.00000000
      ideal mu1:      -0.486824807329
             Q0:     -16.762932335486
             G0:      -0.000000000026
   RMS gradient:       0.000000842719
     Trial step:       0.580757996017
             Q1:     -16.762932335493
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000015
           Qmin:     -16.762932335493
Quadratic minimum step length (  0.577895292942) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.76293233548550 0.00000000001 0.00000063204 0.5779  0.000    8.00000000
      ideal mu1:      -0.486824350148
             Q0:     -16.762932335493
             G0:      -0.000000000006
   RMS gradient:       0.000000414390
     Trial step:       0.579324876245
             Q1:     -16.762932335495
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.762932335495
Quadratic minimum step length (  0.699907290612) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.76293233549296 0.00000000000 0.00000031079 0.6999  0.242    8.00000000
      ideal mu1:      -0.486824554595
             Q0:     -16.762932335495
             G0:      -0.000000000001
   RMS gradient:       0.000000117406
     Trial step:       0.636768171721
             Q1:     -16.762932335495
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.762932335495
  Cubic LS coeff:       0.805209821610
Predicted energy:     -16.762932335495
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.76293233549507 0.00000000000 0.00000008805 0.8052  0.080    8.00000000
      ideal mu1:      -0.486824478579
10    -16.76293233549538 0.00000000000 0.00000004898 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00160563147378              |
           | Maximum change in energy =  0.08606151293550 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14188959E-01     0.60786510E-02
               2       0.12516814E-03     0.53202278E-04
               3       0.11571499E-07     0.50565053E-08
               4       0.90621298E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.83109356E-02     0.35631258E-02
               2       0.41896987E-04     0.17681315E-04
               3       0.12624148E-08     0.54439109E-09
               4       0.81275200E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00160563147378
Trial step length           =               0.264564
Gradient along search dir.  =         -0.04813082509
Functional at step 0        =     -16.76293233549538
Functional at step 1        =     -16.77144006235928
Functional predicted        =     -16.77252465425625
Selected quadratic step     =               0.398594
Conjugate gradients coeff.  =               0.286161
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.03144878
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002693 (step -0.4954 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.509933921453
             Q0:     -16.772429186540
             G0:      -0.002641947591
   RMS gradient:       0.008566646548
     Trial step:       0.716053060854
             Q1:     -16.772618831691
 Quadratic coef:       0.001702129508
 Linear coef   :      -0.001891774659
           Qmin:     -16.772954823888
Quadratic minimum step length (  0.397916559495) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000086 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77242918653992 0.00000000000 0.00642498491 0.3979  0.000    8.00000000
      ideal mu1:      -0.499971584981
             Q0:     -16.772953652312
             G0:      -0.000110183420
   RMS gradient:       0.001750024923
     Trial step:       0.533787757813
             Q1:     -16.772985167389
 Quadratic coef:       0.000027299483
 Linear coef   :      -0.000058814560
           Qmin:     -16.772985330133
Quadratic minimum step length (  0.575001590235) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77295365231191 0.00006570467 0.00131251870 0.5750  0.042    8.00000000
      ideal mu1:      -0.499852579931
             Q0:     -16.772985337133
             G0:      -0.000007665949
   RMS gradient:       0.000461248840
     Trial step:       0.554011560881
             Q1:     -16.772988226665
 Quadratic coef:       0.000001357492
 Linear coef   :      -0.000004247024
           Qmin:     -16.772988658923
Quadratic minimum step length (  0.866635211535) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77298533713268 0.00000412257 0.00034593663 0.8666  0.069    8.00000000
      ideal mu1:      -0.499813408356
             Q0:     -16.772988659171
             G0:      -0.000000005221
   RMS gradient:       0.000012042545
     Trial step:       0.692911196516
             Q1:     -16.772988661177
 Quadratic coef:       0.000000001613
 Linear coef   :      -0.000000003618
           Qmin:     -16.772988661200
Quadratic minimum step length (  0.777213723398) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77298865917137 0.00000044558 0.00000903191 0.7772  0.001    8.00000000
      ideal mu1:      -0.499824209659
             Q0:     -16.772988661200
             G0:      -0.000000002230
   RMS gradient:       0.000007869677
     Trial step:       0.733852908305
             Q1:     -16.772988661840
 Quadratic coef:       0.000000000997
 Linear coef   :      -0.000000001636
           Qmin:     -16.772988661872
Quadratic minimum step length (  0.602216770905) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77298866120032 0.00000000025 0.00000590226 0.6022  0.427    8.00000000
      ideal mu1:      -0.499817907905
             Q0:     -16.772988661872
             G0:      -0.000000000083
   RMS gradient:       0.000001519678
     Trial step:       0.664784573195
             Q1:     -16.772988661899
 Quadratic coef:       0.000000000027
 Linear coef   :      -0.000000000055
           Qmin:     -16.772988661899
Quadratic minimum step length (  0.671542339304) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77298866187152 0.00000000012 0.00000113976 0.6715  0.037    8.00000000
      ideal mu1:      -0.499818607171
             Q0:     -16.772988661899
             G0:      -0.000000000010
   RMS gradient:       0.000000529046
     Trial step:       0.668154912739
             Q1:     -16.772988661901
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000007
           Qmin:     -16.772988661902
Quadratic minimum step length (  0.431248230042) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77298866189938 0.00000000000 0.00000039678 0.4312  0.000    8.00000000
      ideal mu1:      -0.499818384029
             Q0:     -16.772988661902
             G0:      -0.000000000001
   RMS gradient:       0.000000152604
     Trial step:       0.536787316833
             Q1:     -16.772988661902
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.772988661903
Quadratic minimum step length (  2.720175873810) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77298866190151 0.00000000000 0.00000011445 2.7202  0.083    8.00000000
      ideal mu1:      -0.499818604203
             Q0:     -16.772988661900
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.551E+01) too large - resetting
             G0:      -0.000000000005
   RMS gradient:       0.000000358373
     Trial step:       1.208369111081
             Q1:     -16.772988661901
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000006
           Qmin:     -16.772988661902
Quadratic minimum step length (  0.717078921517) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77298866189989 0.00000000000 0.00000026878 0.7171  0.000    8.00000000
      ideal mu1:      -0.499818274889
10    -16.77298866190183 0.00000000000 0.00000013557 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00092359315227              |
           | Maximum change in energy =  0.01161152823006 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13517550E-01     0.49336113E-02
               2       0.12058121E-03     0.44391249E-04
               3       0.10877860E-07     0.43914790E-08
               4       0.62423199E-15     0.33306691E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.33207140E-02     0.11797964E-02
               2       0.71470118E-05     0.25138074E-05
               3       0.37148286E-10     0.14505022E-10
               4       0.69302375E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00092359315227
Trial step length           =               0.324736
Gradient along search dir.  =         -0.01584444831
Functional at step 0        =     -16.77298866190183
Functional at step 1        =     -16.77601828742842
Functional predicted        =     -16.77611700228589
Selected quadratic step     =               0.394882
Conjugate gradients coeff.  =               0.330879
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01231151
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001021 (step -0.4979 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513231009847
             Q0:     -16.776101455891
             G0:      -0.000318090005
   RMS gradient:       0.002972512988
     Trial step:       0.930857679223
             Q1:     -16.776071398724
 Quadratic coef:       0.000326153690
 Linear coef   :      -0.000296096524
           Qmin:     -16.776168658221
Quadratic minimum step length (  0.422536569320) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77610145589111 0.00000000000 0.00222938474 0.4225  0.000    8.00000000
      ideal mu1:      -0.509650109599
             Q0:     -16.776168556389
             G0:      -0.000017549268
   RMS gradient:       0.000698500513
     Trial step:       0.627153418474
             Q1:     -16.776173807184
 Quadratic coef:       0.000005755288
 Linear coef   :      -0.000011006084
           Qmin:     -16.776173818240
Quadratic minimum step length (  0.599666183896) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77616855638862 0.00000840029 0.00052387538 0.5997  0.055    8.00000000
      ideal mu1:      -0.509646779627
             Q0:     -16.776173818242
             G0:      -0.000001532264
   RMS gradient:       0.000206279937
     Trial step:       0.613255817073
             Q1:     -16.776174415069
 Quadratic coef:       0.000000342843
 Linear coef   :      -0.000000939670
           Qmin:     -16.776174462108
Quadratic minimum step length (  0.840411173519) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77617381824163 0.00000069351 0.00015470995 0.8404  0.087    8.00000000
      ideal mu1:      -0.509636756462
             Q0:     -16.776174462118
             G0:      -0.000000001523
   RMS gradient:       0.000006504355
     Trial step:       0.717904618242
             Q1:     -16.776174462537
 Quadratic coef:       0.000000000675
 Linear coef   :      -0.000000001093
           Qmin:     -16.776174462561
Quadratic minimum step length (  0.581693231072) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77617446211841 0.00000008790 0.00000487827 0.5817  0.001    8.00000000
      ideal mu1:      -0.509639057270
             Q0:     -16.776174462561
             G0:      -0.000000000366
   RMS gradient:       0.000003191037
     Trial step:       0.646219975695
             Q1:     -16.776174462708
 Quadratic coef:       0.000000000090
 Linear coef   :      -0.000000000237
           Qmin:     -16.776174462716
Quadratic minimum step length (  0.846918063610) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77617446256126 0.00000000006 0.00000239328 0.8469  0.241    8.00000000
      ideal mu1:      -0.509637796337
             Q0:     -16.776174462717
             G0:      -0.000000000024
   RMS gradient:       0.000000821886
     Trial step:       0.739794140611
             Q1:     -16.776174462726
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000018
           Qmin:     -16.776174462726
Quadratic minimum step length (  0.718756727683) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77617446271680 0.00000000002 0.00000061641 0.7188  0.066    8.00000000
      ideal mu1:      -0.509638423319
             Q0:     -16.776174462725
             G0:      -0.000000000004
   RMS gradient:       0.000000330688
     Trial step:       0.729199571904
             Q1:     -16.776174462726
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000003
           Qmin:     -16.776174462726
Quadratic minimum step length (  0.442351379373) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77617446272547 0.00000000000 0.00000024802 0.4424  0.000    8.00000000
      ideal mu1:      -0.509638108105
             Q0:     -16.776174462726
             G0:      -0.000000000000
   RMS gradient:       0.000000099119
     Trial step:       0.567945804166
             Q1:     -16.776174462726
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776174462726
Quadratic minimum step length (  0.156861518048) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77617446272642 0.00000000000 0.00000007434 0.1569  0.090    8.00000000
      ideal mu1:      -0.509638123359
             Q0:     -16.776174462726
             G0:      -0.000000000000
   RMS gradient:       0.000000078123
     Trial step:       0.298477538536
             Q1:     -16.776174462726
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776174462726
Quadratic minimum step length (  0.201027460654) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77617446272644 0.00000000000 0.00000005859 0.2010  0.621    8.00000000
      ideal mu1:      -0.509638159699
10    -16.77617446272665 0.00000000000 0.00000002984 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00048233186171              |
           | Maximum change in energy =  0.00335210880215 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88766993187970 |
           | Pseudopotential (local)    :      -46.13481140917061 |
           | Pseudopotential (non-local):       -3.19125350585657 |
           | Hartree                    :       19.86053698871507 |
           | Exchange-correlation       :       -4.13416571626507 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77617446272664 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.13481140917078 |
           | Hartree                    :       19.86053698871517 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999594
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46216230E-02     0.17022757E-02
               2       0.13172180E-04     0.51354009E-05
               3       0.12884892E-09     0.54806687E-10
               4       0.70988316E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.75432933E-03     0.26645700E-03
               2       0.35697166E-06     0.13430936E-06
               3       0.92791322E-13     0.38455350E-13
================================================================================
RMS gradient                =       0.00048233186171
Trial step length           =               0.358095
Gradient along search dir.  =         -0.00411849717
Functional at step 0        =     -16.77617446272665
Functional at step 1        =     -16.77678068489806
Functional predicted        =     -16.77680049799257
Selected quadratic step     =               0.304012
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99838769
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000203 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.509742817154
             Q0:     -16.776800213247
             G0:      -0.000003105610
   RMS gradient:       0.000293712363
     Trial step:       0.244953427480
             Q1:     -16.776800760054
 Quadratic coef:       0.000000213923
 Linear coef   :      -0.000000760730
           Qmin:     -16.776800889553
Quadratic minimum step length (  0.435538152962) accepted
    Initial Ne1:       7.99999945
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77680021324706 0.00000000000 0.00022028420 0.4355  0.000    8.00000000
      ideal mu1:      -0.510090988841
             Q0:     -16.776800889517
             G0:      -0.000000140383
   RMS gradient:       0.000062449762
     Trial step:       0.326629091427
             Q1:     -16.776800920137
 Quadratic coef:       0.000000015233
 Linear coef   :      -0.000000045853
           Qmin:     -16.776800924022
Quadratic minimum step length (  0.491585282635) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77680088951686 0.00000008454 0.00004683732 0.4916  0.045    8.00000000
      ideal mu1:      -0.510078821816
             Q0:     -16.776800924023
             G0:      -0.000000002452
   RMS gradient:       0.000008252983
     Trial step:       0.400706943072
             Q1:     -16.776800924810
 Quadratic coef:       0.000000000195
 Linear coef   :      -0.000000000983
           Qmin:     -16.776800925261
Quadratic minimum step length (  1.010086516680) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77680092402256 0.00000000451 0.00000618974 1.0101  0.017    8.00000000
      ideal mu1:      -0.510076094038
             Q0:     -16.776800925262
             G0:      -0.000000000108
   RMS gradient:       0.000001730071
     Trial step:       0.636198617050
             Q1:     -16.776800925282
 Quadratic coef:       0.000000000049
 Linear coef   :      -0.000000000069
           Qmin:     -16.776800925286
Quadratic minimum step length (  0.443979663735) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77680092526218 0.00000000016 0.00000129755 0.4440  0.044    8.00000000
      ideal mu1:      -0.510075817925
             Q0:     -16.776800925286
             G0:      -0.000000000005
   RMS gradient:       0.000000383710
     Trial step:       0.531468953060
             Q1:     -16.776800925288
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.776800925288
Quadratic minimum step length (  0.665509422401) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77680092528633 0.00000000000 0.00000028778 0.6655  0.049    8.00000000
      ideal mu1:      -0.510075837180
             Q0:     -16.776800925289
             G0:      -0.000000000002
   RMS gradient:       0.000000172806
     Trial step:       0.594724806927
             Q1:     -16.776800925289
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.776800925289
Quadratic minimum step length (  0.711120398289) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77680092528857 0.00000000000 0.00000012960 0.7111  0.203    8.00000000
      ideal mu1:      -0.510075862219
             Q0:     -16.776800925289
             G0:      -0.000000000000
   RMS gradient:       0.000000075200
     Trial step:       0.650323720600
             Q1:     -16.776800925289
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776800925289
Quadratic minimum step length (  0.220315227209) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77680092528933 0.00000000000 0.00000005640 0.2203  0.000    8.00000000
      ideal mu1:      -0.510075859205
             Q0:     -16.776800925289
             G0:      -0.000000000000
   RMS gradient:       0.000000048958
     Trial step:       0.378518451681
             Q1:     -16.776800925289
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776800925289
  Cubic LS coeff:       0.498371451433
Predicted energy:     -16.776800925289
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77680092528923 0.00000000000 0.00000003672 0.4984  0.424    8.00000000
      ideal mu1:      -0.510075853620
             Q0:     -16.776800925290
             G0:      -0.000000000000
   RMS gradient:       0.000000038398
     Trial step:       0.434330277736
             Q1:     -16.776800925290
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776800925289
  Cubic LS coeff:       0.449836798328
Predicted energy:     -16.776800925290
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77680092528951 0.00000000000 0.00000002880 0.4498  0.615    8.00000000
      ideal mu1:      -0.510075855161
10    -16.77680092528939 0.00000000000 0.00000002313 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00026990898489              |
           | Maximum change in energy =  0.00106193360827 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.53554303E-02     0.18897206E-02
               2       0.17904313E-04     0.65883870E-05
               3       0.23375451E-09     0.95151831E-10
               4       0.91033091E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17496236E-04     0.58592478E-05
               2       0.19361631E-09     0.68090159E-10
               3       0.74447931E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00026990898489
Trial step length           =               0.329947
Gradient along search dir.  =         -0.00129040972
Functional at step 0        =     -16.77680092528939
Functional at step 1        =     -16.77701442874618
Functional predicted        =     -16.77701443055711
Selected quadratic step     =               0.330911
Conjugate gradients coeff.  =               0.313143
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99802140
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000253 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511222510216
             Q0:     -16.777013951567
             G0:      -0.000000495302
   RMS gradient:       0.000117296194
     Trial step:       0.442015544471
             Q1:     -16.777014084867
 Quadratic coef:       0.000000085632
 Linear coef   :      -0.000000218931
           Qmin:     -16.777014091501
Quadratic minimum step length (  0.565041323850) accepted
    Initial Ne1:       7.99999950
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77701395156743 0.00000000000 0.00008797180 0.5650  0.000    8.00000000
      ideal mu1:      -0.511260779415
             Q0:     -16.777014091500
             G0:      -0.000000012498
   RMS gradient:       0.000018632678
     Trial step:       0.499756989356
             Q1:     -16.777014094756
 Quadratic coef:       0.000000002990
 Linear coef   :      -0.000000006246
           Qmin:     -16.777014094762
Quadratic minimum step length (  0.521996278568) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77701409150015 0.00000001749 0.00001397451 0.5220  0.025    8.00000000
      ideal mu1:      -0.511282656735
             Q0:     -16.777014094762
             G0:      -0.000000002460
   RMS gradient:       0.000008266218
     Trial step:       0.510755605581
             Q1:     -16.777014095636
 Quadratic coef:       0.000000000382
 Linear coef   :      -0.000000001256
           Qmin:     -16.777014095796
Quadratic minimum step length (  0.840518133334) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77701409476171 0.00000000042 0.00000619966 0.8405  0.197    8.00000000
      ideal mu1:      -0.511276991156
             Q0:     -16.777014095795
             G0:      -0.000000000039
   RMS gradient:       0.000001039862
     Trial step:       0.655209392631
             Q1:     -16.777014095812
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000025
           Qmin:     -16.777014095813
Quadratic minimum step length (  0.936466598755) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77701409579500 0.00000000016 0.00000077990 0.9365  0.016    8.00000000
      ideal mu1:      -0.511277103414
             Q0:     -16.777014095813
             G0:      -0.000000000009
   RMS gradient:       0.000000491227
     Trial step:       0.783314567329
             Q1:     -16.777014095814
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000007
           Qmin:     -16.777014095815
Quadratic minimum step length (  0.465757797697) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77701409581331 0.00000000000 0.00000036842 0.4658  0.223    8.00000000
      ideal mu1:      -0.511277046013
             Q0:     -16.777014095815
             G0:      -0.000000000001
   RMS gradient:       0.000000126435
     Trial step:       0.604015618824
             Q1:     -16.777014095815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777014095816
Quadratic minimum step length (  1.951989010437) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77701409581515 0.00000000000 0.00000009483 1.9520  0.066    8.00000000
      ideal mu1:      -0.511276997443
             Q0:     -16.777014095815
             G0:      -0.000000000002
   RMS gradient:       0.000000224467
     Trial step:       1.085832330554
             Q1:     -16.777014095815
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000002
           Qmin:     -16.777014095815
Quadratic minimum step length (  0.496670974637) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77701409581498 0.00000000000 0.00000016835 0.4967  0.000    8.00000000
      ideal mu1:      -0.511277034606
             Q0:     -16.777014095815
             G0:      -0.000000000000
   RMS gradient:       0.000000072224
     Trial step:       0.734371433206
             Q1:     -16.777014095816
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777014095816
  Cubic LS coeff:       1.119159802517
Predicted energy:     -16.777014095816
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77701409581524 0.00000000000 0.00000005417 1.1192  0.104    8.00000000
      ideal mu1:      -0.511277026038
             Q0:     -16.777014095816
             G0:      -0.000000000000
   RMS gradient:       0.000000035622
     Trial step:       0.906575417801
             Q1:     -16.777014095816
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777014095816
Quadratic minimum step length (  0.067668479860) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77701409581573 0.00000000000 0.00000002672 0.0677  0.243    8.00000000
      ideal mu1:      -0.511277027423
10    -16.77701409581549 0.00000000000 0.00000002441 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00011479082995              |
           | Maximum change in energy =  0.00020882085425 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.43502604E-02     0.15264363E-02
               2       0.11667645E-04     0.41952795E-05
               3       0.97715141E-10     0.39022799E-10
               4       0.70158828E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13233640E-02     0.45068283E-03
               2       0.10911004E-05     0.38212566E-06
               3       0.84185286E-12     0.32848724E-12
================================================================================
RMS gradient                =       0.00011479082995
Trial step length           =               0.330429
Gradient along search dir.  =         -0.00023284004
Functional at step 0        =     -16.77701409581549
Functional at step 1        =     -16.77703744559490
Functional predicted        =     -16.77704171108585
Selected quadratic step     =               0.237204
Conjugate gradients coeff.  =               0.180875
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99882101
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000129 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512306046692
             Q0:     -16.777041565626
             G0:      -0.000001877583
   RMS gradient:       0.000228374849
     Trial step:       0.247682418434
             Q1:     -16.777041878220
 Quadratic coef:       0.000000152450
 Linear coef   :      -0.000000465044
           Qmin:     -16.777041920276
Quadratic minimum step length (  0.377773667028) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77704156562582 0.00000000000 0.00017128111 0.3778  0.000    8.00000000
      ideal mu1:      -0.512068180680
             Q0:     -16.777041920290
             G0:      -0.000000008067
   RMS gradient:       0.000014968631
     Trial step:       0.305888697846
             Q1:     -16.777041922158
 Quadratic coef:       0.000000000600
 Linear coef   :      -0.000000002468
           Qmin:     -16.777041922827
Quadratic minimum step length (  0.628996792674) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77704192029022 0.00000004433 0.00001122647 0.6290  0.004    8.00000000
      ideal mu1:      -0.512061357862
             Q0:     -16.777041922826
             G0:      -0.000000000348
   RMS gradient:       0.000003108964
     Trial step:       0.438637674921
             Q1:     -16.777041922945
 Quadratic coef:       0.000000000034
 Linear coef   :      -0.000000000153
           Qmin:     -16.777041922996
Quadratic minimum step length (  0.977579426656) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77704192282624 0.00000000032 0.00000233172 0.9776  0.043    8.00000000
      ideal mu1:      -0.512062785468
             Q0:     -16.777041922996
             G0:      -0.000000000024
   RMS gradient:       0.000000812868
     Trial step:       0.654830639753
             Q1:     -16.777041923004
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000016
           Qmin:     -16.777041923004
Quadratic minimum step length (  0.671092859487) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77704192299566 0.00000000002 0.00000060965 0.6711  0.068    8.00000000
      ideal mu1:      -0.512062830212
             Q0:     -16.777041923004
             G0:      -0.000000000006
   RMS gradient:       0.000000414014
     Trial step:       0.662911884425
             Q1:     -16.777041923006
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777041923006
Quadratic minimum step length (  0.681524374486) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77704192300356 0.00000000000 0.00000031051 0.6815  0.259    8.00000000
      ideal mu1:      -0.512062787765
             Q0:     -16.777041923006
             G0:      -0.000000000000
   RMS gradient:       0.000000076140
     Trial step:       0.672153708144
             Q1:     -16.777041923006
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777041923006
Quadratic minimum step length (  0.479943596844) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77704192300586 0.00000000000 0.00000005710 0.4799  0.034    8.00000000
      ideal mu1:      -0.512062777404
             Q0:     -16.777041923006
             G0:      -0.000000000000
   RMS gradient:       0.000000038784
     Trial step:       0.567975235656
             Q1:     -16.777041923006
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777041923006
Quadratic minimum step length (  0.058537061922) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77704192300608 0.00000000000 0.00000002909 0.0585  0.000    8.00000000
      ideal mu1:      -0.512062777175
             Q0:     -16.777041923006
             G0:      -0.000000000000
   RMS gradient:       0.000000036443
     Trial step:       0.182339248490
             Q1:     -16.777041923006
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777041923006
  Cubic LS coeff:       0.372475429013
Predicted energy:     -16.777041923006
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77704192300577 0.00000000000 0.00000002733 0.3725  0.883    8.00000000
      ideal mu1:      -0.512062774396
             Q0:     -16.777041923006
             G0:      -0.000000000000
   RMS gradient:       0.000000015092
     Trial step:       0.260608690966
             Q1:     -16.777041923006
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777041923006
Quadratic minimum step length (  0.001707525682) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77704192300615 0.00000000000 0.00000001132 0.0017  0.171    8.00000000
      ideal mu1:      -0.512062774386
10    -16.77704192300600 0.00000000000 0.00000001129 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00004032373439              |
           | Maximum change in energy =  0.00007105684203 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.290063E-04
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20009701E-02     0.77253523E-03
               2       0.22003670E-05     0.94593200E-06
               3       0.36130839E-11     0.16593393E-11
               4       0.85153821E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.82065295E-03     0.32033168E-03
               2       0.35974564E-06     0.16020654E-06
               3       0.97057022E-13     0.45741189E-13
================================================================================
RMS gradient                =       0.00004032373439
Trial step length           =               0.279962
Gradient along search dir.  =         -0.00002878514
Functional at step 0        =     -16.77704192300600
Functional at step 1        =     -16.77704293355240
Functional predicted        =     -16.77704422655363
Selected quadratic step     =               0.160051
Conjugate gradients coeff.  =              -0.123398
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00057412
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000065 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511614334539
             Q0:     -16.777044187386
             G0:      -0.000000822882
   RMS gradient:       0.000151188044
     Trial step:       0.021094929077
             Q1:     -16.777044204268
 Quadratic coef:       0.000000000477
 Linear coef   :      -0.000000017359
           Qmin:     -16.777044345424
Quadratic minimum step length (  0.384108914476) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77704418738591 0.00000000000 0.00011339103 0.3841  0.000    8.00000000
      ideal mu1:      -0.511780340195
             Q0:     -16.777044345584
             G0:      -0.000000009096
   RMS gradient:       0.000015887974
     Trial step:       0.090015278196
             Q1:     -16.777044346337
 Quadratic coef:       0.000000000065
 Linear coef   :      -0.000000000819
           Qmin:     -16.777044348155
Quadratic minimum step length (  0.565288657819) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77704434558376 0.00000001975 0.00001191598 0.5653  0.011    8.00000000
      ideal mu1:      -0.511786493731
             Q0:     -16.777044348148
             G0:      -0.000000000071
   RMS gradient:       0.000001402837
     Trial step:       0.225576186232
             Q1:     -16.777044348163
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000016
           Qmin:     -16.777044348188
Quadratic minimum step length (  1.119576660711) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77704434814825 0.00000000033 0.00000105213 1.1196  0.008    8.00000000
      ideal mu1:      -0.511786095454
             Q0:     -16.777044348186
             G0:      -0.000000000004
   RMS gradient:       0.000000327180
     Trial step:       0.502543364614
             Q1:     -16.777044348188
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.777044348188
Quadratic minimum step length (  1.048284704306) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77704434818627 0.00000000000 0.00000024539 1.0483  0.054    8.00000000
      ideal mu1:      -0.511786439161
             Q0:     -16.777044348187
             G0:      -0.000000000002
   RMS gradient:       0.000000286460
     Trial step:       0.725815763383
             Q1:     -16.777044348188
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777044348188
Quadratic minimum step length (  0.600600292435) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77704434818743 0.00000000000 0.00000021484 0.6006  0.767    8.00000000
      ideal mu1:      -0.511786281608
             Q0:     -16.777044348188
             G0:      -0.000000000001
   RMS gradient:       0.000000136346
     Trial step:       0.660246287185
             Q1:     -16.777044348188
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044348188
Quadratic minimum step length (  1.877487833240) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77704434818786 0.00000000000 0.00000010226 1.8775  0.227    8.00000000
      ideal mu1:      -0.511786012041
             Q0:     -16.777044348187
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.747E+01) too large - resetting
             G0:      -0.000000000005
   RMS gradient:       0.000000372676
     Trial step:       1.113375215788
             Q1:     -16.777044348185
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000006
           Qmin:     -16.777044348188
Quadratic minimum step length (  0.429908930356) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77704434818703 0.00000000000 0.00000027951 0.4299  0.000    8.00000000
      ideal mu1:      -0.511786252680
             Q0:     -16.777044348188
             G0:      -0.000000000000
   RMS gradient:       0.000000057908
     Trial step:       0.691845320939
             Q1:     -16.777044348188
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044348188
Quadratic minimum step length (  0.654718683873) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77704434818812 0.00000000000 0.00000004343 0.6547  0.024    8.00000000
      ideal mu1:      -0.511786231990
             Q0:     -16.777044348188
             G0:      -0.000000000000
   RMS gradient:       0.000000020096
     Trial step:       0.673026045535
             Q1:     -16.777044348188
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044348188
Quadratic minimum step length (  0.944593183909) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77704434818840 0.00000000000 0.00000001507 0.9446  0.120    8.00000000
      ideal mu1:      -0.511786254355
10    -16.77704434818845 0.00000000000 0.00000001152 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002354546551              |
           | Maximum change in energy =  0.00000927573017 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.24200552E-02     0.89837818E-03
               2       0.34540391E-05     0.13312554E-05
               3       0.86842926E-11     0.36398662E-11
               4       0.93064230E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22175211E-02     0.82121928E-03
               2       0.29052946E-05     0.11140528E-05
               3       0.61337141E-11     0.25599523E-11
               4       0.61568875E-15     0.22204460E-15
================================================================================
RMS gradient                =       0.00002354546551
Trial step length           =               0.211680
Gradient along search dir.  =         -0.00000929302
Functional at step 0        =     -16.77704434818845
Functional at step 1        =     -16.77703524948653
Functional predicted        =     -16.77704443561191
Selected quadratic step     =               0.018815
Conjugate gradients coeff.  =              -0.340952
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99991007
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511864874023
             Q0:     -16.777044434809
             G0:      -0.000000024250
   RMS gradient:       0.000025954263
     Trial step:       0.797330430377
             Q1:     -16.777044434110
 Quadratic coef:       0.000000020035
 Linear coef   :      -0.000000019336
           Qmin:     -16.777044439474
Quadratic minimum step length (  0.384745647170) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77704443480913 0.00000000000 0.00001946570 0.3847  0.000    8.00000000
      ideal mu1:      -0.511836293398
             Q0:     -16.777044439474
             G0:      -0.000000000271
   RMS gradient:       0.000002742876
     Trial step:       0.553867684961
             Q1:     -16.777044439551
 Quadratic coef:       0.000000000074
 Linear coef   :      -0.000000000150
           Qmin:     -16.777044439551
Quadratic minimum step length (  0.564681843357) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77704443947434 0.00000000058 0.00000205716 0.5647  0.011    8.00000000
      ideal mu1:      -0.511835226554
             Q0:     -16.777044439551
             G0:      -0.000000000003
   RMS gradient:       0.000000274777
     Trial step:       0.559248625675
             Q1:     -16.777044439552
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777044439552
Quadratic minimum step length (  0.644967804550) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77704443955122 0.00000000001 0.00000020608 0.6450  0.010    8.00000000
      ideal mu1:      -0.511835219103
             Q0:     -16.777044439552
             G0:      -0.000000000001
   RMS gradient:       0.000000116959
     Trial step:       0.600580850760
             Q1:     -16.777044439553
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044439553
Quadratic minimum step length (  2.720247073988) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77704443955218 0.00000000000 0.00000008772 2.7202  0.181    8.00000000
      ideal mu1:      -0.511835214798
             Q0:     -16.777044439551
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.638E+01) too large - resetting
             G0:      -0.000000000003
   RMS gradient:       0.000000295480
     Trial step:       1.278173815243
             Q1:     -16.777044439552
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000004
           Qmin:     -16.777044439552
Quadratic minimum step length (  1.017865778096) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77704443955069 0.00000000000 0.00000022161 1.0179  0.000    8.00000000
      ideal mu1:      -0.511835207154
             Q0:     -16.777044439552
             G0:      -0.000000000000
   RMS gradient:       0.000000114490
     Trial step:       1.140617983811
             Q1:     -16.777044439552
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777044439553
Quadratic minimum step length (  0.469039168116) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77704443955244 0.00000000000 0.00000008587 0.4690  0.150    8.00000000
      ideal mu1:      -0.511835186989
             Q0:     -16.777044439552
             G0:      -0.000000000000
   RMS gradient:       0.000000037111
     Trial step:       0.731433189201
             Q1:     -16.777044439553
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044439552
  Cubic LS coeff:       0.948508722808
Predicted energy:     -16.777044439553
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77704443955229 0.00000000000 0.00000002783 0.9485  0.105    8.00000000
      ideal mu1:      -0.511835236058
             Q0:     -16.777044439553
             G0:      -0.000000000000
   RMS gradient:       0.000000031659
     Trial step:       0.832929024652
             Q1:     -16.777044439553
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044439552
  Cubic LS coeff:       0.846403942815
Predicted energy:     -16.777044439553
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77704443955255 0.00000000000 0.00000002374 0.8464  0.728    8.00000000
      ideal mu1:      -0.511835236859
             Q0:     -16.777044439553
             G0:      -0.000000000000
   RMS gradient:       0.000000028861
     Trial step:       0.839639452712
             Q1:     -16.777044439553
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044439553
Quadratic minimum step length (  2.497630144597) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77704443955255 0.00000000000 0.00000002165 2.4976  0.831    8.00000000
      ideal mu1:      -0.511835126779
10    -16.77704443955241 0.00000000000 0.00000007517 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000582427482              |
           | Maximum change in energy =  0.00000080839415 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88275607974884 |
           | Pseudopotential (local)    :      -46.11476145049696 |
           | Pseudopotential (non-local):       -3.19245652176999 |
           | Hartree                    :       19.84277550799275 |
           | Exchange-correlation       :       -4.13120730299788 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77704443955241 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11476145049729 |
           | Hartree                    :       19.84277550799300 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999618
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56223643E-03     0.21139000E-03
               2       0.18411830E-06     0.72917226E-07
               3       0.24861444E-13     0.10769163E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54526817E-03     0.20496680E-03
               2       0.17319111E-06     0.68557937E-07
               3       0.22096759E-13     0.96589403E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.55242613E-07     0.20888783E-07
               2       0.19073707E-14     0.10116148E-14
================================================================================
RMS gradient                =       0.00000582427482
Trial step length           =               0.063109
Gradient along search dir.  =         -0.00000062601
Functional at step 0        =     -16.77704443955241
Functional at step 1        =     -16.77704383042444
Rejected quadratic step     =               0.001922
Functional at new step 1    =     -16.77704444015593
Functional predicted        =     -16.77704444015594
Selected quadratic step     =               0.001928
Conjugate gradients coeff.  =               0.061188
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999257
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511841684992
             Q0:     -16.777044440150
             G0:      -0.000000000161
   RMS gradient:       0.000002116427
     Trial step:       1.448139774914
             Q1:     -16.777044439941
 Quadratic coef:       0.000000000443
 Linear coef   :      -0.000000000234
           Qmin:     -16.777044440181
Quadratic minimum step length (  0.382080111479) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77704444014992 0.00000000000 0.00000158732 0.3821  0.000    8.00000000
      ideal mu1:      -0.511839385304
             Q0:     -16.777044440181
             G0:      -0.000000000001
   RMS gradient:       0.000000198410
     Trial step:       0.743845015199
             Q1:     -16.777044440181
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777044440182
Quadratic minimum step length (  1.451355706528) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77704444018052 0.00000000000 0.00000014881 1.4514  0.009    8.00000000
      ideal mu1:      -0.511839173077
             Q0:     -16.777044440180
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000003
   RMS gradient:       0.000000308051
     Trial step:       1.039030176453
             Q1:     -16.777044440180
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000004
           Qmin:     -16.777044440181
Quadratic minimum step length (  0.559328168713) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77704444018009 0.00000000000 0.00000023104 0.5593  2.411    8.00000000
      ideal mu1:      -0.511839254104
             Q0:     -16.777044440181
             G0:      -0.000000000000
   RMS gradient:       0.000000043539
     Trial step:       0.762337750497
             Q1:     -16.777044440181
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440181
  Cubic LS coeff:       2.366718462428
Predicted energy:     -16.777044440181
WARNING in lnv_denskernel_optimise_cg: setting cubic step to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77704444018087 0.00000000000 0.00000003265 0.1500  0.020    8.00000000
      ideal mu1:      -0.511839272486
             Q0:     -16.777044440181
             G0:      -0.000000000000
   RMS gradient:       0.000000026970
     Trial step:       0.338157748062
             Q1:     -16.777044440181
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440181
  Cubic LS coeff:       0.417486526300
Predicted energy:     -16.777044440181
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77704444018100 0.00000000000 0.00000002023 0.4175  0.384    8.00000000
      ideal mu1:      -0.511839322496
             Q0:     -16.777044440181
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000020894
     Trial step:       0.375734352409
             Q1:     -16.777044440181
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044440181
Quadratic minimum step length (  0.005782654340) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77704444018108 0.00000000000 0.00000001567 0.0058  0.600    8.00000000
      ideal mu1:      -0.511839322169
             Q0:     -16.777044440181
             G0:      -0.000000000000
   RMS gradient:       0.000000020574
     Trial step:       0.046612679429
             Q1:     -16.777044440181
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440181
  Cubic LS coeff:       0.056469108259
Predicted energy:     -16.777044440181
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77704444018098 0.00000000000 0.00000001543 0.0565  0.000    8.00000000
      ideal mu1:      -0.511839319024
             Q0:     -16.777044440181
             G0:      -0.000000000000
   RMS gradient:       0.000000017502
     Trial step:       0.051304740920
             Q1:     -16.777044440181
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440181
  Cubic LS coeff:       0.060747384018
Predicted energy:     -16.777044440181
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77704444018092 0.00000000000 0.00000001313 0.0607  0.724    8.00000000
      ideal mu1:      -0.511839313698
             Q0:     -16.777044440181
             G0:      -0.000000000000
   RMS gradient:       0.000000012318
     Trial step:       0.055826774926
             Q1:     -16.777044440181
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044440181
Quadratic minimum step length (  0.000088921613) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77704444018097 0.00000000000 0.00000000924 0.0001  0.495    8.00000000
      ideal mu1:      -0.511839313691
10    -16.77704444018110 0.00000000000 0.00000000923 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000268800074              |
           | Maximum change in energy =  0.00000003045465 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.133166E-06
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.88830062E-04     0.33628743E-04
               2       0.45571936E-08     0.18338544E-08
               3       0.82846271E-15     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.85089031E-04     0.32213937E-04
               2       0.41812849E-08     0.16827568E-08
               3       0.75339590E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.80359923E-08     0.30395150E-08
               2       0.58478924E-15     0.22204460E-15
================================================================================
RMS gradient                =       0.00000268800074
Trial step length           =               0.011031
Gradient along search dir.  =         -0.00000012791
Functional at step 0        =     -16.77704444018110
Functional at step 1        =     -16.77704442480803
Rejected quadratic step     =               0.000464
Functional at new step 1    =     -16.77704444021082
Functional predicted        =     -16.77704444021082
Selected quadratic step     =               0.000465
Conjugate gradients coeff.  =              -0.212998
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000165
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511837855274
             Q0:     -16.777044440210
             G0:      -0.000000000008
   RMS gradient:       0.000000468692
     Trial step:       0.002228050019
             Q1:     -16.777044440211
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.003777067344
Predicted energy:     -16.777044440211
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77704444021033 0.00000000000 0.00000035152 0.0038  0.000    8.00000000
      ideal mu1:      -0.511837860345
             Q0:     -16.777044440210
             G0:      -0.000000000015
   RMS gradient:       0.000000464099
     Trial step:       0.002900947254
             Q1:     -16.777044440211
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.004476832498
Predicted energy:     -16.777044440211
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77704444021045 0.00000000000 0.00000034807 0.0045  0.980    8.00000000
      ideal mu1:      -0.511837872192
             Q0:     -16.777044440211
             G0:      -0.000000000022
   RMS gradient:       0.000000453371
     Trial step:       0.003603755672
             Q1:     -16.777044440211
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.004783637797
Predicted energy:     -16.777044440211
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77704444021068 0.00000000000 0.00000034003 0.0048  0.954    8.00000000
      ideal mu1:      -0.511837890487
             Q0:     -16.777044440211
             G0:      -0.000000000026
   RMS gradient:       0.000000436814
     Trial step:       0.004151994923
             Q1:     -16.777044440211
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044440211
Quadratic minimum step length (  0.001453165726) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77704444021092 0.00000000000 0.00000032761 0.0015  0.928    8.00000000
      ideal mu1:      -0.511837897467
             Q0:     -16.777044440211
             G0:      -0.000000000032
   RMS gradient:       0.000000430503
     Trial step:       0.002456325857
             Q1:     -16.777044440211
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.009898387905
Predicted energy:     -16.777044440211
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77704444021066 0.00000000000 0.00000032288 0.0099  0.971    8.00000000
      ideal mu1:      -0.511837955865
             Q0:     -16.777044440211
             G0:      -0.000000000027
   RMS gradient:       0.000000377761
     Trial step:       0.004930888983
             Q1:     -16.777044440211
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.006949261006
Predicted energy:     -16.777044440211
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77704444021088 0.00000000000 0.00000028332 0.0069  0.770    8.00000000
      ideal mu1:      -0.511837994977
             Q0:     -16.777044440211
             G0:      -0.000000000004
   RMS gradient:       0.000000342536
     Trial step:       0.005853719718
             Q1:     -16.777044440212
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.007626004379
Predicted energy:     -16.777044440212
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77704444021117 0.00000000000 0.00000025690 0.0076  0.000    8.00000000
      ideal mu1:      -0.511838002491
             Q0:     -16.777044440211
             G0:      -0.000000000008
   RMS gradient:       0.000000335818
     Trial step:       0.006681354070
             Q1:     -16.777044440211
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777044440211
Quadratic minimum step length (  0.002104688433) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77704444021133 0.00000000000 0.00000025186 0.0021  0.961    8.00000000
      ideal mu1:      -0.511838006518
             Q0:     -16.777044440211
             G0:      -0.000000000012
   RMS gradient:       0.000000332220
     Trial step:       0.003749955816
             Q1:     -16.777044440211
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777044440211
  Cubic LS coeff:       0.008961664488
Predicted energy:     -16.777044440211
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77704444021108 0.00000000000 0.00000024916 0.0090  0.979    8.00000000
      ideal mu1:      -0.511838031868
10    -16.77704444021110 0.00000000000 0.00000023219 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000154636960              |
           | Maximum change in energy =  0.00000000020957 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88273777033785 |
           | Pseudopotential (local)    :      -46.11472916987928 |
           | Pseudopotential (non-local):       -3.19245056594300 |
           | Hartree                    :       19.84275084253131 |
           | Exchange-correlation       :       -4.13120256522881 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77704444021109 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11472916987961 |
           | Hartree                    :       19.84275084253148 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999643
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01078033059859    -16.46991321199869   0.244869    -16.72180572730415
   2     0.00300151743611    -16.72809775080519   0.404176    -16.76113783816096
   3     0.00160563147378    -16.76293233549538   0.398594    -16.77252465425625
   4     0.00092359315227    -16.77298866190183   0.394882    -16.77611700228589
   5     0.00048233186171    -16.77617446272665   0.304012    -16.77680049799257
   6     0.00026990898489    -16.77680092528939   0.330911    -16.77701443055711
   7     0.00011479082995    -16.77701409581549   0.237204    -16.77704171108585
   8     0.00004032373439    -16.77704192300600   0.160051    -16.77704422655363
   9     0.00002354546551    -16.77704434818845   0.018815    -16.77704443561191
  10     0.00000582427482    -16.77704443955241   0.001928    -16.77704444015594
  11     0.00000268800074    -16.77704444018110   0.000465    -16.77704444021082
  12     0.00000154636960    -16.77704444021110  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.302121813 Eh
                 Mid-gap level:      -0.105716619 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.965802154   1.0000000
                            2    -0.468910674   1.0000000
                            3    -0.355861773   1.0000000
                            4    -0.256777526   1.0000000
                        .......   --- gap ---   .........
                            5     0.045344288   0.0000000
                            6     0.143912881   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49605426  -0.08652972  -0.08347398 *
*    H       2     -1.16881553   0.92202846  -1.13156258 *
*    H       3     -1.12864476  -0.78710442   1.26739120 *
*                                                        *
**********************************************************
TOTAL:             -0.80140603   0.04839433   0.05235465
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77515105  -0.04378280  -0.02418282 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77515105  -0.04378280  -0.02418282
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00329479  -0.00035893  -0.00205956 *
*    H       2     -0.00006711   0.00038809  -0.00047078 *
*    H       3     -0.00002028  -0.00040381   0.00033644 *
*                                                        *
**********************************************************
TOTAL:              0.00320741  -0.00037466  -0.00219390
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00768252   0.00141229   0.00865931 *
*    H       2     -0.00768252   0.00141229   0.00865931 *
*    H       3     -0.00768252   0.00141229   0.00865931 *
*                                                        *
**********************************************************
TOTAL:             -0.02304757   0.00423687   0.02597792

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01856673   0.00084695   0.01613035 *
*    H       2      0.00815951  -0.00969827  -0.00053457 *
*    H       3      0.01040722   0.00885132  -0.01559578 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000  -0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1345.172s on      3 node(s)                                    
TOTAL TIME:      1345.172s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    48        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    25        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    14        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.000%  ------ ||
|| integrals_brappd_ketppd              :    25        0.01s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    11        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    25        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    12        0.01s   0.001%  ------ ||
|| basis_dot_function_with_box          :  1927        0.04s   0.003%  ------ ||
|| lnv_gradient_norm                    :   120        0.08s   0.006%  ------ ||
|| basis_add_function_to_box            :  3828        0.08s   0.006%  ------ ||
|| integrals_grad                       :     1        0.08s   0.006%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.08s   0.006%  ------ ||
|| kernel_fix                           :   120        0.09s   0.006%  ------ ||
|| kernel_purify                        :   391        0.10s   0.008%  ------ ||
|| sparse_trace                         :  3341        0.18s   0.013%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.18s   0.014%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.19s   0.014%  ------ ||
|| pseudo_make_structure_factor         :     1        0.19s   0.014%  ------ ||
|| sparse_product                       :  4234        0.19s   0.014%  ------ ||
|| density_initial_guess_real           :     1        0.22s   0.016%  ------ ||
|| basis_copy_function_to_box           :   878        0.48s   0.036%  ------ ||
|| density_batch_row_sums               :   271        0.54s   0.040%  ------ ||
|| fourier_apply_box_pair               :    82        0.58s   0.043%   9.555 ||
|| pseudopotentials_local_on_grid       :     1        0.71s   0.052%  ------ ||
|| integrals_kinetic                    :    25        0.83s   0.062%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.93s   0.069%  ------ ||
|| projectors_func_ovlp_box             :    25        1.31s   0.097%  ------ ||
|| projectors_init_fftbox_recip         :    40        1.34s   0.100%  ------ ||
|| projectors_gradient_batch            :    12        1.41s   0.104%  ------ ||
|| forces_calculate                     :     1        1.46s   0.109%  ------ ||
|| integrals_locpot_mat_els_batch       :   131        4.07s   0.303%  ------ ||
|| properties_calculate                 :     1        4.94s   0.367%  ------ ||
|| ngwf_gradient_batch                  :    12        8.73s   0.649%  ------ ||
|| ngwf_gradient_lnv                    :    12        9.51s   0.707%  ------ ||
|| cell_grid_extract_box                :   596       11.06s   0.822%  ------ ||
|| hamiltonian_energy_components        :     3       16.92s   1.258%  ------ ||
|| cell_grid_deposit_box                :  1085       33.80s   2.513%  ------ ||
|| density_fftbox_deposit_to_cell       :  1084       33.81s   2.513%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       34.07s   2.533%  ------ ||
|| density_fftbox_interpolate_multiply  :  1084       36.38s   2.704%  ------ ||
|| fourier_apply_box                    :  2024       36.72s   2.730%  18.052 ||
|| potential_apply_to_ngwf_batch        :   131       38.89s   2.891%  ------ ||
|| integrals_locpot_dbl_grid            :   131       43.03s   3.199%  ------ ||
|| density_batch_interp_deposit         :   271       74.28s   5.522%  ------ ||
|| density_on_dbl_grid                  :   271       83.91s   6.238%  ------ ||
|| hartree_on_grid                      :   271      203.94s  15.161%  ------ ||
|| fourier_apply_cell_backward          :  1356      464.76s  34.550%   3.255 ||
|| fourier_apply_cell_forward           :  1356      506.70s  37.668%   2.986 ||
|| xc_energy_potential                  :   271      944.16s  70.189%  ------ ||
|| lnv_denskernel_optimise_cg           :    12     1207.84s  89.791%  ------ ||
|| ngwf_cg_optimise                     :     1     1298.65s  96.542%  ------ ||
|| total_time                           :     1     1345.17s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 21:38 (-0000)

