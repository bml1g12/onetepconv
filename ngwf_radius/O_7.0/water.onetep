 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 22:45 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on     3 processors.
There are   3 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 7.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         6         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   63 x  63 x  63
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):     44    44    44
         Recip-space ('23') slabs/node (min max mean):     22    23    22
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):     88    88    88
         Recip-space ('23') slabs/node (min max mean):     44    45    44
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      4;  min      1;  average      2
... Projector load balancing: max      3;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1844     11316
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  50.00%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  743    0.0094339623    7.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   29    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1   -3.2842563282   -7.1215041978   10.1554501656   -2.4512393156
  2  -12.6801918524   -3.1675723094   13.3437283838   -3.1730575523
  3  -14.4956094241   -3.0277990632   13.4941625387   -3.2141387871
  4  -15.1296270306   -3.0384303370   13.4832924724   -3.2150418304
  5  -15.3987486283   -3.0320409727   13.4903722500   -3.2181800563
  6  -15.5036963150   -3.0315766932   13.4909608285   -3.2189555787
  7  -15.5461579483   -3.0311146108   13.4914930156   -3.2193449106
  8  -15.5630649729   -3.0310117025   13.4916180558   -3.2194842232
  9  -15.5698453973   -3.0309686087   13.4916701909   -3.2195419006
 10  -15.5725564367   -3.0309564082   13.4916856632   -3.2195643232
 11  -15.5736419816   -3.0309524181   13.4916909084   -3.2195733180
 12  -15.5740764288   -3.0309513389   13.4916924573   -3.2195768904
 13  -15.5742503607   -3.0309510720   13.4916929025   -3.2195783211
 14  -15.5743199929   -3.0309510335   13.4916930083   -3.2195788943
 15  -15.5743478734   -3.0309510432   13.4916930243   -3.2195791249
 16  -15.5743590375   -3.0309510568   13.4916930204   -3.2195792178
 17  -15.5743635084   -3.0309510659   13.4916930150   -3.2195792554
 18  -15.5743652989   -3.0309510710   13.4916930113   -3.2195792706
 19  -15.5743660161   -3.0309510735   13.4916930093   -3.2195792768
 20  -15.5743663034   -3.0309510748   13.4916930083   -3.2195792793
 21  -15.5743664185   -3.0309510754   13.4916930078   -3.2195792803
 22  -15.5743664646   -3.0309510756   13.4916930075   -3.2195792807
Atom SCF converged after  22 iterations to a total energy of    -15.57436646

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20307197E+01     0.84971293E+00
               2       0.18154734E+01     0.72654903E+00
               3       0.15661830E+01     0.56669420E+00
               4       0.13250721E+01     0.48999288E+00
               5       0.11221671E+01     0.42228442E+00
               6       0.88041566E+00     0.33157508E+00
               7       0.54826017E+00     0.20588467E+00
               8       0.21290741E+00     0.79436036E-01
               9       0.32267251E-01     0.11854783E-01
              10       0.75522179E-03     0.29589775E-03
              11       0.43974267E-06     0.18919849E-06
              12       0.16938318E-12     0.77382545E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.72746454573673    0.5868193
               2          -1.80436230564154    0.5763978
               3          -1.90321946213582    0.5601050
               4          -2.01857532543797    0.5387858
               5          -2.12926789054579    0.5186950
               6          -2.20250770694183    0.5064245
               7          -2.22842396774675    0.5008151
               8          -2.23180699437871    0.5000066
               9          -2.23187538599379    0.5000004
              10          -2.23187541625119    0.8926102
              11          -2.23187541625119    0.8926102
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    0.99999999999995]
Closest occupancy to 0.5:     0.99999999999999
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.455140405291=    -16.455140405291+      0.000000000000
    Trial step:       1.000000000000
            G0:      -3.923743826797
WARNING: minimum value of charge density: -0.0824
      Q1=E1+P1:      54.935582419168=    -20.293676066918+     75.229258486086
Quadratic term:     -75.314466651256
   Linear term:      -3.923743826797
  Optimal step:       0.026049071322
 Predicted min:     -16.506245346688
    !!! Quadratic minimum step length accepted !!!
 1    -16.45514040529059 0.33014070345 0.03512217353 0.0260  0.000    8.00000000
      Q0=E0+P0:     -16.546168060251=    -16.557260159332+      0.011092099081
    Trial step:       0.161397246948
            G0:      -0.023849229623
      Q1=E1+P1:     -16.549891469534=    -16.561159318045+      0.011267848511
Quadratic term:      -0.000125790720
   Linear term:      -0.003849200003
  Optimal step:       2.469380428291
 Predicted min:     -16.575614470681
    !!! Quadratic minimum step length accepted !!!
 2    -16.55726015933243 0.25604147228 0.03636697551 2.4694 -0.769    8.00000000
      Q0=E0+P0:     -16.571101565127=    -16.598707222067+      0.027605656940
    Trial step:       0.631309118256
            G0:      -2.234679020321
WARNING: minimum value of charge density: -0.0007
      Q1=E1+P1:      -7.087430719287=    -18.414237347603+     11.326806628315
Quadratic term:     -10.894444087743
   Linear term:      -1.410773241903
  Optimal step:       0.040875606145
 Predicted min:     -16.616773494875
    !!! Quadratic minimum step length accepted !!!
 3    -16.59870722206727 0.25021332018 0.03068071763 0.0409  3.153    8.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.719729232881
   Final penalty energy   :       0.076905639918
   RMS occupancy error    :       0.056607
   Occupancy bounds       : [-0.070, 1.078]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.056607 (step -0.4136 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002018 (step -0.4995 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.550400146470
             Q0:     -16.464498686356
             G0:      -0.053320253634
   RMS gradient:       0.038485297927
     Trial step:       0.500000000000
             Q1:     -16.469738889606
 Quadratic coef:       0.021419923566
 Linear coef   :      -0.026660126817
           Qmin:     -16.472794261731
Quadratic minimum step length (  0.311160386897) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001087 (step -0.4978 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.46449868635564 0.00000000000 0.02886397341 0.3112  0.000    8.00000000
      ideal mu1:      -0.514653300174
             Q0:     -16.472791989821
             G0:      -0.000388013528
   RMS gradient:       0.003276519457
     Trial step:       0.394436551867
             Q1:     -16.472901665474
 Quadratic coef:       0.000043371065
 Linear coef   :      -0.000153046718
           Qmin:     -16.472927006668
Quadratic minimum step length (  0.695938867433) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000070 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.47279198982086 0.00103694692 0.00245738959 0.6959  0.007    8.00000000
      ideal mu1:      -0.513869410290
             Q0:     -16.472927066941
             G0:      -0.000046614953
   RMS gradient:       0.001137586444
     Trial step:       0.523931032847
             Q1:     -16.472941305911
 Quadratic coef:       0.000010184050
 Linear coef   :      -0.000024423020
           Qmin:     -16.472941709542
Quadratic minimum step length (  0.628236227235) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.47292706694106 0.00001706562 0.00085318983 0.6282  0.121    8.00000000
      ideal mu1:      -0.514872029669
             Q0:     -16.472941708237
             G0:      -0.000001135180
   RMS gradient:       0.000177660516
     Trial step:       0.573718097507
             Q1:     -16.472941798894
 Quadratic coef:       0.000000560616
 Linear coef   :      -0.000000651273
           Qmin:     -16.472941897385
Quadratic minimum step length (  0.333246793279) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.47294170823741 0.00000205525 0.00013324539 0.3332  0.024    8.00000000
      ideal mu1:      -0.514726110004
             Q0:     -16.472941897379
             G0:      -0.000000044343
   RMS gradient:       0.000035096457
     Trial step:       0.437252462818
             Q1:     -16.472941912670
 Quadratic coef:       0.000000004098
 Linear coef   :      -0.000000019389
           Qmin:     -16.472941920313
Quadratic minimum step length (  1.034345871727) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.47294189737947 0.00000002427 0.00002632234 1.0343  0.039    8.00000000
      ideal mu1:      -0.514726542919
             Q0:     -16.472941920313
             G0:      -0.000000003516
   RMS gradient:       0.000009882845
     Trial step:       0.672510431011
             Q1:     -16.472941921073
 Quadratic coef:       0.000000001604
 Linear coef   :      -0.000000002365
           Qmin:     -16.472941921184
Quadratic minimum step length (  0.495573220271) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.47294192031286 0.00000000298 0.00000741213 0.4956  0.079    8.00000000
      ideal mu1:      -0.514729688474
             Q0:     -16.472941921184
             G0:      -0.000000000348
   RMS gradient:       0.000003108367
     Trial step:       0.577302485671
             Q1:     -16.472941921250
 Quadratic coef:       0.000000000134
 Linear coef   :      -0.000000000201
           Qmin:     -16.472941921259
Quadratic minimum step length (  0.431211105293) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.47294192118402 0.00000000012 0.00000233128 0.4312  0.000    8.00000000
      ideal mu1:      -0.514728367586
             Q0:     -16.472941921259
             G0:      -0.000000000032
   RMS gradient:       0.000000948413
     Trial step:       0.498938115335
             Q1:     -16.472941921268
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000016
           Qmin:     -16.472941921268
Quadratic minimum step length (  0.551580804367) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.47294192125898 0.00000000001 0.00000071131 0.5516  0.093    8.00000000
      ideal mu1:      -0.514728969564
             Q0:     -16.472941921268
             G0:      -0.000000000003
   RMS gradient:       0.000000271398
     Trial step:       0.524599549167
             Q1:     -16.472941921269
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.472941921269
Quadratic minimum step length (  1.021295313562) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.47294192126766 0.00000000000 0.00000020355 1.0213  0.082    8.00000000
      ideal mu1:      -0.514728587928
10    -16.47294192126821 0.00000000000 0.00000023473 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01011927468245              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21923814E-01     0.14236368E-01
               2       0.27904964E-03     0.19404655E-03
               3       0.48770123E-07     0.36219150E-07
               4       0.18447175E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28320002E-01     0.17774856E-01
               2       0.46052535E-03     0.30083041E-03
               3       0.12982088E-06     0.86113871E-07
               4       0.10740387E-13     0.73274720E-14
================================================================================
RMS gradient                =       0.01011927468245
Trial step length           =               0.122474
Gradient along search dir.  =         -2.10974143320
Functional at step 0        =     -16.47294192126821
Functional at step 1        =     -16.66709601984886
Functional predicted        =     -16.73278747458063
Selected quadratic step     =               0.246329
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.12001518
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010203 (step -0.4829 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000068 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.525144486608
             Q0:     -16.732651343136
             G0:      -0.023896551268
   RMS gradient:       0.025764182323
     Trial step:       0.731963838629
             Q1:     -16.736216949998
 Quadratic coef:       0.013925804534
 Linear coef   :      -0.017491411396
           Qmin:     -16.738143835004
Quadratic minimum step length (  0.459689082875) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001046 (step -0.4980 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.73265134313556 0.00000000000 0.01932313676 0.4597  0.000    8.00000000
      ideal mu1:      -0.497887532760
             Q0:     -16.738120565193
             G0:      -0.001634050743
   RMS gradient:       0.006727667797
     Trial step:       0.580065328801
             Q1:     -16.738467379492
 Quadratic coef:       0.000601041883
 Linear coef   :      -0.000947856181
           Qmin:     -16.738494262670
Quadratic minimum step length (  0.457387848624) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000207 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.73812056519325 0.00068656148 0.00504575085 0.4574  0.068    8.00000000
      ideal mu1:      -0.501994154351
             Q0:     -16.738494943782
             G0:      -0.000216814383
   RMS gradient:       0.002451647076
     Trial step:       0.515087208928
             Q1:     -16.738562897219
 Quadratic coef:       0.000043724878
 Linear coef   :      -0.000111678315
           Qmin:     -16.738566253564
Quadratic minimum step length (  0.657795672578) accepted
    Initial Ne1:       8.00000007
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000075 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.73849494378227 0.00005002081 0.00183873528 0.6578  0.133    8.00000000
      ideal mu1:      -0.501108050947
             Q0:     -16.738566336887
             G0:      -0.000001469137
   RMS gradient:       0.000201858485
     Trial step:       0.582084304060
             Q1:     -16.738566839913
 Quadratic coef:       0.000000352135
 Linear coef   :      -0.000000855161
           Qmin:     -16.738566856077
Quadratic minimum step length (  0.706796547726) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.73856633688661 0.00001020017 0.00015139386 0.7068  0.007    8.00000000
      ideal mu1:      -0.501261580409
             Q0:     -16.738566856076
             G0:      -0.000000492563
   RMS gradient:       0.000116974935
     Trial step:       0.641416539072
             Q1:     -16.738566971665
 Quadratic coef:       0.000000200348
 Linear coef   :      -0.000000315938
           Qmin:     -16.738566980630
Quadratic minimum step length (  0.505738882717) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.73856685607568 0.00000006550 0.00008773120 0.5057  0.336    8.00000000
      ideal mu1:      -0.501178141645
             Q0:     -16.738566980628
             G0:      -0.000000013651
   RMS gradient:       0.000019472653
     Trial step:       0.569551827165
             Q1:     -16.738566983651
 Quadratic coef:       0.000000004752
 Linear coef   :      -0.000000007775
           Qmin:     -16.738566983809
Quadratic minimum step length (  0.465978515686) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.73856698062805 0.00000002085 0.00001460449 0.4660  0.028    8.00000000
      ideal mu1:      -0.501190019304
             Q0:     -16.738566983809
             G0:      -0.000000001772
   RMS gradient:       0.000007015066
     Trial step:       0.515168821871
             Q1:     -16.738566984243
 Quadratic coef:       0.000000000479
 Linear coef   :      -0.000000000913
           Qmin:     -16.738566984244
Quadratic minimum step length (  0.491266315833) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.73856698380886 0.00000000041 0.00000526130 0.4913  0.000    8.00000000
      ideal mu1:      -0.501185563653
             Q0:     -16.738566984244
             G0:      -0.000000000313
   RMS gradient:       0.000002950499
     Trial step:       0.503075629655
             Q1:     -16.738566984330
 Quadratic coef:       0.000000000071
 Linear coef   :      -0.000000000158
           Qmin:     -16.738566984331
Quadratic minimum step length (  0.556673698030) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.73856698424373 0.00000000005 0.00000221287 0.5567  0.177    8.00000000
      ideal mu1:      -0.501187739903
             Q0:     -16.738566984331
             G0:      -0.000000000014
   RMS gradient:       0.000000635233
     Trial step:       0.529196533576
             Q1:     -16.738566984334
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000008
           Qmin:     -16.738566984334
Quadratic minimum step length (  0.471720480581) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.73856698433072 0.00000000001 0.00000047642 0.4717  0.046    8.00000000
      ideal mu1:      -0.501187331278
10    -16.73856698433397 0.00000000000 0.00000018479 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00279045416203              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11501422E-01     0.63136091E-02
               2       0.79050018E-04     0.46209230E-04
               3       0.42038087E-08     0.26301532E-08
               4       0.94905711E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15595031E-01     0.87579361E-02
               2       0.14120219E-03     0.83294401E-04
               3       0.12789413E-07     0.80148496E-08
               4       0.10311224E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00279045416203
Trial step length           =               0.173692
Gradient along search dir.  =         -0.16403846425
Functional at step 0        =     -16.73856698433397
Functional at step 1        =     -16.76040221478709
Functional predicted        =     -16.76905394630145
Selected quadratic step     =               0.371705
Conjugate gradients coeff.  =               0.076042
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.05256062
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004359 (step -0.4924 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512031242067
             Q0:     -16.768816948521
             G0:      -0.006711739868
   RMS gradient:       0.013654201498
     Trial step:       0.499632708237
             Q1:     -16.770044325321
 Quadratic coef:       0.002126027967
 Linear coef   :      -0.003353404767
           Qmin:     -16.770139288079
Quadratic minimum step length (  0.394037785840) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000224 (step -0.4995 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.76881694852064 0.00000000000 0.01024065111 0.3940  0.000    8.00000000
      ideal mu1:      -0.496773135340
             Q0:     -16.770138727870
             G0:      -0.000360862643
   RMS gradient:       0.003163506984
     Trial step:       0.443705044018
             Q1:     -16.770223051203
 Quadratic coef:       0.000075793242
 Linear coef   :      -0.000160116575
           Qmin:     -16.770223291206
Quadratic minimum step length (  0.468673260765) accepted
    Initial Ne1:       8.00000021
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000041 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77013872787027 0.00016529244 0.00237263058 0.4687  0.054    8.00000000
      ideal mu1:      -0.497316991172
             Q0:     -16.770223321035
             G0:      -0.000015375816
   RMS gradient:       0.000653224687
     Trial step:       0.456018299850
             Q1:     -16.770228392777
 Quadratic coef:       0.000001939912
 Linear coef   :      -0.000007011654
           Qmin:     -16.770229656799
Quadratic minimum step length (  0.824120597007) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77022332103531 0.00001115398 0.00048991852 0.8241  0.043    8.00000000
      ideal mu1:      -0.497209433773
             Q0:     -16.770229657640
             G0:      -0.000000011657
   RMS gradient:       0.000017992639
     Trial step:       0.613036763594
             Q1:     -16.770229660518
 Quadratic coef:       0.000000004268
 Linear coef   :      -0.000000007146
           Qmin:     -16.770229660631
Quadratic minimum step length (  0.513206177465) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77022965764014 0.00000082837 0.00001349448 0.5132  0.001    8.00000000
      ideal mu1:      -0.497226073904
             Q0:     -16.770229660631
             G0:      -0.000000002869
   RMS gradient:       0.000008926941
     Trial step:       0.560904852974
             Q1:     -16.770229661551
 Quadratic coef:       0.000000000690
 Linear coef   :      -0.000000001609
           Qmin:     -16.770229661570
Quadratic minimum step length (  0.654260944766) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77022966063133 0.00000000037 0.00000669521 0.6543  0.246    8.00000000
      ideal mu1:      -0.497220471423
             Q0:     -16.770229661570
             G0:      -0.000000000095
   RMS gradient:       0.000001627112
     Trial step:       0.605787206064
             Q1:     -16.770229661586
 Quadratic coef:       0.000000000042
 Linear coef   :      -0.000000000058
           Qmin:     -16.770229661590
Quadratic minimum step length (  0.420936526181) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77022966156979 0.00000000015 0.00000122033 0.4209  0.033    8.00000000
      ideal mu1:      -0.497220923308
             Q0:     -16.770229661590
             G0:      -0.000000000004
   RMS gradient:       0.000000327557
     Trial step:       0.504973229118
             Q1:     -16.770229661591
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.770229661591
Quadratic minimum step length (  0.482994351349) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77022966158986 0.00000000000 0.00000024567 0.4830  0.000    8.00000000
      ideal mu1:      -0.497220758861
             Q0:     -16.770229661591
             G0:      -0.000000000001
   RMS gradient:       0.000000117562
     Trial step:       0.493861536513
             Q1:     -16.770229661591
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.770229661594
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  9.762124907835)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77022966159088 0.00000000000 0.00000008817 0.1500  0.000    8.00000000
      ideal mu1:      -0.497220765132
             Q0:     -16.770229661591
             G0:      -0.000000000001
   RMS gradient:       0.000000092745
     Trial step:       0.272174999728
             Q1:     -16.770229661591
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.770229661591
  Cubic LS coeff:       0.408020314912
Predicted energy:     -16.770229661591
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77022966159082 0.00000000000 0.00000006956 0.4080  0.622    8.00000000
      ideal mu1:      -0.497220801306
10    -16.77022966159097 0.00000000000 0.00000003232 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00126943183345              |
           | Maximum change in energy =  0.08854168768859 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12060779E-01     0.50149853E-02
               2       0.93227864E-04     0.38194184E-04
               3       0.65576248E-08     0.27951632E-08
               4       0.53057598E-15     0.22204460E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63244705E-02     0.26137750E-02
               2       0.25217667E-04     0.10071892E-04
               3       0.46488091E-09     0.19294311E-09
               4       0.10092739E-14     0.77715612E-15
================================================================================
RMS gradient                =       0.00126943183345
Trial step length           =               0.254091
Gradient along search dir.  =         -0.03451060649
Functional at step 0        =     -16.77022966159097
Functional at step 1        =     -16.77599304907701
Functional predicted        =     -16.77662574834886
Selected quadratic step     =               0.370674
Conjugate gradients coeff.  =               0.206952
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02131512
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001798 (step -0.4967 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.510457241058
             Q0:     -16.776583341304
             G0:      -0.001312160971
   RMS gradient:       0.006037293753
     Trial step:       0.333246048889
             Q1:     -16.776826174550
 Quadratic coef:       0.000194439213
 Linear coef   :      -0.000437272459
           Qmin:     -16.776829185751
Quadratic minimum step length (  0.374716902535) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000038 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77658334130372 0.00000000000 0.00452797031 0.3747  0.000    8.00000000
      ideal mu1:      -0.503791778471
             Q0:     -16.776829250180
             G0:      -0.000050208762
   RMS gradient:       0.001180267042
     Trial step:       0.353373636852
             Q1:     -16.776841064124
 Quadratic coef:       0.000005928509
 Linear coef   :      -0.000017742453
           Qmin:     -16.776842524792
Quadratic minimum step length (  0.528776711062) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77682925018035 0.00003073056 0.00088520028 0.5288  0.038    8.00000000
      ideal mu1:      -0.503709122292
             Q0:     -16.776842528706
             G0:      -0.000002402898
   RMS gradient:       0.000258265863
     Trial step:       0.432268145334
             Q1:     -16.776843301549
 Quadratic coef:       0.000000265853
 Linear coef   :      -0.000001038696
           Qmin:     -16.776843543260
Quadratic minimum step length (  0.844442194604) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77684252870566 0.00000172464 0.00019369940 0.8444  0.048    8.00000000
      ideal mu1:      -0.503697323052
             Q0:     -16.776843543285
             G0:      -0.000000004022
   RMS gradient:       0.000010569793
     Trial step:       0.604173370237
             Q1:     -16.776843544815
 Quadratic coef:       0.000000000900
 Linear coef   :      -0.000000002430
           Qmin:     -16.776843544925
Quadratic minimum step length (  0.815751242404) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77684354328460 0.00000013322 0.00000792735 0.8158  0.002    8.00000000
      ideal mu1:      -0.503693043223
             Q0:     -16.776843544925
             G0:      -0.000000001326
   RMS gradient:       0.000006068839
     Trial step:       0.702036450192
             Q1:     -16.776843545231
 Quadratic coef:       0.000000000625
 Linear coef   :      -0.000000000931
           Qmin:     -16.776843545272
Quadratic minimum step length (  0.523098817653) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77684354492514 0.00000000021 0.00000455163 0.5231  0.330    8.00000000
      ideal mu1:      -0.503696304898
             Q0:     -16.776843545272
             G0:      -0.000000000035
   RMS gradient:       0.000000989630
     Trial step:       0.605998710432
             Q1:     -16.776843545282
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000021
           Qmin:     -16.776843545282
Quadratic minimum step length (  0.552956723852) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77684354527186 0.00000000006 0.00000074222 0.5530  0.027    8.00000000
      ideal mu1:      -0.503695547082
             Q0:     -16.776843545282
             G0:      -0.000000000006
   RMS gradient:       0.000000417258
     Trial step:       0.578870505017
             Q1:     -16.776843545283
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.776843545283
Quadratic minimum step length (  0.432776720848) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77684354528170 0.00000000000 0.00000031294 0.4328  0.000    8.00000000
      ideal mu1:      -0.503695869059
             Q0:     -16.776843545283
             G0:      -0.000000000001
   RMS gradient:       0.000000151691
     Trial step:       0.500521407092
             Q1:     -16.776843545283
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776843545283
  Cubic LS coeff:       0.711985845829
Predicted energy:     -16.776843545284
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77684354528286 0.00000000000 0.00000011377 0.7120  0.132    8.00000000
      ideal mu1:      -0.503695788469
             Q0:     -16.776843545283
             G0:      -0.000000000000
   RMS gradient:       0.000000040881
     Trial step:       0.596962442188
             Q1:     -16.776843545283
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776843545283
  Cubic LS coeff:       0.996039395232
Predicted energy:     -16.776843545283
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77684354528304 0.00000000000 0.00000003066 0.9960  0.073    8.00000000
      ideal mu1:      -0.503695808724
10    -16.77684354528312 0.00000000000 0.00000003585 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00072550431254              |
           | Maximum change in energy =  0.01055422575233 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12898145E-01     0.44738289E-02
               2       0.11274703E-03     0.39456250E-04
               3       0.96193681E-08     0.37150086E-08
               4       0.81405865E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.59394398E-02     0.21832534E-02
               2       0.23443454E-04     0.81295998E-05
               3       0.39745857E-09     0.14590321E-09
               4       0.91178676E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00072550431254
Trial step length           =               0.306896
Gradient along search dir.  =         -0.01122533124
Functional at step 0        =     -16.77684354528312
Functional at step 1        =     -16.77905287961378
Functional predicted        =     -16.77924468249665
Selected quadratic step     =               0.427807
Conjugate gradients coeff.  =               0.326634
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00935036
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000799 (step -0.4982 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514047261145
             Q0:     -16.779233600150
             G0:      -0.000332129426
   RMS gradient:       0.003037403069
     Trial step:       0.771101880359
             Q1:     -16.779246979264
 Quadratic coef:       0.000242726511
 Linear coef   :      -0.000256105625
           Qmin:     -16.779301155700
Quadratic minimum step length (  0.406802553784) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77923360015016 0.00000000000 0.00227805230 0.4068  0.000    8.00000000
      ideal mu1:      -0.510531291359
             Q0:     -16.779301089010
             G0:      -0.000017552836
   RMS gradient:       0.000698412219
     Trial step:       0.560076971637
             Q1:     -16.779305722610
 Quadratic coef:       0.000005197339
 Linear coef   :      -0.000009830939
           Qmin:     -16.779305737897
Quadratic minimum step length (  0.529702119649) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77930108900988 0.00000844444 0.00052380916 0.5297  0.053    8.00000000
      ideal mu1:      -0.510572410197
             Q0:     -16.779305737884
             G0:      -0.000001048054
   RMS gradient:       0.000170607609
     Trial step:       0.544677848863
             Q1:     -16.779306124569
 Quadratic coef:       0.000000184167
 Linear coef   :      -0.000000570852
           Qmin:     -16.779306180244
Quadratic minimum step length (  0.844153586106) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77930573788445 0.00000061161 0.00012795571 0.8442  0.060    8.00000000
      ideal mu1:      -0.510556446133
             Q0:     -16.779306180251
             G0:      -0.000000000941
   RMS gradient:       0.000005111417
     Trial step:       0.678079463920
             Q1:     -16.779306180496
 Quadratic coef:       0.000000000393
 Linear coef   :      -0.000000000638
           Qmin:     -16.779306180510
Quadratic minimum step length (  0.550357248288) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77930618025122 0.00000005878 0.00000383356 0.5504  0.001    8.00000000
      ideal mu1:      -0.510557959828
             Q0:     -16.779306180510
             G0:      -0.000000000200
   RMS gradient:       0.000002358747
     Trial step:       0.610889472723
             Q1:     -16.779306180586
 Quadratic coef:       0.000000000046
 Linear coef   :      -0.000000000122
           Qmin:     -16.779306180592
Quadratic minimum step length (  0.817307940660) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77930618050983 0.00000000003 0.00000176906 0.8173  0.213    8.00000000
      ideal mu1:      -0.510557145850
             Q0:     -16.779306180592
             G0:      -0.000000000011
   RMS gradient:       0.000000553913
     Trial step:       0.706600889415
             Q1:     -16.779306180595
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000008
           Qmin:     -16.779306180595
Quadratic minimum step length (  0.551111364371) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77930618059175 0.00000000001 0.00000041543 0.5511  0.055    8.00000000
      ideal mu1:      -0.510557541685
             Q0:     -16.779306180595
             G0:      -0.000000000002
   RMS gradient:       0.000000207333
     Trial step:       0.624031874371
             Q1:     -16.779306180595
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.779306180596
Quadratic minimum step length (  1.021843246922) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77930618059471 0.00000000000 0.00000015550 1.0218  0.000    8.00000000
      ideal mu1:      -0.510557170737
             Q0:     -16.779306180595
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000003
   RMS gradient:       0.000000289112
     Trial step:       0.798537886822
             Q1:     -16.779306180595
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000002
           Qmin:     -16.779306180595
Quadratic minimum step length (  0.354389787787) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77930618059483 0.00000000000 0.00000021683 0.3544  1.944    8.00000000
      ideal mu1:      -0.510557425518
             Q0:     -16.779306180595
             G0:      -0.000000000000
   RMS gradient:       0.000000028539
     Trial step:       0.531971495712
             Q1:     -16.779306180595
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.779306180595
  Cubic LS coeff:       0.997352755589
Predicted energy:     -16.779306180595
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77930618059521 0.00000000000 0.00000002140 0.9974  0.010    8.00000000
      ideal mu1:      -0.510557414369
10    -16.77930618059534 0.00000000000 0.00000001606 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00043807122991              |
           | Maximum change in energy =  0.00220462789738 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88960599381709 |
           | Pseudopotential (local)    :      -46.13027871684081 |
           | Pseudopotential (non-local):       -3.19709459057224 |
           | Hartree                    :       19.85607226857620 |
           | Exchange-correlation       :       -4.13346038354641 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.77930618059534 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.13027871684157 |
           | Hartree                    :       19.85607226857650 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999758
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56081264E-02     0.19480883E-02
               2       0.22353150E-04     0.83341989E-05
               3       0.42464370E-09     0.16728630E-09
               4       0.85537886E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.84041725E-03     0.27910621E-03
               2       0.49826800E-06     0.17929771E-06
               3       0.20505464E-12     0.78770324E-13
================================================================================
RMS gradient                =       0.00043807122991
Trial step length           =               0.362342
Gradient along search dir.  =         -0.00395384761
Functional at step 0        =     -16.77930618059534
Functional at step 1        =     -16.77990960203685
Functional predicted        =     -16.77992497405472
Selected quadratic step     =               0.313008
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99845696
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000174 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511438652139
             Q0:     -16.779924752224
             G0:      -0.000001212534
   RMS gradient:       0.000183525173
     Trial step:       0.728397719068
             Q1:     -16.779925077214
 Quadratic coef:       0.000000558216
 Linear coef   :      -0.000000883207
           Qmin:     -16.779925101575
Quadratic minimum step length (  0.576233276620) accepted
    Initial Ne1:       7.99999958
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77992475222359 0.00000000000 0.00013764385 0.5762  0.000    8.00000000
      ideal mu1:      -0.511254470108
             Q0:     -16.779925101557
             G0:      -0.000000085780
   RMS gradient:       0.000048812643
     Trial step:       0.647863414881
             Q1:     -16.779925127166
 Quadratic coef:       0.000000029965
 Linear coef   :      -0.000000055574
           Qmin:     -16.779925127325
Quadratic minimum step length (  0.600770900688) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77992510155748 0.00000004367 0.00003660948 0.6008  0.071    8.00000000
      ideal mu1:      -0.511286382318
             Q0:     -16.779925127325
             G0:      -0.000000016981
   RMS gradient:       0.000021718991
     Trial step:       0.623872973674
             Q1:     -16.779925131935
 Quadratic coef:       0.000000005984
 Linear coef   :      -0.000000010594
           Qmin:     -16.779925132014
Quadratic minimum step length (  0.552302065868) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77992512732459 0.00000000345 0.00001628924 0.5523  0.198    8.00000000
      ideal mu1:      -0.511275574356
             Q0:     -16.779925132014
             G0:      -0.000000000156
   RMS gradient:       0.000002084859
     Trial step:       0.586997727593
             Q1:     -16.779925132044
 Quadratic coef:       0.000000000062
 Linear coef   :      -0.000000000092
           Qmin:     -16.779925132048
Quadratic minimum step length (  0.433048255077) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77992513201407 0.00000000071 0.00000156364 0.4330  0.009    8.00000000
      ideal mu1:      -0.511276450757
             Q0:     -16.779925132048
             G0:      -0.000000000009
   RMS gradient:       0.000000512444
     Trial step:       0.504180862061
             Q1:     -16.779925132051
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000005
           Qmin:     -16.779925132052
Quadratic minimum step length (  0.892254894450) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77992513204795 0.00000000000 0.00000038433 0.8923  0.060    8.00000000
      ideal mu1:      -0.511276372179
             Q0:     -16.779925132052
             G0:      -0.000000000001
   RMS gradient:       0.000000115609
     Trial step:       0.670714426460
             Q1:     -16.779925132053
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779925132053
Quadratic minimum step length (  1.243520850444) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77992513205237 0.00000000000 0.00000008671 1.2435  0.051    8.00000000
      ideal mu1:      -0.511276369385
             Q0:     -16.779925132053
             G0:      -0.000000000000
   RMS gradient:       0.000000055465
     Trial step:       0.913261941612
             Q1:     -16.779925132052
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779925132053
Quadratic minimum step length (  0.124997961486) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77992513205274 0.00000000000 0.00000004160 0.1250  0.000    8.00000000
      ideal mu1:      -0.511276372187
             Q0:     -16.779925132053
             G0:      -0.000000000000
   RMS gradient:       0.000000044964
     Trial step:       0.337869621310
             Q1:     -16.779925132052
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779925132053
Quadratic minimum step length (  0.019047860990) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77992513205282 0.00000000000 0.00000003372 0.0190  0.657    8.00000000
      ideal mu1:      -0.511276372738
             Q0:     -16.779925132053
             G0:      -0.000000000000
   RMS gradient:       0.000000042691
     Trial step:       0.080222774692
             Q1:     -16.779925132053
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.779925132053
Quadratic minimum step length (  0.002482314165) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77992513205288 0.00000000000 0.00000003202 0.0025  0.901    8.00000000
      ideal mu1:      -0.511276372834
10    -16.77992513205293 0.00000000000 0.00000003170 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00028133485436              |
           | Maximum change in energy =  0.00082087843741 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.74709899E-02     0.24672104E-02
               2       0.38680022E-04     0.13574357E-04
               3       0.12062863E-08     0.45823616E-09
               4       0.95782599E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26393677E-02     0.91864688E-03
               2       0.47488501E-05     0.17105880E-05
               3       0.17233022E-10     0.62184841E-11
               4       0.92241497E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00028133485436
Trial step length           =               0.336773
Gradient along search dir.  =         -0.00163090332
Functional at step 0        =     -16.77992513205293
Functional at step 1        =     -16.78026244239473
Functional predicted        =     -16.78028098492181
Selected quadratic step     =               0.436387
Conjugate gradients coeff.  =               0.412437
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99770364
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000254 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513721066805
             Q0:     -16.780280292234
             G0:      -0.000005935469
   RMS gradient:       0.000406046980
     Trial step:       0.014111631017
             Q1:     -16.780280374628
 Quadratic coef:       0.000000001365
 Linear coef   :      -0.000000083759
           Qmin:     -16.780281576916
Quadratic minimum step length (  0.432882848734) accepted
    Initial Ne1:       7.99999956
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78028029223429 0.00000000000 0.00030453511 0.4329  0.000    8.00000000
      ideal mu1:      -0.513230715188
             Q0:     -16.780281577504
             G0:      -0.000000434938
   RMS gradient:       0.000109886073
     Trial step:       0.078158064426
             Q1:     -16.780281609343
 Quadratic coef:       0.000000002155
 Linear coef   :      -0.000000033994
           Qmin:     -16.780281711560
Quadratic minimum step length (  0.616436270302) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78028157750369 0.00000016059 0.00008241455 0.6164  0.073    8.00000000
      ideal mu1:      -0.513236388229
             Q0:     -16.780281711560
             G0:      -0.000000043410
   RMS gradient:       0.000034724494
     Trial step:       0.219498213498
             Q1:     -16.780281719721
 Quadratic coef:       0.000000001367
 Linear coef   :      -0.000000009528
           Qmin:     -16.780281728160
Quadratic minimum step length (  0.764797374011) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78028171155970 0.00000001799 0.00002604337 0.7648  0.100    8.00000000
      ideal mu1:      -0.513237663104
             Q0:     -16.780281728154
             G0:      -0.000000000055
   RMS gradient:       0.000001237242
     Trial step:       0.409721438643
             Q1:     -16.780281728171
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000023
           Qmin:     -16.780281728175
Quadratic minimum step length (  0.744138600797) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.78028172815424 0.00000000230 0.00000092793 0.7441  0.001    8.00000000
      ideal mu1:      -0.513237707295
             Q0:     -16.780281728175
             G0:      -0.000000000016
   RMS gradient:       0.000000645290
     Trial step:       0.552168034269
             Q1:     -16.780281728180
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000009
           Qmin:     -16.780281728180
Quadratic minimum step length (  0.661255707314) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78028172817518 0.00000000000 0.00000048397 0.6613  0.272    8.00000000
      ideal mu1:      -0.513237751162
             Q0:     -16.780281728180
             G0:      -0.000000000000
   RMS gradient:       0.000000082135
     Trial step:       0.604255131593
             Q1:     -16.780281728180
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780281728180
Quadratic minimum step length (  1.427139568089) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78028172818012 0.00000000000 0.00000006160 1.4271  0.016    8.00000000
      ideal mu1:      -0.513237721498
             Q0:     -16.780281728180
             G0:      -0.000000000001
   RMS gradient:       0.000000164301
     Trial step:       0.928631470238
             Q1:     -16.780281728180
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.780281728180
Quadratic minimum step length (  0.491436378293) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78028172818016 0.00000000000 0.00000012323 0.4914  0.000    8.00000000
      ideal mu1:      -0.513237752144
             Q0:     -16.780281728180
             G0:      -0.000000000000
   RMS gradient:       0.000000039402
     Trial step:       0.675546657532
             Q1:     -16.780281728180
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780281728180
Quadratic minimum step length (  0.709858598583) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78028172818016 0.00000000000 0.00000002955 0.7099  0.058    8.00000000
      ideal mu1:      -0.513237736178
             Q0:     -16.780281728180
             G0:      -0.000000000000
   RMS gradient:       0.000000014031
     Trial step:       0.692490146929
             Q1:     -16.780281728180
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780281728180
  Cubic LS coeff:       1.205398032487
Predicted energy:     -16.780281728180
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78028172818021 0.00000000000 0.00000001052 1.2054  0.127    8.00000000
      ideal mu1:      -0.513237754099
10    -16.78028172818035 0.00000000000 0.00000001387 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00018691423312              |
           | Maximum change in energy =  0.00020631715253 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.99181738E-02     0.33772195E-02
               2       0.66634618E-04     0.23658982E-04
               3       0.33528822E-08     0.12015365E-08
               4       0.11287464E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23066977E-03     0.83945595E-04
               2       0.35637196E-07     0.13397154E-07
               3       0.95126353E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00018691423312
Trial step length           =               0.383358
Gradient along search dir.  =         -0.00072091548
Functional at step 0        =     -16.78028172818035
Functional at step 1        =     -16.78041710002557
Functional predicted        =     -16.78041715613214
Selected quadratic step     =               0.375711
Conjugate gradients coeff.  =               0.441405
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99831335
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000167 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515677465400
             Q0:     -16.780416942324
             G0:      -0.000014845494
   RMS gradient:       0.000642164185
     Trial step:       0.913633548325
             Q1:     -16.780415061408
 Quadratic coef:       0.000015444258
 Linear coef   :      -0.000013563342
           Qmin:     -16.780419920199
Quadratic minimum step length (  0.401182242194) accepted
    Initial Ne1:       7.99999990
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78041694232429 0.00000000000 0.00048162307 0.4012  0.000    8.00000000
      ideal mu1:      -0.514935942084
             Q0:     -16.780419919124
             G0:      -0.000000531538
   RMS gradient:       0.000121524401
     Trial step:       0.605420147881
             Q1:     -16.780420081694
 Quadratic coef:       0.000000159234
 Linear coef   :      -0.000000321804
           Qmin:     -16.780420081712
Quadratic minimum step length (  0.611763796188) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78041991912372 0.00000037223 0.00009114330 0.6118  0.036    8.00000000
      ideal mu1:      -0.514910078632
             Q0:     -16.780420081712
             G0:      -0.000000037254
   RMS gradient:       0.000032167755
     Trial step:       0.608583706615
             Q1:     -16.780420096510
 Quadratic coef:       0.000000007874
 Linear coef   :      -0.000000022672
           Qmin:     -16.780420098032
Quadratic minimum step length (  0.876144038800) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78042008171195 0.00000002105 0.00002412582 0.8761  0.070    8.00000000
      ideal mu1:      -0.514909866077
             Q0:     -16.780420098032
             G0:      -0.000000000010
   RMS gradient:       0.000000531440
     Trial step:       0.730210234564
             Q1:     -16.780420098035
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000007
           Qmin:     -16.780420098035
Quadratic minimum step length (  0.684910615951) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78042009803194 0.00000000219 0.00000039858 0.6849  0.000    8.00000000
      ideal mu1:      -0.514910023686
             Q0:     -16.780420098036
             G0:      -0.000000000002
   RMS gradient:       0.000000255751
     Trial step:       0.707197809335
             Q1:     -16.780420098036
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.780420098036
Quadratic minimum step length (  0.766194944795) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78042009803553 0.00000000000 0.00000019181 0.7662  0.232    8.00000000
      ideal mu1:      -0.514909917711
             Q0:     -16.780420098036
             G0:      -0.000000000000
   RMS gradient:       0.000000087462
     Trial step:       0.736105553900
             Q1:     -16.780420098036
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780420098036
Quadratic minimum step length (  0.724840270945) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.78042009803638 0.00000000000 0.00000006560 0.7248  0.117    8.00000000
      ideal mu1:      -0.514909982896
             Q0:     -16.780420098036
             G0:      -0.000000000000
   RMS gradient:       0.000000036053
     Trial step:       0.730451195586
             Q1:     -16.780420098037
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780420098036
  Cubic LS coeff:       0.950917816827
Predicted energy:     -16.780420098037
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78042009803640 0.00000000000 0.00000002704 0.9509  0.000    8.00000000
      ideal mu1:      -0.514909915577
             Q0:     -16.780420098037
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000047126
     Trial step:       0.833426095227
             Q1:     -16.780420098036
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780420098037
Quadratic minimum step length (  0.084038457263) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78042009803674 0.00000000000 0.00000003534 0.0840  1.709    8.00000000
      ideal mu1:      -0.514909925086
             Q0:     -16.780420098037
             G0:      -0.000000000000
   RMS gradient:       0.000000036467
     Trial step:       0.264650417127
             Q1:     -16.780420098037
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780420098037
Quadratic minimum step length (  0.010333224378) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78042009803678 0.00000000000 0.00000002735 0.0103  0.599    8.00000000
      ideal mu1:      -0.514909926686
10    -16.78042009803668 0.00000000000 0.00000002600 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00007649166855              |
           | Maximum change in energy =  0.00011886537580 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.55503338E-02     0.17897872E-02
               2       0.21087316E-04     0.71485164E-05
               3       0.34823541E-09     0.12889971E-09
               4       0.71723251E-15     0.33306691E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27973828E-02     0.91016665E-03
               2       0.53254676E-05     0.18475473E-05
               3       0.21723288E-10     0.78800161E-11
               4       0.39479651E-15     0.22204460E-15
================================================================================
RMS gradient                =       0.00007649166855
Trial step length           =               0.379515
Gradient along search dir.  =         -0.00012313062
Functional at step 0        =     -16.78042009803668
Functional at step 1        =     -16.78042283348284
Functional predicted        =     -16.78043250691050
Selected quadratic step     =               0.201556
Conjugate gradients coeff.  =               0.167473
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99926575
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000077 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515546545012
             Q0:     -16.780432466314
             G0:      -0.000003248403
   RMS gradient:       0.000300388771
     Trial step:       0.052294284028
             Q1:     -16.780432625541
 Quadratic coef:       0.000000010645
 Linear coef   :      -0.000000169873
           Qmin:     -16.780433144009
Quadratic minimum step length (  0.417248296778) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78043246631375 0.00000000000 0.00022529158 0.4172  0.000    8.00000000
      ideal mu1:      -0.515190398968
             Q0:     -16.780433144079
             G0:      -0.000000132463
   RMS gradient:       0.000060653782
     Trial step:       0.147714931343
             Q1:     -16.780433161016
 Quadratic coef:       0.000000002630
 Linear coef   :      -0.000000019567
           Qmin:     -16.780433180476
Quadratic minimum step length (  0.549553878460) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78043314407882 0.00000008471 0.00004549034 0.5496  0.041    8.00000000
      ideal mu1:      -0.515185039673
             Q0:     -16.780433180479
             G0:      -0.000000005556
   RMS gradient:       0.000012422112
     Trial step:       0.284916327062
             Q1:     -16.780433181827
 Quadratic coef:       0.000000000235
 Linear coef   :      -0.000000001583
           Qmin:     -16.780433183141
Quadratic minimum step length (  0.958263401788) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78043318047917 0.00000000474 0.00000931658 0.9583  0.042    8.00000000
      ideal mu1:      -0.515183401419
             Q0:     -16.780433183140
             G0:      -0.000000000003
   RMS gradient:       0.000000296528
     Trial step:       0.522517835863
             Q1:     -16.780433183141
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.780433183141
Quadratic minimum step length (  0.519518713282) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78043318313972 0.00000000035 0.00000022240 0.5195  0.001    8.00000000
      ideal mu1:      -0.515183386668
             Q0:     -16.780433183141
             G0:      -0.000000000000
   RMS gradient:       0.000000106757
     Trial step:       0.521016116597
             Q1:     -16.780433183140
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780433183141
Quadratic minimum step length (  0.160102593812) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78043318314057 0.00000000000 0.00000008007 0.1601  0.130    8.00000000
      ideal mu1:      -0.515183388412
             Q0:     -16.780433183141
             G0:      -0.000000000000
   RMS gradient:       0.000000086348
     Trial step:       0.288818336823
             Q1:     -16.780433183141
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780433183141
Quadratic minimum step length (  0.055112356415) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78043318314072 0.00000000000 0.00000006476 0.0551  0.654    8.00000000
      ideal mu1:      -0.515183389373
             Q0:     -16.780433183140
             G0:      -0.000000000000
   RMS gradient:       0.000000074512
     Trial step:       0.126164413041
             Q1:     -16.780433183141
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780433183140
  Cubic LS coeff:       0.180280575866
Predicted energy:     -16.780433183141
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78043318314041 0.00000000000 0.00000005588 0.1803  0.000    8.00000000
      ideal mu1:      -0.515183390802
             Q0:     -16.780433183140
             G0:      -0.000000000000
   RMS gradient:       0.000000055946
     Trial step:       0.150814432455
             Q1:     -16.780433183140
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780433183141
  Cubic LS coeff:       0.278519620961
Predicted energy:     -16.780433183141
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78043318314035 0.00000000000 0.00000004196 0.2785  0.564    8.00000000
      ideal mu1:      -0.515183393280
             Q0:     -16.780433183141
             G0:      -0.000000000000
   RMS gradient:       0.000000032074
     Trial step:       0.204950673487
             Q1:     -16.780433183141
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780433183141
  Cubic LS coeff:       0.325096004881
Predicted energy:     -16.780433183141
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78043318314057 0.00000000000 0.00000002406 0.3251  0.329    8.00000000
      ideal mu1:      -0.515183393770
10    -16.78043318314057 0.00000000000 0.00000001641 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00004000370276              |
           | Maximum change in energy =  0.00004612328544 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21853453E-02     0.76881364E-03
               2       0.33844184E-05     0.12437046E-05
               3       0.99310956E-11     0.38355291E-11
               4       0.10472497E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17372226E-03     0.59094162E-04
               2       0.21247122E-07     0.75953151E-08
               3       0.72780002E-15     0.45796700E-15
================================================================================
RMS gradient                =       0.00004000370276
Trial step length           =               0.276575
Gradient along search dir.  =         -0.00003297090
Functional at step 0        =     -16.78043318314057
Functional at step 1        =     -16.78043738490000
Functional predicted        =     -16.78043741092148
Selected quadratic step     =               0.256455
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99913443
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000090 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515549011172
             Q0:     -16.780437338976
             G0:      -0.000001758986
   RMS gradient:       0.000221044618
     Trial step:       0.258125250893
             Q1:     -16.780437658655
 Quadratic coef:       0.000000134360
 Linear coef   :      -0.000000454039
           Qmin:     -16.780437722557
Quadratic minimum step length (  0.436138282442) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78043733897611 0.00000000000 0.00016578346 0.4361  0.000    8.00000000
      ideal mu1:      -0.515281527152
             Q0:     -16.780437722573
             G0:      -0.000000081765
   RMS gradient:       0.000047655231
     Trial step:       0.335526904404
             Q1:     -16.780437741100
 Quadratic coef:       0.000000008907
 Linear coef   :      -0.000000027434
           Qmin:     -16.780437743698
Quadratic minimum step length (  0.516717110738) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78043772257313 0.00000004795 0.00003574142 0.5167  0.046    8.00000000
      ideal mu1:      -0.515283217289
             Q0:     -16.780437743698
             G0:      -0.000000002489
   RMS gradient:       0.000008314744
     Trial step:       0.416380226018
             Q1:     -16.780437744519
 Quadratic coef:       0.000000000215
 Linear coef   :      -0.000000001036
           Qmin:     -16.780437744947
Quadratic minimum step length (  1.004057633328) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78043774369780 0.00000000276 0.00000623606 1.0041  0.030    8.00000000
      ideal mu1:      -0.515281611866
             Q0:     -16.780437744946
             G0:      -0.000000000004
   RMS gradient:       0.000000326647
     Trial step:       0.646583130232
             Q1:     -16.780437744948
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.780437744948
Quadratic minimum step length (  0.666255735722) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.78043774494648 0.00000000016 0.00000024499 0.6663  0.002    8.00000000
      ideal mu1:      -0.515281631293
             Q0:     -16.780437744948
             G0:      -0.000000000001
   RMS gradient:       0.000000167988
     Trial step:       0.656345731408
             Q1:     -16.780437744948
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.780437744948
Quadratic minimum step length (  0.477621273839) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78043774494797 0.00000000000 0.00000012599 0.4776  0.264    8.00000000
      ideal mu1:      -0.515281637348
             Q0:     -16.780437744948
             G0:      -0.000000000000
   RMS gradient:       0.000000055204
     Trial step:       0.559897030099
             Q1:     -16.780437744948
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437744948
Quadratic minimum step length (  0.081343030364) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78043774494844 0.00000000000 0.00000004140 0.0813  0.108    8.00000000
      ideal mu1:      -0.515281637637
             Q0:     -16.780437744948
             G0:      -0.000000000000
   RMS gradient:       0.000000045832
     Trial step:       0.213409749356
             Q1:     -16.780437744948
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437744948
Quadratic minimum step length (  0.007128143237) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78043774494833 0.00000000000 0.00000003437 0.0071  0.000    8.00000000
      ideal mu1:      -0.515281637652
             Q0:     -16.780437744948
             G0:      -0.000000000000
   RMS gradient:       0.000000045332
     Trial step:       0.039002759667
             Q1:     -16.780437744948
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437744948
Quadratic minimum step length (  0.000403904944) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.78043774494832 0.00000000000 0.00000003400 0.0004  0.978    8.00000000
      ideal mu1:      -0.515281637654
             Q0:     -16.780437744948
             G0:      -0.000000000000
   RMS gradient:       0.000000045277
     Trial step:       0.003969056244
             Q1:     -16.780437744948
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780437744948
  Cubic LS coeff:       0.004972599504
Predicted energy:     -16.780437744948
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78043774494812 0.00000000000 0.00000003396 0.0050  0.998    8.00000000
      ideal mu1:      -0.515281637686
10    -16.78043774494816 0.00000000000 0.00000003319 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001346920002              |
           | Maximum change in energy =  0.00000436170130 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87266070509883 |
           | Pseudopotential (local)    :      -46.08381171398772 |
           | Pseudopotential (non-local):       -3.19571766134201 |
           | Hartree                    :       19.81714655420145 |
           | Exchange-correlation       :       -4.12656487688955 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.78043774494816 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08381171398859 |
           | Hartree                    :       19.81714655420181 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999718
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22834233E-02     0.78831558E-03
               2       0.37530002E-05     0.13562994E-05
               3       0.12438744E-10     0.46970483E-11
               4       0.61203204E-15     0.22204460E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17151485E-02     0.58597174E-03
               2       0.21117300E-05     0.75682985E-06
               3       0.39107739E-11     0.14687973E-11
               4       0.68729023E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00001346920002
Trial step length           =               0.266325
Gradient along search dir.  =         -0.00000402925
Functional at step 0        =     -16.78043774494816
Functional at step 1        =     -16.78043681903827
Functional predicted        =     -16.78043788896041
Selected quadratic step     =               0.071483
Conjugate gradients coeff.  =               0.113366
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99971195
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000029 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515374039797
             Q0:     -16.780437880890
             G0:      -0.000000091800
   RMS gradient:       0.000050497451
     Trial step:       0.004442581131
             Q1:     -16.780437881296
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000408
           Qmin:     -16.780437898570
Quadratic minimum step length (  0.385180196379) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78043788089004 0.00000000000 0.00003787309 0.3852  0.000    8.00000000
      ideal mu1:      -0.515320155142
             Q0:     -16.780437900634
             G0:      -0.000000005012
   RMS gradient:       0.000011165430
     Trial step:       0.041366584010
             Q1:     -16.780437900833
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000207
           Qmin:     -16.780437902013
Quadratic minimum step length (  0.550411259868) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78043790063350 0.00000000221 0.00000837407 0.5504  0.049    8.00000000
      ideal mu1:      -0.515310869664
             Q0:     -16.780437901930
             G0:      -0.000000000270
   RMS gradient:       0.000002835530
     Trial step:       0.150892788500
             Q1:     -16.780437901965
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000041
           Qmin:     -16.780437901999
Quadratic minimum step length (  0.509035864103) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78043790193048 0.00000000020 0.00000212665 0.5090  0.064    8.00000000
      ideal mu1:      -0.515313477793
             Q0:     -16.780437902000
             G0:      -0.000000000064
   RMS gradient:       0.000001326494
     Trial step:       0.277145883933
             Q1:     -16.780437902014
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000018
           Qmin:     -16.780437902020
Quadratic minimum step length (  0.627277421442) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78043790200011 0.00000000001 0.00000099487 0.6273  0.219    8.00000000
      ideal mu1:      -0.515313505842
             Q0:     -16.780437902021
             G0:      -0.000000000004
   RMS gradient:       0.000000309600
     Trial step:       0.416950063481
             Q1:     -16.780437902021
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.780437902021
Quadratic minimum step length (  0.430519670151) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.78043790202069 0.00000000000 0.00000023220 0.4305  0.054    8.00000000
      ideal mu1:      -0.515313146848
             Q0:     -16.780437902021
             G0:      -0.000000000000
   RMS gradient:       0.000000106599
     Trial step:       0.423680544513
             Q1:     -16.780437902021
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437902021
Quadratic minimum step length (  0.450358618775) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78043790202136 0.00000000000 0.00000007995 0.4504  0.119    8.00000000
      ideal mu1:      -0.515313125173
             Q0:     -16.780437902022
             G0:      -0.000000000000
   RMS gradient:       0.000000034081
     Trial step:       0.436815962196
             Q1:     -16.780437902021
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437902022
Quadratic minimum step length (  0.019360055505) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78043790202158 0.00000000000 0.00000002556 0.0194  0.000    8.00000000
      ideal mu1:      -0.515313126272
             Q0:     -16.780437902022
             G0:      -0.000000000000
   RMS gradient:       0.000000032867
     Trial step:       0.091960759422
             Q1:     -16.780437902021
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437902022
Quadratic minimum step length (  0.000663602934) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78043790202172 0.00000000000 0.00000002465 0.0007  0.930    8.00000000
      ideal mu1:      -0.515313126343
             Q0:     -16.780437902022
             G0:      -0.000000000000
   RMS gradient:       0.000000032789
     Trial step:       0.007811877479
             Q1:     -16.780437902021
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437902022
Quadratic minimum step length (  0.000013476559) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78043790202161 0.00000000000 0.00000002459 0.0000  0.995    8.00000000
      ideal mu1:      -0.515313126345
10    -16.78043790202166 0.00000000000 0.00000002459 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000724797826              |
           | Maximum change in energy =  0.00000152060253 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.118702E-05
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.86806791E-03     0.31831713E-03
               2       0.55024222E-06     0.20790931E-06
               3       0.27928665E-12     0.10808021E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.65753256E-03     0.24212667E-03
               2       0.31564379E-06     0.11963214E-06
               3       0.92214608E-13     0.35721426E-13
================================================================================
RMS gradient                =       0.00000724797826
Trial step length           =               0.137978
Gradient along search dir.  =         -0.00000108234
Functional at step 0        =     -16.78043790202166
Functional at step 1        =     -16.78043773178633
Functional predicted        =     -16.78043791946840
Selected quadratic step     =               0.032239
Conjugate gradients coeff.  =              -0.289568
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00011918
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515278598218
             Q0:     -16.780437918007
             G0:      -0.000000012178
   RMS gradient:       0.000018392351
     Trial step:       0.000324464526
             Q1:     -16.780437918011
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000004
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780437918015
  Cubic LS coeff:       0.001084361367
Predicted energy:     -16.780437918018
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78043791800726 0.00000000000 0.00001379426 0.0011  0.000    8.00000000
      ideal mu1:      -0.515278653492
             Q0:     -16.780437918021
             G0:      -0.000000024205
   RMS gradient:       0.000018346507
     Trial step:       0.000593158324
             Q1:     -16.780437918035
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000014
           Qmin:     -16.780437918578
Quadratic minimum step length (  0.046097286695) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78043791802061 0.00000000000 0.00001375988 0.0461  0.995    8.00000000
      ideal mu1:      -0.515283335128
             Q0:     -16.780437919019
             G0:      -0.000000019453
   RMS gradient:       0.000014487022
     Trial step:       0.005229052431
             Q1:     -16.780437919119
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000102
           Qmin:     -16.780437920655
Quadratic minimum step length (  0.168224986105) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78043791901855 0.00000000014 0.00001086527 0.1682  0.624    8.00000000
      ideal mu1:      -0.515300638730
             Q0:     -16.780437920675
             G0:      -0.000000000478
   RMS gradient:       0.000003584862
     Trial step:       0.029659016715
             Q1:     -16.780437920689
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000014
           Qmin:     -16.780437920752
Quadratic minimum step length (  0.321340913097) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78043792067537 0.00000000053 0.00000268865 0.3213  0.061    8.00000000
      ideal mu1:      -0.515301992909
             Q0:     -16.780437920770
             G0:      -0.000000000166
   RMS gradient:       0.000001930593
     Trial step:       0.097625076249
             Q1:     -16.780437920783
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000016
           Qmin:     -16.780437920794
Quadratic minimum step length (  0.296806826135) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.78043792076952 0.00000000001 0.00000144794 0.2968  0.290    8.00000000
      ideal mu1:      -0.515301171408
             Q0:     -16.780437920795
             G0:      -0.000000000017
   RMS gradient:       0.000000661900
     Trial step:       0.170222762969
             Q1:     -16.780437920797
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -16.780437920799
Quadratic minimum step length (  0.565899671891) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.78043792079480 0.00000000000 0.00000049643 0.5659  0.118    8.00000000
      ideal mu1:      -0.515300365599
             Q0:     -16.780437920799
             G0:      -0.000000000010
   RMS gradient:       0.000000521882
     Trial step:       0.310369144266
             Q1:     -16.780437920800
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.780437920801
Quadratic minimum step length (  0.418009841412) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78043792079851 0.00000000000 0.00000039141 0.4180  0.000    8.00000000
      ideal mu1:      -0.515300790996
             Q0:     -16.780437920800
             G0:      -0.000000000000
   RMS gradient:       0.000000112928
     Trial step:       0.360190722776
             Q1:     -16.780437920801
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437920801
Quadratic minimum step length (  1.156031017865) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78043792080049 0.00000000000 0.00000008470 1.1560  0.047    8.00000000
      ideal mu1:      -0.515300617745
             Q0:     -16.780437920801
             G0:      -0.000000000000
   RMS gradient:       0.000000090305
     Trial step:       0.645284160565
             Q1:     -16.780437920801
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780437920801
  Cubic LS coeff:       0.855877750531
Predicted energy:     -16.780437920801
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78043792080062 0.00000000000 0.00000006773 0.8559  0.639    8.00000000
      ideal mu1:      -0.515300735541
10    -16.78043792080083 0.00000000000 0.00000004059 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000519807670              |
           | Maximum change in energy =  0.00000005235783 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.69219793E-03     0.24689027E-03
               2       0.34917099E-06     0.12927645E-06
               3       0.11065286E-12     0.42230108E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.62826361E-03     0.22379082E-03
               2       0.28756215E-06     0.10636110E-06
               3       0.75163946E-13     0.28602121E-13
================================================================================
RMS gradient                =       0.00000519807670
Trial step length           =               0.066695
Gradient along search dir.  =         -0.00000051288
Functional at step 0        =     -16.78043792080083
Functional at step 1        =     -16.78043777526691
Functional predicted        =     -16.78043792242832
Selected quadratic step     =               0.006346
Conjugate gradients coeff.  =              -0.514342
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99996456
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.515311154157
             Q0:     -16.780437922314
             G0:      -0.000000001114
   RMS gradient:       0.000005562308
     Trial step:       0.743158365221
             Q1:     -16.780437922434
 Quadratic coef:       0.000000000708
 Linear coef   :      -0.000000000828
           Qmin:     -16.780437922556
Quadratic minimum step length (  0.434497005293) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.78043792231365 0.00000000000 0.00000417173 0.4345  0.000    8.00000000
      ideal mu1:      -0.515304449719
             Q0:     -16.780437922556
             G0:      -0.000000000050
   RMS gradient:       0.000001178889
     Trial step:       0.568242979848
             Q1:     -16.780437922568
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000028
           Qmin:     -16.780437922569
Quadratic minimum step length (  0.508663752415) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.78043792255578 0.00000000003 0.00000088417 0.5087  0.045    8.00000000
      ideal mu1:      -0.515304483158
             Q0:     -16.780437922569
             G0:      -0.000000000001
   RMS gradient:       0.000000190591
     Trial step:       0.537628688235
             Q1:     -16.780437922569
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.780437922572
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  4.893916856321)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.78043792256852 0.00000000000 0.00000014294 0.1500  0.000    8.00000000
      ideal mu1:      -0.515304480117
             Q0:     -16.780437922569
             G0:      -0.000000000002
   RMS gradient:       0.000000163685
     Trial step:       0.283979406358
             Q1:     -16.780437922569
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.780437922569
Quadratic minimum step length (  0.511010999409) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.78043792256873 0.00000000000 0.00000012276 0.5110  0.738    8.00000000
      ideal mu1:      -0.515304460621
             Q0:     -16.780437922569
             G0:      -0.000000000000
   RMS gradient:       0.000000023104
     Trial step:       0.380941728161
             Q1:     -16.780437922569
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780437922569
  Cubic LS coeff:       0.529476260854
Predicted energy:     -16.780437922569
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.78043792256901 0.00000000000 0.00000001733 0.5295  0.020    8.00000000
      ideal mu1:      -0.515304457421
             Q0:     -16.780437922569
             G0:      -0.000000000000
   RMS gradient:       0.000000008802
     Trial step:       0.449109788170
             Q1:     -16.780437922569
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780437922569
  Cubic LS coeff:       0.384051350034
Predicted energy:     -16.780437922569
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.78043792256910 0.00000000000 0.00000000660 0.3841  0.145    8.00000000
      ideal mu1:      -0.515304454535
             Q0:     -16.780437922569
             G0:      -0.000000000000
   RMS gradient:       0.000000004612
     Trial step:       0.415308584621
             Q1:     -16.780437922569
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437922569
Quadratic minimum step length (  0.000784162211) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.78043792256934 0.00000000000 0.00000000346 0.0008  0.275    8.00000000
      ideal mu1:      -0.515304454533
             Q0:     -16.780437922569
             G0:      -0.000000000000
   RMS gradient:       0.000000004607
     Trial step:       0.018046309818
             Q1:     -16.780437922569
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.780437922569
Quadratic minimum step length (  0.000013433852) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.78043792256927 0.00000000000 0.00000000346 0.0000  0.998    8.00000000
      ideal mu1:      -0.515304454533
             Q0:     -16.780437922569
             G0:      -0.000000000000
   RMS gradient:       0.000000004607
     Trial step:       0.000492373291
             Q1:     -16.780437922569
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.780437922569
  Cubic LS coeff:       0.001220708042
Predicted energy:     -16.780437922569
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.78043792256926 0.00000000000 0.00000000346 0.0012  0.000    8.00000000
      ideal mu1:      -0.515304454531
10    -16.78043792256935 0.00000000000 0.00000000345 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000137070489              |
           | Maximum change in energy =  0.00000000625972 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87249062690705 |
           | Pseudopotential (local)    :      -46.08362041359332 |
           | Pseudopotential (non-local):       -3.19557809232510 |
           | Hartree                    :       19.81695504445551 |
           | Exchange-correlation       :       -4.12653433598432 |
           | Ewald                      :        5.93584924797084 |
           | Total                      :      -16.78043792256935 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08362041359412 |
           | Hartree                    :       19.81695504445609 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999725
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01011927468245    -16.47294192126821   0.246329    -16.73278747458063
   2     0.00279045416203    -16.73856698433397   0.371705    -16.76905394630145
   3     0.00126943183345    -16.77022966159097   0.370674    -16.77662574834886
   4     0.00072550431254    -16.77684354528312   0.427807    -16.77924468249665
   5     0.00043807122991    -16.77930618059534   0.313008    -16.77992497405472
   6     0.00028133485436    -16.77992513205293   0.436387    -16.78028098492181
   7     0.00018691423312    -16.78028172818035   0.375711    -16.78041715613214
   8     0.00007649166855    -16.78042009803668   0.201556    -16.78043250691050
   9     0.00004000370276    -16.78043318314057   0.256455    -16.78043741092148
  10     0.00001346920002    -16.78043774494816   0.071483    -16.78043788896041
  11     0.00000724797826    -16.78043790202166   0.032239    -16.78043791946840
  12     0.00000519807670    -16.78043792080083   0.006346    -16.78043792242832
  13     0.00000137070489    -16.78043792256935  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       6
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.314093879 Eh
                 Mid-gap level:      -0.104206431 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.969082172   1.0000000
                            2    -0.471838021   1.0000000
                            3    -0.359044255   1.0000000
                            4    -0.261253370   1.0000000
                        .......   --- gap ---   .........
                            5     0.052840509   0.0000000
                            6     0.141603039   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49640210  -0.08656464  -0.08398788 *
*    H       2     -1.16890358   0.92203758  -1.13126586 *
*    H       3     -1.12879005  -0.78711643   1.26718259 *
*                                                        *
**********************************************************
TOTAL:             -0.80129153   0.04835651   0.05192886
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77507393  -0.04409724  -0.02611752 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77507393  -0.04409724  -0.02611752
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00459117  -0.00048474  -0.00191466 *
*    H       2      0.00018041   0.00005391  -0.00004292 *
*    H       3      0.00017648  -0.00008497  -0.00003038 *
*                                                        *
**********************************************************
TOTAL:              0.00494806  -0.00051580  -0.00198796
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00708985   0.00124782   0.00794113 *
*    H       2     -0.00708985   0.00124782   0.00794113 *
*    H       3     -0.00708985   0.00124782   0.00794113 *
*                                                        *
**********************************************************
TOTAL:             -0.02126954   0.00374347   0.02382338

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01759231   0.00053625   0.01454483 *
*    H       2      0.00772631  -0.00985887   0.00090819 *
*    H       3      0.00986600   0.00932262  -0.01545303 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000  -0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1443.255s on      3 node(s)                                    
TOTAL TIME:      1443.256s on      3 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    52        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    25        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    15        0.01s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.01s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    12        0.01s   0.001%  ------ ||
|| integrals_brappd_ketppd              :    25        0.01s   0.001%  ------ ||
|| sparse_hotelling_invert              :    25        0.01s   0.001%  ------ ||
|| ngwf_gradient_coeffs                 :    13        0.01s   0.001%  ------ ||
|| basis_dot_function_with_box          :  2047        0.04s   0.003%  ------ ||
|| integrals_grad                       :     1        0.06s   0.004%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.06s   0.004%  ------ ||
|| lnv_gradient_norm                    :   130        0.09s   0.006%  ------ ||
|| basis_add_function_to_box            :  4056        0.09s   0.006%  ------ ||
|| kernel_fix                           :   130        0.09s   0.006%  ------ ||
|| kernel_purify                        :   417        0.11s   0.008%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.17s   0.012%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.17s   0.012%  ------ ||
|| sparse_trace                         :  3575        0.17s   0.012%  ------ ||
|| sparse_product                       :  4538        0.21s   0.014%  ------ ||
|| pseudo_make_structure_factor         :     1        0.24s   0.017%  ------ ||
|| density_initial_guess_real           :     1        0.24s   0.017%  ------ ||
|| basis_copy_function_to_box           :   930        0.52s   0.036%  ------ ||
|| density_batch_row_sums               :   286        0.60s   0.041%  ------ ||
|| fourier_apply_box_pair               :    86        0.60s   0.042%   9.640 ||
|| pseudopotentials_local_on_grid       :     1        0.77s   0.053%  ------ ||
|| integrals_kinetic                    :    25        0.84s   0.058%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.91s   0.063%  ------ ||
|| projectors_func_ovlp_box             :    25        1.34s   0.093%  ------ ||
|| projectors_init_fftbox_recip         :    41        1.39s   0.096%  ------ ||
|| forces_calculate                     :     1        1.45s   0.100%  ------ ||
|| projectors_gradient_batch            :    13        1.53s   0.106%  ------ ||
|| integrals_locpot_mat_els_batch       :   141        4.50s   0.312%  ------ ||
|| properties_calculate                 :     1        5.19s   0.360%  ------ ||
|| ngwf_gradient_batch                  :    13        9.43s   0.653%  ------ ||
|| ngwf_gradient_lnv                    :    13       10.27s   0.712%  ------ ||
|| cell_grid_extract_box                :   642       12.09s   0.838%  ------ ||
|| hamiltonian_energy_components        :     3       16.59s   1.149%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       34.55s   2.394%  ------ ||
|| cell_grid_deposit_box                :  1145       35.60s   2.467%  ------ ||
|| density_fftbox_deposit_to_cell       :  1144       35.61s   2.467%  ------ ||
|| density_fftbox_interpolate_multiply  :  1144       38.50s   2.667%  ------ ||
|| fourier_apply_box                    :  2152       39.86s   2.762%  17.702 ||
|| potential_apply_to_ngwf_batch        :   141       43.26s   2.998%  ------ ||
|| integrals_locpot_dbl_grid            :   141       47.85s   3.315%  ------ ||
|| density_batch_interp_deposit         :   286       78.49s   5.438%  ------ ||
|| density_on_dbl_grid                  :   286       88.81s   6.154%  ------ ||
|| hartree_on_grid                      :   286      214.08s  14.833%  ------ ||
|| fourier_apply_cell_backward          :  1431      496.46s  34.399%   3.216 ||
|| fourier_apply_cell_forward           :  1431      548.66s  38.016%   2.910 ||
|| xc_energy_potential                  :   286     1018.25s  70.552%  ------ ||
|| lnv_denskernel_optimise_cg           :    13     1296.37s  89.823%  ------ ||
|| ngwf_cg_optimise                     :     1     1395.54s  96.694%  ------ ||
|| total_time                           :     1     1443.25s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 23:09 (-0000)

