 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 10-03-2015 01:26 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on 1 processor.
There are   1 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 5 6.0                                                                     
H H 1 1 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         5         3
  H          2         2         0
.......   ......    ......    ......
Totals:      3         7         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   55 x  55 x  55
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):    132   132   132
         Recip-space ('23') slabs/node (min max mean):     67    67    67
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):    264   264   264
         Recip-space ('23') slabs/node (min max mean):    133   133   133
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      7;  min      7;  average      7
... Projector load balancing: max      3;  min      3;  average      3
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       9472      9472
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  55.10%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  3     2.00 4.00 0.00
Orbitals   (num,l):  3        0    1    0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3216.4518354715   -7.1202816974   10.1554512533   -2.4512395525
  2 1275.3268459984   -3.1443812453   13.3511488054   -3.1747088977
  3  655.6100215422   -2.9485004107   13.5591716205   -3.2265097030
  4  333.4383110991   -2.9071229743   13.6038731329   -3.2393597159
  5  165.9195334793   -2.8936012298   13.6186080893   -3.2442341554
  6   78.8111333398   -2.8876998472   13.6250676297   -3.2465384671
  7   33.5149711848   -2.8848489821   13.6281943061   -3.2476984221
  8    9.9610079041   -2.8834315976   13.6297503547   -3.2482910000
  9   -2.2870418903   -2.8827209226   13.6305310368   -3.2485948083
 10   -8.6560240825   -2.8823635388   13.6309238114   -3.2487507577
 11  -11.9678934703   -2.8821835875   13.6311216658   -3.2488308715
 12  -13.6900650503   -2.8820929160   13.6312213986   -3.2488720574
 13  -14.5855940943   -2.8820472100   13.6312716928   -3.2488932467
 14  -15.0512691430   -2.8820241631   13.6312970640   -3.2489041566
 15  -15.2934201584   -2.8820125389   13.6313098662   -3.2489097782
 16  -15.4193386906   -2.8820066745   13.6313163278   -3.2489126774
 17  -15.4848163341   -2.8820037152   13.6313195901   -3.2489141737
 18  -15.5188647147   -2.8820022215   13.6313212375   -3.2489149466
 19  -15.5365698769   -2.8820014674   13.6313220696   -3.2489153462
 20  -15.5457765642   -2.8820010866   13.6313224901   -3.2489155530
 21  -15.5505640434   -2.8820008943   13.6313227026   -3.2489156600
 22  -15.5530535338   -2.8820007971   13.6313228100   -3.2489157156
 23  -15.5543480695   -2.8820007479   13.6313228644   -3.2489157443
 24  -15.5550212284   -2.8820007231   13.6313228919   -3.2489157593
 25  -15.5553712713   -2.8820007105   13.6313229058   -3.2489157671
 26  -15.5555532937   -2.8820007042   13.6313229129   -3.2489157711
 27  -15.5556479455   -2.8820007009   13.6313229164   -3.2489157732
 28  -15.5556971644   -2.8820006993   13.6313229182   -3.2489157743
 29  -15.5557227583   -2.8820006985   13.6313229191   -3.2489157749
 30  -15.5557360672   -2.8820006981   13.6313229196   -3.2489157752
 31  -15.5557429878   -2.8820006979   13.6313229199   -3.2489157753
 32  -15.5557465865   -2.8820006978   13.6313229200   -3.2489157754
 33  -15.5557484578   -2.8820006977   13.6313229200   -3.2489157755
 34  -15.5557494309   -2.8820006977   13.6313229201   -3.2489157755
 35  -15.5557499369   -2.8820006977   13.6313229201   -3.2489157755
 36  -15.5557502000   -2.8820006976   13.6313229201   -3.2489157755
 37  -15.5557503369   -2.8820006976   13.6313229201   -3.2489157755
 38  -15.5557504080   -2.8820006976   13.6313229201   -3.2489157755
Atom SCF converged after  38 iterations to a total energy of    -15.55575041

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22861204E+01     0.88693634E+00
               2       0.20771591E+01     0.78909812E+00
               3       0.18090572E+01     0.63042331E+00
               4       0.15159622E+01     0.54099213E+00
               5       0.12979819E+01     0.48336738E+00
               6       0.11530326E+01     0.42155600E+00
               7       0.98559256E+00     0.33467223E+00
               8       0.79417736E+00     0.23345257E+00
               9       0.59064092E+00     0.17919327E+00
              10       0.34713548E+00     0.10557680E+00
              11       0.12050006E+00     0.36648999E-01
              12       0.14520265E-01     0.44162067E-02
              13       0.21083810E-03     0.64124492E-04
              14       0.44452705E-07     0.13519886E-07
              15       0.22566666E-14     0.11102230E-14
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.55834927341321    0.5090798
               2          -1.71648510660710    0.5215104
               3          -1.87815684196708    0.5338506
               4          -2.00977074687500    0.5285113
               5          -2.10184827003200    0.5148916
               6          -2.14968066882898    0.5043532
               7          -2.16342309521166    0.5002043
               8          -2.16473533369088    0.5000003
               9          -2.16474768386549    0.5000001
              10          -2.16474768497139    0.9208026
              11          -2.16474768497139    0.9208026
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.483184557687=    -16.483184557687+      0.000000000000
    Trial step:       1.000000000000
            G0:      -6.237425903660
WARNING: minimum value of charge density: -0.0668
      Q1=E1+P1:     122.047417623900=    -21.910506160400+    143.957923784299
Quadratic term:    -144.768028085247
   Linear term:      -6.237425903660
  Optimal step:       0.021542829540
 Predicted min:     -16.550370459191
    !!! Quadratic minimum step length accepted !!!
 1    -16.48318455768669 0.35678341637 0.03269377003 0.0215  0.000    8.00000000
WARNING: minimum value of charge density: -0.0002
      Q0=E0+P0:     -16.605008573496=    -16.617153666327+      0.012145092831
    Trial step:       0.146774757842
            G0:      -0.028597915152
WARNING: minimum value of charge density: -0.0002
      Q1=E1+P1:     -16.609068319459=    -16.621547928403+      0.012479608944
Quadratic term:      -0.000137706108
   Linear term:      -0.004197452071
  Optimal step:       2.236937847439
 Predicted min:     -16.636994452877
    !!! Quadratic minimum step length accepted !!!
 2    -16.61715366632716 0.28848746696 0.03531040232 2.2369 -0.803    8.00000000
      Q0=E0+P0:     -16.632672374640=    -16.666806623399+      0.034134248759
    Trial step:       0.572997391675
            G0:      -3.986319226650
WARNING: minimum value of charge density: -0.0141
      Q1=E1+P1:      -1.653504620790=    -19.372871445372+     17.719366824582
Quadratic term:     -17.263318273103
   Linear term:      -2.284150519253
  Optimal step:       0.037907320859
 Predicted min:     -16.708227715624
    !!! Quadratic minimum step length accepted !!!
 3    -16.66680662339864 0.28622295575 0.03380698441 0.0379  4.495    8.00000000
WARNING: minimum value of charge density: -0.0007

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.857658167541
   Final penalty energy   :       0.104680025811
   RMS occupancy error    :       0.061144
   Occupancy bounds       : [-0.080, 1.086]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.061144 (step -0.4083 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002570 (step -0.4981 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000021 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.554768156520
             Q0:     -16.485064716443
             G0:      -0.078524871140
   RMS gradient:       0.040031842209
     Trial step:       0.500000000000
             Q1:     -16.490976006592
 Quadratic coef:       0.033351145421
 Linear coef   :      -0.039262435570
           Qmin:     -16.496620083038
Quadratic minimum step length (  0.294310997973) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001177 (step -0.4975 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.48506471644293 0.00000000000 0.03502786166 0.2943  0.000    8.00000000
      ideal mu1:      -0.508783585116
             Q0:     -16.496570618770
             G0:      -0.000476964414
   RMS gradient:       0.003116096422
     Trial step:       0.383608523089
             Q1:     -16.496716474497
 Quadratic coef:       0.000037111887
 Linear coef   :      -0.000182967614
           Qmin:     -16.496796133763
Quadratic minimum step length (  0.945626070781) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000145 (step -0.4996 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.49657061877024 0.00144442082 0.00272658437 0.9456  0.006    8.00000000
      ideal mu1:      -0.509930195507
             Q0:     -16.496795570297
             G0:      -0.000028369963
   RMS gradient:       0.000762757276
     Trial step:       0.602287489831
             Q1:     -16.496802086948
 Quadratic coef:       0.000010570223
 Linear coef   :      -0.000017086874
           Qmin:     -16.496802475574
Quadratic minimum step length (  0.486801951892) accepted
    Initial Ne1:       8.00000029
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.49679557029691 0.00002842900 0.00066741265 0.4868  0.060    8.00000000
      ideal mu1:      -0.509864406696
             Q0:     -16.496802476634
             G0:      -0.000001728674
   RMS gradient:       0.000187813556
     Trial step:       0.541474584491
             Q1:     -16.496802761495
 Quadratic coef:       0.000000651172
 Linear coef   :      -0.000000936033
           Qmin:     -16.496802813011
Quadratic minimum step length (  0.389173714235) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.49680247663403 0.00000091150 0.00016433686 0.3892  0.061    8.00000000
      ideal mu1:      -0.509740732828
             Q0:     -16.496802813008
             G0:      -0.000000131093
   RMS gradient:       0.000051723537
     Trial step:       0.459050841640
             Q1:     -16.496802849420
 Quadratic coef:       0.000000023767
 Linear coef   :      -0.000000060178
           Qmin:     -16.496802851102
Quadratic minimum step length (  0.581170805422) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.49680281300795 0.00000004473 0.00004525809 0.5812  0.076    8.00000000
      ideal mu1:      -0.509773031716
             Q0:     -16.496802851102
             G0:      -0.000000019229
   RMS gradient:       0.000019809865
     Trial step:       0.516514227651
             Q1:     -16.496802858137
 Quadratic coef:       0.000000002897
 Linear coef   :      -0.000000009932
           Qmin:     -16.496802859615
Quadratic minimum step length (  0.885460545084) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.49680285110163 0.00000000515 0.00001733363 0.8855  0.147    8.00000000
      ideal mu1:      -0.509760737124
             Q0:     -16.496802859614
             G0:      -0.000000002932
   RMS gradient:       0.000007735091
     Trial step:       0.676278766160
             Q1:     -16.496802859613
 Quadratic coef:       0.000000001984
 Linear coef   :      -0.000000001983
           Qmin:     -16.496802860109
Quadratic minimum step length (  0.337864467076) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.49680285961417 0.00000000123 0.00000676820 0.3379  0.000    8.00000000
      ideal mu1:      -0.509766989514
             Q0:     -16.496802860109
             G0:      -0.000000000111
   RMS gradient:       0.000001506310
     Trial step:       0.478006867025
             Q1:     -16.496802860142
 Quadratic coef:       0.000000000021
 Linear coef   :      -0.000000000053
           Qmin:     -16.496802860143
Quadratic minimum step length (  0.610674374894) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.49680286010944 0.00000000006 0.00000131802 0.6107  0.038    8.00000000
      ideal mu1:      -0.509765672281
             Q0:     -16.496802860144
             G0:      -0.000000000029
   RMS gradient:       0.000000764347
     Trial step:       0.540283763143
             Q1:     -16.496802860152
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000016
           Qmin:     -16.496802860152
Quadratic minimum step length (  0.605347507123) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.49680286014362 0.00000000000 0.00000066880 0.6053  0.257    8.00000000
      ideal mu1:      -0.509766216320
10    -16.49680286015235 0.00000000000 0.00000026313 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01066990867773              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22030396E-01     0.13742866E-01
               2       0.26424212E-03     0.18209536E-03
               3       0.41393054E-07     0.32191760E-07
               4       0.16461420E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26565034E-01     0.16581496E-01
               2       0.38750706E-03     0.26368619E-03
               3       0.87745159E-07     0.66883215E-07
               4       0.51030836E-14     0.42188475E-14
================================================================================
RMS gradient                =       0.01066990867773
Trial step length           =               0.122474
Gradient along search dir.  =         -1.96602300012
Functional at step 0        =     -16.49680286015235
Functional at step 1        =     -16.67671662579834
Functional predicted        =     -16.73491272014384
Selected quadratic step     =               0.242225
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.10358075
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.008841 (step -0.4829 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000067 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513796652496
             Q0:     -16.734756438959
             G0:      -0.017641718302
   RMS gradient:       0.018974590045
     Trial step:       0.571891099037
             Q1:     -16.738293302405
 Quadratic coef:       0.006552278223
 Linear coef   :      -0.010089141669
           Qmin:     -16.738640232357
Quadratic minimum step length (  0.440296498477) accepted
    Initial Ne1:       7.99999960
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000644 (step -0.4986 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.73475643895944 0.00000000000 0.01660276553 0.4403  0.000    8.00000000
      ideal mu1:      -0.491392129360
             Q0:     -16.738636126639
             G0:      -0.001539248877
   RMS gradient:       0.005592282473
     Trial step:       0.501798414123
             Q1:     -16.738977278407
 Quadratic coef:       0.000431240877
 Linear coef   :      -0.000772392645
           Qmin:     -16.738981983461
Quadratic minimum step length (  0.449383888614) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000160 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.73863612663862 0.00048547417 0.00489324716 0.4494  0.087    8.00000000
      ideal mu1:      -0.496658813262
             Q0:     -16.738982468049
             G0:      -0.000191796906
   RMS gradient:       0.001978160275
     Trial step:       0.474868531952
             Q1:     -16.739040545478
 Quadratic coef:       0.000033000886
 Linear coef   :      -0.000091078315
           Qmin:     -16.739045309237
Quadratic minimum step length (  0.655288865853) accepted
    Initial Ne1:       8.00000036
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000058 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.73898246804852 0.00004716282 0.00173089028 0.6553  0.125    8.00000000
      ideal mu1:      -0.495835839967
             Q0:     -16.739045365896
             G0:      -0.000010010558
   RMS gradient:       0.000451691423
     Trial step:       0.557831571115
             Q1:     -16.739048501455
 Quadratic coef:       0.000002448646
 Linear coef   :      -0.000005584205
           Qmin:     -16.739048549630
Quadratic minimum step length (  0.636075176682) accepted
    Initial Ne1:       8.00000010
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.73904536589591 0.00000893409 0.00039523000 0.6361  0.052    8.00000000
      ideal mu1:      -0.495970729416
             Q0:     -16.739048549878
             G0:      -0.000000489625
   RMS gradient:       0.000099959303
     Trial step:       0.595670055614
             Q1:     -16.739048673730
 Quadratic coef:       0.000000167803
 Linear coef   :      -0.000000291655
           Qmin:     -16.739048676608
Quadratic minimum step length (  0.517660156929) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.73904854987826 0.00000042207 0.00008746439 0.5177  0.049    8.00000000
      ideal mu1:      -0.495879505076
             Q0:     -16.739048676608
             G0:      -0.000000133695
   RMS gradient:       0.000052233887
     Trial step:       0.555296906589
             Q1:     -16.739048720048
 Quadratic coef:       0.000000030800
 Linear coef   :      -0.000000074240
           Qmin:     -16.739048721344
Quadratic minimum step length (  0.669241561965) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.73904867660753 0.00000001667 0.00004570465 0.6692  0.273    8.00000000
      ideal mu1:      -0.495923192057
             Q0:     -16.739048721344
             G0:      -0.000000010200
   RMS gradient:       0.000014427749
     Trial step:       0.609612802621
             Q1:     -16.739048722565
 Quadratic coef:       0.000000004997
 Linear coef   :      -0.000000006218
           Qmin:     -16.739048723278
Quadratic minimum step length (  0.379279811702) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.73904872134414 0.00000000720 0.00001262428 0.3793  0.000    8.00000000
      ideal mu1:      -0.495911632699
             Q0:     -16.739048723278
             G0:      -0.000000000761
   RMS gradient:       0.000003942065
     Trial step:       0.480846991245
             Q1:     -16.739048723505
 Quadratic coef:       0.000000000140
 Linear coef   :      -0.000000000366
           Qmin:     -16.739048723518
Quadratic minimum step length (  0.629659850187) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.73904872327829 0.00000000024 0.00000344931 0.6297  0.075    8.00000000
      ideal mu1:      -0.495915981637
             Q0:     -16.739048723518
             G0:      -0.000000000157
   RMS gradient:       0.000001792478
     Trial step:       0.550245440208
             Q1:     -16.739048723554
 Quadratic coef:       0.000000000050
 Linear coef   :      -0.000000000087
           Qmin:     -16.739048723555
Quadratic minimum step length (  0.475908827600) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.73904872351789 0.00000000003 0.00000156842 0.4759  0.207    8.00000000
      ideal mu1:      -0.495914492090
10    -16.73904872355522 0.00000000001 0.00000043672 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00277980908974              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12535339E-01     0.58398155E-02
               2       0.91694627E-04     0.40623440E-04
               3       0.49657522E-08     0.20695577E-08
               4       0.13596691E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18534656E-01     0.88841855E-02
               2       0.20279953E-03     0.87784471E-04
               3       0.25497713E-07     0.92582051E-08
               4       0.93281035E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00277980908974
Trial step length           =               0.172239
Gradient along search dir.  =         -0.13583552778
Functional at step 0        =     -16.73904872355522
Functional at step 1        =     -16.75723588655163
Functional predicted        =     -16.76531948025228
Selected quadratic step     =               0.386802
Conjugate gradients coeff.  =               0.067875
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.03971874
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003631 (step -0.4903 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000019 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.502066634120
             Q0:     -16.765132691344
             G0:      -0.004198642800
   RMS gradient:       0.009256705016
     Trial step:       0.511729090771
             Q1:     -16.765812724897
 Quadratic coef:       0.001468534110
 Linear coef   :      -0.002148567663
           Qmin:     -16.765918567370
Quadratic minimum step length (  0.374347646757) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000117 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.76513269134434 0.00000000000 0.00809961685 0.3743  0.000    8.00000000
      ideal mu1:      -0.489772268127
             Q0:     -16.765918025241
             G0:      -0.000259244509
   RMS gradient:       0.002299239419
     Trial step:       0.437680912203
             Q1:     -16.765980158314
 Quadratic coef:       0.000051333300
 Linear coef   :      -0.000113466373
           Qmin:     -16.765980726343
Quadratic minimum step length (  0.483721733515) accepted
    Initial Ne1:       8.00000012
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000026 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.76591802524123 0.00009823450 0.00201183453 0.4837  0.062    8.00000000
      ideal mu1:      -0.490855454719
             Q0:     -16.765980736145
             G0:      -0.000012040525
   RMS gradient:       0.000495671129
     Trial step:       0.460125819290
             Q1:     -16.765984453234
 Quadratic coef:       0.000001823068
 Linear coef   :      -0.000005540157
           Qmin:     -16.765984945167
Quadratic minimum step length (  0.699142518008) accepted
    Initial Ne1:       7.99999993
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.76598073614533 0.00000832703 0.00043371223 0.6991  0.046    8.00000000
      ideal mu1:      -0.490813206587
             Q0:     -16.765984945381
             G0:      -0.000000878534
   RMS gradient:       0.000133895666
     Trial step:       0.567180327497
             Q1:     -16.765985213456
 Quadratic coef:       0.000000230212
 Linear coef   :      -0.000000498287
           Qmin:     -16.765985215013
Quadratic minimum step length (  0.613822978912) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.76598494538083 0.00000055220 0.00011715871 0.6138  0.073    8.00000000
      ideal mu1:      -0.490837452674
             Q0:     -16.765985215015
             G0:      -0.000000110518
   RMS gradient:       0.000047491591
     Trial step:       0.590040946210
             Q1:     -16.765985232774
 Quadratic coef:       0.000000047451
 Linear coef   :      -0.000000065210
           Qmin:     -16.765985237419
Quadratic minimum step length (  0.405432031603) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.76598521501498 0.00000003629 0.00004155514 0.4054  0.126    8.00000000
      ideal mu1:      -0.490818258530
             Q0:     -16.765985237419
             G0:      -0.000000000334
   RMS gradient:       0.000002609708
     Trial step:       0.489102749482
             Q1:     -16.765985237537
 Quadratic coef:       0.000000000045
 Linear coef   :      -0.000000000163
           Qmin:     -16.765985237567
Quadratic minimum step length (  0.887825451560) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.76598523741859 0.00000000318 0.00000228349 0.8878  0.003    8.00000000
      ideal mu1:      -0.490819832972
             Q0:     -16.765985237567
             G0:      -0.000000000074
   RMS gradient:       0.000001225134
     Trial step:       0.658967274922
             Q1:     -16.765985237573
 Quadratic coef:       0.000000000043
 Linear coef   :      -0.000000000048
           Qmin:     -16.765985237581
Quadratic minimum step length (  0.374465062851) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.76598523756687 0.00000000002 0.00000107199 0.3745  0.000    8.00000000
      ideal mu1:      -0.490818680162
             Q0:     -16.765985237580
             G0:      -0.000000000005
   RMS gradient:       0.000000314494
     Trial step:       0.496749657293
             Q1:     -16.765985237582
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.765985237585
Quadratic minimum step length (  1.811762415258) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.76598523758015 0.00000000000 0.00000027518 1.8118  0.066    8.00000000
      ideal mu1:      -0.490819527196
             Q0:     -16.765985237579
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000018
   RMS gradient:       0.000000614451
     Trial step:       0.948679270816
             Q1:     -16.765985237574
 Quadratic coef:       0.000000000022
 Linear coef   :      -0.000000000018
           Qmin:     -16.765985237582
Quadratic minimum step length (  0.373011066049) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.76598523757865 0.00000000000 0.00000053764 0.3730  3.817    8.00000000
      ideal mu1:      -0.490818807472
10    -16.76598523758198 0.00000000000 0.00000015472 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00143419430072              |
           | Maximum change in energy =  0.08074862113429 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17424026E-01     0.56367514E-02
               2       0.19067384E-03     0.58369816E-04
               3       0.24898510E-07     0.79453265E-08
               4       0.17660269E-14     0.74940054E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11756735E-01     0.37603902E-02
               2       0.88285758E-04     0.26018202E-04
               3       0.57669051E-08     0.17619511E-08
               4       0.10564452E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00143419430072
Trial step length           =               0.258113
Gradient along search dir.  =         -0.03642883176
Functional at step 0        =     -16.76598523758198
Functional at step 1        =     -16.77237338403470
Functional predicted        =     -16.77331716903568
Selected quadratic step     =               0.402535
Conjugate gradients coeff.  =               0.266187
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02047990
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002204 (step -0.4936 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.505505420756
             Q0:     -16.773247763490
             G0:      -0.001290969755
   RMS gradient:       0.005132866794
     Trial step:       0.594867940089
             Q1:     -16.773353125432
 Quadratic coef:       0.000662594576
 Linear coef   :      -0.000767956519
           Qmin:     -16.773470281616
Quadratic minimum step length (  0.344730193059) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000027 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77324776348969 0.00000000000 0.00449125844 0.3447  0.000    8.00000000
      ideal mu1:      -0.498605212745
             Q0:     -16.773469995197
             G0:      -0.000042707023
   RMS gradient:       0.000933737876
     Trial step:       0.452845381815
             Q1:     -16.773482398660
 Quadratic coef:       0.000006936216
 Linear coef   :      -0.000019339678
           Qmin:     -16.773483476005
Quadratic minimum step length (  0.631315720240) accepted
    Initial Ne1:       7.99999993
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77346999519727 0.00002781477 0.00081702064 0.6313  0.033    8.00000000
      ideal mu1:      -0.498725717535
             Q0:     -16.773483477579
             G0:      -0.000002485505
   RMS gradient:       0.000225190550
     Trial step:       0.534685335855
             Q1:     -16.773484311097
 Quadratic coef:       0.000000495444
 Linear coef   :      -0.000001328963
           Qmin:     -16.773484368770
Quadratic minimum step length (  0.717110600740) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77348347757901 0.00000174031 0.00019704173 0.7171  0.058    8.00000000
      ideal mu1:      -0.498773292631
             Q0:     -16.773484368780
             G0:      -0.000000164261
   RMS gradient:       0.000057898405
     Trial step:       0.619216054703
             Q1:     -16.773484422957
 Quadratic coef:       0.000000047537
 Linear coef   :      -0.000000101713
           Qmin:     -16.773484423189
Quadratic minimum step length (  0.662458823033) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77348436878043 0.00000011812 0.00005066110 0.6625  0.066    8.00000000
      ideal mu1:      -0.498761274162
             Q0:     -16.773484423188
             G0:      -0.000000005188
   RMS gradient:       0.000010289292
     Trial step:       0.640472590203
             Q1:     -16.773484423764
 Quadratic coef:       0.000000002747
 Linear coef   :      -0.000000003323
           Qmin:     -16.773484424193
Quadratic minimum step length (  0.387378716153) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77348442318848 0.00000000728 0.00000900313 0.3874  0.032    8.00000000
      ideal mu1:      -0.498757557859
             Q0:     -16.773484424193
             G0:      -0.000000000196
   RMS gradient:       0.000001999079
     Trial step:       0.498101846739
             Q1:     -16.773484424267
 Quadratic coef:       0.000000000024
 Linear coef   :      -0.000000000098
           Qmin:     -16.773484424294
Quadratic minimum step length (  1.026567114072) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77348442419315 0.00000000013 0.00000174919 1.0266  0.038    8.00000000
      ideal mu1:      -0.498758529900
             Q0:     -16.773484424293
             G0:      -0.000000000042
   RMS gradient:       0.000000921478
     Trial step:       0.715076901683
             Q1:     -16.773484424296
 Quadratic coef:       0.000000000027
 Linear coef   :      -0.000000000030
           Qmin:     -16.773484424301
Quadratic minimum step length (  0.394857111393) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77348442429301 0.00000000001 0.00000080629 0.3949  0.000    8.00000000
      ideal mu1:      -0.498757900058
             Q0:     -16.773484424301
             G0:      -0.000000000002
   RMS gradient:       0.000000220281
     Trial step:       0.531369174701
             Q1:     -16.773484424302
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.773484424302
Quadratic minimum step length (  0.755497399207) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77348442430121 0.00000000000 0.00000019275 0.7555  0.057    8.00000000
      ideal mu1:      -0.498758128046
             Q0:     -16.773484424302
             G0:      -0.000000000001
   RMS gradient:       0.000000120101
     Trial step:       0.633599265707
             Q1:     -16.773484424303
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.773484424302
  Cubic LS coeff:       0.764014479591
Predicted energy:     -16.773484424303
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77348442430206 0.00000000000 0.00000010509 0.7640  0.297    8.00000000
      ideal mu1:      -0.498757970784
10    -16.77348442430258 0.00000000000 0.00000006641 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00087000741717              |
           | Maximum change in energy =  0.00897883800892 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21137095E-01     0.65309794E-02
               2       0.28949238E-03     0.84212888E-04
               3       0.61688659E-07     0.18560770E-07
               4       0.32500997E-14     0.12212453E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.60086355E-02     0.22322876E-02
               2       0.23758541E-04     0.69677901E-05
               3       0.43702593E-09     0.11593948E-09
               4       0.11921173E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00087000741717
Trial step length           =               0.322335
Gradient along search dir.  =         -0.01336536739
Functional at step 0        =     -16.77348442430258
Functional at step 1        =     -16.77604945940739
Functional predicted        =     -16.77614635678671
Selected quadratic step     =               0.398333
Conjugate gradients coeff.  =               0.367985
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01071006
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001253 (step -0.4962 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511006727866
             Q0:     -16.776124736642
             G0:      -0.000302215756
   RMS gradient:       0.002483479111
     Trial step:       0.695757869707
             Q1:     -16.776123667604
 Quadratic coef:       0.000211338029
 Linear coef   :      -0.000210268991
           Qmin:     -16.776177037982
Quadratic minimum step length (  0.346119214804) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77612473664194 0.00000000000 0.00217304422 0.3461  0.000    8.00000000
      ideal mu1:      -0.507663448474
             Q0:     -16.776176980514
             G0:      -0.000006539005
   RMS gradient:       0.000365406366
     Trial step:       0.490729220198
             Q1:     -16.776178979186
 Quadratic coef:       0.000001210209
 Linear coef   :      -0.000003208881
           Qmin:     -16.776179107609
Quadratic minimum step length (  0.650586499813) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77617698051440 0.00000653767 0.00031973057 0.6506  0.022    8.00000000
      ideal mu1:      -0.507662274128
             Q0:     -16.776179107720
             G0:      -0.000000430618
   RMS gradient:       0.000093738004
     Trial step:       0.565032570499
             Q1:     -16.776179256212
 Quadratic coef:       0.000000094821
 Linear coef   :      -0.000000243313
           Qmin:     -16.776179263807
Quadratic minimum step length (  0.724943812803) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77617910771989 0.00000027150 0.00008202075 0.7249  0.066    8.00000000
      ideal mu1:      -0.507681091592
             Q0:     -16.776179263807
             G0:      -0.000000030441
   RMS gradient:       0.000024924804
     Trial step:       0.640013176439
             Q1:     -16.776179272937
 Quadratic coef:       0.000000010352
 Linear coef   :      -0.000000019483
           Qmin:     -16.776179272973
Quadratic minimum step length (  0.602233222279) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77617926380665 0.00000002082 0.00002180920 0.6022  0.071    8.00000000
      ideal mu1:      -0.507681764875
             Q0:     -16.776179272973
             G0:      -0.000000003424
   RMS gradient:       0.000008359899
     Trial step:       0.620835886163
             Q1:     -16.776179273635
 Quadratic coef:       0.000000001463
 Linear coef   :      -0.000000002126
           Qmin:     -16.776179273745
Quadratic minimum step length (  0.450933374480) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77617927297283 0.00000000123 0.00000731491 0.4509  0.112    8.00000000
      ideal mu1:      -0.507677424595
             Q0:     -16.776179273745
             G0:      -0.000000000039
   RMS gradient:       0.000000888500
     Trial step:       0.529108326475
             Q1:     -16.776179273760
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000020
           Qmin:     -16.776179273764
Quadratic minimum step length (  1.005388599203) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77617927374490 0.00000000011 0.00000077744 1.0054  0.011    8.00000000
      ideal mu1:      -0.507677960405
             Q0:     -16.776179273764
             G0:      -0.000000000013
   RMS gradient:       0.000000517633
     Trial step:       0.729355523172
             Q1:     -16.776179273765
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000010
           Qmin:     -16.776179273767
Quadratic minimum step length (  0.405003624823) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77617927376424 0.00000000000 0.00000045293 0.4050  0.000    8.00000000
      ideal mu1:      -0.507677581983
             Q0:     -16.776179273767
             G0:      -0.000000000001
   RMS gradient:       0.000000139557
     Trial step:       0.543499430238
             Q1:     -16.776179273767
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000001
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.776179273767
  Cubic LS coeff:       0.861487323816
Predicted energy:     -16.776179273768
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77617927376674 0.00000000000 0.00000012211 0.8615  0.073    8.00000000
      ideal mu1:      -0.507677722760
             Q0:     -16.776179273767
             G0:      -0.000000000000
   RMS gradient:       0.000000076714
     Trial step:       0.684264473469
             Q1:     -16.776179273767
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776179273767
Quadratic minimum step length (  0.643232802745) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77617927376728 0.00000000000 0.00000006712 0.6432  0.302    8.00000000
      ideal mu1:      -0.507677641298
10    -16.77617927376754 0.00000000000 0.00000002768 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00049941736170              |
           | Maximum change in energy =  0.00249972890687 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.90578132953963 |
           | Pseudopotential (local)    :      -46.15886171410042 |
           | Pseudopotential (non-local):       -3.19849186220917 |
           | Hartree                    :       19.87725836645228 |
           | Exchange-correlation       :       -4.13771464142066 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77617927376754 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.15886171410030 |
           | Hartree                    :       19.87725836645230 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999837
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.73054409E-02     0.23349440E-02
               2       0.31920161E-04     0.10300129E-04
               3       0.65278849E-09     0.22507324E-09
               4       0.12473808E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68201884E-03     0.22939826E-03
               2       0.28609639E-06     0.87755901E-07
               3       0.55805989E-13     0.18762769E-13
================================================================================
RMS gradient                =       0.00049941736170
Trial step length           =               0.358325
Gradient along search dir.  =         -0.00430719428
Functional at step 0        =     -16.77617927376754
Functional at step 1        =     -16.77688355036936
Functional predicted        =     -16.77688896585505
Selected quadratic step     =               0.329538
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99929219
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000140 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.509485330425
             Q0:     -16.776888882912
             G0:      -0.000003047691
   RMS gradient:       0.000249394817
     Trial step:       0.663431499922
             Q1:     -16.776889141257
 Quadratic coef:       0.000001763589
 Linear coef   :      -0.000002021934
           Qmin:     -16.776889462443
Quadratic minimum step length (  0.380308227157) accepted
    Initial Ne1:       7.99999948
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77688888291188 0.00000000000 0.00021822044 0.3803  0.000    8.00000000
      ideal mu1:      -0.509129130924
             Q0:     -16.776889462381
             G0:      -0.000000148463
   RMS gradient:       0.000055045025
     Trial step:       0.502303153062
             Q1:     -16.776889502781
 Quadratic coef:       0.000000034174
 Linear coef   :      -0.000000074573
           Qmin:     -16.776889503064
Quadratic minimum step length (  0.548061948602) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77688946238089 0.00000007244 0.00004816440 0.5481  0.049    8.00000000
      ideal mu1:      -0.509144089438
             Q0:     -16.776889503064
             G0:      -0.000000004970
   RMS gradient:       0.000010070921
     Trial step:       0.524683947587
             Q1:     -16.776889504618
 Quadratic coef:       0.000000001054
 Linear coef   :      -0.000000002608
           Qmin:     -16.776889504677
Quadratic minimum step length (  0.649006364608) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77688950306436 0.00000000533 0.00000881206 0.6490  0.033    8.00000000
      ideal mu1:      -0.509146810206
             Q0:     -16.776889504677
             G0:      -0.000000000281
   RMS gradient:       0.000002394440
     Trial step:       0.583543675650
             Q1:     -16.776889504770
 Quadratic coef:       0.000000000071
 Linear coef   :      -0.000000000164
           Qmin:     -16.776889504772
Quadratic minimum step length (  0.673622900193) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77688950467732 0.00000000021 0.00000209514 0.6736  0.057    8.00000000
      ideal mu1:      -0.509147263846
             Q0:     -16.776889504772
             G0:      -0.000000000055
   RMS gradient:       0.000001054242
     Trial step:       0.626967609356
             Q1:     -16.776889504787
 Quadratic coef:       0.000000000020
 Linear coef   :      -0.000000000034
           Qmin:     -16.776889504787
Quadratic minimum step length (  0.545071266196) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77688950477215 0.00000000001 0.00000092246 0.5451  0.194    8.00000000
      ideal mu1:      -0.509147112789
             Q0:     -16.776889504787
             G0:      -0.000000000001
   RMS gradient:       0.000000125933
     Trial step:       0.584587058269
             Q1:     -16.776889504787
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776889504787
Quadratic minimum step length (  0.672446511695) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77688950478704 0.00000000000 0.00000011019 0.6724  0.014    8.00000000
      ideal mu1:      -0.509147110934
             Q0:     -16.776889504787
             G0:      -0.000000000000
   RMS gradient:       0.000000075109
     Trial step:       0.626979687163
             Q1:     -16.776889504787
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776889504787
Quadratic minimum step length (  0.246662116114) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77688950478730 0.00000000000 0.00000006572 0.2467  0.000    8.00000000
      ideal mu1:      -0.509147111753
             Q0:     -16.776889504787
             G0:      -0.000000000000
   RMS gradient:       0.000000037785
     Trial step:       0.393258358329
             Q1:     -16.776889504787
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776889504787
Quadratic minimum step length (  0.024998087312) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77688950478739 0.00000000000 0.00000003306 0.0250  0.253    8.00000000
      ideal mu1:      -0.509147111823
             Q0:     -16.776889504787
             G0:      -0.000000000000
   RMS gradient:       0.000000035660
     Trial step:       0.099149920714
             Q1:     -16.776889504787
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776889504787
Quadratic minimum step length (  0.004084531291) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77688950478736 0.00000000000 0.00000003120 0.0041  0.891    8.00000000
      ideal mu1:      -0.509147111841
10    -16.77688950478723 0.00000000000 0.00000003076 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00028872705075              |
           | Maximum change in energy =  0.00089828315498 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.99657909E-02     0.33140461E-02
               2       0.62624464E-04     0.18796204E-04
               3       0.28315950E-08     0.91675073E-09
               4       0.18900304E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.29889345E-03     0.12647153E-03
               2       0.58044627E-07     0.21509722E-07
               3       0.33140029E-14     0.13322676E-14
================================================================================
RMS gradient                =       0.00028872705075
Trial step length           =               0.343630
Gradient along search dir.  =         -0.00144039519
Functional at step 0        =     -16.77688950478723
Functional at step 1        =     -16.77713069985632
Functional predicted        =     -16.77713085558439
Selected quadratic step     =               0.335117
Conjugate gradients coeff.  =               0.334232
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99852158
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000168 (step -0.5003 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511458655514
             Q0:     -16.777130622142
             G0:      -0.000005587481
   RMS gradient:       0.000337683614
     Trial step:       0.020124138581
             Q1:     -16.777130731611
 Quadratic coef:       0.000000002974
 Linear coef   :      -0.000000112443
           Qmin:     -16.777131685074
Quadratic minimum step length (  0.380469129355) accepted
    Initial Ne1:       7.99999993
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77713062214183 0.00000000000 0.00029547311 0.3805  0.000    8.00000000
      ideal mu1:      -0.510995679588
             Q0:     -16.777131685392
             G0:      -0.000000294066
   RMS gradient:       0.000077452964
     Trial step:       0.087502077033
             Q1:     -16.777131709417
 Quadratic coef:       0.000000001706
 Linear coef   :      -0.000000025731
           Qmin:     -16.777131782425
Quadratic minimum step length (  0.659941983505) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77713168539175 0.00000013287 0.00006777134 0.6599  0.053    8.00000000
      ideal mu1:      -0.511020430951
             Q0:     -16.777131782424
             G0:      -0.000000013048
   RMS gradient:       0.000016318078
     Trial step:       0.240304586468
             Q1:     -16.777131785006
 Quadratic coef:       0.000000000553
 Linear coef   :      -0.000000003135
           Qmin:     -16.777131786867
Quadratic minimum step length (  0.680997433904) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77713178242417 0.00000001277 0.00001427832 0.6810  0.044    8.00000000
      ideal mu1:      -0.511025134187
             Q0:     -16.777131786865
             G0:      -0.000000002106
   RMS gradient:       0.000006556501
     Trial step:       0.404532825294
             Q1:     -16.777131787417
 Quadratic coef:       0.000000000300
 Linear coef   :      -0.000000000852
           Qmin:     -16.777131787469
Quadratic minimum step length (  0.574162998761) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77713178686481 0.00000000058 0.00000573694 0.5742  0.161    8.00000000
      ideal mu1:      -0.511026769487
             Q0:     -16.777131787469
             G0:      -0.000000000201
   RMS gradient:       0.000002028340
     Trial step:       0.481941677040
             Q1:     -16.777131787522
 Quadratic coef:       0.000000000043
 Linear coef   :      -0.000000000097
           Qmin:     -16.777131787523
Quadratic minimum step length (  0.539046582827) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77713178746858 0.00000000009 0.00000177480 0.5390  0.096    8.00000000
      ideal mu1:      -0.511025833298
             Q0:     -16.777131787523
             G0:      -0.000000000002
   RMS gradient:       0.000000214289
     Trial step:       0.509695020704
             Q1:     -16.777131787523
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777131787524
Quadratic minimum step length (  0.965846197371) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77713178752259 0.00000000001 0.00000018750 0.9658  0.011    8.00000000
      ideal mu1:      -0.511025809699
             Q0:     -16.777131787524
             G0:      -0.000000000000
   RMS gradient:       0.000000049774
     Trial step:       0.701631668018
             Q1:     -16.777131787524
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777131787524
  Cubic LS coeff:       1.243329573745
Predicted energy:     -16.777131787524
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77713178752396 0.00000000000 0.00000004355 1.2433  0.000    8.00000000
      ideal mu1:      -0.511025870058
             Q0:     -16.777131787524
             G0:      -0.000000000000
   RMS gradient:       0.000000033367
     Trial step:       0.934001821584
             Q1:     -16.777131787524
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777131787524
Quadratic minimum step length (  0.201638586638) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77713178752393 0.00000000000 0.00000002920 0.2016  0.449    8.00000000
      ideal mu1:      -0.511025848715
             Q0:     -16.777131787524
             G0:      -0.000000000000
   RMS gradient:       0.000000018040
     Trial step:       0.433970975091
             Q1:     -16.777131787524
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777131787524
Quadratic minimum step length (  0.011488418995) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77713178752398 0.00000000000 0.00000001579 0.0115  0.292    8.00000000
      ideal mu1:      -0.511025847596
10    -16.77713178752408 0.00000000000 0.00000001509 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00011918019651              |
           | Maximum change in energy =  0.00023674367323 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.82821818E-02     0.29456621E-02
               2       0.45297706E-04     0.13989486E-04
               3       0.15747389E-08     0.48153170E-09
               4       0.14827817E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.32508922E-02     0.13335480E-02
               2       0.70877753E-05     0.25703222E-05
               3       0.38963599E-10     0.13647083E-10
               4       0.14050189E-14     0.77715612E-15
================================================================================
RMS gradient                =       0.00011918019651
Trial step length           =               0.339347
Gradient along search dir.  =         -0.00024616433
Functional at step 0        =     -16.77713178752408
Functional at step 1        =     -16.77715103475234
Functional predicted        =     -16.77715892372632
Selected quadratic step     =               0.220472
Conjugate gradients coeff.  =               0.170386
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99895631
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000099 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512042023597
             Q0:     -16.777158837719
             G0:      -0.000003083664
   RMS gradient:       0.000250862352
     Trial step:       0.070609067360
             Q1:     -16.777159034834
 Quadratic coef:       0.000000020620
 Linear coef   :      -0.000000217735
           Qmin:     -16.777159412519
Quadratic minimum step length (  0.372803179601) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77715883771932 0.00000000000 0.00021950455 0.3728  0.000    8.00000000
      ideal mu1:      -0.511707451307
             Q0:     -16.777159412581
             G0:      -0.000000085959
   RMS gradient:       0.000041880327
     Trial step:       0.162244521696
             Q1:     -16.777159424614
 Quadratic coef:       0.000000001913
 Linear coef   :      -0.000000013946
           Qmin:     -16.777159437999
Quadratic minimum step length (  0.591406088046) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77715941258069 0.00000007185 0.00003664529 0.5914  0.028    8.00000000
      ideal mu1:      -0.511712041709
             Q0:     -16.777159438001
             G0:      -0.000000005061
   RMS gradient:       0.000010162701
     Trial step:       0.309761840586
             Q1:     -16.777159439172
 Quadratic coef:       0.000000000397
 Linear coef   :      -0.000000001568
           Qmin:     -16.777159439548
Quadratic minimum step length (  0.611482908936) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77715943800099 0.00000000327 0.00000889236 0.6115  0.059    8.00000000
      ideal mu1:      -0.511710530065
             Q0:     -16.777159439547
             G0:      -0.000000000714
   RMS gradient:       0.000003818712
     Trial step:       0.435217269142
             Q1:     -16.777159439737
 Quadratic coef:       0.000000000121
 Linear coef   :      -0.000000000311
           Qmin:     -16.777159439747
Quadratic minimum step length (  0.558368153569) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77715943954719 0.00000000021 0.00000334137 0.5584  0.141    8.00000000
      ideal mu1:      -0.511713121251
             Q0:     -16.777159439746
             G0:      -0.000000000067
   RMS gradient:       0.000001169516
     Trial step:       0.492961928522
             Q1:     -16.777159439768
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000033
           Qmin:     -16.777159439771
Quadratic minimum step length (  0.734041058990) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77715943974646 0.00000000003 0.00000102333 0.7340  0.094    8.00000000
      ideal mu1:      -0.511712773735
             Q0:     -16.777159439771
             G0:      -0.000000000000
   RMS gradient:       0.000000083880
     Trial step:       0.601543261997
             Q1:     -16.777159439771
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159439771
Quadratic minimum step length (  1.425875409462) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77715943977059 0.00000000000 0.00000007340 1.4259  0.005    8.00000000
      ideal mu1:      -0.511712790225
             Q0:     -16.777159439771
             G0:      -0.000000000000
   RMS gradient:       0.000000052648
     Trial step:       0.926134841699
             Q1:     -16.777159439771
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159439771
  Cubic LS coeff:       1.168087194987
Predicted energy:     -16.777159439771
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77715943977067 0.00000000000 0.00000004607 1.1681  0.000    8.00000000
      ideal mu1:      -0.511712760839
             Q0:     -16.777159439771
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000084652
     Trial step:       1.040099153648
             Q1:     -16.777159439771
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159439771
Quadratic minimum step length (  0.441814127145) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77715943977077 0.00000000000 0.00000007407 0.4418  2.585    8.00000000
      ideal mu1:      -0.511712774135
             Q0:     -16.777159439771
             G0:      -0.000000000000
   RMS gradient:       0.000000012826
     Trial step:       0.677886789747
             Q1:     -16.777159439771
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159439771
Quadratic minimum step length (  0.017142233890) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77715943977098 0.00000000000 0.00000001122 0.0171  0.023    8.00000000
      ideal mu1:      -0.511712774262
10    -16.77715943977103 0.00000000000 0.00000001083 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001591086994              |
           | Maximum change in energy =  0.00008076091228 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.445552E-05
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.32987679E-02     0.10974777E-02
               2       0.65124924E-05     0.20731160E-05
               3       0.29571187E-10     0.10107248E-10
               4       0.11072701E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30367255E-02     0.10118558E-02
               2       0.54835061E-05     0.17481787E-05
               3       0.20863092E-10     0.71477824E-11
               4       0.12335628E-14     0.55511151E-15
================================================================================
RMS gradient                =       0.00001591086994
Trial step length           =               0.273526
Gradient along search dir.  =         -0.00000437175
Functional at step 0        =     -16.77715943977103
Functional at step 1        =     -16.77715247497605
Functional predicted        =     -16.77715948357636
Selected quadratic step     =               0.020040
Conjugate gradients coeff.  =              -0.017823
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00007294
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511659729031
             Q0:     -16.777159483006
             G0:      -0.000000018585
   RMS gradient:       0.000019475092
     Trial step:       0.107798394704
             Q1:     -16.777159484727
 Quadratic coef:       0.000000000283
 Linear coef   :      -0.000000002003
           Qmin:     -16.777159486557
Quadratic minimum step length (  0.382085233117) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77715948300623 0.00000000000 0.00001704071 0.3821  0.000    8.00000000
      ideal mu1:      -0.511685842821
             Q0:     -16.777159486555
             G0:      -0.000000000578
   RMS gradient:       0.000003436545
     Trial step:       0.202948699848
             Q1:     -16.777159486650
 Quadratic coef:       0.000000000022
 Linear coef   :      -0.000000000117
           Qmin:     -16.777159486708
Quadratic minimum step length (  0.529816423002) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77715948655492 0.00000000044 0.00000300698 0.5298  0.031    8.00000000
      ideal mu1:      -0.511685303300
             Q0:     -16.777159486709
             G0:      -0.000000000024
   RMS gradient:       0.000000693893
     Trial step:       0.327910893699
             Q1:     -16.777159486714
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000008
           Qmin:     -16.777159486716
Quadratic minimum step length (  0.593265434697) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77715948670879 0.00000000002 0.00000060716 0.5933  0.041    8.00000000
      ideal mu1:      -0.511685498476
             Q0:     -16.777159486717
             G0:      -0.000000000004
   RMS gradient:       0.000000264375
     Trial step:       0.441064846584
             Q1:     -16.777159486717
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777159486717
Quadratic minimum step length (  0.467955920151) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77715948671656 0.00000000000 0.00000023133 0.4680  0.145    8.00000000
      ideal mu1:      -0.511685362060
             Q0:     -16.777159486717
             G0:      -0.000000000000
   RMS gradient:       0.000000078900
     Trial step:       0.454311463788
             Q1:     -16.777159486718
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159486718
  Cubic LS coeff:       0.821229292290
Predicted energy:     -16.777159486718
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77715948671744 0.00000000000 0.00000006904 0.8212  0.089    8.00000000
      ideal mu1:      -0.511685310415
             Q0:     -16.777159486718
             G0:      -0.000000000000
   RMS gradient:       0.000000042690
     Trial step:       0.610814114020
             Q1:     -16.777159486718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159486718
Quadratic minimum step length (  0.077402584214) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77715948671770 0.00000000000 0.00000003735 0.0774  0.293    8.00000000
      ideal mu1:      -0.511685315244
             Q0:     -16.777159486718
             G0:      -0.000000000000
   RMS gradient:       0.000000035386
     Trial step:       0.217436406564
             Q1:     -16.777159486718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159486718
Quadratic minimum step length (  0.015702562725) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77715948671780 0.00000000000 0.00000003096 0.0157  0.000    8.00000000
      ideal mu1:      -0.511685316295
             Q0:     -16.777159486718
             G0:      -0.000000000000
   RMS gradient:       0.000000033927
     Trial step:       0.058432087185
             Q1:     -16.777159486718
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159486718
  Cubic LS coeff:       0.054256049522
Predicted energy:     -16.777159486718
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77715948671771 0.00000000000 0.00000002969 0.0543  0.919    8.00000000
      ideal mu1:      -0.511685323109
             Q0:     -16.777159486718
             G0:      -0.000000000000
   RMS gradient:       0.000000024498
     Trial step:       0.056305365783
             Q1:     -16.777159486718
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159486718
  Cubic LS coeff:       0.068097480611
Predicted energy:     -16.777159486718
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77715948671770 0.00000000000 0.00000002144 0.0681  0.521    8.00000000
      ideal mu1:      -0.511685330672
10    -16.77715948671772 0.00000000000 0.00000001241 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000606054880              |
           | Maximum change in energy =  0.00000921741565 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.588246E-06
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.98113188E-03     0.31961911E-03
               2       0.60499082E-06     0.18929125E-06
               3       0.26634458E-12     0.88651309E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.94423629E-03     0.30771828E-03
               2       0.56010686E-06     0.17532203E-06
               3       0.22816558E-12     0.75828233E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.24432619E-06     0.78767050E-07
               2       0.38007400E-13     0.11879386E-13
================================================================================
RMS gradient                =       0.00000606054880
Trial step length           =               0.074037
Gradient along search dir.  =         -0.00000063429
Functional at step 0        =     -16.77715948671772
Functional at step 1        =     -16.77715889807643
Rejected quadratic step     =               0.002735
Functional at new step 1    =     -16.77715948757946
Functional predicted        =     -16.77715948757950
Selected quadratic step     =               0.002717
Conjugate gradients coeff.  =               0.145090
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000991
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511678045814
             Q0:     -16.777159487571
             G0:      -0.000000000347
   RMS gradient:       0.000002660157
     Trial step:       0.061921349749
             Q1:     -16.777159487590
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000021
           Qmin:     -16.777159487632
Quadratic minimum step length (  0.357083628891) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77715948757056 0.00000000000 0.00000232764 0.3571  0.000    8.00000000
      ideal mu1:      -0.511681395551
             Q0:     -16.777159487637
             G0:      -0.000000000011
   RMS gradient:       0.000000467372
     Trial step:       0.148698017048
             Q1:     -16.777159487638
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.777159487639
Quadratic minimum step length (  0.459901645623) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77715948763651 0.00000000001 0.00000040895 0.4599  0.031    8.00000000
      ideal mu1:      -0.511681622897
             Q0:     -16.777159487639
             G0:      -0.000000000001
   RMS gradient:       0.000000128602
     Trial step:       0.261508054831
             Q1:     -16.777159487640
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487640
Quadratic minimum step length (  0.181927649571) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77715948763947 0.00000000000 0.00000011253 0.1819  0.076    8.00000000
      ideal mu1:      -0.511681594785
             Q0:     -16.777159487640
             G0:      -0.000000000001
   RMS gradient:       0.000000083997
     Trial step:       0.218118192179
             Q1:     -16.777159487640
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487640
Quadratic minimum step length (  0.097038589691) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77715948763964 0.00000000000 0.00000007350 0.0970  0.427    8.00000000
      ideal mu1:      -0.511681578908
             Q0:     -16.777159487640
             G0:      -0.000000000000
   RMS gradient:       0.000000063248
     Trial step:       0.145484988075
             Q1:     -16.777159487640
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487640
  Cubic LS coeff:       0.225729736168
Predicted energy:     -16.777159487640
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77715948763959 0.00000000000 0.00000005534 0.2257  0.567    8.00000000
      ideal mu1:      -0.511681546974
             Q0:     -16.777159487640
             G0:      -0.000000000000
   RMS gradient:       0.000000034252
     Trial step:       0.181218895192
             Q1:     -16.777159487640
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487640
Quadratic minimum step length (  0.045305818309) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77715948763987 0.00000000000 0.00000002997 0.0453  0.293    8.00000000
      ideal mu1:      -0.511681547194
             Q0:     -16.777159487640
             G0:      -0.000000000000
   RMS gradient:       0.000000031816
     Trial step:       0.090610542101
             Q1:     -16.777159487640
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487640
  Cubic LS coeff:      24.102637579520
Predicted energy:     -16.777159489555
WARNING in lnv_denskernel_optimise_cg: setting cubic step to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77715948763964 0.00000000000 0.00000002784 0.1500  0.000    8.00000000
      ideal mu1:      -0.511681553970
             Q0:     -16.777159487640
             G0:      -0.000000000000
   RMS gradient:       0.000000024375
     Trial step:       0.116582937496
             Q1:     -16.777159487640
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487640
Quadratic minimum step length (  0.002171486291) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77715948763983 0.00000000000 0.00000002133 0.0022  0.587    8.00000000
      ideal mu1:      -0.511681554079
             Q0:     -16.777159487640
             G0:      -0.000000000000
   RMS gradient:       0.000000024244
     Trial step:       0.015910947504
             Q1:     -16.777159487640
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487640
Quadratic minimum step length (  0.000256057631) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77715948763981 0.00000000000 0.00000002121 0.0003  0.989    8.00000000
      ideal mu1:      -0.511681554097
10    -16.77715948763976 0.00000000000 0.00000002119 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000232382379              |
           | Maximum change in energy =  0.00000001564890 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88315135789695 |
           | Pseudopotential (local)    :      -46.11579065980471 |
           | Pseudopotential (non-local):       -3.19321821876513 |
           | Hartree                    :       19.84415332014359 |
           | Exchange-correlation       :       -4.13130453508127 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77715948763975 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11579065980499 |
           | Hartree                    :       19.84415332014364 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999737
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.861946E-07
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19347323E-03     0.62480113E-04
               2       0.23772834E-07     0.73797130E-08
               3       0.10509619E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18802873E-03     0.60725548E-04
               2       0.22452666E-07     0.69703968E-08
               3       0.13250926E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23987103E-06     0.77299671E-07
               2       0.36697288E-13     0.11324275E-13
================================================================================
RMS gradient                =       0.00000232382379
Trial step length           =               0.014184
Gradient along search dir.  =         -0.00000009326
Functional at step 0        =     -16.77715948763976
Functional at step 1        =     -16.77715946540361
Rejected quadratic step     =               0.000398
Functional at new step 1    =     -16.77715948765747
Functional predicted        =     -16.77715948765751
Selected quadratic step     =               0.000381
Conjugate gradients coeff.  =               0.147022
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000139
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511680531645
             Q0:     -16.777159487657
             G0:      -0.000000000007
   RMS gradient:       0.000000383067
     Trial step:       0.002018444830
             Q1:     -16.777159487657
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487658
  Cubic LS coeff:       0.003745872277
Predicted energy:     -16.777159487658
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77715948765712 0.00000000000 0.00000033518 0.0037  0.000    8.00000000
      ideal mu1:      -0.511680536648
             Q0:     -16.777159487657
             G0:      -0.000000000014
   RMS gradient:       0.000000379310
     Trial step:       0.002749697534
             Q1:     -16.777159487657
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487657
Quadratic minimum step length (  0.000514825601) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77715948765747 0.00000000000 0.00000033190 0.0005  0.980    8.00000000
      ideal mu1:      -0.511680538002
             Q0:     -16.777159487658
             G0:      -0.000000000021
   RMS gradient:       0.000000378292
     Trial step:       0.001189796069
             Q1:     -16.777159487658
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487658
Quadratic minimum step length (  0.001042482872) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77715948765755 0.00000000000 0.00000033101 0.0010  0.995    8.00000000
      ideal mu1:      -0.511680542105
             Q0:     -16.777159487657
             G0:      -0.000000000027
   RMS gradient:       0.000000375212
     Trial step:       0.001113706435
             Q1:     -16.777159487658
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487658
  Cubic LS coeff:       0.001745743505
Predicted energy:     -16.777159487658
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77715948765742 0.00000000000 0.00000032831 0.0017  0.984    8.00000000
      ideal mu1:      -0.511680551144
             Q0:     -16.777159487658
             G0:      -0.000000000033
   RMS gradient:       0.000000368427
     Trial step:       0.001394362139
             Q1:     -16.777159487657
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487658
Quadratic minimum step length (  0.000287017354) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77715948765755 0.00000000000 0.00000032237 0.0003  0.964    8.00000000
      ideal mu1:      -0.511680552944
             Q0:     -16.777159487657
             G0:      -0.000000000039
   RMS gradient:       0.000000367076
     Trial step:       0.000632618472
             Q1:     -16.777159487658
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487658
  Cubic LS coeff:       0.000956994579
Predicted energy:     -16.777159487658
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77715948765740 0.00000000000 0.00000032119 0.0010  0.993    8.00000000
      ideal mu1:      -0.511680560127
             Q0:     -16.777159487657
             G0:      -0.000000000006
   RMS gradient:       0.000000361688
     Trial step:       0.000778082546
             Q1:     -16.777159487658
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487657
  Cubic LS coeff:       0.001070517100
Predicted energy:     -16.777159487658
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77715948765735 0.00000000000 0.00000031648 0.0011  0.000    8.00000000
      ideal mu1:      -0.511680561472
             Q0:     -16.777159487657
             G0:      -0.000000000013
   RMS gradient:       0.000000360678
     Trial step:       0.000912661312
             Q1:     -16.777159487657
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777159487657
Quadratic minimum step length (  0.000048142255) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77715948765744 0.00000000000 0.00000031559 0.0000  0.994    8.00000000
      ideal mu1:      -0.511680561593
             Q0:     -16.777159487657
             G0:      -0.000000000019
   RMS gradient:       0.000000360588
     Trial step:       0.000209612914
             Q1:     -16.777159487658
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777159487657
  Cubic LS coeff:       0.000186533756
Predicted energy:     -16.777159487658
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77715948765750 0.00000000000 0.00000031551 0.0002  0.999    8.00000000
      ideal mu1:      -0.511680562293
10    -16.77715948765769 0.00000000000 0.00000031505 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000052577798              |
           | Maximum change in energy =  0.00000000030735 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88315734291313 |
           | Pseudopotential (local)    :      -46.11580112140680 |
           | Pseudopotential (non-local):       -3.19322064645827 |
           | Hartree                    :       19.84416170928979 |
           | Exchange-correlation       :       -4.13130601996636 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77715948765769 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11580112140713 |
           | Hartree                    :       19.84416170929002 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999736
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01066990867773    -16.49680286015235   0.242225    -16.73491272014384
   2     0.00277980908974    -16.73904872355522   0.386802    -16.76531948025228
   3     0.00143419430072    -16.76598523758198   0.402535    -16.77331716903568
   4     0.00087000741717    -16.77348442430258   0.398333    -16.77614635678671
   5     0.00049941736170    -16.77617927376754   0.329538    -16.77688896585505
   6     0.00028872705075    -16.77688950478723   0.335117    -16.77713085558439
   7     0.00011918019651    -16.77713178752408   0.220472    -16.77715892372632
   8     0.00001591086994    -16.77715943977103   0.020040    -16.77715948357636
   9     0.00000606054880    -16.77715948671772   0.002717    -16.77715948757950
  10     0.00000232382379    -16.77715948763976   0.000381    -16.77715948765751
  11     0.00000052577798    -16.77715948765769  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       7
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.316154665 Eh
                 Mid-gap level:      -0.098668411 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.965617189   1.0000000
                            2    -0.468685297   1.0000000
                            3    -0.355674019   1.0000000
                            4    -0.256745744   1.0000000
                        .......   --- gap ---   .........
                            5     0.059408921   0.0000000
                            6     0.153671238   0.0000000
                            7     0.316568453   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49627942  -0.08643128  -0.08354821 *
*    H       2     -1.16910719   0.92218681  -1.13156778 *
*    H       3     -1.12893516  -0.78720901   1.26753163 *
*                                                        *
**********************************************************
TOTAL:             -0.80176293   0.04854652   0.05241564
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77370899  -0.04364584  -0.02326458 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77370899  -0.04364584  -0.02326458
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00496327  -0.00062722  -0.00268154 *
*    H       2      0.00024554   0.00008693  -0.00009621 *
*    H       3      0.00022294  -0.00014118  -0.00003070 *
*                                                        *
**********************************************************
TOTAL:              0.00543175  -0.00068148  -0.00280846
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00754073   0.00140640   0.00878087 *
*    H       2     -0.00754073   0.00140640   0.00878087 *
*    H       3     -0.00754073   0.00140640   0.00878087 *
*                                                        *
**********************************************************
TOTAL:             -0.02262219   0.00421921   0.02634260

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01825695   0.00081995   0.01623082 *
*    H       2      0.00803871  -0.00983520  -0.00028677 *
*    H       3      0.01021825   0.00901526  -0.01594405 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000  -0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    1345.242s on      1 node(s)                                    
TOTAL TIME:      1345.242s on      1 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    23        0.00s   0.000%  ------ ||
|| restart_kernel_write                 :    13        0.00s   0.000%  ------ ||
|| ngwf_gradient_coeffs                 :    11        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :   154        0.00s   0.000%  ------ ||
|| integrals_brappd_ketppd              :    23        0.00s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    10        0.00s   0.000%  ------ ||
|| sparse_hotelling_invert              :    23        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.00s   0.000%  ------ ||
|| kernel_purify                        :   356        0.02s   0.001%  ------ ||
|| lnv_gradient_norm                    :   110        0.02s   0.002%  ------ ||
|| kernel_fix                           :   110        0.02s   0.002%  ------ ||
|| sparse_trace                         :  3076        0.03s   0.002%  ------ ||
|| integrals_grad                       :     1        0.05s   0.004%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.05s   0.004%  ------ ||
|| sparse_product                       :  3900        0.06s   0.004%  ------ ||
|| integrals_locpot_mat_els_batch       :   121        0.07s   0.005%  ------ ||
|| basis_dot_function_with_box          :  7170        0.08s   0.006%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.09s   0.007%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.09s   0.007%  ------ ||
|| basis_add_function_to_box            : 14259        0.15s   0.011%  ------ ||
|| density_batch_row_sums               :   247        0.15s   0.011%  ------ ||
|| basis_copy_function_to_box           :  2814        0.39s   0.029%  ------ ||
|| pseudo_make_structure_factor         :     1        0.44s   0.033%  ------ ||
|| integrals_kinetic                    :    23        0.51s   0.038%  ------ ||
|| density_initial_guess_real           :     1        0.51s   0.038%  ------ ||
|| fourier_apply_box_pair               :   250        0.54s   0.040%   6.673 ||
|| projectors_func_ovlp_box             :    23        0.69s   0.051%  ------ ||
|| projectors_init_fftbox_recip         :    37        0.75s   0.056%  ------ ||
|| projectors_gradient_batch            :    11        0.94s   0.070%  ------ ||
|| pseudopotentials_local_on_grid       :     1        1.22s   0.091%  ------ ||
|| cell_grid_extract_box                :  1067        1.53s   0.114%  ------ ||
|| pseudo_local_calculate_forces        :     1        1.84s   0.137%  ------ ||
|| forces_calculate                     :     1        2.16s   0.161%  ------ ||
|| cell_grid_deposit_box                :  1732        3.04s   0.226%  ------ ||
|| density_fftbox_deposit_to_cell       :  1729        3.04s   0.226%  ------ ||
|| ngwf_gradient_batch                  :    11        5.40s   0.402%  ------ ||
|| properties_calculate                 :     1        5.53s   0.411%  ------ ||
|| ngwf_gradient_lnv                    :    11        5.89s   0.438%  ------ ||
|| hamiltonian_energy_components        :     3       18.51s   1.376%  ------ ||
|| potential_apply_to_ngwf_batch        :   121       24.93s   1.853%  ------ ||
|| integrals_locpot_dbl_grid            :   121       25.00s   1.859%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       37.61s   2.796%  ------ ||
|| density_fftbox_interpolate_multiply  :  1729       40.34s   2.998%  ------ ||
|| density_batch_interp_deposit         :   247       44.16s   3.283%  ------ ||
|| fourier_apply_box                    :  6126       44.77s   3.328%   9.676 ||
|| density_on_dbl_grid                  :   247       48.99s   3.642%  ------ ||
|| hartree_on_grid                      :   247      177.50s  13.194%  ------ ||
|| fourier_apply_cell_backward          :  1236      337.38s  25.080%   4.087 ||
|| fourier_apply_cell_forward           :  1236      523.91s  38.945%   2.632 ||
|| xc_energy_potential                  :   247     1042.13s  77.468%  ------ ||
|| lnv_denskernel_optimise_cg           :    11     1203.15s  89.438%  ------ ||
|| ngwf_cg_optimise                     :     1     1292.13s  96.052%  ------ ||
|| total_time                           :     1     1345.24s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 10-03-2015 01:49 (-0000)

