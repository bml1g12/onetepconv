 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 20:36 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on 1 processor.
There are   1 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 2 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         4         0
.......   ......    ......    ......
Totals:      3         8         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   55 x  55 x  55
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):    132   132   132
         Recip-space ('23') slabs/node (min max mean):     67    67    67
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):    264   264   264
         Recip-space ('23') slabs/node (min max mean):    133   133   133
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      8;  min      8;  average      8
... Projector load balancing: max      3;  min      3;  average      3
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):      10676     10676
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  37.50%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3216.4518354715   -7.1202816974   10.1554512533   -2.4512395525
  2 1275.3268459984   -3.1443812453   13.3511488054   -3.1747088977
  3  655.6100215422   -2.9485004107   13.5591716205   -3.2265097030
  4  333.4383110991   -2.9071229743   13.6038731329   -3.2393597159
  5  165.9195334793   -2.8936012298   13.6186080893   -3.2442341554
  6   78.8111333398   -2.8876998472   13.6250676297   -3.2465384671
  7   33.5149711848   -2.8848489821   13.6281943061   -3.2476984221
  8    9.9610079041   -2.8834315976   13.6297503547   -3.2482910000
  9   -2.2870418903   -2.8827209226   13.6305310368   -3.2485948083
 10   -8.6560240825   -2.8823635388   13.6309238114   -3.2487507577
 11  -11.9678934703   -2.8821835875   13.6311216658   -3.2488308715
 12  -13.6900650503   -2.8820929160   13.6312213986   -3.2488720574
 13  -14.5855940943   -2.8820472100   13.6312716928   -3.2488932467
 14  -15.0512691430   -2.8820241631   13.6312970640   -3.2489041566
 15  -15.2934201584   -2.8820125389   13.6313098662   -3.2489097782
 16  -15.4193386906   -2.8820066745   13.6313163278   -3.2489126774
 17  -15.4848163341   -2.8820037152   13.6313195901   -3.2489141737
 18  -15.5188647147   -2.8820022215   13.6313212375   -3.2489149466
 19  -15.5365698769   -2.8820014674   13.6313220696   -3.2489153462
 20  -15.5457765642   -2.8820010866   13.6313224901   -3.2489155530
 21  -15.5505640434   -2.8820008943   13.6313227026   -3.2489156600
 22  -15.5530535338   -2.8820007971   13.6313228100   -3.2489157156
 23  -15.5543480695   -2.8820007479   13.6313228644   -3.2489157443
 24  -15.5550212284   -2.8820007231   13.6313228919   -3.2489157593
 25  -15.5553712713   -2.8820007105   13.6313229058   -3.2489157671
 26  -15.5555532937   -2.8820007042   13.6313229129   -3.2489157711
 27  -15.5556479455   -2.8820007009   13.6313229164   -3.2489157732
 28  -15.5556971644   -2.8820006993   13.6313229182   -3.2489157743
 29  -15.5557227583   -2.8820006985   13.6313229191   -3.2489157749
 30  -15.5557360672   -2.8820006981   13.6313229196   -3.2489157752
 31  -15.5557429878   -2.8820006979   13.6313229199   -3.2489157753
 32  -15.5557465865   -2.8820006978   13.6313229200   -3.2489157754
 33  -15.5557484578   -2.8820006977   13.6313229200   -3.2489157755
 34  -15.5557494309   -2.8820006977   13.6313229201   -3.2489157755
 35  -15.5557499369   -2.8820006977   13.6313229201   -3.2489157755
 36  -15.5557502000   -2.8820006976   13.6313229201   -3.2489157755
 37  -15.5557503369   -2.8820006976   13.6313229201   -3.2489157755
 38  -15.5557504080   -2.8820006976   13.6313229201   -3.2489157755
Atom SCF converged after  38 iterations to a total energy of    -15.55575041

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  2     1.00 0.00
Orbitals   (num,l):  2        0    0
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    0   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.24229899E+01     0.87479084E+00
               2       0.21956295E+01     0.77130955E+00
               3       0.19289696E+01     0.61739698E+00
               4       0.16400215E+01     0.53537346E+00
               5       0.13343435E+01     0.47659432E+00
               6       0.10209171E+01     0.39485701E+00
               7       0.69142077E+00     0.27312783E+00
               8       0.33802597E+00     0.13149518E+00
               9       0.82416690E-01     0.30773943E-01
              10       0.51507345E-02     0.17392278E-02
              11       0.22618683E-04     0.80996448E-05
              12       0.49321547E-09     0.17981272E-09
              13       0.17164696E-14     0.13322676E-14
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -1.53120152253796    0.4704851
               2          -1.72170016894136    0.5038784
               3          -1.90380160242874    0.5333337
               4          -2.02679077485752    0.5272395
               5          -2.11243290555972    0.5132609
               6          -2.15870829987581    0.5040174
               7          -2.17291991537846    0.5002007
               8          -2.17448478223274    0.5000003
               9          -2.17450421926701    0.5000000
              10          -2.17450422227726    0.8903986
              11          -2.17450422227726    0.8903986
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.503582228924=    -16.503582228924+      0.000000000000
    Trial step:       1.000000000000
            G0:      -7.425519430764
WARNING: minimum value of charge density: -0.2468
      Q1=E1+P1:     150.838594932583=    -22.054233410006+    172.892828342588
Quadratic term:    -174.767696592271
   Linear term:      -7.425519430764
  Optimal step:       0.021243970069
 Predicted min:     -16.582455985190
    !!! Quadratic minimum step length accepted !!!
 1    -16.50358222892447 0.34062257868 0.03455934352 0.0212  0.000    8.00000000
WARNING: minimum value of charge density: -0.0002
      Q0=E0+P0:     -16.647372674268=    -16.661433863351+      0.014061189083
    Trial step:       0.145753113410
            G0:      -0.049618714236
WARNING: minimum value of charge density: -0.0003
      Q1=E1+P1:     -16.654392912807=    -16.669217431044+      0.014824518237
Quadratic term:      -0.000211843544
   Linear term:      -0.007232082083
  Optimal step:       2.487917401476
 Predicted min:     -16.709096305562
    !!! Quadratic minimum step length accepted !!!
 2    -16.66143386335097 0.27780029762 0.03974306006 2.4879 -0.808    8.00000000
WARNING: minimum value of charge density: -0.0008
      Q0=E0+P0:     -16.697843071804=    -16.764743328966+      0.066900257163
    Trial step:       0.602180792762
            G0:      -4.570847807507
WARNING: minimum value of charge density: -0.0331
      Q1=E1+P1:       4.065224209949=    -19.924098003823+     23.989322213773
Quadratic term:     -23.515544038074
   Linear term:      -2.752476756321
  Optimal step:       0.035242404609
 Predicted min:     -16.778386905723
    !!! Quadratic minimum step length accepted !!!
 3    -16.76474332896619 0.26917489669 0.05218268111 0.0352  4.388    8.00000000
WARNING: minimum value of charge density: -0.0011

======================== Penalty functional minimisation =======================
   Final total energy     :     -16.973890895510
   Final penalty energy   :       0.146361444094
   RMS occupancy error    :       0.067630
   Occupancy bounds       : [-0.080, 1.092]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.067630 (step -0.3995 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.002537 (step -0.4959 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.523292920533
             Q0:     -16.489485813986
             G0:      -0.195760260954
   RMS gradient:       0.055306003991
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000344 (step -0.4992 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.48948581398615 0.00000000000 0.05530600366 0.1000  0.000    8.00000000
      ideal mu1:      -0.505413698902
             Q0:     -16.505706681080
             G0:      -0.141067031466
   RMS gradient:       0.036464611027
     Trial step:       0.500000000000
             Q1:     -16.478183314452
 Quadratic coef:       0.098056882361
 Linear coef   :      -0.070533515733
           Qmin:     -16.518390586385
Quadratic minimum step length (  0.179828060089) accepted
    Initial Ne1:       8.00000071
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001845 (step -0.4959 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.50570668107977 0.00122350163 0.03646461241 0.1798  0.435    8.00000000
      ideal mu1:      -0.466981435564
             Q0:     -16.518290491624
             G0:      -0.001584554649
   RMS gradient:       0.004982629743
     Trial step:       0.299856682507
             Q1:     -16.518565158764
 Quadratic coef:       0.000200472160
 Linear coef   :      -0.000475139300
           Qmin:     -16.518572023676
Quadratic minimum step length (  0.355345336005) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000139 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.51829049162389 0.00263030578 0.00498262974 0.3553  0.019    8.00000000
      ideal mu1:      -0.464691055881
             Q0:     -16.518572608470
             G0:      -0.000123815162
   RMS gradient:       0.001388702978
     Trial step:       0.326424070189
             Q1:     -16.518603231772
 Quadratic coef:       0.000009792947
 Linear coef   :      -0.000040416249
           Qmin:     -16.518614308714
Quadratic minimum step length (  0.673588656815) accepted
    Initial Ne1:       8.00000063
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000033 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.51857260847009 0.00003690690 0.00138870302 0.6736  0.078    8.00000000
      ideal mu1:      -0.466273982300
             Q0:     -16.518614304862
             G0:      -0.000064700663
   RMS gradient:       0.001005788887
     Trial step:       0.468908894127
             Q1:     -16.518626487974
 Quadratic coef:       0.000018155604
 Linear coef   :      -0.000030338716
           Qmin:     -16.518626979154
Quadratic minimum step length (  0.391782438214) accepted
    Initial Ne1:       8.00000021
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.51861430486223 0.00000565115 0.00100578889 0.3918  0.525    8.00000000
      ideal mu1:      -0.465954316559
             Q0:     -16.518626983709
             G0:      -0.000003695821
   RMS gradient:       0.000240254385
     Trial step:       0.428614360283
             Q1:     -16.518627761847
 Quadratic coef:       0.000000805944
 Linear coef   :      -0.000001584082
           Qmin:     -16.518627762087
Quadratic minimum step length (  0.421220511120) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.51862698370936 0.00000248768 0.00024025438 0.4212  0.057    8.00000000
      ideal mu1:      -0.465800551543
             Q0:     -16.518627762113
             G0:      -0.000000461301
   RMS gradient:       0.000084898952
     Trial step:       0.424901353154
             Q1:     -16.518627844351
 Quadratic coef:       0.000000113769
 Linear coef   :      -0.000000196008
           Qmin:     -16.518627846536
Quadratic minimum step length (  0.366022534393) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.51862776211262 0.00000010605 0.00008489895 0.3660  0.000    8.00000000
      ideal mu1:      -0.465909107386
             Q0:     -16.518627846536
             G0:      -0.000000074530
   RMS gradient:       0.000034125313
     Trial step:       0.394364641098
             Q1:     -16.518627866798
 Quadratic coef:       0.000000009130
 Linear coef   :      -0.000000029392
           Qmin:     -16.518627870191
Quadratic minimum step length (  0.634770934539) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.51862784653644 0.00000001055 0.00003412531 0.6348  0.162    8.00000000
      ideal mu1:      -0.465920826495
             Q0:     -16.518627870191
             G0:      -0.000000012735
   RMS gradient:       0.000014105736
     Trial step:       0.500331102150
             Q1:     -16.518627874753
 Quadratic coef:       0.000000001810
 Linear coef   :      -0.000000006372
           Qmin:     -16.518627875798
Quadratic minimum step length (  0.880598595593) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.51862787019145 0.00000000343 0.00001410574 0.8806  0.171    8.00000000
      ideal mu1:      -0.465907564728
10    -16.51862787579826 0.00000000084 0.00000771674 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00968730100061              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20640479E-01     0.13390214E-01
               2       0.25270313E-03     0.17676797E-03
               3       0.40696264E-07     0.30920532E-07
               4       0.14150505E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23514707E-01     0.15032065E-01
               2       0.32393201E-03     0.22024251E-03
               3       0.65606466E-07     0.47758383E-07
               4       0.34121914E-14     0.25535130E-14
================================================================================
RMS gradient                =       0.00968730100061
Trial step length           =               0.122474
Gradient along search dir.  =         -1.85200740635
Functional at step 0        =     -16.51862787579826
Functional at step 1        =     -16.68675283984168
Functional predicted        =     -16.73775103114059
Selected quadratic step     =               0.236633
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.09644158
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.008505 (step -0.4821 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000058 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.483165061728
             Q0:     -16.737622479115
             G0:      -0.019293547702
   RMS gradient:       0.017362651953
     Trial step:       0.663770190567
             Q1:     -16.739908306351
 Quadratic coef:       0.010520654599
 Linear coef   :      -0.012806481835
           Qmin:     -16.741519717054
Quadratic minimum step length (  0.403993915407) accepted
    Initial Ne1:       7.99999960
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000549 (step -0.4988 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.73762247911470 0.00000000000 0.01736265122 0.4040  0.000    8.00000000
      ideal mu1:      -0.466532151719
             Q0:     -16.741502085050
             G0:      -0.000930733858
   RMS gradient:       0.003811119261
     Trial step:       0.517840823243
             Q1:     -16.741697189187
 Quadratic coef:       0.000286867850
 Linear coef   :      -0.000481971987
           Qmin:     -16.741704527566
Quadratic minimum step length (  0.435016978789) accepted
    Initial Ne1:       8.00000057
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000081 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.74150208504999 0.00048715474 0.00381112011 0.4350  0.048    8.00000000
      ideal mu1:      -0.468546267248
             Q0:     -16.741704713016
             G0:      -0.000150599407
   RMS gradient:       0.001533540022
     Trial step:       0.474625695070
             Q1:     -16.741746825317
 Quadratic coef:       0.000029366048
 Linear coef   :      -0.000071478348
           Qmin:     -16.741748208436
Quadratic minimum step length (  0.577630692551) accepted
    Initial Ne1:       8.00000021
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000032 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.74170471301604 0.00002655450 0.00153354002 0.5776  0.162    8.00000000
      ideal mu1:      -0.467339613682
             Q0:     -16.741748233212
             G0:      -0.000028685075
   RMS gradient:       0.000669140439
     Trial step:       0.523601345439
             Q1:     -16.741756930457
 Quadratic coef:       0.000006322299
 Linear coef   :      -0.000015019544
           Qmin:     -16.741757153492
Quadratic minimum step length (  0.621945709295) accepted
    Initial Ne1:       8.00000008
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.74174823321235 0.00000636448 0.00066914044 0.6219  0.190    8.00000000
      ideal mu1:      -0.467052636867
             Q0:     -16.741757155531
             G0:      -0.000003424224
   RMS gradient:       0.000231260153
     Trial step:       0.570658926310
             Q1:     -16.741758183423
 Quadratic coef:       0.000000926171
 Linear coef   :      -0.000001954064
           Qmin:     -16.741758186216
Quadratic minimum step length (  0.601996575382) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.74175715553088 0.00000136457 0.00023126015 0.6020  0.119    8.00000000
      ideal mu1:      -0.467294138364
             Q0:     -16.741758186245
             G0:      -0.000000307315
   RMS gradient:       0.000069297393
     Trial step:       0.586118349269
             Q1:     -16.741758303663
 Quadratic coef:       0.000000062705
 Linear coef   :      -0.000000180123
           Qmin:     -16.741758315598
Quadratic minimum step length (  0.841828580660) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.74175818624522 0.00000014773 0.00006929739 0.8418  0.090    8.00000000
      ideal mu1:      -0.467307742130
             Q0:     -16.741758315598
             G0:      -0.000000061880
   RMS gradient:       0.000031094515
     Trial step:       0.702432329882
             Q1:     -16.741758325967
 Quadratic coef:       0.000000033097
 Linear coef   :      -0.000000043466
           Qmin:     -16.741758329869
Quadratic minimum step length (  0.461245006345) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.74175831559819 0.00000001783 0.00003109452 0.4612  0.000    8.00000000
      ideal mu1:      -0.467282634354
             Q0:     -16.741758329869
             G0:      -0.000000014695
   RMS gradient:       0.000015152860
     Trial step:       0.569204185204
             Q1:     -16.741758333776
 Quadratic coef:       0.000000004457
 Linear coef   :      -0.000000008364
           Qmin:     -16.741758333793
Quadratic minimum step length (  0.534075467298) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.74175832986899 0.00000000178 0.00001515286 0.5341  0.237    8.00000000
      ideal mu1:      -0.467289347876
             Q0:     -16.741758333793
             G0:      -0.000000002304
   RMS gradient:       0.000006000385
     Trial step:       0.551360128410
             Q1:     -16.741758334605
 Quadratic coef:       0.000000000459
 Linear coef   :      -0.000000001271
           Qmin:     -16.741758334672
Quadratic minimum step length (  0.763397598320) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.74175833379278 0.00000000061 0.00000600038 0.7634  0.157    8.00000000
      ideal mu1:      -0.467287968717
10    -16.74175833467190 0.00000000013 0.00000237368 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00232652984677              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11369246E-01     0.53509404E-02
               2       0.77816523E-04     0.38738451E-04
               3       0.39811230E-08     0.20734697E-08
               4       0.82468227E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19735965E-01     0.92182610E-02
               2       0.22278186E-03     0.10925672E-03
               3       0.31854649E-07     0.16119538E-07
               4       0.15302722E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00232652984677
Trial step length           =               0.170240
Gradient along search dir.  =         -0.10885911460
Functional at step 0        =     -16.74175833467190
Functional at step 1        =     -16.75653309467883
Functional predicted        =     -16.76460940662594
Selected quadratic step     =               0.419828
Conjugate gradients coeff.  =               0.057678
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.04004542
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004122 (step -0.4895 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000028 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.491970126767
             Q0:     -16.764332987159
             G0:      -0.005368456036
   RMS gradient:       0.009158718555
     Trial step:       0.648773456484
             Q1:     -16.764653067704
 Quadratic coef:       0.003162831233
 Linear coef   :      -0.003482911779
           Qmin:     -16.765291833329
Quadratic minimum step length (  0.357214872802) accepted
    Initial Ne1:       7.99999992
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000125 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.76433298715878 0.00000000000 0.00915871849 0.3572  0.000    8.00000000
      ideal mu1:      -0.482805728273
             Q0:     -16.765289756203
             G0:      -0.000209345774
   RMS gradient:       0.001808978320
     Trial step:       0.481405782823
             Q1:     -16.765325933265
 Quadratic coef:       0.000064603205
 Linear coef   :      -0.000100780266
           Qmin:     -16.765329060221
Quadratic minimum step length (  0.375493776964) accepted
    Initial Ne1:       8.00000011
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.76528975620347 0.00011985577 0.00180897840 0.3755  0.039    8.00000000
      ideal mu1:      -0.483312495325
             Q0:     -16.765329063675
             G0:      -0.000007353599
   RMS gradient:       0.000338932600
     Trial step:       0.425164527736
             Q1:     -16.765331006588
 Quadratic coef:       0.000001183577
 Linear coef   :      -0.000003126490
           Qmin:     -16.765331128378
Quadratic minimum step length (  0.561548887726) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.76532906367549 0.00000510268 0.00033893260 0.5615  0.035    8.00000000
      ideal mu1:      -0.483228396899
             Q0:     -16.765331128443
             G0:      -0.000000822259
   RMS gradient:       0.000113344740
     Trial step:       0.488621190341
             Q1:     -16.765331374162
 Quadratic coef:       0.000000156054
 Linear coef   :      -0.000000401773
           Qmin:     -16.765331387041
Quadratic minimum step length (  0.628995332254) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.76533112844282 0.00000026755 0.00011334474 0.6290  0.112    8.00000000
      ideal mu1:      -0.483088088843
             Q0:     -16.765331387050
             G0:      -0.000000101419
   RMS gradient:       0.000039806123
     Trial step:       0.554382943429
             Q1:     -16.765331422707
 Quadratic coef:       0.000000020568
 Linear coef   :      -0.000000056225
           Qmin:     -16.765331425474
Quadratic minimum step length (  0.757727809077) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.76533138704982 0.00000003607 0.00003980612 0.7577  0.123    8.00000000
      ideal mu1:      -0.483117977138
             Q0:     -16.765331425474
             G0:      -0.000000003294
   RMS gradient:       0.000007174303
     Trial step:       0.648129133055
             Q1:     -16.765331426323
 Quadratic coef:       0.000000001286
 Linear coef   :      -0.000000002135
           Qmin:     -16.765331426360
Quadratic minimum step length (  0.538064040348) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.76533142547372 0.00000000546 0.00000717430 0.5381  0.032    8.00000000
      ideal mu1:      -0.483123135601
             Q0:     -16.765331426360
             G0:      -0.000000000494
   RMS gradient:       0.000002778106
     Trial step:       0.590537873467
             Q1:     -16.765331426424
 Quadratic coef:       0.000000000228
 Linear coef   :      -0.000000000292
           Qmin:     -16.765331426453
Quadratic minimum step length (  0.377649186216) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.76533142635994 0.00000000011 0.00000277811 0.3776  0.000    8.00000000
      ideal mu1:      -0.483120795741
             Q0:     -16.765331426453
             G0:      -0.000000000097
   RMS gradient:       0.000001229073
     Trial step:       0.472245854767
             Q1:     -16.765331426487
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000046
           Qmin:     -16.765331426497
Quadratic minimum step length (  0.902266563444) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.76533142645348 0.00000000001 0.00000122907 0.9023  0.196    8.00000000
      ideal mu1:      -0.483121433377
             Q0:     -16.765331426497
             G0:      -0.000000000008
   RMS gradient:       0.000000361714
     Trial step:       0.652756956670
             Q1:     -16.765331426499
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000005
           Qmin:     -16.765331426500
Quadratic minimum step length (  0.583302422573) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.76533142649708 0.00000000001 0.00000036171 0.5833  0.087    8.00000000
      ideal mu1:      -0.483121595229
10    -16.76533142649970 0.00000000000 0.00000013095 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00139332387227              |
           | Maximum change in energy =  0.07437681962454 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18055601E-01     0.62651183E-02
               2       0.19528409E-03     0.65396499E-04
               3       0.25194759E-07     0.83111716E-08
               4       0.14742341E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12207354E-01     0.39041550E-02
               2       0.83636312E-04     0.25315349E-04
               3       0.45460991E-08     0.12585851E-08
               4       0.92674815E-15     0.50480453E-15
================================================================================
RMS gradient                =       0.00139332387227
Trial step length           =               0.267341
Gradient along search dir.  =         -0.03945365057
Functional at step 0        =     -16.76533142649970
Functional at step 1        =     -16.77249168069247
Functional predicted        =     -16.77354227583039
Selected quadratic step     =               0.416228
Conjugate gradients coeff.  =               0.358663
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.02637151
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002652 (step -0.4928 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.509121203067
             Q0:     -16.773421405925
             G0:      -0.001698996278
   RMS gradient:       0.005152360317
     Trial step:       0.617053250682
             Q1:     -16.773528236326
 Quadratic coef:       0.000941540776
 Linear coef   :      -0.001048371176
           Qmin:     -16.773713236654
Quadratic minimum step length (  0.343533099499) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000035 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77342140592550 0.00000000000 0.00515236031 0.3435  0.000    8.00000000
      ideal mu1:      -0.503018384660
             Q0:     -16.773712841506
             G0:      -0.000042860184
   RMS gradient:       0.000818509967
     Trial step:       0.460410920551
             Q1:     -16.773720704336
 Quadratic coef:       0.000011870467
 Linear coef   :      -0.000019733297
           Qmin:     -16.773721042595
Quadratic minimum step length (  0.382690307021) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77371284150648 0.00003647884 0.00081850997 0.3827  0.025    8.00000000
      ideal mu1:      -0.502894807465
             Q0:     -16.773721042445
             G0:      -0.000001901631
   RMS gradient:       0.000172365804
     Trial step:       0.419755639082
             Q1:     -16.773721602293
 Quadratic coef:       0.000000238372
 Linear coef   :      -0.000000798220
           Qmin:     -16.773721710680
Quadratic minimum step length (  0.702802513189) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77372104244479 0.00000105061 0.00017236580 0.7028  0.044    8.00000000
      ideal mu1:      -0.502818302838
             Q0:     -16.773721710729
             G0:      -0.000000275070
   RMS gradient:       0.000065553782
     Trial step:       0.543143920220
             Q1:     -16.773721797745
 Quadratic coef:       0.000000062387
 Linear coef   :      -0.000000149403
           Qmin:     -16.773721800176
Quadratic minimum step length (  0.650351686500) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77372171072935 0.00000008733 0.00006555378 0.6504  0.145    8.00000000
      ideal mu1:      -0.502768748119
             Q0:     -16.773721800177
             G0:      -0.000000019630
   RMS gradient:       0.000017512985
     Trial step:       0.594335397337
             Q1:     -16.773721806552
 Quadratic coef:       0.000000005292
 Linear coef   :      -0.000000011667
           Qmin:     -16.773721806607
Quadratic minimum step length (  0.655182750635) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77372180017652 0.00000001287 0.00001751299 0.6552  0.071    8.00000000
      ideal mu1:      -0.502785010328
             Q0:     -16.773721806607
             G0:      -0.000000000262
   RMS gradient:       0.000002023557
     Trial step:       0.624017868676
             Q1:     -16.773721806686
 Quadratic coef:       0.000000000085
 Linear coef   :      -0.000000000164
           Qmin:     -16.773721806686
Quadratic minimum step length (  0.599038914209) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77372180660731 0.00000000087 0.00000202356 0.5990  0.013    8.00000000
      ideal mu1:      -0.502786528046
             Q0:     -16.773721806685
             G0:      -0.000000000074
   RMS gradient:       0.000001074995
     Trial step:       0.611400839465
             Q1:     -16.773721806700
 Quadratic coef:       0.000000000031
 Linear coef   :      -0.000000000045
           Qmin:     -16.773721806702
Quadratic minimum step length (  0.447749333291) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77372180668529 0.00000000001 0.00000107500 0.4477  0.000    8.00000000
      ideal mu1:      -0.502785554705
             Q0:     -16.773721806702
             G0:      -0.000000000024
   RMS gradient:       0.000000614638
     Trial step:       0.523215365069
             Q1:     -16.773721806711
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000013
           Qmin:     -16.773721806714
Quadratic minimum step length (  1.010239437998) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77372180670204 0.00000000000 0.00000061464 1.0102  0.327    8.00000000
      ideal mu1:      -0.502785803260
             Q0:     -16.773721806714
             G0:      -0.000000000002
   RMS gradient:       0.000000164413
     Trial step:       0.727030120668
             Q1:     -16.773721806714
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.773721806714
Quadratic minimum step length (  0.442461348068) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77372180671351 0.00000000000 0.00000016441 0.4425  0.072    8.00000000
      ideal mu1:      -0.502785810700
10    -16.77372180671385 0.00000000000 0.00000005790 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00081289216829              |
           | Maximum change in energy =  0.00785769727593 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18594250E-01     0.60169421E-02
               2       0.21095447E-03     0.59284092E-04
               3       0.29412368E-07     0.83640112E-08
               4       0.98435910E-15     0.43715032E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.37314446E-02     0.14985374E-02
               2       0.82496442E-05     0.30260130E-05
               3       0.46144888E-10     0.15666135E-10
               4       0.11486984E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00081289216829
Trial step length           =               0.333579
Gradient along search dir.  =         -0.01329626863
Functional at step 0        =     -16.77372180671385
Functional at step 1        =     -16.77625804465398
Functional predicted        =     -16.77631148055179
Selected quadratic step     =               0.389534
Conjugate gradients coeff.  =               0.340378
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00905534
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000891 (step -0.4974 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514592743347
             Q0:     -16.776298869784
             G0:      -0.000183806941
   RMS gradient:       0.001694692730
     Trial step:       0.567170809613
             Q1:     -16.776325362333
 Quadratic coef:       0.000077757382
 Linear coef   :      -0.000104249931
           Qmin:     -16.776333811958
Quadratic minimum step length (  0.380205172907) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77629886978352 0.00000000000 0.00169469273 0.3802  0.000    8.00000000
      ideal mu1:      -0.512063867421
             Q0:     -16.776333795471
             G0:      -0.000007930229
   RMS gradient:       0.000352003094
     Trial step:       0.464371915319
             Q1:     -16.776335727318
 Quadratic coef:       0.000001750728
 Linear coef   :      -0.000003682575
           Qmin:     -16.776335732003
Quadratic minimum step length (  0.488392359147) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77633379547107 0.00000436777 0.00035200309 0.4884  0.043    8.00000000
      ideal mu1:      -0.511915520419
             Q0:     -16.776335732020
             G0:      -0.000001392521
   RMS gradient:       0.000147503173
     Trial step:       0.476230716402
             Q1:     -16.776336122655
 Quadratic coef:       0.000000272527
 Linear coef   :      -0.000000663161
           Qmin:     -16.776336135451
Quadratic minimum step length (  0.579425501723) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77633573201991 0.00000025252 0.00014750317 0.5794  0.176    8.00000000
      ideal mu1:      -0.511830691485
             Q0:     -16.776336135459
             G0:      -0.000000099103
   RMS gradient:       0.000039349593
     Trial step:       0.525300125440
             Q1:     -16.776336171736
 Quadratic coef:       0.000000015781
 Linear coef   :      -0.000000052059
           Qmin:     -16.776336178391
Quadratic minimum step length (  0.866421060523) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77633613545854 0.00000005967 0.00003934959 0.8664  0.071    8.00000000
      ideal mu1:      -0.511844061545
             Q0:     -16.776336178391
             G0:      -0.000000002118
   RMS gradient:       0.000005753169
     Trial step:       0.674634042853
             Q1:     -16.776336178842
 Quadratic coef:       0.000000000978
 Linear coef   :      -0.000000001429
           Qmin:     -16.776336178913
Quadratic minimum step length (  0.493130730433) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77633617839089 0.00000000582 0.00000575317 0.4931  0.021    8.00000000
      ideal mu1:      -0.511843938617
             Q0:     -16.776336178913
             G0:      -0.000000000049
   RMS gradient:       0.000000871699
     Trial step:       0.576786596869
             Q1:     -16.776336178932
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000028
           Qmin:     -16.776336178934
Quadratic minimum step length (  0.843313939860) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77633617891337 0.00000000007 0.00000087170 0.8433  0.023    8.00000000
      ideal mu1:      -0.511844159999
             Q0:     -16.776336178934
             G0:      -0.000000000019
   RMS gradient:       0.000000540413
     Trial step:       0.697432561230
             Q1:     -16.776336178937
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000013
           Qmin:     -16.776336178938
Quadratic minimum step length (  0.436248274823) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77633617893424 0.00000000000 0.00000054041 0.4362  0.000    8.00000000
      ideal mu1:      -0.511843913725
             Q0:     -16.776336178938
             G0:      -0.000000000004
   RMS gradient:       0.000000244871
     Trial step:       0.551592015571
             Q1:     -16.776336178940
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.776336178940
Quadratic minimum step length (  1.249421176486) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77633617893803 0.00000000000 0.00000024487 1.2494  0.205    8.00000000
      ideal mu1:      -0.511844106722
             Q0:     -16.776336178940
             G0:      -0.000000000001
   RMS gradient:       0.000000184336
     Trial step:       0.830163083397
             Q1:     -16.776336178940
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.776336178940
Quadratic minimum step length (  0.500597963359) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77633617893964 0.00000000000 0.00000018434 0.5006  0.567    8.00000000
      ideal mu1:      -0.511843989534
10    -16.77633617894015 0.00000000000 0.00000009257 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00042186982699              |
           | Maximum change in energy =  0.00279679340472 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87359751028454 |
           | Pseudopotential (local)    :      -46.10799469208914 |
           | Pseudopotential (non-local):       -3.18956658445975 |
           | Hartree                    :       19.84176675900639 |
           | Exchange-correlation       :       -4.12998841965300 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77633617894015 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.10799469208897 |
           | Hartree                    :       19.84176675900635 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999973
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.70762879E-02     0.21378399E-02
               2       0.29186592E-04     0.83500177E-05
               3       0.56580246E-09     0.16020291E-09
               4       0.11345569E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10957871E-02     0.31805866E-03
               2       0.74613166E-06     0.21712334E-06
               3       0.39053981E-12     0.12478907E-12
================================================================================
RMS gradient                =       0.00042186982699
Trial step length           =               0.360472
Gradient along search dir.  =         -0.00351231987
Functional at step 0        =     -16.77633617894015
Functional at step 1        =     -16.77686696781187
Functional predicted        =     -16.77688118875116
Selected quadratic step     =               0.310342
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99779645
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000200 (step -0.5004 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511100304865
             Q0:     -16.776880697826
             G0:      -0.000003248458
   RMS gradient:       0.000225293491
     Trial step:       0.644653355536
             Q1:     -16.776881116442
 Quadratic coef:       0.000001675513
 Linear coef   :      -0.000002094129
           Qmin:     -16.776881352160
Quadratic minimum step length (  0.402857909913) accepted
    Initial Ne1:       8.00000026
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77688069782615 0.00000000000 0.00022529350 0.4029  0.000    8.00000000
      ideal mu1:      -0.511331869273
             Q0:     -16.776881352216
             G0:      -0.000000115190
   RMS gradient:       0.000042424299
     Trial step:       0.509611325845
             Q1:     -16.776881378829
 Quadratic coef:       0.000000032089
 Linear coef   :      -0.000000058702
           Qmin:     -16.776881379063
Quadratic minimum step length (  0.466130865329) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77688135221585 0.00000008179 0.00004242430 0.4661  0.035    8.00000000
      ideal mu1:      -0.511291426296
             Q0:     -16.776881379063
             G0:      -0.000000021987
   RMS gradient:       0.000018535131
     Trial step:       0.487386467085
             Q1:     -16.776881385954
 Quadratic coef:       0.000000003825
 Linear coef   :      -0.000000010716
           Qmin:     -16.776881386569
Quadratic minimum step length (  0.682761439775) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77688137906268 0.00000000347 0.00001853513 0.6828  0.191    8.00000000
      ideal mu1:      -0.511277863619
             Q0:     -16.776881386569
             G0:      -0.000000002508
   RMS gradient:       0.000006259339
     Trial step:       0.576861062990
             Q1:     -16.776881387307
 Quadratic coef:       0.000000000709
 Linear coef   :      -0.000000001447
           Qmin:     -16.776881387307
Quadratic minimum step length (  0.588874684829) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77688138656909 0.00000000112 0.00000625934 0.5889  0.114    8.00000000
      ideal mu1:      -0.511280879686
             Q0:     -16.776881387308
             G0:      -0.000000000150
   RMS gradient:       0.000001529100
     Trial step:       0.582836921152
             Q1:     -16.776881387352
 Quadratic coef:       0.000000000042
 Linear coef   :      -0.000000000087
           Qmin:     -16.776881387352
Quadratic minimum step length (  0.599482970613) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77688138730755 0.00000000010 0.00000152910 0.5995  0.060    8.00000000
      ideal mu1:      -0.511281349798
             Q0:     -16.776881387353
             G0:      -0.000000000003
   RMS gradient:       0.000000226348
     Trial step:       0.591101352456
             Q1:     -16.776881387353
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.776881387353
Quadratic minimum step length (  0.412927103359) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77688138735277 0.00000000001 0.00000022635 0.4129  0.022    8.00000000
      ideal mu1:      -0.511281388698
             Q0:     -16.776881387354
             G0:      -0.000000000000
   RMS gradient:       0.000000083027
     Trial step:       0.494046322991
             Q1:     -16.776881387353
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776881387354
Quadratic minimum step length (  0.122221264098) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77688138735353 0.00000000000 0.00000008303 0.1222  0.000    8.00000000
      ideal mu1:      -0.511281394235
             Q0:     -16.776881387354
             G0:      -0.000000000001
   RMS gradient:       0.000000071692
     Trial step:       0.245729457166
             Q1:     -16.776881387354
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776881387354
Quadratic minimum step length (  0.086627767512) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77688138735360 0.00000000000 0.00000007169 0.0866  0.746    8.00000000
      ideal mu1:      -0.511281400179
             Q0:     -16.776881387354
             G0:      -0.000000000001
   RMS gradient:       0.000000060066
     Trial step:       0.145900631548
             Q1:     -16.776881387354
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.776881387354
Quadratic minimum step length (  0.054799429862) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77688138735360 0.00000000000 0.00000006007 0.0548  0.702    8.00000000
      ideal mu1:      -0.511281404116
10    -16.77688138735373 0.00000000000 0.00000005255 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00022261988504              |
           | Maximum change in energy =  0.00087145740877 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.84153621E-02     0.26793356E-02
               2       0.42369344E-04     0.12940736E-04
               3       0.12592778E-08     0.39833503E-09
               4       0.10849987E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.98947083E-03     0.31539462E-03
               2       0.63153519E-06     0.21586782E-06
               3       0.30091794E-12     0.10347279E-12
================================================================================
RMS gradient                =       0.00022261988504
Trial step length           =               0.334469
Gradient along search dir.  =         -0.00097827866
Functional at step 0        =     -16.77688138735373
Functional at step 1        =     -16.77702638202167
Functional predicted        =     -16.77702828221807
Selected quadratic step     =               0.300313
Conjugate gradients coeff.  =               0.278465
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99764618
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000218 (step -0.5004 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511263124417
             Q0:     -16.777027724921
             G0:      -0.000001381803
   RMS gradient:       0.000146937654
     Trial step:       0.089416281657
             Q1:     -16.777027835572
 Quadratic coef:       0.000000012904
 Linear coef   :      -0.000000123556
           Qmin:     -16.777028020671
Quadratic minimum step length (  0.428064203221) accepted
    Initial Ne1:       7.99999975
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77702772492099 0.00000000000 0.00014693758 0.4281  0.000    8.00000000
      ideal mu1:      -0.511456476513
             Q0:     -16.777028020639
             G0:      -0.000000035720
   RMS gradient:       0.000023626681
     Trial step:       0.195642299523
             Q1:     -16.777028026626
 Quadratic coef:       0.000000001001
 Linear coef   :      -0.000000006988
           Qmin:     -16.777028032839
Quadratic minimum step length (  0.683091953506) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77702802063882 0.00000003697 0.00002362668 0.6831  0.026    8.00000000
      ideal mu1:      -0.511459731507
             Q0:     -16.777028032841
             G0:      -0.000000006524
   RMS gradient:       0.000010095355
     Trial step:       0.365570349686
             Q1:     -16.777028034276
 Quadratic coef:       0.000000000949
 Linear coef   :      -0.000000002385
           Qmin:     -16.777028034338
Quadratic minimum step length (  0.459210648848) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77702803284062 0.00000000156 0.00001009535 0.4592  0.183    8.00000000
      ideal mu1:      -0.511468711487
             Q0:     -16.777028034339
             G0:      -0.000000001059
   RMS gradient:       0.000004068197
     Trial step:       0.409724050403
             Q1:     -16.777028034656
 Quadratic coef:       0.000000000116
 Linear coef   :      -0.000000000434
           Qmin:     -16.777028034743
Quadratic minimum step length (  0.763882910016) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77702803433881 0.00000000022 0.00000406820 0.7639  0.162    8.00000000
      ideal mu1:      -0.511467326974
             Q0:     -16.777028034744
             G0:      -0.000000000057
   RMS gradient:       0.000000946517
     Trial step:       0.559447227114
             Q1:     -16.777028034760
 Quadratic coef:       0.000000000017
 Linear coef   :      -0.000000000032
           Qmin:     -16.777028034760
Quadratic minimum step length (  0.535247381579) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77702803474440 0.00000000006 0.00000094652 0.5352  0.054    8.00000000
      ideal mu1:      -0.511466817620
             Q0:     -16.777028034760
             G0:      -0.000000000002
   RMS gradient:       0.000000168660
     Trial step:       0.547213544646
             Q1:     -16.777028034760
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777028034760
Quadratic minimum step length (  0.490244633571) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77702803475987 0.00000000000 0.00000016866 0.4902  0.032    8.00000000
      ideal mu1:      -0.511466780897
             Q0:     -16.777028034760
             G0:      -0.000000000000
   RMS gradient:       0.000000084276
     Trial step:       0.517946429353
             Q1:     -16.777028034761
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777028034761
  Cubic LS coeff:       0.950845715605
Predicted energy:     -16.777028034761
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77702803476027 0.00000000000 0.00000008428 0.9508  0.000    8.00000000
      ideal mu1:      -0.511466775458
             Q0:     -16.777028034761
             G0:      -0.000000000000
   RMS gradient:       0.000000041421
     Trial step:       0.701774282276
             Q1:     -16.777028034761
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777028034761
  Cubic LS coeff:       0.895226031321
Predicted energy:     -16.777028034761
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77702803476061 0.00000000000 0.00000004142 0.8952  0.242    8.00000000
      ideal mu1:      -0.511466765250
             Q0:     -16.777028034761
             G0:      -0.000000000000
   RMS gradient:       0.000000035320
     Trial step:       0.792620089075
             Q1:     -16.777028034761
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777028034761
  Cubic LS coeff:       1.064144722486
Predicted energy:     -16.777028034761
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77702803476065 0.00000000000 0.00000003532 1.0641  0.727    8.00000000
      ideal mu1:      -0.511466745959
10    -16.77702803476059 0.00000000000 0.00000003330 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00007503890669              |
           | Maximum change in energy =  0.00018173613786 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.62970803E-02     0.22239497E-02
               2       0.22690439E-04     0.74943484E-05
               3       0.36251159E-09     0.11417312E-09
               4       0.11907719E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.32977548E-02     0.11284420E-02
               2       0.65862390E-05     0.22323495E-05
               3       0.31978506E-10     0.10579426E-10
               4       0.12415886E-14     0.50653925E-15
================================================================================
RMS gradient                =       0.00007503890669
Trial step length           =               0.316931
Gradient along search dir.  =         -0.00011094138
Functional at step 0        =     -16.77702803476059
Functional at step 1        =     -16.77702860012867
Functional predicted        =     -16.77703696860965
Selected quadratic step     =               0.161055
Conjugate gradients coeff.  =               0.113617
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99896255
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000087 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511680954507
             Q0:     -16.777036889737
             G0:      -0.000000509312
   RMS gradient:       0.000089207630
     Trial step:       0.918402136716
             Q1:     -16.777036918051
 Quadratic coef:       0.000000439439
 Linear coef   :      -0.000000467753
           Qmin:     -16.777037014210
Quadratic minimum step length (  0.488788580493) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703688973704 0.00000000000 0.00008920763 0.4888  0.000    8.00000000
      ideal mu1:      -0.511720683030
             Q0:     -16.777037014213
             G0:      -0.000000055495
   RMS gradient:       0.000029446582
     Trial step:       0.670003340833
             Q1:     -16.777037027487
 Quadratic coef:       0.000000023908
 Linear coef   :      -0.000000037182
           Qmin:     -16.777037028670
Quadratic minimum step length (  0.521006009703) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703701421311 0.00000001556 0.00002944658 0.5210  0.109    8.00000000
      ideal mu1:      -0.511754351939
             Q0:     -16.777037028670
             G0:      -0.000000009418
   RMS gradient:       0.000012130908
     Trial step:       0.590826342587
             Q1:     -16.777037031470
 Quadratic coef:       0.000000002765
 Linear coef   :      -0.000000005564
           Qmin:     -16.777037031470
Quadratic minimum step length (  0.594494769179) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703702867013 0.00000000200 0.00001213091 0.5945  0.170    8.00000000
      ideal mu1:      -0.511747864626
             Q0:     -16.777037031469
             G0:      -0.000000001201
   RMS gradient:       0.000004331181
     Trial step:       0.592657717542
             Q1:     -16.777037031870
 Quadratic coef:       0.000000000311
 Linear coef   :      -0.000000000712
           Qmin:     -16.777037031877
Quadratic minimum step length (  0.678796718665) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703703146941 0.00000000042 0.00000433118 0.6788  0.127    8.00000000
      ideal mu1:      -0.511751134811
             Q0:     -16.777037031877
             G0:      -0.000000000076
   RMS gradient:       0.000001090069
     Trial step:       0.634266595336
             Q1:     -16.777037031895
 Quadratic coef:       0.000000000030
 Linear coef   :      -0.000000000048
           Qmin:     -16.777037031896
Quadratic minimum step length (  0.510327097095) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703703187701 0.00000000006 0.00000109007 0.5103  0.063    8.00000000
      ideal mu1:      -0.511749975268
             Q0:     -16.777037031897
             G0:      -0.000000000002
   RMS gradient:       0.000000158622
     Trial step:       0.568931832808
             Q1:     -16.777037031897
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777037031897
Quadratic minimum step length (  0.471533548637) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703703189659 0.00000000000 0.00000015862 0.4715  0.021    8.00000000
      ideal mu1:      -0.511749913088
             Q0:     -16.777037031897
             G0:      -0.000000000000
   RMS gradient:       0.000000068330
     Trial step:       0.517948304425
             Q1:     -16.777037031897
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777037031897
Quadratic minimum step length (  0.121310923982) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703703189716 0.00000000000 0.00000006833 0.1213  0.000    8.00000000
      ideal mu1:      -0.511749912804
             Q0:     -16.777037031897
             G0:      -0.000000000000
   RMS gradient:       0.000000060872
     Trial step:       0.250664691141
             Q1:     -16.777037031897
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777037031898
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  3.961560395814)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703703189687 0.00000000000 0.00000006087 0.1500  0.000    8.00000000
      ideal mu1:      -0.511749911681
             Q0:     -16.777037031897
             G0:      -0.000000000000
   RMS gradient:       0.000000046530
     Trial step:       0.193906430195
             Q1:     -16.777037031897
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777037031897
  Cubic LS coeff:       0.363525826343
Predicted energy:     -16.777037031897
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703703189699 0.00000000000 0.00000004653 0.3635  0.584    8.00000000
      ideal mu1:      -0.511749906140
10    -16.77703703189706 0.00000000000 0.00000002380 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00003299059762              |
           | Maximum change in energy =  0.00004888246895 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44336032E-02     0.16569467E-02
               2       0.10659705E-04     0.36320132E-05
               3       0.77300025E-10     0.23392066E-10
               4       0.10014806E-14     0.76674778E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31985885E-02     0.11822176E-02
               2       0.57197719E-05     0.19519071E-05
               3       0.22883358E-10     0.71314621E-11
               4       0.99922850E-15     0.66613381E-15
================================================================================
RMS gradient                =       0.00003299059762
Trial step length           =               0.225928
Gradient along search dir.  =         -0.00002163112
Functional at step 0        =     -16.77703703189706
Functional at step 1        =     -16.77703365464305
Functional predicted        =     -16.77703775438475
Selected quadratic step     =               0.066801
Conjugate gradients coeff.  =               0.193289
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99955816
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000038 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511839341162
             Q0:     -16.777037741086
             G0:      -0.000000150220
   RMS gradient:       0.000048447724
     Trial step:       0.265499520282
             Q1:     -16.777037769744
 Quadratic coef:       0.000000011226
 Linear coef   :      -0.000000039883
           Qmin:     -16.777037776511
Quadratic minimum step length (  0.471630268771) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703774108647 0.00000000000 0.00004844772 0.4716  0.000    8.00000000
      ideal mu1:      -0.511849836791
             Q0:     -16.777037776511
             G0:      -0.000000014840
   RMS gradient:       0.000015227320
     Trial step:       0.353861003940
             Q1:     -16.777037779918
 Quadratic coef:       0.000000001844
 Linear coef   :      -0.000000005251
           Qmin:     -16.777037780249
Quadratic minimum step length (  0.503828322137) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703777651089 0.00000000443 0.00001522732 0.5038  0.099    8.00000000
      ideal mu1:      -0.511867401621
             Q0:     -16.777037780250
             G0:      -0.000000002477
   RMS gradient:       0.000006221643
     Trial step:       0.422238316457
             Q1:     -16.777037780951
 Quadratic coef:       0.000000000345
 Linear coef   :      -0.000000001046
           Qmin:     -16.777037781043
Quadratic minimum step length (  0.640416191698) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703778024954 0.00000000051 0.00000622164 0.6404  0.167    8.00000000
      ideal mu1:      -0.511865290091
             Q0:     -16.777037781043
             G0:      -0.000000000276
   RMS gradient:       0.000002076087
     Trial step:       0.520007937069
             Q1:     -16.777037781132
 Quadratic coef:       0.000000000055
 Linear coef   :      -0.000000000144
           Qmin:     -16.777037781137
Quadratic minimum step length (  0.683131359061) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77703778104310 0.00000000012 0.00000207609 0.6831  0.111    8.00000000
      ideal mu1:      -0.511866840042
             Q0:     -16.777037781137
             G0:      -0.000000000019
   RMS gradient:       0.000000540754
     Trial step:       0.596014872946
             Q1:     -16.777037781142
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000011
           Qmin:     -16.777037781142
Quadratic minimum step length (  0.518647548925) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703778113742 0.00000000001 0.00000054075 0.5186  0.068    8.00000000
      ideal mu1:      -0.511866199188
             Q0:     -16.777037781142
             G0:      -0.000000000000
   RMS gradient:       0.000000083512
     Trial step:       0.555987097851
             Q1:     -16.777037781143
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777037781142
  Cubic LS coeff:       0.802451975183
Predicted energy:     -16.777037781143
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77703778114212 0.00000000000 0.00000008351 0.8025  0.024    8.00000000
      ideal mu1:      -0.511866172817
             Q0:     -16.777037781142
             G0:      -0.000000000000
   RMS gradient:       0.000000032090
     Trial step:       0.667946812887
             Q1:     -16.777037781143
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777037781142
  Cubic LS coeff:       1.010780056033
Predicted energy:     -16.777037781143
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703778114222 0.00000000000 0.00000003209 1.0108  0.000    8.00000000
      ideal mu1:      -0.511866175236
             Q0:     -16.777037781142
             G0:      -0.000000000000
   RMS gradient:       0.000000026069
     Trial step:       0.821673485612
             Q1:     -16.777037781142
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777037781142
Quadratic minimum step length (  0.066511516464) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703778114235 0.00000000000 0.00000002607 0.0665  0.660    8.00000000
      ideal mu1:      -0.511866176498
             Q0:     -16.777037781142
             G0:      -0.000000000000
   RMS gradient:       0.000000024219
     Trial step:       0.233774997736
             Q1:     -16.777037781143
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777037781143
  Cubic LS coeff:       0.368397874203
Predicted energy:     -16.777037781143
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703778114242 0.00000000000 0.00000002422 0.3684  0.863    8.00000000
      ideal mu1:      -0.511866187924
10    -16.77703778114240 0.00000000000 0.00000001092 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002610511908              |
           | Maximum change in energy =  0.00000299904549 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18088662E-02     0.70719713E-03
               2       0.16043616E-05     0.57307731E-06
               3       0.15595563E-11     0.42776893E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17192136E-03     0.66695719E-04
               2       0.15088199E-07     0.53139907E-08
               3       0.10258019E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00002610511908
Trial step length           =               0.122850
Gradient along search dir.  =         -0.00001344895
Functional at step 0        =     -16.77703778114240
Functional at step 1        =     -16.77703852303300
Functional predicted        =     -16.77703853082343
Selected quadratic step     =               0.111485
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99940561
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000052 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.511972470244
             Q0:     -16.777038506676
             G0:      -0.000000330777
   RMS gradient:       0.000071891494
     Trial step:       0.293465862082
             Q1:     -16.777038573434
 Quadratic coef:       0.000000030313
 Linear coef   :      -0.000000097072
           Qmin:     -16.777038584388
Quadratic minimum step length (  0.469879253109) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703850667576 0.00000000000 0.00007189149 0.4699  0.000    8.00000000
      ideal mu1:      -0.511987083189
             Q0:     -16.777038584387
             G0:      -0.000000030449
   RMS gradient:       0.000021812356
     Trial step:       0.371340167620
             Q1:     -16.777038591520
 Quadratic coef:       0.000000004174
 Linear coef   :      -0.000000011307
           Qmin:     -16.777038592044
Quadratic minimum step length (  0.502947084467) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703858438710 0.00000000971 0.00002181236 0.5029  0.092    8.00000000
      ideal mu1:      -0.512011744664
             Q0:     -16.777038592044
             G0:      -0.000000005242
   RMS gradient:       0.000009050601
     Trial step:       0.432162532677
             Q1:     -16.777038593554
 Quadratic coef:       0.000000000756
 Linear coef   :      -0.000000002266
           Qmin:     -16.777038593741
Quadratic minimum step length (  0.647238197106) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703859204440 0.00000000105 0.00000905060 0.6472  0.172    8.00000000
      ideal mu1:      -0.512008821395
             Q0:     -16.777038593741
             G0:      -0.000000000573
   RMS gradient:       0.000002992861
     Trial step:       0.528878150907
             Q1:     -16.777038593926
 Quadratic coef:       0.000000000118
 Linear coef   :      -0.000000000303
           Qmin:     -16.777038593936
Quadratic minimum step length (  0.678551712888) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703859374131 0.00000000025 0.00000299286 0.6786  0.109    8.00000000
      ideal mu1:      -0.512011162887
             Q0:     -16.777038593936
             G0:      -0.000000000040
   RMS gradient:       0.000000790200
     Trial step:       0.599058574104
             Q1:     -16.777038593946
 Quadratic coef:       0.000000000014
 Linear coef   :      -0.000000000024
           Qmin:     -16.777038593946
Quadratic minimum step length (  0.509009811169) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703859393584 0.00000000003 0.00000079020 0.5090  0.070    8.00000000
      ideal mu1:      -0.512010248818
             Q0:     -16.777038593946
             G0:      -0.000000000001
   RMS gradient:       0.000000113976
     Trial step:       0.552201676640
             Q1:     -16.777038593946
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038593946
Quadratic minimum step length (  0.994455080122) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703859394600 0.00000000000 0.00000011398 0.9945  0.021    8.00000000
      ideal mu1:      -0.512010150689
             Q0:     -16.777038593946
             G0:      -0.000000000000
   RMS gradient:       0.000000063524
     Trial step:       0.741039649807
             Q1:     -16.777038593946
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038593946
  Cubic LS coeff:       0.887608859497
Predicted energy:     -16.777038593946
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703859394615 0.00000000000 0.00000006352 0.8876  0.000    8.00000000
      ideal mu1:      -0.512010202173
             Q0:     -16.777038593946
             G0:      -0.000000000000
   RMS gradient:       0.000000036094
     Trial step:       0.811019949451
             Q1:     -16.777038593946
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038593946
Quadratic minimum step length (  0.178546611105) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703859394630 0.00000000000 0.00000003609 0.1785  0.323    8.00000000
      ideal mu1:      -0.512010203785
             Q0:     -16.777038593946
             G0:      -0.000000000000
   RMS gradient:       0.000000028191
     Trial step:       0.380532342269
             Q1:     -16.777038593946
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038593946
  Cubic LS coeff:       0.545625684502
Predicted energy:     -16.777038593946
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703859394617 0.00000000000 0.00000002819 0.5456  0.610    8.00000000
      ideal mu1:      -0.512010199763
10    -16.77703859394634 0.00000000000 0.00000002614 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002051616783              |
           | Maximum change in energy =  0.00000027093465 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87966197423322 |
           | Pseudopotential (local)    :      -46.11175943013052 |
           | Pseudopotential (non-local):       -3.19132415654413 |
           | Hartree                    :       19.84121749484725 |
           | Exchange-correlation       :       -4.13068372432297 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77703859394634 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11175943013101 |
           | Hartree                    :       19.84121749484746 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999968
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28687661E-02     0.11192492E-02
               2       0.42571424E-05     0.15103385E-05
               3       0.11807418E-10     0.34723335E-11
               4       0.70705362E-15     0.25673907E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20639380E-02     0.80047536E-03
               2       0.22513855E-05     0.79543166E-06
               3       0.33834138E-11     0.10205170E-11
               4       0.10685338E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00002051616783
Trial step length           =               0.117030
Gradient along search dir.  =         -0.00000900493
Functional at step 0        =     -16.77703859394634
Functional at step 1        =     -16.77703783596904
Functional predicted        =     -16.77703874718867
Selected quadratic step     =               0.034035
Conjugate gradients coeff.  =               0.617648
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99970740
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000026 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512057118049
             Q0:     -16.777038741422
             G0:      -0.000000085467
   RMS gradient:       0.000036543334
     Trial step:       0.455662396655
             Q1:     -16.777038761524
 Quadratic coef:       0.000000018842
 Linear coef   :      -0.000000038944
           Qmin:     -16.777038761545
Quadratic minimum step length (  0.470885959493) accepted
    Initial Ne1:       7.99999992
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703874142247 0.00000000000 0.00003654333 0.4709  0.000    8.00000000
      ideal mu1:      -0.512065854774
             Q0:     -16.777038761545
             G0:      -0.000000007578
   RMS gradient:       0.000010881505
     Trial step:       0.463211641535
             Q1:     -16.777038763452
 Quadratic coef:       0.000000001604
 Linear coef   :      -0.000000003510
           Qmin:     -16.777038763466
Quadratic minimum step length (  0.506893019973) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703876154514 0.00000000252 0.00001088151 0.5069  0.089    8.00000000
      ideal mu1:      -0.512077985031
             Q0:     -16.777038763466
             G0:      -0.000000001354
   RMS gradient:       0.000004599727
     Trial step:       0.484560365553
             Q1:     -16.777038763874
 Quadratic coef:       0.000000000248
 Linear coef   :      -0.000000000656
           Qmin:     -16.777038763900
Quadratic minimum step length (  0.641719882423) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703876346563 0.00000000026 0.00000459973 0.6417  0.179    8.00000000
      ideal mu1:      -0.512076361834
             Q0:     -16.777038763900
             G0:      -0.000000000150
   RMS gradient:       0.000001529789
     Trial step:       0.557630720826
             Q1:     -16.777038763949
 Quadratic coef:       0.000000000035
 Linear coef   :      -0.000000000083
           Qmin:     -16.777038763950
Quadratic minimum step length (  0.667775840316) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703876390019 0.00000000006 0.00000152979 0.6678  0.111    8.00000000
      ideal mu1:      -0.512077602647
             Q0:     -16.777038763950
             G0:      -0.000000000011
   RMS gradient:       0.000000404482
     Trial step:       0.610223174900
             Q1:     -16.777038763953
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000006
           Qmin:     -16.777038763953
Quadratic minimum step length (  0.547601843688) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703876395033 0.00000000001 0.00000040448 0.5476  0.070    8.00000000
      ideal mu1:      -0.512077118800
             Q0:     -16.777038763953
             G0:      -0.000000000000
   RMS gradient:       0.000000064431
     Trial step:       0.578065165562
             Q1:     -16.777038763953
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038763953
Quadratic minimum step length (  0.262441502146) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703876395333 0.00000000000 0.00000006443 0.2624  0.025    8.00000000
      ideal mu1:      -0.512077119316
             Q0:     -16.777038763953
             G0:      -0.000000000000
   RMS gradient:       0.000000039522
     Trial step:       0.389497484444
             Q1:     -16.777038763953
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038763953
  Cubic LS coeff:       0.679920209522
Predicted energy:     -16.777038763953
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77703876395321 0.00000000000 0.00000003952 0.6799  0.000    8.00000000
      ideal mu1:      -0.512077126091
             Q0:     -16.777038763953
             G0:      -0.000000000000
   RMS gradient:       0.000000017443
     Trial step:       0.514613652395
             Q1:     -16.777038763953
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038763953
  Cubic LS coeff:       0.644814338087
Predicted energy:     -16.777038763953
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77703876395337 0.00000000000 0.00000001744 0.6448  0.195    8.00000000
      ideal mu1:      -0.512077112919
             Q0:     -16.777038763953
             G0:      -0.000000000000
   RMS gradient:       0.000000007877
     Trial step:       0.576047100192
             Q1:     -16.777038763953
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038763953
Quadratic minimum step length (  0.009686479216) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77703876395330 0.00000000000 0.00000000788 0.0097  0.204    8.00000000
      ideal mu1:      -0.512077112950
10    -16.77703876395336 0.00000000000 0.00000000778 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001830273489              |
           | Maximum change in energy =  0.00000027093465 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21624213E-02     0.85056506E-03
               2       0.23948205E-05     0.85799111E-06
               3       0.36945982E-11     0.10889067E-11
               4       0.10545526E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16510859E-02     0.64722465E-03
               2       0.14151408E-05     0.50537381E-06
               3       0.13114374E-11     0.39224179E-12
================================================================================
RMS gradient                =       0.00001830273489
Trial step length           =               0.063112
Gradient along search dir.  =         -0.00000739229
Functional at step 0        =     -16.77703876395336
Functional at step 1        =     -16.77703827079333
Functional predicted        =     -16.77703882065381
Selected quadratic step     =               0.015340
Conjugate gradients coeff.  =               0.795865
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99981380
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512104903512
             Q0:     -16.777038818323
             G0:      -0.000000035904
   RMS gradient:       0.000023685337
     Trial step:       0.074698515806
             Q1:     -16.777038820793
 Quadratic coef:       0.000000000212
 Linear coef   :      -0.000000002682
           Qmin:     -16.777038826789
Quadratic minimum step length (  0.471623189103) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703881832296 0.00000000000 0.00002368534 0.4716  0.000    8.00000000
      ideal mu1:      -0.512111102469
             Q0:     -16.777038826789
             G0:      -0.000000003115
   RMS gradient:       0.000006976760
     Trial step:       0.187695370869
             Q1:     -16.777038827266
 Quadratic coef:       0.000000000108
 Linear coef   :      -0.000000000585
           Qmin:     -16.777038827582
Quadratic minimum step length (  0.509299010896) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703882678871 0.00000000106 0.00000697676 0.5093  0.087    8.00000000
      ideal mu1:      -0.512118808109
             Q0:     -16.777038827582
             G0:      -0.000000000568
   RMS gradient:       0.000002979070
     Trial step:       0.309181284578
             Q1:     -16.777038827715
 Quadratic coef:       0.000000000042
 Linear coef   :      -0.000000000176
           Qmin:     -16.777038827764
Quadratic minimum step length (  0.639543064572) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77703882758217 0.00000000011 0.00000297907 0.6395  0.182    8.00000000
      ideal mu1:      -0.512117706411
             Q0:     -16.777038827763
             G0:      -0.000000000063
   RMS gradient:       0.000000997174
     Trial step:       0.444673752595
             Q1:     -16.777038827783
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000028
           Qmin:     -16.777038827785
Quadratic minimum step length (  0.680980170569) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703882776349 0.00000000003 0.00000099717 0.6810  0.112    8.00000000
      ideal mu1:      -0.512118559266
             Q0:     -16.777038827785
             G0:      -0.000000000005
   RMS gradient:       0.000000271707
     Trial step:       0.550285387676
             Q1:     -16.777038827786
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777038827786
Quadratic minimum step length (  0.601791313080) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77703882778467 0.00000000000 0.00000027171 0.6018  0.074    8.00000000
      ideal mu1:      -0.512118183590
             Q0:     -16.777038827786
             G0:      -0.000000000000
   RMS gradient:       0.000000064892
     Trial step:       0.575462393227
             Q1:     -16.777038827786
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038827786
  Cubic LS coeff:       0.785531489887
Predicted energy:     -16.777038827786
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703882778600 0.00000000000 0.00000006489 0.7855  0.057    8.00000000
      ideal mu1:      -0.512118238552
             Q0:     -16.777038827786
             G0:      -0.000000000000
   RMS gradient:       0.000000028656
     Trial step:       0.672342049202
             Q1:     -16.777038827786
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038827786
Quadratic minimum step length (  0.090366527783) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703882778600 0.00000000000 0.00000002866 0.0904  0.000    8.00000000
      ideal mu1:      -0.512118233268
             Q0:     -16.777038827786
             G0:      -0.000000000000
   RMS gradient:       0.000000023184
     Trial step:       0.246489789786
             Q1:     -16.777038827786
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038827786
Quadratic minimum step length (  0.011550741912) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703882778621 0.00000000000 0.00000002318 0.0116  0.655    8.00000000
      ideal mu1:      -0.512118232333
             Q0:     -16.777038827786
             G0:      -0.000000000000
   RMS gradient:       0.000000022197
     Trial step:       0.053358597675
             Q1:     -16.777038827786
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777038827786
Quadratic minimum step length (  0.000405510023) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703882778621 0.00000000000 0.00000002220 0.0004  0.917    8.00000000
      ideal mu1:      -0.512118232287
10    -16.77703882778616 0.00000000000 0.00000002215 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001689260445              |
           | Maximum change in energy =  0.00000005666901 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13529093E-02     0.53663011E-03
               2       0.92032234E-06     0.33344480E-06
               3       0.53319790E-12     0.15598633E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.98872504E-03     0.39136383E-03
               2       0.49617482E-06     0.17924719E-06
               3       0.15691473E-12     0.46407322E-13
================================================================================
RMS gradient                =       0.00001689260445
Trial step length           =               0.031115
Gradient along search dir.  =         -0.00000641932
Functional at step 0        =     -16.77703882778616
Functional at step 1        =     -16.77703866237244
Functional predicted        =     -16.77703885510067
Selected quadratic step     =               0.008510
Conjugate gradients coeff.  =               0.851846
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99986698
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512137055295
             Q0:     -16.777038853912
             G0:      -0.000000018788
   RMS gradient:       0.000017133548
     Trial step:       0.004651606835
             Q1:     -16.777038853999
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000087
           Qmin:     -16.777038856239
Quadratic minimum step length (  0.247672838432) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703885391215 0.00000000000 0.00001713355 0.2477  0.000    8.00000000
      ideal mu1:      -0.512139539315
             Q0:     -16.777038857345
             G0:      -0.000000006914
   RMS gradient:       0.000008557278
     Trial step:       0.033942254907
             Q1:     -16.777038857568
 Quadratic coef:       0.000000000011
 Linear coef   :      -0.000000000235
           Qmin:     -16.777038858584
Quadratic minimum step length (  0.358622678427) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703885734458 0.00000000029 0.00000855728 0.3586  0.249    8.00000000
      ideal mu1:      -0.512144010529
             Q0:     -16.777038858585
             G0:      -0.000000000801
   RMS gradient:       0.000003535966
     Trial step:       0.110328882740
             Q1:     -16.777038858664
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000088
           Qmin:     -16.777038858783
Quadratic minimum step length (  0.492976937069) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703885858503 0.00000000023 0.00000353597 0.4930  0.171    8.00000000
      ideal mu1:      -0.512147549175
             Q0:     -16.777038858787
             G0:      -0.000000000243
   RMS gradient:       0.000001926334
     Trial step:       0.233215768514
             Q1:     -16.777038858830
 Quadratic coef:       0.000000000013
 Linear coef   :      -0.000000000057
           Qmin:     -16.777038858848
Quadratic minimum step length (  0.504027211960) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703885878672 0.00000000003 0.00000192633 0.5040  0.297    8.00000000
      ideal mu1:      -0.512147339440
             Q0:     -16.777038858848
             G0:      -0.000000000053
   RMS gradient:       0.000000908669
     Trial step:       0.342851416198
             Q1:     -16.777038858859
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000018
           Qmin:     -16.777038858859
Quadratic minimum step length (  0.407969628732) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703885884845 0.00000000001 0.00000090867 0.4080  0.223    8.00000000
      ideal mu1:      -0.512146824521
             Q0:     -16.777038858860
             G0:      -0.000000000011
   RMS gradient:       0.000000418189
     Trial step:       0.373995942460
             Q1:     -16.777038858862
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777038858862
Quadratic minimum step length (  0.391952381608) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703885885963 0.00000000000 0.00000041819 0.3920  0.212    8.00000000
      ideal mu1:      -0.512146891860
             Q0:     -16.777038858862
             G0:      -0.000000000002
   RMS gradient:       0.000000175022
     Trial step:       0.382868907537
             Q1:     -16.777038858862
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777038858862
Quadratic minimum step length (  0.421314524241) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703885886205 0.00000000000 0.00000017502 0.4213  0.000    8.00000000
      ideal mu1:      -0.512146935373
             Q0:     -16.777038858863
             G0:      -0.000000000000
   RMS gradient:       0.000000059940
     Trial step:       0.401631960414
             Q1:     -16.777038858863
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038858863
  Cubic LS coeff:       0.535157145680
Predicted energy:     -16.777038858863
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703885886261 0.00000000000 0.00000005994 0.5352  0.117    8.00000000
      ideal mu1:      -0.512146860614
             Q0:     -16.777038858862
             G0:      -0.000000000000
   RMS gradient:       0.000000023959
     Trial step:       0.463612136973
             Q1:     -16.777038858863
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777038858863
  Cubic LS coeff:       0.705270042880
Predicted energy:     -16.777038858863
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703885886250 0.00000000000 0.00000002396 0.7053  0.160    8.00000000
      ideal mu1:      -0.512146846427
10    -16.77703885886233 0.00000000000 0.00000000777 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001583021370              |
           | Maximum change in energy =  0.00000002127760 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22741880E-03     0.92161184E-04
               2       0.24360105E-07     0.92612475E-08
               3       0.12213929E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.70456899E-03     0.28501076E-03
               2       0.23775099E-06     0.89361633E-07
               3       0.33157926E-13     0.10103030E-13
================================================================================
RMS gradient                =       0.00001583021370
Trial step length           =               0.016273
Gradient along search dir.  =         -0.00000494551
Functional at step 0        =     -16.77703885886233
Functional at step 1        =     -16.77703892942586
Functional predicted        =     -16.77703902220458
Selected quadratic step     =               0.066057
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99965038
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000031 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512188863642
             Q0:     -16.777039013509
             G0:      -0.000000137897
   RMS gradient:       0.000046418063
     Trial step:       0.571814438190
             Q1:     -16.777039044793
 Quadratic coef:       0.000000047567
 Linear coef   :      -0.000000078851
           Qmin:     -16.777039046186
Quadratic minimum step length (  0.473948203356) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703901350853 0.00000000000 0.00004641806 0.4739  0.000    8.00000000
      ideal mu1:      -0.512203822344
             Q0:     -16.777039046187
             G0:      -0.000000011330
   RMS gradient:       0.000013305323
     Trial step:       0.520586616840
             Q1:     -16.777039049124
 Quadratic coef:       0.000000002961
 Linear coef   :      -0.000000005898
           Qmin:     -16.777039049124
Quadratic minimum step length (  0.518502494607) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703904618688 0.00000000408 0.00001330532 0.5185  0.082    8.00000000
      ideal mu1:      -0.512218199369
             Q0:     -16.777039049124
             G0:      -0.000000002186
   RMS gradient:       0.000005844759
     Trial step:       0.519543510681
             Q1:     -16.777039049788
 Quadratic coef:       0.000000000472
 Linear coef   :      -0.000000001136
           Qmin:     -16.777039049807
Quadratic minimum step length (  0.625012020746) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703904912422 0.00000000040 0.00000584476 0.6250  0.193    8.00000000
      ideal mu1:      -0.512215795904
             Q0:     -16.777039049807
             G0:      -0.000000000248
   RMS gradient:       0.000001966573
     Trial step:       0.569842907718
             Q1:     -16.777039049888
 Quadratic coef:       0.000000000060
 Linear coef   :      -0.000000000141
           Qmin:     -16.777039049890
Quadratic minimum step length (  0.666617795348) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703904980747 0.00000000010 0.00000196657 0.6666  0.113    8.00000000
      ideal mu1:      -0.512217510952
             Q0:     -16.777039049890
             G0:      -0.000000000018
   RMS gradient:       0.000000530429
     Trial step:       0.616333856638
             Q1:     -16.777039049894
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000011
           Qmin:     -16.777039049894
Quadratic minimum step length (  0.511593453152) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703904988976 0.00000000001 0.00000053043 0.5116  0.073    8.00000000
      ideal mu1:      -0.512216937253
             Q0:     -16.777039049894
             G0:      -0.000000000000
   RMS gradient:       0.000000069545
     Trial step:       0.561526816823
             Q1:     -16.777039049894
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039049894
Quadratic minimum step length (  0.319053752191) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703904989444 0.00000000000 0.00000006955 0.3191  0.017    8.00000000
      ideal mu1:      -0.512216907523
             Q0:     -16.777039049894
             G0:      -0.000000000000
   RMS gradient:       0.000000041105
     Trial step:       0.423269698730
             Q1:     -16.777039049894
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039049894
Quadratic minimum step length (  0.041946265365) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703904989438 0.00000000000 0.00000004110 0.0419  0.000    8.00000000
      ideal mu1:      -0.512216906316
             Q0:     -16.777039049894
             G0:      -0.000000000000
   RMS gradient:       0.000000039148
     Trial step:       0.133246324917
             Q1:     -16.777039049895
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039049894
  Cubic LS coeff:       0.157177534971
Predicted energy:     -16.777039049895
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703904989447 0.00000000000 0.00000003915 0.1572  0.907    8.00000000
      ideal mu1:      -0.512216897886
             Q0:     -16.777039049894
             G0:      -0.000000000000
   RMS gradient:       0.000000026367
     Trial step:       0.144718101475
             Q1:     -16.777039049895
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039049894
  Cubic LS coeff:       0.220786796541
Predicted energy:     -16.777039049895
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703904989447 0.00000000000 0.00000002637 0.2208  0.454    8.00000000
      ideal mu1:      -0.512216888378
10    -16.77703904989437 0.00000000000 0.00000001593 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001174081708              |
           | Maximum change in energy =  0.00000006367735 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.71770884E-03     0.29163158E-03
               2       0.24738021E-06     0.93449025E-07
               3       0.35939666E-13     0.10880186E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31355047E-03     0.12722602E-03
               2       0.47639975E-07     0.17911225E-07
               3       0.15573457E-14     0.46490589E-15
================================================================================
RMS gradient                =       0.00001174081708
Trial step length           =               0.032786
Gradient along search dir.  =         -0.00000318057
Functional at step 0        =     -16.77703904989437
Functional at step 1        =     -16.77703906200418
Functional predicted        =     -16.77703907938898
Selected quadratic step     =               0.018547
Conjugate gradients coeff.  =               0.550076
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99984796
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000013 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512233781812
             Q0:     -16.777039077807
             G0:      -0.000000026914
   RMS gradient:       0.000020506986
     Trial step:       0.178750793078
             Q1:     -16.777039081711
 Quadratic coef:       0.000000000907
 Linear coef   :      -0.000000004811
           Qmin:     -16.777039084188
Quadratic minimum step length (  0.474221769486) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77703907780660 0.00000000000 0.00002050699 0.4742  0.000    8.00000000
      ideal mu1:      -0.512240797850
             Q0:     -16.777039084188
             G0:      -0.000000002171
   RMS gradient:       0.000005824783
     Trial step:       0.291148617360
             Q1:     -16.777039084644
 Quadratic coef:       0.000000000176
 Linear coef   :      -0.000000000632
           Qmin:     -16.777039084755
Quadratic minimum step length (  0.522109319171) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703908418775 0.00000000080 0.00000582478 0.5221  0.081    8.00000000
      ideal mu1:      -0.512247044635
             Q0:     -16.777039084754
             G0:      -0.000000000426
   RMS gradient:       0.000002581793
     Trial step:       0.389886401901
             Q1:     -16.777039084868
 Quadratic coef:       0.000000000052
 Linear coef   :      -0.000000000166
           Qmin:     -16.777039084886
Quadratic minimum step length (  0.619640476156) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703908475431 0.00000000008 0.00000258179 0.6196  0.196    8.00000000
      ideal mu1:      -0.512245945501
             Q0:     -16.777039084887
             G0:      -0.000000000049
   RMS gradient:       0.000000869922
     Trial step:       0.491517441929
             Q1:     -16.777039084902
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000024
           Qmin:     -16.777039084903
Quadratic minimum step length (  0.647551173358) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703908488695 0.00000000002 0.00000086992 0.6476  0.114    8.00000000
      ideal mu1:      -0.512246689128
             Q0:     -16.777039084903
             G0:      -0.000000000003
   RMS gradient:       0.000000229446
     Trial step:       0.564165486579
             Q1:     -16.777039084904
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777039084904
Quadratic minimum step length (  0.480559003866) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703908490301 0.00000000000 0.00000022945 0.4806  0.070    8.00000000
      ideal mu1:      -0.512246479968
             Q0:     -16.777039084904
             G0:      -0.000000000000
   RMS gradient:       0.000000037533
     Trial step:       0.520686858146
             Q1:     -16.777039084904
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039084904
  Cubic LS coeff:       0.714383021411
Predicted energy:     -16.777039084904
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703908490377 0.00000000000 0.00000003753 0.7144  0.027    8.00000000
      ideal mu1:      -0.512246414691
             Q0:     -16.777039084904
             G0:      -0.000000000000
   RMS gradient:       0.000000018607
     Trial step:       0.609893311106
             Q1:     -16.777039084904
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039084904
Quadratic minimum step length (  0.089225511837) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77703908490384 0.00000000000 0.00000001861 0.0892  0.000    8.00000000
      ideal mu1:      -0.512246419336
             Q0:     -16.777039084904
             G0:      -0.000000000000
   RMS gradient:       0.000000015472
     Trial step:       0.233276751626
             Q1:     -16.777039084904
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039084904
Quadratic minimum step length (  0.004289982286) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703908490401 0.00000000000 0.00000001547 0.0043  0.691    8.00000000
      ideal mu1:      -0.512246419664
             Q0:     -16.777039084904
             G0:      -0.000000000000
   RMS gradient:       0.000000015254
     Trial step:       0.031634682425
             Q1:     -16.777039084904
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039084904
Quadratic minimum step length (  0.000163225397) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703908490394 0.00000000000 0.00000001525 0.0002  0.972    8.00000000
      ideal mu1:      -0.512246419682
10    -16.77703908490398 0.00000000000 0.00000001524 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000959817292              |
           | Maximum change in energy =  0.00000006367735 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87832685115207 |
           | Pseudopotential (local)    :      -46.10918831685036 |
           | Pseudopotential (non-local):       -3.19093253663189 |
           | Hartree                    :       19.83921252009951 |
           | Exchange-correlation       :       -4.13030685064411 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77703908490398 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.10918831685087 |
           | Hartree                    :       19.83921252009961 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999957
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.70758691E-03     0.28830288E-03
               2       0.24059403E-06     0.91211134E-07
               3       0.33686629E-13     0.10325074E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.48825072E-03     0.19879500E-03
               2       0.11510458E-06     0.43530839E-07
               3       0.78919760E-14     0.23314684E-14
================================================================================
RMS gradient                =       0.00000959817292
Trial step length           =               0.024659
Gradient along search dir.  =         -0.00000221316
Functional at step 0        =     -16.77703908490398
Functional at step 1        =     -16.77703905204888
Functional predicted        =     -16.77703909342051
Selected quadratic step     =               0.007696
Conjugate gradients coeff.  =               0.668314
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99991716
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512255177372
             Q0:     -16.777039092959
             G0:      -0.000000008133
   RMS gradient:       0.000011272965
     Trial step:       0.002272351995
             Q1:     -16.777039092977
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000018
           Qmin:     -16.777039093760
Quadratic minimum step length (  0.197013533017) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77703909295892 0.00000000000 0.00001127297 0.1970  0.000    8.00000000
      ideal mu1:      -0.512256843624
             Q0:     -16.777039094228
             G0:      -0.000000004585
   RMS gradient:       0.000006723541
     Trial step:       0.021158546613
             Q1:     -16.777039094322
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000097
           Qmin:     -16.777039094997
Quadratic minimum step length (  0.335133718377) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703909422840 0.00000000010 0.00000672354 0.3351  0.356    8.00000000
      ideal mu1:      -0.512260317928
             Q0:     -16.777039094961
             G0:      -0.000000000408
   RMS gradient:       0.000002624155
     Trial step:       0.084207733623
             Q1:     -16.777039094992
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000034
           Qmin:     -16.777039095073
Quadratic minimum step length (  0.552963806837) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703909496054 0.00000000015 0.00000262415 0.5530  0.152    8.00000000
      ideal mu1:      -0.512263132881
             Q0:     -16.777039095061
             G0:      -0.000000000135
   RMS gradient:       0.000001528392
     Trial step:       0.215786535608
             Q1:     -16.777039095084
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000029
           Qmin:     -16.777039095095
Quadratic minimum step length (  0.495864501326) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703909506128 0.00000000002 0.00000152839 0.4959  0.339    8.00000000
      ideal mu1:      -0.512262667941
             Q0:     -16.777039095095
             G0:      -0.000000000033
   RMS gradient:       0.000000713677
     Trial step:       0.327109894182
             Q1:     -16.777039095101
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000011
           Qmin:     -16.777039095101
Quadratic minimum step length (  0.398320421248) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77703909509453 0.00000000001 0.00000071368 0.3983  0.218    8.00000000
      ideal mu1:      -0.512262233787
             Q0:     -16.777039095101
             G0:      -0.000000000007
   RMS gradient:       0.000000337981
     Trial step:       0.360963364963
             Q1:     -16.777039095103
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777039095103
Quadratic minimum step length (  0.535845281861) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703909510110 0.00000000000 0.00000033798 0.5358  0.224    8.00000000
      ideal mu1:      -0.512262301787
             Q0:     -16.777039095103
             G0:      -0.000000000001
   RMS gradient:       0.000000148738
     Trial step:       0.439795993660
             Q1:     -16.777039095103
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039095103
Quadratic minimum step length (  0.377862451392) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703909510306 0.00000000000 0.00000014874 0.3779  0.000    8.00000000
      ideal mu1:      -0.512262293413
             Q0:     -16.777039095103
             G0:      -0.000000000000
   RMS gradient:       0.000000053861
     Trial step:       0.407654746418
             Q1:     -16.777039095103
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039095103
Quadratic minimum step length (  0.077928681457) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703909510338 0.00000000000 0.00000005386 0.0779  0.131    8.00000000
      ideal mu1:      -0.512262287278
             Q0:     -16.777039095103
             G0:      -0.000000000000
   RMS gradient:       0.000000047965
     Trial step:       0.178235790115
             Q1:     -16.777039095104
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039095103
  Cubic LS coeff:       0.220969009412
Predicted energy:     -16.777039095104
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703909510344 0.00000000000 0.00000004796 0.2210  0.793    8.00000000
      ideal mu1:      -0.512262259404
10    -16.77703909510337 0.00000000000 0.00000002637 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000823089179              |
           | Maximum change in energy =  0.00000001166987 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.48204109E-03     0.19696387E-03
               2       0.11096572E-06     0.42332923E-07
               3       0.70542593E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.34627660E-03     0.14144054E-03
               2       0.57421331E-07     0.21873279E-07
               3       0.24049894E-14     0.13322676E-14
================================================================================
RMS gradient                =       0.00000823089179
Trial step length           =               0.013776
Gradient along search dir.  =         -0.00000165547
Functional at step 0        =     -16.77703909510337
Functional at step 1        =     -16.77703907760989
Functional predicted        =     -16.77703909832994
Selected quadratic step     =               0.003898
Conjugate gradients coeff.  =               0.735388
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99994855
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512267517639
             Q0:     -16.777039098155
             G0:      -0.000000003170
   RMS gradient:       0.000007037635
     Trial step:       0.198455501268
             Q1:     -16.777039098653
 Quadratic coef:       0.000000000132
 Linear coef   :      -0.000000000629
           Qmin:     -16.777039098907
Quadratic minimum step length (  0.474196000453) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703909815508 0.00000000000 0.00000703764 0.4742  0.000    8.00000000
      ideal mu1:      -0.512270063547
             Q0:     -16.777039098906
             G0:      -0.000000000249
   RMS gradient:       0.000001973956
     Trial step:       0.306768324586
             Q1:     -16.777039098960
 Quadratic coef:       0.000000000023
 Linear coef   :      -0.000000000076
           Qmin:     -16.777039098971
Quadratic minimum step length (  0.518751830394) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703909890594 0.00000000009 0.00000197396 0.5188  0.079    8.00000000
      ideal mu1:      -0.512272141696
             Q0:     -16.777039098971
             G0:      -0.000000000049
   RMS gradient:       0.000000869238
     Trial step:       0.398919327541
             Q1:     -16.777039098985
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000019
           Qmin:     -16.777039098987
Quadratic minimum step length (  0.650129797395) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703909897109 0.00000000001 0.00000086924 0.6501  0.194    8.00000000
      ideal mu1:      -0.512271756989
             Q0:     -16.777039098986
             G0:      -0.000000000006
   RMS gradient:       0.000000313795
     Trial step:       0.509263528629
             Q1:     -16.777039098988
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777039098989
Quadratic minimum step length (  0.674294727073) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77703909898649 0.00000000000 0.00000031379 0.6743  0.130    8.00000000
      ideal mu1:      -0.512272083314
             Q0:     -16.777039098988
             G0:      -0.000000000000
   RMS gradient:       0.000000090095
     Trial step:       0.585998047817
             Q1:     -16.777039098988
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039098988
Quadratic minimum step length (  0.232596511832) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77703909898838 0.00000000000 0.00000009009 0.2326  0.082    8.00000000
      ideal mu1:      -0.512272027040
             Q0:     -16.777039098989
             G0:      -0.000000000000
   RMS gradient:       0.000000049738
     Trial step:       0.369189791113
             Q1:     -16.777039098989
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039098989
Quadratic minimum step length (  0.146990468027) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703909898856 0.00000000000 0.00000004974 0.1470  0.305    8.00000000
      ideal mu1:      -0.512271993822
             Q0:     -16.777039098989
             G0:      -0.000000000000
   RMS gradient:       0.000000027883
     Trial step:       0.232953600931
             Q1:     -16.777039098988
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039098989
Quadratic minimum step length (  0.003275963467) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703909898868 0.00000000000 0.00000002788 0.0033  0.000    8.00000000
      ideal mu1:      -0.512271993568
             Q0:     -16.777039098989
             G0:      -0.000000000000
   RMS gradient:       0.000000027716
     Trial step:       0.027625124183
             Q1:     -16.777039098989
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039098989
  Cubic LS coeff:       0.034084078761
Predicted energy:     -16.777039098989
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703909898859 0.00000000000 0.00000002772 0.0341  0.988    8.00000000
      ideal mu1:      -0.512271988339
             Q0:     -16.777039098989
             G0:      -0.000000000000
   RMS gradient:       0.000000024307
     Trial step:       0.030685125198
             Q1:     -16.777039098988
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039098989
Quadratic minimum step length (  0.000193867286) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703909898869 0.00000000000 0.00000002431 0.0002  0.769    8.00000000
      ideal mu1:      -0.512271988303
10    -16.77703909898855 0.00000000000 0.00000002428 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000725962477              |
           | Maximum change in energy =  0.00000000339980 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10077974E-03     0.41437043E-04
               2       0.47508409E-08     0.18486027E-08
               3       0.87904287E-15     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11831542E-03     0.48634363E-04
               2       0.65696713E-08     0.25495031E-08
               3       0.86138459E-15     0.55511151E-15
================================================================================
RMS gradient                =       0.00000725962477
Trial step length           =               0.007328
Gradient along search dir.  =         -0.00000104008
Functional at step 0        =     -16.77703909898855
Functional at step 1        =     -16.77703910485475
Functional predicted        =     -16.77703910726113
Selected quadratic step     =               0.015908
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99991593
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512279964894
             Q0:     -16.777039106748
             G0:      -0.000000008649
   RMS gradient:       0.000011625300
     Trial step:       0.002439024792
             Q1:     -16.777039106769
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000021
           Qmin:     -16.777039107202
Quadratic minimum step length (  0.104949750592) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703910674767 0.00000000000 0.00001162530 0.1049  0.000    8.00000000
      ideal mu1:      -0.512280930746
             Q0:     -16.777039107555
             G0:      -0.000000009394
   RMS gradient:       0.000009083711
     Trial step:       0.015999220094
             Q1:     -16.777039107701
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000150
           Qmin:     -16.777039108743
Quadratic minimum step length (  0.252939381976) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703910755498 0.00000000006 0.00000908371 0.2529  0.611    8.00000000
      ideal mu1:      -0.512284488867
             Q0:     -16.777039108831
             G0:      -0.000000000572
   RMS gradient:       0.000002808771
     Trial step:       0.063614721901
             Q1:     -16.777039108865
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000036
           Qmin:     -16.777039108977
Quadratic minimum step length (  0.508159830192) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703910883130 0.00000000026 0.00000280877 0.5082  0.096    8.00000000
      ideal mu1:      -0.512287755478
             Q0:     -16.777039108974
             G0:      -0.000000000153
   RMS gradient:       0.000001564192
     Trial step:       0.179795568018
             Q1:     -16.777039108996
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000027
           Qmin:     -16.777039109012
Quadratic minimum step length (  0.506852269389) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77703910897364 0.00000000003 0.00000156419 0.5069  0.310    8.00000000
      ideal mu1:      -0.512287904752
             Q0:     -16.777039109014
             G0:      -0.000000000045
   RMS gradient:       0.000000815413
     Trial step:       0.301877113535
             Q1:     -16.777039109022
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000013
           Qmin:     -16.777039109023
Quadratic minimum step length (  0.403320366253) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703910901402 0.00000000001 0.00000081541 0.4033  0.272    8.00000000
      ideal mu1:      -0.512287418877
             Q0:     -16.777039109023
             G0:      -0.000000000009
   RMS gradient:       0.000000363021
     Trial step:       0.348931494701
             Q1:     -16.777039109025
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777039109025
Quadratic minimum step length (  0.535393832310) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703910902304 0.00000000000 0.00000036302 0.5354  0.198    8.00000000
      ideal mu1:      -0.512287427380
             Q0:     -16.777039109025
             G0:      -0.000000000002
   RMS gradient:       0.000000166659
     Trial step:       0.432221899216
             Q1:     -16.777039109026
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039109026
Quadratic minimum step length (  0.805814519278) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77703910902527 0.00000000000 0.00000016666 0.8058  0.000    8.00000000
      ideal mu1:      -0.512287507852
             Q0:     -16.777039109025
             G0:      -0.000000000000
   RMS gradient:       0.000000169899
     Trial step:       0.590161572739
             Q1:     -16.777039109025
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039109025
Quadratic minimum step length (  0.309346008379) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77703910902539 0.00000000000 0.00000016990 0.3093  1.039    8.00000000
      ideal mu1:      -0.512287439753
             Q0:     -16.777039109025
             G0:      -0.000000000001
   RMS gradient:       0.000000147709
     Trial step:       0.427275235446
             Q1:     -16.777039109026
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039109026
Quadratic minimum step length (  0.591289303393) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703910902537 0.00000000000 0.00000014771 0.5913  0.756    8.00000000
      ideal mu1:      -0.512287242513
10    -16.77703910902540 0.00000000000 0.00000016352 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000525948364              |
           | Maximum change in energy =  0.00000000334562 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22693864E-03     0.93382332E-04
               2       0.24182730E-07     0.93944800E-08
               3       0.13220618E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13498311E-03     0.55537772E-04
               2       0.85682617E-08     0.33251435E-08
               3       0.90701546E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00000525948364
Trial step length           =               0.010797
Gradient along search dir.  =         -0.00000066155
Functional at step 0        =     -16.77703910902540
Functional at step 1        =     -16.77703910736895
Functional predicted        =     -16.77703911047491
Selected quadratic step     =               0.004382
Conjugate gradients coeff.  =               0.524877
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99996469
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512290523687
             Q0:     -16.777039110394
             G0:      -0.000000001502
   RMS gradient:       0.000004844249
     Trial step:       0.502636326109
             Q1:     -16.777039110754
 Quadratic coef:       0.000000000394
 Linear coef   :      -0.000000000755
           Qmin:     -16.777039110755
Quadratic minimum step length (  0.481572842663) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703911039355 0.00000000000 0.00000484425 0.4816  0.000    8.00000000
      ideal mu1:      -0.512292631232
             Q0:     -16.777039110755
             G0:      -0.000000000116
   RMS gradient:       0.000001346928
     Trial step:       0.491991874313
             Q1:     -16.777039110786
 Quadratic coef:       0.000000000026
 Linear coef   :      -0.000000000057
           Qmin:     -16.777039110786
Quadratic minimum step length (  0.542171855999) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703911075499 0.00000000005 0.00000134693 0.5422  0.077    8.00000000
      ideal mu1:      -0.512294019405
             Q0:     -16.777039110787
             G0:      -0.000000000025
   RMS gradient:       0.000000622592
     Trial step:       0.516472794669
             Q1:     -16.777039110794
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000013
           Qmin:     -16.777039110794
Quadratic minimum step length (  0.612298621594) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703911078657 0.00000000000 0.00000062259 0.6123  0.214    8.00000000
      ideal mu1:      -0.512293719999
             Q0:     -16.777039110794
             G0:      -0.000000000003
   RMS gradient:       0.000000217786
     Trial step:       0.562348273107
             Q1:     -16.777039110795
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777039110795
Quadratic minimum step length (  0.532796657078) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703911079429 0.00000000000 0.00000021779 0.5328  0.122    8.00000000
      ideal mu1:      -0.512293891504
             Q0:     -16.777039110795
             G0:      -0.000000000000
   RMS gradient:       0.000000059371
     Trial step:       0.547373072068
             Q1:     -16.777039110795
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039110795
Quadratic minimum step length (  1.374096678334) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703911079486 0.00000000000 0.00000005937 1.3741  0.074    8.00000000
      ideal mu1:      -0.512293832705
             Q0:     -16.777039110795
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000083784
     Trial step:       0.867262082728
             Q1:     -16.777039110795
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039110795
Quadratic minimum step length (  0.480367433680) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703911079507 0.00000000000 0.00000008378 0.4804  1.991    8.00000000
      ideal mu1:      -0.512293831513
             Q0:     -16.777039110795
             G0:      -0.000000000000
   RMS gradient:       0.000000023222
     Trial step:       0.645449038274
             Q1:     -16.777039110795
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039110795
  Cubic LS coeff:       1.414198270705
Predicted energy:     -16.777039110795
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77703911079497 0.00000000000 0.00000002322 1.4142  0.000    8.00000000
      ideal mu1:      -0.512293891808
             Q0:     -16.777039110795
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000035679
     Trial step:       0.955401964492
             Q1:     -16.777039110795
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039110795
Quadratic minimum step length (  0.307834903990) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703911079491 0.00000000000 0.00000003568 0.3078  2.361    8.00000000
      ideal mu1:      -0.512293861157
             Q0:     -16.777039110795
             G0:      -0.000000000000
   RMS gradient:       0.000000011099
     Trial step:       0.542315472775
             Q1:     -16.777039110795
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039110795
  Cubic LS coeff:       0.824990204112
Predicted energy:     -16.777039110795
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77703911079498 0.00000000000 0.00000001110 0.8250  0.097    8.00000000
      ideal mu1:      -0.512293840424
10    -16.77703911079488 0.00000000000 0.00000000981 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000415141074              |
           | Maximum change in energy =  0.00000000334562 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18468610E-03     0.76051144E-04
               2       0.16004401E-07     0.62262981E-08
               3       0.91665703E-15     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13779804E-03     0.56741430E-04
               2       0.89160873E-08     0.34670071E-08
               3       0.10589772E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00000415141074
Trial step length           =               0.006878
Gradient along search dir.  =         -0.00000042913
Functional at step 0        =     -16.77703911079488
Functional at step 1        =     -16.77703910794278
Functional predicted        =     -16.77703911117019
Selected quadratic step     =               0.001749
Conjugate gradients coeff.  =               0.623025
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  020 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998198
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512295493036
             Q0:     -16.777039111150
             G0:      -0.000000000402
   RMS gradient:       0.000002506916
     Trial step:       0.668883362461
             Q1:     -16.777039111230
 Quadratic coef:       0.000000000189
 Linear coef   :      -0.000000000269
           Qmin:     -16.777039111246
Quadratic minimum step length (  0.475529212826) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703911115049 0.00000000000 0.00000250692 0.4755  0.000    8.00000000
      ideal mu1:      -0.512296473290
             Q0:     -16.777039111246
             G0:      -0.000000000031
   RMS gradient:       0.000000697888
     Trial step:       0.563980122720
             Q1:     -16.777039111254
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000018
           Qmin:     -16.777039111254
Quadratic minimum step length (  0.527287510665) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703911124626 0.00000000001 0.00000069789 0.5273  0.077    8.00000000
      ideal mu1:      -0.512297202662
             Q0:     -16.777039111255
             G0:      -0.000000000006
   RMS gradient:       0.000000313021
     Trial step:       0.545325292806
             Q1:     -16.777039111257
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777039111257
Quadratic minimum step length (  0.700250970645) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703911125452 0.00000000000 0.00000031302 0.7003  0.201    8.00000000
      ideal mu1:      -0.512297043106
             Q0:     -16.777039111257
             G0:      -0.000000000001
   RMS gradient:       0.000000130146
     Trial step:       0.617951912049
             Q1:     -16.777039111257
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039111257
Quadratic minimum step length (  0.335717907049) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703911125653 0.00000000000 0.00000013015 0.3357  0.173    8.00000000
      ideal mu1:      -0.512297120985
             Q0:     -16.777039111256
             G0:      -0.000000000000
   RMS gradient:       0.000000061573
     Trial step:       0.455475051534
             Q1:     -16.777039111257
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111257
  Cubic LS coeff:       0.689336632563
Predicted energy:     -16.777039111257
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703911125646 0.00000000000 0.00000006157 0.6893  0.224    8.00000000
      ideal mu1:      -0.512297198209
             Q0:     -16.777039111257
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000059134
     Trial step:       0.560335290911
             Q1:     -16.777039111257
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111257
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  3.296344487306)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77703911125653 0.00000000000 0.00000005913 0.1500  0.000    8.00000000
      ideal mu1:      -0.512297169227
             Q0:     -16.777039111257
             G0:      -0.000000000000
   RMS gradient:       0.000000036058
     Trial step:       0.289914286707
             Q1:     -16.777039111257
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111257
Quadratic minimum step length (  0.225609463234) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703911125663 0.00000000000 0.00000003606 0.2256  0.372    8.00000000
      ideal mu1:      -0.512297127703
             Q0:     -16.777039111257
             G0:      -0.000000000000
   RMS gradient:       0.000000009631
     Trial step:       0.255748717705
             Q1:     -16.777039111257
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111257
  Cubic LS coeff:       0.250667625047
Predicted energy:     -16.777039111257
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703911125677 0.00000000000 0.00000000963 0.2507  0.071    8.00000000
      ideal mu1:      -0.512297125160
             Q0:     -16.777039111257
             G0:      -0.000000000000
   RMS gradient:       0.000000005540
     Trial step:       0.253195425859
             Q1:     -16.777039111257
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111257
Quadratic minimum step length (  0.008838362875) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703911125677 0.00000000000 0.00000000554 0.0088  0.331    8.00000000
      ideal mu1:      -0.512297125204
10    -16.77703911125669 0.00000000000 0.00000000542 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000346257731              |
           | Maximum change in energy =  0.00000000058983 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87804569352029 |
           | Pseudopotential (local)    :      -46.10864389439936 |
           | Pseudopotential (non-local):       -3.19084565154001 |
           | Hartree                    :       19.83878211420991 |
           | Exchange-correlation       :       -4.13022662101834 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77703911125669 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.10864389439958 |
           | Hartree                    :       19.83878211421008 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999984
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11237305E-03     0.46299670E-04
               2       0.59160065E-08     0.23056119E-08
               3       0.10253775E-14     0.55511151E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.84927123E-04     0.34991032E-04
               2       0.33804542E-08     0.13170807E-08
               3       0.10666728E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00000346257731
Trial step length           =               0.003469
Gradient along search dir.  =         -0.00000030219
Functional at step 0        =     -16.77703911125669
Functional at step 1        =     -16.77703911016118
Functional predicted        =     -16.77703911138482
Selected quadratic step     =               0.000848
Conjugate gradients coeff.  =               0.695677
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  021 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998944
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512298085226
             Q0:     -16.777039111379
             G0:      -0.000000000138
   RMS gradient:       0.000001470391
     Trial step:       0.047305740161
             Q1:     -16.777039111385
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000007
           Qmin:     -16.777039111410
Quadratic minimum step length (  0.453954325509) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703911137866 0.00000000000 0.00000147039 0.4540  0.000    8.00000000
      ideal mu1:      -0.512298632920
             Q0:     -16.777039111412
             G0:      -0.000000000010
   RMS gradient:       0.000000395641
     Trial step:       0.146542298901
             Q1:     -16.777039111413
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.777039111413
Quadratic minimum step length (  0.229174562387) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77703911141187 0.00000000000 0.00000039564 0.2292  0.072    8.00000000
      ideal mu1:      -0.512298822489
             Q0:     -16.777039111414
             G0:      -0.000000000006
   RMS gradient:       0.000000244366
     Trial step:       0.183258743917
             Q1:     -16.777039111414
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039111415
Quadratic minimum step length (  0.461805487037) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703911141350 0.00000000000 0.00000024437 0.4618  0.381    8.00000000
      ideal mu1:      -0.512299110467
             Q0:     -16.777039111415
             G0:      -0.000000000002
   RMS gradient:       0.000000175426
     Trial step:       0.290912174871
             Q1:     -16.777039111415
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111415
Quadratic minimum step length (  0.202676279690) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703911141491 0.00000000000 0.00000017543 0.2027  0.515    8.00000000
      ideal mu1:      -0.512299111909
             Q0:     -16.777039111415
             G0:      -0.000000000002
   RMS gradient:       0.000000131772
     Trial step:       0.242818857009
             Q1:     -16.777039111415
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111415
Quadratic minimum step length (  0.157334211904) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703911141504 0.00000000000 0.00000013177 0.1573  0.564    8.00000000
      ideal mu1:      -0.512299075546
             Q0:     -16.777039111415
             G0:      -0.000000000000
   RMS gradient:       0.000000068975
     Trial step:       0.195457702593
             Q1:     -16.777039111415
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111415
  Cubic LS coeff:       0.279905527581
Predicted energy:     -16.777039111415
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77703911141494 0.00000000000 0.00000006898 0.2799  0.274    8.00000000
      ideal mu1:      -0.512299034960
             Q0:     -16.777039111415
             G0:      -0.000000000000
   RMS gradient:       0.000000042861
     Trial step:       0.233901028993
             Q1:     -16.777039111415
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111415
Quadratic minimum step length (  0.181053513208) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703911141534 0.00000000000 0.00000004286 0.1811  0.000    8.00000000
      ideal mu1:      -0.512299045291
             Q0:     -16.777039111415
             G0:      -0.000000000000
   RMS gradient:       0.000000025441
     Trial step:       0.205787762129
             Q1:     -16.777039111415
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111415
  Cubic LS coeff:       0.278871748578
Predicted energy:     -16.777039111415
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77703911141515 0.00000000000 0.00000002544 0.2789  0.352    8.00000000
      ideal mu1:      -0.512299055338
             Q0:     -16.777039111415
             G0:      -0.000000000000
   RMS gradient:       0.000000012017
     Trial step:       0.239558746576
             Q1:     -16.777039111415
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111415
Quadratic minimum step length (  0.021034953855) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703911141521 0.00000000000 0.00000001202 0.0210  0.223    8.00000000
      ideal mu1:      -0.512299054863
10    -16.77703911141528 0.00000000000 0.00000001155 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000298764565              |
           | Maximum change in energy =  0.00000000015394 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23488828E-04     0.96881075E-05
               2       0.25751006E-09     0.10077383E-09
               3       0.12767310E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14984778E-04     0.61803570E-05
               2       0.10485875E-09     0.41016524E-10
               3       0.87194080E-15     0.44408921E-15
================================================================================
RMS gradient                =       0.00000298764565
Trial step length           =               0.001715
Gradient along search dir.  =         -0.00000017616
Functional at step 0        =     -16.77703911141528
Functional at step 1        =     -16.77703911162516
Functional predicted        =     -16.77703911166266
Selected quadratic step     =               0.002809
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  022 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998516
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512300382498
             Q0:     -16.777039111646
             G0:      -0.000000000275
   RMS gradient:       0.000002071517
     Trial step:       0.070986669029
             Q1:     -16.777039111664
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000019
           Qmin:     -16.777039111710
Quadratic minimum step length (  0.469323260805) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703911164578 0.00000000000 0.00000207152 0.4693  0.000    8.00000000
      ideal mu1:      -0.512301167451
             Q0:     -16.777039111711
             G0:      -0.000000000021
   RMS gradient:       0.000000571640
     Trial step:       0.182525874830
             Q1:     -16.777039111714
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.777039111716
Quadratic minimum step length (  0.512978655767) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703911171083 0.00000000001 0.00000057164 0.5130  0.076    8.00000000
      ideal mu1:      -0.512301759253
             Q0:     -16.777039111716
             G0:      -0.000000000004
   RMS gradient:       0.000000250910
     Trial step:       0.305993264490
             Q1:     -16.777039111717
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039111725
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  4.256207212476)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703911171625 0.00000000000 0.00000025091 0.1500  0.000    8.00000000
      ideal mu1:      -0.512301737399
             Q0:     -16.777039111717
             G0:      -0.000000000004
   RMS gradient:       0.000000193361
     Trial step:       0.214240494943
             Q1:     -16.777039111718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039111718
Quadratic minimum step length (  0.487520912585) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703911171680 0.00000000000 0.00000019336 0.4875  0.594    8.00000000
      ideal mu1:      -0.512301573915
             Q0:     -16.777039111718
             G0:      -0.000000000001
   RMS gradient:       0.000000151392
     Trial step:       0.323182180213
             Q1:     -16.777039111718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111718
Quadratic minimum step length (  0.118978491346) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703911171783 0.00000000000 0.00000015139 0.1190  0.613    8.00000000
      ideal mu1:      -0.512301600356
             Q0:     -16.777039111718
             G0:      -0.000000000001
   RMS gradient:       0.000000140499
     Trial step:       0.196091122266
             Q1:     -16.777039111718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111718
Quadratic minimum step length (  0.064470057105) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703911171776 0.00000000000 0.00000014050 0.0645  0.861    8.00000000
      ideal mu1:      -0.512301636959
             Q0:     -16.777039111718
             G0:      -0.000000000001
   RMS gradient:       0.000000112016
     Trial step:       0.112436674845
             Q1:     -16.777039111718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111718
Quadratic minimum step length (  0.137491993665) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703911171758 0.00000000000 0.00000011202 0.1375  0.636    8.00000000
      ideal mu1:      -0.512301724806
             Q0:     -16.777039111718
             G0:      -0.000000000000
   RMS gradient:       0.000000045606
     Trial step:       0.124334800380
             Q1:     -16.777039111718
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111718
Quadratic minimum step length (  0.007967410484) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77703911171797 0.00000000000 0.00000004561 0.0080  0.166    8.00000000
      ideal mu1:      -0.512301725854
             Q0:     -16.777039111718
             G0:      -0.000000000000
   RMS gradient:       0.000000044581
     Trial step:       0.031474217895
             Q1:     -16.777039111718
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111718
  Cubic LS coeff:       0.038299912369
Predicted energy:     -16.777039111718
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77703911171798 0.00000000000 0.00000004458 0.0383  0.000    8.00000000
      ideal mu1:      -0.512301726705
10    -16.77703911171797 0.00000000000 0.00000004144 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000214612533              |
           | Maximum change in energy =  0.00000000010090 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.45586702E-04     0.18805382E-04
               2       0.97053634E-09     0.37970405E-09
               3       0.11583236E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.29888159E-04     0.12329368E-04
               2       0.41728071E-09     0.16322610E-09
               3       0.76936533E-15     0.42392305E-15
================================================================================
RMS gradient                =       0.00000214612533
Trial step length           =               0.002195
Gradient along search dir.  =         -0.00000010989
Functional at step 0        =     -16.77703911171797
Functional at step 1        =     -16.77703911160909
Functional predicted        =     -16.77703911175951
Selected quadratic step     =               0.000756
Conjugate gradients coeff.  =               0.516003
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  023 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999394
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512302266397
             Q0:     -16.777039111757
             G0:      -0.000000000047
   RMS gradient:       0.000000859673
     Trial step:       0.034719731958
             Q1:     -16.777039111759
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000002
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111761
  Cubic LS coeff:       0.085582023979
Predicted energy:     -16.777039111761
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77703911175733 0.00000000000 0.00000085967 0.0856  0.000    8.00000000
      ideal mu1:      -0.512302327541
             Q0:     -16.777039111761
             G0:      -0.000000000058
   RMS gradient:       0.000000704418
     Trial step:       0.054510411235
             Q1:     -16.777039111765
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -16.777039112110
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step= 12.072050848840)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77703911176139 0.00000000000 0.00000070442 0.1500  0.000    8.00000000
      ideal mu1:      -0.512302497788
             Q0:     -16.777039111768
             G0:      -0.000000000012
   RMS gradient:       0.000000327215
     Trial step:       0.090424342327
             Q1:     -16.777039111769
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777039111771
Quadratic minimum step length (  0.585052255315) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77703911176760 0.00000000000 0.00000032722 0.5851  0.216    8.00000000
      ideal mu1:      -0.512302918002
             Q0:     -16.777039111768
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000011
   RMS gradient:       0.000000405836
     Trial step:       0.230006446461
             Q1:     -16.777039111769
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777039111770
Quadratic minimum step length (  0.400420131360) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77703911176750 0.00000000000 0.00000040584 0.4004  1.538    8.00000000
      ideal mu1:      -0.512302855458
             Q0:     -16.777039111770
             G0:      -0.000000000000
   RMS gradient:       0.000000078172
     Trial step:       0.303478519018
             Q1:     -16.777039111770
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111770
Quadratic minimum step length (  0.108543235814) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77703911176974 0.00000000000 0.00000007817 0.1085  0.037    8.00000000
      ideal mu1:      -0.512302838564
             Q0:     -16.777039111770
             G0:      -0.000000000000
   RMS gradient:       0.000000058915
     Trial step:       0.181495290446
             Q1:     -16.777039111770
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111770
Quadratic minimum step length (  0.153294482126) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77703911176975 0.00000000000 0.00000005891 0.1533  0.568    8.00000000
      ideal mu1:      -0.512302809593
             Q0:     -16.777039111769
             G0:      -0.000000000000
   RMS gradient:       0.000000027989
     Trial step:       0.166799959704
             Q1:     -16.777039111770
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111770
  Cubic LS coeff:       0.260300742734
Predicted energy:     -16.777039111770
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77703911176948 0.00000000000 0.00000002799 0.2603  0.226    8.00000000
      ideal mu1:      -0.512302794907
             Q0:     -16.777039111770
             G0:      -0.000000000000
   RMS gradient:       0.000000017630
     Trial step:       0.208370231557
             Q1:     -16.777039111770
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777039111770
Quadratic minimum step length (  0.001761629481) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77703911176977 0.00000000000 0.00000001763 0.0018  0.000    8.00000000
      ideal mu1:      -0.512302794963
             Q0:     -16.777039111770
             G0:      -0.000000000000
   RMS gradient:       0.000000017579
     Trial step:       0.019159100783
             Q1:     -16.777039111770
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777039111770
  Cubic LS coeff:       0.018619120645
Predicted energy:     -16.777039111770
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77703911176970 0.00000000000 0.00000001758 0.0186  0.994    8.00000000
      ideal mu1:      -0.512302796150
10    -16.77703911176973 0.00000000000 0.00000001651 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000168775712              |
           | Maximum change in energy =  0.00000000010090 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.87801439794361 |
           | Pseudopotential (local)    :      -46.10858309772791 |
           | Pseudopotential (non-local):       -3.19083598025558 |
           | Hartree                    :       19.83873397427131 |
           | Exchange-correlation       :       -4.13021765397197 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77703911176973 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.10858309772838 |
           | Hartree                    :       19.83873397427149 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999991
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.00968730100061    -16.51862787579826   0.236633    -16.73775103114059
   2     0.00232652984677    -16.74175833467190   0.419828    -16.76460940662594
   3     0.00139332387227    -16.76533142649970   0.416228    -16.77354227583039
   4     0.00081289216829    -16.77372180671385   0.389534    -16.77631148055179
   5     0.00042186982699    -16.77633617894015   0.310342    -16.77688118875116
   6     0.00022261988504    -16.77688138735373   0.300313    -16.77702828221807
   7     0.00007503890669    -16.77702803476059   0.161055    -16.77703696860965
   8     0.00003299059762    -16.77703703189706   0.066801    -16.77703775438475
   9     0.00002610511908    -16.77703778114240   0.111485    -16.77703853082343
  10     0.00002051616783    -16.77703859394634   0.034035    -16.77703874718867
  11     0.00001830273489    -16.77703876395336   0.015340    -16.77703882065381
  12     0.00001689260445    -16.77703882778616   0.008510    -16.77703885510067
  13     0.00001583021370    -16.77703885886233   0.066057    -16.77703902220458
  14     0.00001174081708    -16.77703904989437   0.018547    -16.77703907938898
  15     0.00000959817292    -16.77703908490398   0.007696    -16.77703909342051
  16     0.00000823089179    -16.77703909510337   0.003898    -16.77703909832994
  17     0.00000725962477    -16.77703909898855   0.015908    -16.77703910726113
  18     0.00000525948364    -16.77703910902540   0.004382    -16.77703911047491
  19     0.00000415141074    -16.77703911079488   0.001749    -16.77703911117019
  20     0.00000346257731    -16.77703911125669   0.000848    -16.77703911138482
  21     0.00000298764565    -16.77703911141528   0.002809    -16.77703911166266
  22     0.00000214612533    -16.77703911171797   0.000756    -16.77703911175951
  23     0.00000168775712    -16.77703911176973  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:       8
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.276620833 Eh
                 Mid-gap level:      -0.119205967 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.966330908   1.0000000
                            2    -0.469144366   1.0000000
                            3    -0.356219527   1.0000000
                            4    -0.257516383   1.0000000
                        .......   --- gap ---   .........
                            5     0.019104450   0.0000000
                            6     0.108430955   0.0000000
                            7     0.355626203   0.0000000
                            8     0.418085757   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49693993  -0.08643466  -0.08352479 *
*    H       2     -1.16865548   0.92205141  -1.13140960 *
*    H       3     -1.12852325  -0.78709896   1.26730485 *
*                                                        *
**********************************************************
TOTAL:             -0.80023880   0.04851779   0.05237047
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77326285  -0.04359695  -0.02293113 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77326285  -0.04359695  -0.02293113
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00358240  -0.00063246  -0.00283030 *
*    H       2     -0.00011561   0.00011613  -0.00018962 *
*    H       3     -0.00007621  -0.00014183   0.00007427 *
*                                                        *
**********************************************************
TOTAL:              0.00339058  -0.00065817  -0.00294565
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00786179   0.00142089   0.00883123 *
*    H       2     -0.00786179   0.00142089   0.00883123 *
*    H       3     -0.00786179   0.00142089   0.00883123 *
*                                                        *
**********************************************************
TOTAL:             -0.02358537   0.00426267   0.02649369

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01910240   0.00084573   0.01638857 *
*    H       2      0.00845033  -0.00995589  -0.00027235 *
*    H       3      0.01065207   0.00911016  -0.01611622 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    6161.091s on      1 node(s)                                    
TOTAL TIME:      6161.091s on      1 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :    45        0.01s   0.000%  ------ ||
|| ngwf_gradient_coeffs                 :    23        0.01s   0.000%  ------ ||
|| integrals_brappd_ketppd              :    45        0.01s   0.000%  ------ ||
|| basis_extract_function_from_box      :   368        0.02s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    22        0.02s   0.000%  ------ ||
|| restart_kernel_write                 :    25        0.02s   0.000%  ------ ||
|| sparse_hotelling_invert              :    45        0.04s   0.001%  ------ ||
|| kernel_purify                        :   740        0.05s   0.001%  ------ ||
|| kernel_fix                           :   230        0.06s   0.001%  ------ ||
|| lnv_gradient_norm                    :   230        0.06s   0.001%  ------ ||
|| eigenstates_calculate                :     1        0.07s   0.001%  ------ ||
|| integrals_grad                       :     1        0.07s   0.001%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.07s   0.001%  ------ ||
|| sparse_trace                         :  6042        0.11s   0.002%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.14s   0.002%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.14s   0.002%  ------ ||
|| sparse_product                       :  7802        0.17s   0.003%  ------ ||
|| integrals_locpot_mat_els_batch       :   245        0.29s   0.005%  ------ ||
|| basis_dot_function_with_box          : 18500        0.30s   0.005%  ------ ||
|| pseudo_make_structure_factor         :     1        0.52s   0.008%  ------ ||
|| density_batch_row_sums               :   501        0.60s   0.010%  ------ ||
|| basis_add_function_to_box            : 37952        0.65s   0.011%  ------ ||
|| density_initial_guess_real           :     1        0.65s   0.011%  ------ ||
|| projectors_init_fftbox_recip         :    71        1.65s   0.027%  ------ ||
|| pseudopotentials_local_on_grid       :     1        1.92s   0.031%  ------ ||
|| projectors_func_ovlp_box             :    45        1.93s   0.031%  ------ ||
|| basis_copy_function_to_box           :  6512        2.05s   0.033%  ------ ||
|| integrals_kinetic                    :    45        2.24s   0.036%  ------ ||
|| fourier_apply_box_pair               :   552        2.42s   0.039%   3.297 ||
|| pseudo_local_calculate_forces        :     1        2.64s   0.043%  ------ ||
|| forces_calculate                     :     1        3.17s   0.051%  ------ ||
|| projectors_gradient_batch            :    23        4.77s   0.077%  ------ ||
|| cell_grid_extract_box                :  2190        7.54s   0.122%  ------ ||
|| properties_calculate                 :     1       12.85s   0.209%  ------ ||
|| cell_grid_deposit_box                :  4011       15.41s   0.250%  ------ ||
|| density_fftbox_deposit_to_cell       :  4008       15.45s   0.251%  ------ ||
|| ngwf_gradient_batch                  :    23       25.91s   0.421%  ------ ||
|| ngwf_gradient_lnv                    :    23       27.87s   0.452%  ------ ||
|| hamiltonian_energy_components        :     5       67.97s   1.103%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       84.37s   1.369%  ------ ||
|| potential_apply_to_ngwf_batch        :   245      105.98s   1.720%  ------ ||
|| integrals_locpot_dbl_grid            :   245      106.29s   1.725%  ------ ||
|| fourier_apply_box                    : 13560      185.03s   3.003%   5.200 ||
|| density_fftbox_interpolate_multiply  :  4008      193.24s   3.136%  ------ ||
|| density_batch_interp_deposit         :   501      212.32s   3.446%  ------ ||
|| density_on_dbl_grid                  :   501      236.77s   3.843%  ------ ||
|| hartree_on_grid                      :   501      941.39s  15.280%  ------ ||
|| fourier_apply_cell_backward          :  2506     1865.35s  30.276%   1.499 ||
|| fourier_apply_cell_forward           :  2506     2789.20s  45.271%   1.002 ||
|| xc_energy_potential                  :   501     4639.91s  75.310%  ------ ||
|| lnv_denskernel_optimise_cg           :    23     5684.48s  92.264%  ------ ||
|| ngwf_cg_optimise                     :     1     6045.13s  98.118%  ------ ||
|| total_time                           :     1     6161.09s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 09-03-2015 22:19 (-0000)

