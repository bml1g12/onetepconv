 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 3.5.9.8   |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  H. H. Helal,                   |
 |  Q. O. Hill, L. P. Lee, J.-H. Li, D. D. O`Regan,              |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer,    |
 |  G. Teobaldi, V. Vitale, K. A. Wilkinson and                  |
 |  T. J. Zuehlsdorff                                            |
 |                                                               |
 |                                   Copyright (c) 2004-2014     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 09-03-2015 23:12 (-0000)
 
If your calculation crashes here, before "Reading parameters..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.

Reading parameters from file "water.dat" ...... done
Running on 1 processor.
There are   1 MPI processes running on the same node as the root process.
Each MPI process is using: 
             1 threads for simulation cell FFTs.
             1 threads for parallel FFT box operations.
             1 threads for loops over batched FFT box operations.
             1 threads in other parallel regions.
 
Reading geometry and species blocks from file "water.dat" ...    
  Number of PPD points along a3 set to 1 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                         : SINGLEPOINT *! Type of calculation (String)      
cutoffenergy                 : 14.6995976898129      hartree *! Plane wave kine 
kernelcutoff                 : 1000.00000000000      bohr *! Density kernel rad 
xcfunctional                 : PBE *! Exchange-correlation functional (String)  
libxcxfuncid                 : 0 *! Functional identifier for which exchange fu 
libxccfuncid                 : 0 *! Functional identifier for which correlation 
charge                       : 0.000000000000000E+000 *! The total charge of th 
spin                         : 0 *! Total spin of system (Integer)              
spinpolarized                : F *! Switch for spin polarisation (Boolean)      
spinpolarised                : F *! Switch for spin polarisation (Boolean)      
constantefield               : 0.0000000000     0.0000000000     0.0000000000 * 
fftboxpref                   : 0 0 0 *! Preferred FFT box dimensions (String)   
ppdnpoints                   : 0 0 1 *! PPD edge length in grid points for each 
psincspacing                 : 0.0 0.0 0.0 *! PSINC grid spacing in atomic unit 
oldinput                     : F *! Read old-format input file (Boolean)        
develcode                    : *! For development code only (String)            
positionsxyzfile             : *! .xyz file to read positional data from (Strin 
positionsintermediatexyzfile : *! .xyz file to read positional data for interme 
positionsproductxyzfile      : *! .xyz file to read positional data for product 
nnho                         : F *! Initialise NGWFs to nonorthogonal natural h 
ngwfhalo                     : -1.00000000000000      bohr *! Halo extension to 
nonscforces                  : T *! Include non self-consistent forces due to N 
externalpressure             : 0.000000000000000E+000 ha/bohr**3 *! External ap 
smoothingfactor              : 5.00000000000000 *! Smoothing factor in volume t 
isosurfacecutoff             : 5.000000000000000E-004 *! Isosurface cutoff in v 
maxitpalsermano              : 50 *! Maximum number of iterations for Palser-Ma 
maxitkernelocccheck          : 0 *! Maximum number of kernel resets after occup 
maxitpen                     : 3 *! Max number of penalty functional iterations 
penparam                     : 4.00000000000000 *! Penalty functional parameter 
minitlnv                     : 10 *! Min number of LNV iterations (Integer)     
maxitlnv                     : 10 *! Max number of LNV iterations (Integer)     
lnvthresholdorig             : 1.000000000000000E-009 *! LNV convergence thresh 
lnvcgtype                    : LNV_FLETCHER *! Type of CG coefficient for LNV d 
lnvcgmaxstep                 : 3.00000000000000 *! Maximum length of trial step 
exactlnv                     : T *! Use original LNV algorithm (Boolean)        
oldlnv                       : F *! Use LNV algorithm backwards compatible pre  
lnvchecktrialsteps           : T *! Check stability of kernel at each trial ste 
kerfix                       : 1 *! Density kernel fixing approach (Integer)    
maxitkernelfix               : 3 *! Maximum # iterations of Penalty Functional  
initialdensrealspace         : T *! Construct initial density in real space fro 
kerneldiissize               : 10 *! Max number of kernels saved during kernel  
kerneldiismaxit              : 25 *! Max number of kernel DIIS iterations (Inte 
kerneldiisthreshold          : 1.000000000000000E-009 *! Density mixing converg 
kerneldiislineariter         : 5 *! Number of linear mixing iterations (Integer 
kerneldiiscoeff              : 0.100000000000000 *! Coefficient for the input k 
kerneldiisconvcriteria       : 1000 *! Density mixing convergence criteria (Str 
kerneldiislshift             : 1.00000000000000      hartree *! The initial val 
kerneldiislsiter             : 0 *! Maximum Level shifting iteration (Integer)  
kerneldiisscheme             : NONE *! Select scheme for kernel-diis (String)   
edft                         : F *! Use Ensemble-DFT method to optimise the ker 
edftmaxit                    : 10 *! Maximum number of EDFT iterations to optim 
edftmaxstep                  : 1.00000000000000 *! Maximum step during EDFT lin 
edftsmearingwidth            : 3.166811429000000E-003 hartree *! Occupancy smea 
edftfreeenergythres          : 1.000000000000000E-006 hartree *! Convergence th 
edftenergythres              : 1.000000000000000E-004 hartree *! Convergence th 
edftentropythres             : 1.000000000000000E-004 hartree *! Convergence th 
edftrmsgradientthres         : 1.000000000000000E-004 *! Convergence threshold  
edftcommutatorthres          : 1.000000000000000E-005 hartree *! Convergence th 
edftfermithres               : 1.000000000000000E-003 hartree *! Convergence th 
edftwriteocc                 : F *! Generate file with smeared occupancies (Boo 
edftextrabands               : -1 *! Number of additional MOs with non-zero occ 
eigensolverorfac             : 1.000000000000000E-004 *! Precision to which the 
eigensolverabstol            : 1.000000000000000E-009 *! Precision to which the 
writehamiltonian             : F *! Save current Hamiltonian matrix in a file ( 
readhamiltonian              : F *! Read current Hamiltonian matrix from a file 
ngwfcgrotate                 : F *! Rotate density kernel during NGWF optimizat 
edftroundevals               : -1 *! Round EDFT eigenvalues to N decimal figure 
maxitngwfcg                  : 100 *! Max number of NGWF conjugate gradients (C 
ngwfcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for NGWF 
ngwfcgmaxstep                : -8.00000000000000 *! Maximum length of trial ste 
eleccgmax                    : 3 *! Number of NGWF iterations to reset CG (Inte 
precondscheme                : TETER *! Recip-space preconditioning scheme (Str 
kzero                        : 3.00000000000000      1/bohr *! KE preconditioni 
rprecond                     : 2.00000000000000      bohr *! Radial cut-off for 
precondrecip                 : T *! Recip-space KE preconditioning (Boolean)    
precondreal                  : F *! Real-space KE preconditioning (Boolean)     
smoothscheme                 : NONE *! Smoothing scheme for the NGWF gradients  
rsmooth                      : 1.50000000000000      bohr *! Radius of the unsh 
ksmooth                      : 5.00000000000000      1/bohr *! Characteristic w 
occmix                       : 0.250000000000000 *! Mix fraction of occupancy p 
kernelupdate                 : F *! Update density kernel during NGWF line sear 
kernelchristoffelupdate      : F *! Update density kernel during NGWF line sear 
maxithotelling               : 100 *! Number of Hotelling iteration per NGWF ch 
maxresidhotelling            : 1.000000000000000E-012 *! Max allowed value in H 
rmskernelmeasure             : F *! Use root mean squared measure of [K,H] comm 
maxitngwfdiis                : 0 *! Max number of NGWF DIIS steps (Integer)     
ngwfdiissize                 : 4 *! Max size of the DIIS iterative subspace (In 
ngwfdiisreset                : 8 *! Max number of iteration for the resetting o 
ngwfdiismaxstep              : 2.00000000000000 *! Max length of trial step for 
ngwfthresholdorig            : 1.837500000000000E-006 *! NGWF convergence thres 
elecenergytol                : 3.674899422453221E-005 hartree *! Tolerance on t 
elecforcetol                 : -1.000000000000000E-003 ha/bohr *! Tolerance on  
ngwfmaxgrad                  : -2.000000000000000E-005 *! Maximum permissible v 
deltaeconv                   : T *! Use consecutive energy gains as a criterion 
kernelforceconv              : F *! Force density kernel convergence on last NG 
fftboxbatchsize              : 16 *! Number of NGWFs in fftbox batches (Integer 
densethreshold               : 0.400000000000000 *! Threshold for matrix segmen 
commsgroupsize               : -1 *! Number of nodes in a group (determines com 
ovlpfornonlocal              : F *! Overlap sparsity for nonlocal (Boolean)     
usespacefillingcurve         : T *! Re-arrange atoms according to space-filling 
corehamdenskernguess         : T *! Initial guess for density kernel from core  
checkatoms                   : T *! Check atoms on top of each other (Boolean)  
locpotscheme                 : FULL *! Scheme for evaluating local potential ma 
smoothprojectors             : -0.400000000000000 *! Halfwidth of Gaussian filt 
smoothlocpspot               : -0.400000000000000 *! Halfwidth of Gaussian filt 
oddpsincgrid                 : F *! Force odd number of points in simcell psinc 
evenpsincgrid                : F *! Force even number of points in simcell psin 
realspaceprojectors          : F *! Whether to evaluate and store projectors in 
projectorsprecalculate       : T *! Whether to pre-calculate the nonlocal proje 
outputdetail                 : VERBOSE *! Level of output detail (String)       
pawoutputdetail              : DEFAULT *! Level of output detail for PAW: BRIEF 
mdoutputdetail               : DEFAULT *! Level of output detail for MD: BRIEF, 
timingslevel                 : 1 *! Level of timings output: 0(none) 1(nodes su 
timingsorder                 : TIME *! Sorting order of timings (String)        
runtime                      : -1.00000000000000 *! The maximum allocated run t 
writeparams                  : T *! Output runtime parameters at startup (Boole 
esdfdump                     : T *! Dump all runtime parameters at startup (Boo 
writeforces                  : T *! Write ionic forces (Boolean)                
writepositions               : T *! Write ionic positions each geometry or MD s 
writevelocities              : F *! Write ionic velocities each MD step (Boolea 
writexyz                     : F *! Output coordinates in .xyz file (Boolean)   
printqc                      : F *! Print Quality Control information (Boolean) 
cubeformat                   : T *! Allow .cube format for plot outputs (Boolea 
dxformat                     : F *! Allow .dx format for plot outputs (Boolean) 
dxformatcoarse               : F *! Output only points on the coarse grid (Bool 
dxformatdigits               : 7 *! Number of significant digits in .dx output  
grdformat                    : F *! Allow .grd format for plot outputs (Boolean 
writedensityplot             : F *! Write the charge density in plotting format 
writepolarisationplot        : F *! Write the polarisation density in plotting  
writengwfplot                : F *! Write NGWFs in plotting format (Boolean)    
writengwfgradplot            : F *! Write NGWF Gradients in plotting format (Bo 
writengwfradial              : 0 *! Write NGWFs radial distributions (Integer)  
writengwfgradradial          : 0 *! Write NGWFs gradients radial distributions  
writeradialstep              : 5.000000000000000E-003 bohr *! Define the grid s 
writeradialsmear             : 1.000000000000000E-002 bohr *! Define the gaussi 
writeinitialradialngwfs      : F *! Controls output of radial NGWF plots from a 
readdenskern                 : F *! Read density kernel restart information (Bo 
writedenskern                : T *! Write density kernel restart information (B 
readtightboxngwfs            : F *! Read in universal tightbox NGWFs restart in 
writetightboxngwfs           : T *! Write in universal tightbox NGWFs restart i 
writeconvergeddkngwfs        : F *! Only write Density Kernel and NGWFs upon co 
readswngwfs                  : F *! Read NGWFs restart information in spherical 
writeswngwfs                 : F *! Write NGWFs restart information in spherica 
writemaxl                    : 3 *! Maximum angular momentum number when writin 
readmaxl                     : 3 *! Maximum angular momentum number when readin 
extransw                     : 0 *! Maximum number of zeros of the sph Bessel f 
paw                          : F *! Uses a PAW construction to find correct cor 
finegridscale                : 2.00000000000000 *! Ratio of size of fine grid t 
dblgridscale                 : 2.00000000000000 *! Ratio of charge density / po 
augfuncsrecip                : T *! Construct Augmentation functions in recip s 
pseudopath                   : *! Path to pseudopotentials (String)             
dispersion                   : 0 *! Select dispersion correction (String)       
vdwdcoeff                    : -1.00000000000000 *! Replacement VDW damping coe 
hubbardmaxiter               : 10 *! Maximum number of DFT+U projector optimisa 
hubbardenergytol             : 1.000000000000000E-008 hartree *! Energy toleran 
hubbardconvwin               : 2 *! Energy convergence window when using DFT+U  
hubbardprojmixing            : 0.000000000000000E+000 *! Proportion of old Hubb 
hubbardfunctional            : 1 *! DFT+U energy functional to use (Integer)    
hubbardtensorcorr            : 1 *! DFT+U projector tensorial correction to use 
hubbardngwfspinthreshold     : 2.000000000000000E-005 *! NGWF RMS  gradient thr 
hubbardscfonthefly           : F *! Carry out on-the-fly HUBBARDSCF with new pr 
hubbardreadprojectors        : F *! Logical to read Hubbard-projectors from fil 
cdftatomcharge               : F *! Perform an ATOM-CHARGE-constrained CDFT sim 
cdftatomspin                 : F *! Perform an ATOM-SPIN-constrained CDFT simul 
cdftgroupchargediff          : F *! Perform a GROUP-CHARGE-DIFFERENCE-constrain 
cdftgroupspindiff            : F *! Perform a GROUP-SPIN-DIFFERENCE-constrained 
cdftgroupchargeacceptor      : F *! Perform an ACCEPTOR GROUP-CHARGE-constraine 
cdftgroupchargedonor         : F *! Perform a DONOR GROUP-CHARGE-constrained CD 
cdftgroupspinacceptor        : F *! Perform an ACCEPTOR GROUP-SPIN-constrained  
cdftgroupspindonor           : F *! Perform a DONOR GROUP-SPIN-constrained CDFT 
cdfthubbard                  : F *! Perform a constrained-DFT+U simulation (Boo 
cicdft                       : F *! Perform a CONFIGURATION-INTERACTION CDFT si 
cdftprintallocc              : F *! Logical to have the occupancy-matrix of all 
cdftreadprojectors           : F *! Logical to read cDFT-projectors from file ( 
cdftgroupchargeuponly        : F *! Logical to constrain only UP electrons (Boo 
cdftgroupchargedownonly      : F *! Logical to constrain only UP electrons (Boo 
cdftmultiproj                : F *! Logical to use mutiple angular-momentum pro 
cicdftnumconf                : 0 *! Number of cDFT-configurations for CI_CDFT s 
cdftgroupchargedifftarget    : 0.000000000000000E+000 *! Targeted CHARGE differ 
cdftgroupspindifftarget      : 0.000000000000000E+000 *! Targeted SPIN differen 
cdftchargeacceptortarget     : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftchargedonortarget        : 0.000000000000000E+000 *! Targeted group-CHARGE  
cdftspinacceptortarget       : 0.000000000000000E+000 *! Targeted group-SPIN fo 
cdftspindonortarget          : 0.000000000000000E+000 *! Targeted group-SPIN fo 
maxitcdftucg                 : 60 *! Max number of cdFT-U conjugate gradients ( 
cdftcgtype                   : NGWF_FLETCHER *! Type of CG coefficient for CDFT 
cdftcgthreshold              : 1.000000000000000E-003 *! RMS gradient convergen 
cdfttriallength              : 0.100000000000000 *! Trial length for cDFT line- 
cdftcgmax                    : 5 *! Number of U-opt iterations to reset CG (Int 
cdftmaxgrad                  : 1.000000000000000E-003 *! Maximum permissible va 
cdftelecenergytol            : -1.000000000000000E-004 hartree *! Tolerance on  
cdftcgmaxstep                : 50.0000000000000 *! Maximum length of trial step 
cdftguru                     : F *! Let the user signal she/he does not need he 
cdftcontinuation             : F *! Logical to restart (from the *.cdft file) a 
cdfttight                    : F *! Logical to activate tight NGWFs-cDFT optimi 
cdftwritepotentials          : T *! Logical to write cDFT-potentials into file  
coulombcutoffradius          : 0.000000000000000E+000 bohr *! Radius of sphere  
coulombcutofflength          : 0.000000000000000E+000 bohr *! Length of cylinde 
coulombcutofftype            : NONE *! Type of cutoff coulomb interaction: NONE 
coulombcutoffwriteint        : F *! Write real-space cutoff Coulomb interaction 
pbccorrectioncutoff          : 0.000000000000000E+000 bohr *! alpha*L cutoff pa 
doproperties                 : T *! Allow calculation of properties (Boolean)   
numeigenvalues               : 6 *! Number of energy and occupancy eigenvalues  
homodensplot                 : -1 *! Number of squared MOs to plot from HOMO an 
lumodensplot                 : -1 *! Number of squared MOs to plot from LUMO an 
homoplot                     : -1 *! Number of MOs to plot from HOMO and lower  
lumoplot                     : -1 *! Number of MOs to plot from LUMO and higher 
dossmear                     : 3.674899422453221E-003 hartree *! Half width of  
ldossmear                    : 3.674932438755288E-003 hartree *! Lorentzian bro 
popncalculate                : F *! Allow population analysis (Boolean)         
popnbondcutoff               : 5.66917840375065      bohr *! Bond length cutoff 
ngwfanalysis                 : F *! Perform NGWF analysis (Boolean)             
polarisationcalculate        : F *! Allow calculation of polarisation (Boolean) 
spreadcalculate              : F *! Calculate spread of NGWFs (Boolean)         
anharmoniccalculate          : F *! Active the calculation of the IR spectrum ( 
geommodulusest               : 1.700000000000000E-002 ha/bohr**3 *! The estimat 
geomfrequencyest             : 7.600000000000000E-003 hartree *! The estimated  
geomenergytol                : 3.674899422453221E-007 hartree *! Geometry optim 
geomforcetol                 : 5.834023153688738E-004 ha/bohr *! Geometry optim 
geomdisptol                  : 1.889726877774356E-003 bohr *! Geometry optimiza 
geommaxiter                  : 100 *! Maximum number of geometry optimization i 
geomconvergencewin           : 2 *! Geometry optimization convergence tolerance 
geomcontinuation             : F *! Read information for continuation of a prev 
geombackupiter               : 1 *! Number of geometry optimisation iterations  
geomresetdkngwfsiter         : 6 *! Number of geom iterations between resets of 
geomlbfgsmaxupdates          : 30 *! Number of LBFGS update vectors to store (I 
geomlbfgsblocklength         : 30 *! How many updates to store before reallocat 
geomreusedkngwfs             : T *! Re-use density kernel and NGWFs during geom 
geomprintinvhessian          : F *! Write inverse Hessian to standard output (B 
geommethod                   : CARTESIAN *! Method for geometry optimization (S 
geomlbfgs                    : F *! Whether to perform LBFGS rather than BFGS i 
tssearchmethod               : LSTQST *! Specifies method to be used for TS sea 
tssearchlstqstprotocol       : LSTMAXIMUM *! Specifies LSTQST protocol (String) 
tssearchqstmaxiter           : 5 *! Specifies maximum number of QST steps (Inte 
tssearchcgmaxiter            : 20 *! Specifies maximum number of CG steps (Inte 
tssearchforcetol             : 5.000000000000000E-003 ha/bohr *! Force toleranc 
tssearchdisptol              : 1.000000000000000E-002 bohr *! Displacement tole 
mdproperties                 : F *! Compute vibrational and IR spectra from MD  
mdrestart                    : F *! Restart MD from backup files (Boolean)      
mddeltat                     : 40.0000000000000      aut *! Molecular dynamics  
mdnumiter                    : 100 *! Maximum number of molecular dynamics iter 
mdresethistory               : 100 *! Reset mixing scheme for initial guess of  
mtsxi                        : F *! Internal thermostat in the multiple time-st 
mtsnstep                     : 1 *! Number of time steps in the multiple time-s 
mtsngwfthreshold             : 5.000000000000000E-004 *! NGWF convergence thres 
mtslnvthreshold              : 5.000000000000000E-006 *! LNV convergence thresh 
mtselecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on  
mtselecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on  
mtsngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible v 
mtsmaxitngwfcg               : 50 *! Max number of conjugate gradients iteratio 
mtsminitlnv                  : 5 *! Min number of LNV iterations (Integer)      
mtsmaxitlnv                  : 5 *! Max number of LNV iterations (Integer)      
mtsmaxitpen                  : 3 *! Max number of penalty iterations (Integer)  
mtsmixinc                    : F *! Include the mts correction step in the NGWF 
mixdkntype                   : NONE *! Type of mixing used to build new guess f 
mixdknnum                    : 0 *! Number of coefficients used to build new gu 
mixdkninittype               : NONE *! Type of initialization before MIX_DKN_TY 
mixdkninitnum                : 0 *! Number of steps before extrapolation of the 
mixdknreset                  : 50 *! Number of extrapolation steps between two  
mixngwfstype                 : NONE *! Type of mixing used to build new guess f 
mixngwfsnum                  : 0 *! Number of coefficients used to build new gu 
mixngwfsinittype             : NONE *! Type of initialization before MIX_DKN_TY 
mixngwfsinitnum              : 0 *! Number of steps before extrapolation of the 
mixngwfsreset                : 50 *! Number of extrapolation steps between two  
mixngwfscoeff                : 0.100000000000000 *! Mix the propagated NGWFs wi 
mixlocallength               : 10.0000000000000      bohr *! Max radius for loc 
mixlocalsmear                : 5.00000000000000      bohr *! Radial smearing fo 
condreaddenskern             : F *! Read in conduction density kernel (Boolean) 
condreadtightboxngwfs        : F *! Read in universal tightbox conduction NGWFs 
condfixedshift               : F *! Fixed projected conduction Hamiltonian shif 
condcalcmaxeigen             : T *! Calculate maximum conduction Hamiltonian ei 
condnumstates                : 0 *! Number of conduction states to be optimised 
condmaxitlnv                 : 10 *! Max number of LNV iterations during conduc 
condminitlnv                 : 10 *! Min number of LNV iterations during conduc 
condkernelcutoff             : 1000.00000000000      bohr *! Conduction density 
condinitshift                : 0.000000000000000E+000 hartree *! Initial shifti 
condshiftbuffer              : 0.100000000000000      hartree *! Additional buf 
condnumextrastates           : 0 *! Number of extra conduction states for initi 
condnumextraits              : 0 *! Number of NGWF iterations with extra conduc 
condplotjointorbitals        : T *! Plot orbitals in the joint basis following  
condplotvcorbitals           : T *! Plot orbitals in the val and cond NGWF basi 
condcalcopticalspectra       : F *! Calculate matrix elements for optical absor 
condspeccalcmommatels        : T *! Calculate momentum matrix elements (default 
condspeccalcnonloccomm       : T *! Calculate nonlocal commutator for momentum  
condspeccontderiv            : T *! Calculate non-local commuator using continu 
condspecnonloccommshift      : 1.000000000000000E-004 *! Finite difference shif 
condspecprintmatels          : F *! Write optical matrix elements to file (Bool 
condspecoptsmear             : 3.674932438755288E-003 hartree *! Half width of  
condspecscissorop            : 0.000000000000000E+000 hartree *! Scissor operat 
condcalceels                 : F *! Calculate matrix elements for electron ener 
lrtddftcalculate             : F *! enables LR-TDDFT calculation (Boolean)      
lrtddftnumstates             : 1 *! Sets the number of excitation energies we w 
lrtddftcgthreshold           : 1.000000000000000E-006 *! sets convergence toler 
lrtddftpenaltytol            : 1.000000000000000E-008 *! sets the convergence t 
lrtddftmaxitpen              : 20 *! sets the maximum number of iterations for  
lrtddftmaxitcg               : 60 *! sets the maximum number of iterations for  
lrtddftresetcg               : 100 *! sets the number of iterations after which 
lrtddftkernelcutoff          : 1000.00000000000      bohr *! sets cutoff on the 
lrtddftwritedensities        : T *!Determines whether to write out TDDFT respon 
lrtddftwritekernels          : F *! writes out response kernels after each iter 
lrtddftrestart               : F *! Restart flag for the LR_TDDFT option (Boole 
lrtddfttriplet               : F *! DEtermines if triplet states are calculated 
lrtddftprojector             : T *! Use projector onto unoccupied subspace (Boo 
lrtddftjointset              : T *! Use joint set to represent cond states (Boo 
lrtddftpreopt                : T *! Refine starting guess in preoptimisation ro 
lrtddftpreoptiter            : 20 *! Number of preoptimisation iterations (Inte 
lrtddftanalysis              : F *! Do a full O(N^3) analysis of TDDFT transiti 
etransbulk                   : F *! Compute electronic transport coefficients ( 
etranslcr                    : F *! Compute electronic transport coefficients ( 
etranssameleads              : F *! Use same description for all leads (Boolean 
etranswritehs                : F *! Write hamiltonian corresponding to transpor 
etransecmplx                 : 1.000000000000000E-006 hartree *! Imaginary part 
etransemax                   : 0.200000000000000      hartree *! Highest energy 
etransemin                   : -0.200000000000000      hartree *! Lowest energy 
etransenum                   : 50 *! Number of energy points for the calculatio 
etranseref                   : 0.000000000000000E+000 hartree *! Reference ener 
etranserefmethod             : DIAG *! The method used to determine the referen 
etranscalculateleadmu        : F *! Calculate the lead chemical potentials (Boo 
etransleadnkpoints           : 32 *! Number of kpoints to use to determine lead 
etransleaddisptol            : 1.00000000000000      bohr *! The maximum accept 
anhqcfactor                  : HARMONIC *! Quantum correction factor in IR spec 
anhacffactor                 : NONE *! Prefactor for the autocorrelation functi 
anhtype                      : IR_CALCULATION *! Describe the type of calculati 
anhfirstiter                 : 0 *! First md iteration to include in the autoco 
anhlastiter                  : 0 *! Last md iteration to include in the autocor 
anhmdtemp                    : 0.000000000000000E+000 kelvin *! Temperature in  
anhplotfirstfreq             : 0.000000000000000E+000 1/cm *! First freq to be  
anhplotlastfreq              : 0.000000000000000E+000 1/cm *! Last freq to be s 
anhplotall                   : F *! Plot the whole IR spectrum (Boolean)        
anhapplyfilter               : F *! Apply the gaussian filter (Boolean)         
phononfarmingtask            : 0 *! Operation to perform for phonon calc (for t 
phononsampling               : 1 *! Default number of sampling points for finit 
phononvibfree                : 7 *! Default allowed vibrational degrees of free 
phononfinitedisp             : 0.100000000000000      bohr *! Amplitude of the  
phononfmax                   : 5.000000000000000E-003 ha/bohr *! Maximum force  
phononenergycheck            : F *! Check total energy of system doesn't decrea 
phonontmin                   : 0.000000000000000E+000 hartree *! Lower bound of 
phonontmax                   : 2.000000000000000E-003 hartree *! Upper bound of 
phonondeltat                 : 1.500000000000000E-005 hartree *! Temperature st 
phononminfreq                : 3.600000000000000E-006 hartree *! Discard phonon 
phononwriteeigenvecs         : F *! Write phonon mode eigenvectors to file (Boo 
phononanimatescale           : 1.00000000000000 *! Scaling factor for phonon mo 
phonondosmin                 : 0.000000000000000E+000 *! Lower bound of frequen 
phonondosmax                 : 1000.00000000000 *! Upper bound of frequency ran 
phonondosdelta               : 10.0000000000000 *! Frequency step (in cm^-1) fo 
phonondos                    : T *! Calculate phonon DOS from MP grid and write 
phononsk                     : F *! Use Slater-Koster style interpolation for q 
bskpointpathspacing          : 0.188972700000000      1/bohr *! K-point spacing 
bsnumeigenvalues             : -1 *! Num of energy and occ. eigenvalues to prin 
bsunfold                     : 0 0 0 *! Number of times to unfold Brillouin zon 
bsmethod                     : TB *! Method to use: 'KP' or 'TB' (String)       
dotddft                      : F *! Allow Time-Dependent DFT calculation (Boole 
tddftmaximumenergy           : 1.00000000000000      hartree *! Desired maximum 
tddftresolution              : 1.000000000000000E-003 hartree *! Desired resolu 
tddftpropagationmethod       : CRANKNICHOLSON *! Method used to integrate von N 
tddftsparsitylevel           : 0 *! Matrix sparsity when computing propagators  
tddfttammdancoff             : F *! Invoke Tamm-Dancoff decoupling approximatio 
tddftdipolekickstrength      : 0.0 0.0 0.0 *! Maximum allowed phase shift in TD 
tddftxcfunctional            : LDA *! Exchange-correlation functional for TDDFT 
tddfthamiltonianmixing       : 0 *! Order of polynomial extrapolation to H(t +  
tddftdamping                 : 0.000000000000000E+000 hartree *! Energy smearin 
tddftenforcedidempotency     : F *! Project out at each timestep that part of c 
tddftmaxithotelling          : 50 *! Number of Hotelling iteration per propagat 
tddftmaxresidhotelling       : 1.000000000000000E-018 *! Max allowed value in H 
tddftinvoverlapexact         : T *! Renew inverse overlap with O N^3 algorithm  
isimplicitsolvent            : F *! Use implicit solvent? (Boolean)             
issmearedionrep              : F *! Implicit solvent: use smeared ions for elec 
isseparaterestartfiles       : F *! If true, dielectric cavity will be construc 
isautosolvation              : F *! If true, vacuum calculation will automatica 
isincludecavitation          : F *! Implicit solvent: include cavitation energy 
isdensitythreshold           : 7.800000000000000E-004 *! Implicit solvent: rho_ 
issolvationbeta              : 1.30000000000000 *! Implicit solvent: beta param 
isbulkpermittivity           : 1.00000000000000 *! Implicit solvent: eps_inf pa 
ismultigriddefecterrortol    : 1.000000000000000E-002 *! Implicit solvent: stop 
ismultigriderrortol          : 1.000000000000000E-005 *! Implicit solvent: stop 
issmearedionwidth            : 0.800000000000000      bohr *! Implicit solvent: 
iscorewidth                  : 1.20000000000000      bohr *! Implicit solvent:  
issurfacethickness           : 2.000000000000000E-004 *! Implicit solvent: thic 
issolventsurfacetension      : 4.762400000000000E-005 ha/bohr**2 *! Implicit so 
ismultigridmaxiters          : 100 *! Implicit solvent: max number of iteration 
ismultigridnlevels           : 4 *! Implicit solvent: number of levels in multi 
isdiscretizationorder        : 8 *! Implicit solvent: discretization order (2nd 
isbccoarseness               : 5 *! Open BCs: controls boundary condition coars 
isbcsurfacecoarseness        : 1 *! Open BCs: controls boundary condition coars 
isbcthreshold                : 1.000000000000000E-009 *! Open BCs: controls bou 
ischecksolvenergygrad        : F *! Implicit solvent: sanity check the energy g 
issolvationmethod            : DIRECT *! Implicit solvent: direct or corrective 
isdielectricmodel            : FIX_INITIAL *! Implicit solvent: how the cavity  
isdielectricfunction         : FGF *! Implicit solvent: how the cavity is deter 
issolvationoutputdetail      : NONE *! Implicit solvent: controls extra output  
openbcionion                 : F *! Force open BCs in ion-ion energy (Boolean)  
openbchartree                : F *! Force open BCs in Hartree potential (Boolea 
openbcpspot                  : F *! Force open BCs in local pseudopotential (Bo 
openbcpspotfinetunenptsx     : 100000 *! Open BCs in local pseudo, npts_x param 
openbcpspotfinetunealpha     : 0.300000000000000 *! Open BCs in local pseudo, a 
openbcpspotfinetunef         : -1 *! Open BCs in local pseudo, fineness paramet 
hfxintegration               : 2 *! Variant of the numerical pointwise approach 
hfxcutoff                    : 1000.00000000000      bohr *! HFx cutoff radius  
hfxnlppforexchange           : F *! Give exchange matrix same sparsity as non-l 
hfxradialsegments            : 50 *! Number of radial segments in vmatrix evalu 
hfxangularsegments           : 50 *! Number of angular segments in vmatrix eval 
hfxcheborder                 : 16 *! Order for Chebyshev interpolation (Integer 
hfxchebintervals             : 14 *! Number of intervals Chebyshev interpolatio 
hfxchebabatchsize            : 10 *! Number of SW expansions buffered (Integer) 
hfxchebbbatchsize            : 10 *! Number of SW pot expansions buffered (Inte 
hfxmaxl                      : 4 *! Maximum quantum number l used for SW expans 
hfxmaxzeros                  : 10 *! Maximum number of Bessel zeros used for SW 
hfxreadvmatrix               : F *! Read restart information for the V matrix ( 
hfxwritevmatrix              : F *! Write restart information for the V matrix  
hfxreadxmatrix               : F *! Read restart information for the X matrix ( 
hfxwritexmatrix              : F *! Write restart information for the X matrix  
hfxdebug                     : F *! Debug HFx? (Boolean)                        
hfxmetric                    : ELECTROSTATIC *! Electrostatic or overlap metric 
hfxoverlapindirect           : F *! Inversions done for overlap metric (Boolean 
hfximproveinverse            : F *! Use Hotelling improvement when calculating  
hfxcthreshold                : 0.000000000000000E+000 *! Absolute magnitude bel 
hfxcachelimitforsnpos        : 1024 *! Max cache size for SWOP-NGWF-product ove 
hfxcachelimitforswops        : 1024 *! Max cache size for SWs or SWpots in PPDs 
hfxcachelimitforwmats        : 1024 *! Max cache size for W-matrices (in MiB) ( 
hfxcachelimitforexpansions   : 1024 *! Max cache size for expansions (tb_swpot_ 
hfxcachelimitforps           : 1024 *! Max cache size for p_beta_delta (in MiB) 
hfxcachelimitforngwfs        : 256 *! Max cache size for remote NGWFs (in MiB)  
hfxcachelimitfordknblks      : 50 *! Max cache size for remote DKN blocks (in M 
zerototalforce               : T *! Subtract avg force to ensure Newton's 3rd l 
ddeccalculate                : F *! Performs DDEC charge analysis (Boolean)     
ddecwriterad                 : F *! Write DDEC partial radial density for each  
ddecclassicalhirshfeld       : F *! DDEC range of IH (+/-) ionic reference stat 
ddecradnpts                  : 100 *! Number of spherical shells per atom (Inte 
ddecradrcut                  : 10.0000000000000      bohr *! Radius of largest  
ddecmaxit                    : 2000 *! Maximum number of DDEC iterations (Integ 
ddecconvthreshold            : 2.000000000000000E-005 *! DDEC charge convergenc 
ddecihfraction               : 0.214285714285714 *! DDEC IH fraction (Double Pr 
ddeczerothreshold            : 1.000000000000000E-007 *! DDEC threshold to negl 
ddecihionicrange             : 2 *! DDEC range of IH (+/-) ionic reference stat 
ddecatomsolvemaxit           : 480 *! Maximum number of iterations for the atom 
ddecrcompmaxit               : 50 *! Maximum number of iterations for finding r 
ddectargetradius             : 11.5000000000000      bohr *! DDEC force target  
ddecrcompeconv               : 5.000000000000000E-008 hartree *! Energy converg 
ddecwritercomp               : F *! Write compensated ionic densities for all r 
ddecrefdensinit              : T *! Initialize ISA guess densities as neutral r 
ddecrenormalizerefdens       : F *! Renormalize reference densities (Boolean)   
ddecmultipole                : F *! Compute DDEC dipoles and quadrupoles (Boole 
ddecmoment                   : F *! Compute DDEC moment (Boolean)               
ddecmomentorder              : 1 *! Order of DDEC moment (Integer)              
ddecinterpraddens            : F *! Interpolate converged radial densities for  
ddecavgrad                   : F *! Compute expected radius of each atom based  
ddecminshelldens             : 100.000000000000 *! Minimum number of points per 
ddecrmse                     : F *! Calculate DDEC point charge RMS V(r) (Boole 
writenbo                     : F *! Performs Natural Population Analysis and wr 
nboinitlclowdin              : T *! Performs atom-centered Lowdin symmetric ort 
nbowritelclowdin             : F *! Write a GENNBO FILE.47 containing all the a 
nbowritenpacomp              : F *! Writes individual NAO population into the s 
nboscaledm                   : T *! Scales density matrix in the FILE.47 output 
nbowritedipole               : F *! Writes dipole matrix to FILE.47 (Boolean)   
nboscalespin                 : T *! Whether or not partial density matrices for 
nbopnaoanalysis              : F *! S/P/D/F CHARACTER ANALYSIS ON PNAO. (Boolea 
nboaopnaoscheme              : ORIGINAL *! AO to PNAO scheme to use in generati 
plotnbo                      : F *! Plot NBO's orbitals from FILE.xx as defined 
nboplotorbtype               : *! Type of GENNBO-generated orbital to plot. (St 
threadsmax                   : 1 *! Number of threads in outer loops (Integer)  
threadsnumfftboxes           : 1 *! Number of threads to use in OpenMP-parallel 
threadsperfftbox             : 1 *! Number of nested threads used for FFT box o 
threadspercellfft            : 1 *! Number of threads to use in OpenMP-parallel 
threadsnummkl                : 1 *! Number of threads to use in OpenMP-parallel 
%block positionsabs          : *! Cartesian positions for each atom (Block)     
O 47.82274073160245      47.25667645460973      45.98252560975496               
H 49.02657873213836      46.37388321646128      47.05079896262087               
H 48.98893597357800      48.00111084095992      44.77769116409311               
%endblock positionsabs       : *! Cartesian positions for each atom (Block)     
%block latticecart           : *! The simulation cell lattice vectors (Block)   
94.486315649999995      0.000000000000000       0.000000000000000               
0.000000000000000       94.486315649999995      0.000000000000000               
0.000000000000000       0.000000000000000       94.486315649999995              
%endblock latticecart        : *! The simulation cell lattice vectors (Block)   
%block species               : *! Species information (symbol, atomic number, n 
O O 8 4 6.0                                                                     
H H 1 4 6.0                                                                     
%endblock species            : *! Species information (symbol, atomic number, n 
%block speciespot            : *! Pseudopotential name for each species (Block) 
O O_00PBE_OP.recpot                                                             
H H_00PBE_OP.recpot                                                             
%endblock speciespot         : *! Pseudopotential name for each species (Block) 
%block speciesatomicset      : *! Atomic set name for each species (Block)      
O SOLVE                                                                         
H SOLVE                                                                         
%endblock speciesatomicset   : *! Atomic set name for each species (Block)      
%block speciesconstraints    : *! Ionic constraints for each species (Block)    
O NONE                                                                          
H NONE                                                                          
%endblock speciesconstraints : *! Ionic constraints for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: O_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 1; rc = 1.54 bohr
File: H_00PBE_OP.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          1         4         3
  H          2         8         0
.......   ......    ......    ......
Totals:      3        12         3
-------------------------------------------------------------------------------
 
============================== PSINC grid sizes ================================
                      Simulation cell:  132 x 132 x 132
                              FFT-box:   55 x  55 x  55
                                  PPD:    6 x   6 x   1
Grid space d1=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d2=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
Grid space d3=  0.715805421591a0 (KE cutoff=  14.82566Eh = 403.42673eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:    132   132   132
          Real-space ('12') slabs/node (min max mean):    132   132   132
         Recip-space ('23') slabs/node (min max mean):     67    67    67
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    264   264   264
          Real-space ('12') slabs/node (min max mean):    264   264   264
         Recip-space ('23') slabs/node (min max mean):    133   133   133
********************************************************************************

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max     12;  min     12;  average     12
... Projector load balancing: max      3;  min      3;  average      3
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       6.571766
        Ewald: reciprocal-space energy =       0.081892
         Ewald: (sum_charge)**2 Energy =       0.234823
         Ewald: (sum_charge**2) Energy =       0.482986
                          Ewald Energy =       5.935849
Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):      15812     15812
... Nonlocal pseudopotential projector initialisation
... done

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  33.33%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1 3216.4518354715   -7.1202816974   10.1554512533   -2.4512395525
  2 1275.3268459984   -3.1443812453   13.3511488054   -3.1747088977
  3  655.6100215422   -2.9485004107   13.5591716205   -3.2265097030
  4  333.4383110991   -2.9071229743   13.6038731329   -3.2393597159
  5  165.9195334793   -2.8936012298   13.6186080893   -3.2442341554
  6   78.8111333398   -2.8876998472   13.6250676297   -3.2465384671
  7   33.5149711848   -2.8848489821   13.6281943061   -3.2476984221
  8    9.9610079041   -2.8834315976   13.6297503547   -3.2482910000
  9   -2.2870418903   -2.8827209226   13.6305310368   -3.2485948083
 10   -8.6560240825   -2.8823635388   13.6309238114   -3.2487507577
 11  -11.9678934703   -2.8821835875   13.6311216658   -3.2488308715
 12  -13.6900650503   -2.8820929160   13.6312213986   -3.2488720574
 13  -14.5855940943   -2.8820472100   13.6312716928   -3.2488932467
 14  -15.0512691430   -2.8820241631   13.6312970640   -3.2489041566
 15  -15.2934201584   -2.8820125389   13.6313098662   -3.2489097782
 16  -15.4193386906   -2.8820066745   13.6313163278   -3.2489126774
 17  -15.4848163341   -2.8820037152   13.6313195901   -3.2489141737
 18  -15.5188647147   -2.8820022215   13.6313212375   -3.2489149466
 19  -15.5365698769   -2.8820014674   13.6313220696   -3.2489153462
 20  -15.5457765642   -2.8820010866   13.6313224901   -3.2489155530
 21  -15.5505640434   -2.8820008943   13.6313227026   -3.2489156600
 22  -15.5530535338   -2.8820007971   13.6313228100   -3.2489157156
 23  -15.5543480695   -2.8820007479   13.6313228644   -3.2489157443
 24  -15.5550212284   -2.8820007231   13.6313228919   -3.2489157593
 25  -15.5553712713   -2.8820007105   13.6313229058   -3.2489157671
 26  -15.5555532937   -2.8820007042   13.6313229129   -3.2489157711
 27  -15.5556479455   -2.8820007009   13.6313229164   -3.2489157732
 28  -15.5556971644   -2.8820006993   13.6313229182   -3.2489157743
 29  -15.5557227583   -2.8820006985   13.6313229191   -3.2489157749
 30  -15.5557360672   -2.8820006981   13.6313229196   -3.2489157752
 31  -15.5557429878   -2.8820006979   13.6313229199   -3.2489157753
 32  -15.5557465865   -2.8820006978   13.6313229200   -3.2489157754
 33  -15.5557484578   -2.8820006977   13.6313229200   -3.2489157755
 34  -15.5557494309   -2.8820006977   13.6313229201   -3.2489157755
 35  -15.5557499369   -2.8820006977   13.6313229201   -3.2489157755
 36  -15.5557502000   -2.8820006976   13.6313229201   -3.2489157755
 37  -15.5557503369   -2.8820006976   13.6313229201   -3.2489157755
 38  -15.5557504080   -2.8820006976   13.6313229201   -3.2489157755
Atom SCF converged after  38 iterations to a total energy of    -15.55575041

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  3     1.00 0.00 0.00
Orbitals   (num,l):  3        0    0    1
Real-space Grid (nr,dr,rmax):  637    0.0094339623    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   25    1   88.1975861389
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1  537.4654842999   -0.2254827711    0.2820958681   -0.2424203425
  2  214.7280855807   -0.2112694385    0.3031950732   -0.2589113369
  3  111.4461646031   -0.2047684684    0.3114512359   -0.2660487211
  4   57.7393944033   -0.2013056753    0.3157781989   -0.2698901558
  5   29.8120993670   -0.1995701427    0.3179353179   -0.2718414940
  6   15.2900770756   -0.1987217522    0.3189853766   -0.2728079371
  7    7.7387185466   -0.1983116029    0.3194906733   -0.2732812799
  8    3.8120572281   -0.1981142618    0.3197325181   -0.2735121253
  9    1.7702139201   -0.1980194628    0.3198480134   -0.2736246301
 10    0.7084643782   -0.1979739171    0.3199031408   -0.2736795313
 11    0.1563583683   -0.1979520107    0.3199294648   -0.2737063879
 12   -0.1307352713   -0.1979414564    0.3199420468   -0.2737195666
 13   -0.2800234226   -0.1979363608    0.3199480681   -0.2737260566
 14   -0.3576530938   -0.1979338951    0.3199509539   -0.2737292650
 15   -0.3980204917   -0.1979326989    0.3199523390   -0.2737308575
 16   -0.4190115498   -0.1979321171    0.3199530049   -0.2737316511
 17   -0.4299269194   -0.1979318334    0.3199533256   -0.2737320484
 18   -0.4356029284   -0.1979316946    0.3199534802   -0.2737322480
 19   -0.4385544652   -0.1979316266    0.3199535549   -0.2737323488
 20   -0.4400892722   -0.1979315931    0.3199535911   -0.2737323998
 21   -0.4408873768   -0.1979315766    0.3199536086   -0.2737324258
 22   -0.4413023942   -0.1979315685    0.3199536171   -0.2737324391
 23   -0.4415182051   -0.1979315644    0.3199536212   -0.2737324459
 24   -0.4416304277   -0.1979315624    0.3199536232   -0.2737324494
 25   -0.4416887841   -0.1979315614    0.3199536241   -0.2737324512
 26   -0.4417191298   -0.1979315609    0.3199536246   -0.2737324521
 27   -0.4417349097   -0.1979315607    0.3199536248   -0.2737324526
 28   -0.4417431154   -0.1979315606    0.3199536250   -0.2737324529
 29   -0.4417473824   -0.1979315605    0.3199536250   -0.2737324530
 30   -0.4417496013   -0.1979315605    0.3199536250   -0.2737324531
 31   -0.4417507551   -0.1979315605    0.3199536250   -0.2737324531
 32   -0.4417513551   -0.1979315604    0.3199536251   -0.2737324531
 33   -0.4417516671   -0.1979315604    0.3199536251   -0.2737324531
 34   -0.4417518294   -0.1979315604    0.3199536251   -0.2737324531
 35   -0.4417519137   -0.1979315604    0.3199536251   -0.2737324531
Atom SCF converged after  35 iterations to a total energy of     -0.44175191
 
WARNING in ngwfs_initialise: Setting radial NGWF functions for species  2 (H):
Last NGWF on atom has m =  0 and does not complete set of m-values for l = 1.
This breaks symmetry and may cause unstable NGWF optimisation and poor 
convergence. Suggest increasing number of NGWFs per atom from   4 to   5.
NB: All NGWF radial function angular momenta:     0    0    1
 
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31145372E+01     0.91085494E+00
               2       0.29104830E+01     0.83692052E+00
               3       0.26609835E+01     0.71930992E+00
               4       0.23742790E+01     0.65302022E+00
               5       0.20395091E+01     0.59227242E+00
               6       0.16688146E+01     0.50913281E+00
               7       0.13482232E+01     0.40584745E+00
               8       0.11527202E+01     0.34849439E+00
               9       0.10330093E+01     0.30777740E+00
              10       0.96257051E+00     0.27436086E+00
              11       0.91434508E+00     0.25101497E+00
              12       0.83587616E+00     0.22815571E+00
              13       0.69868893E+00     0.19069470E+00
              14       0.48816623E+00     0.13323627E+00
              15       0.23830626E+00     0.65041448E-01
              16       0.56789876E-01     0.15499785E-01
              17       0.32250900E-02     0.88023084E-03
              18       0.10401205E-04     0.28388237E-05
              19       0.10818413E-09     0.29526048E-10
              20       0.83139982E-14     0.40473267E-14
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -0.86203552186821    0.3883311
               2          -1.15665139200179    0.3965332
               3          -1.45628477589473    0.4075371
               4          -1.71398628830448    0.4346277
               5          -1.92380635812784    0.4717526
               6          -2.07564568027263    0.4944531
               7          -2.15275369991155    0.4991459
               8          -2.17887761990237    0.4998761
               9          -2.18342521856401    0.4999993
              10          -2.18359192528711    0.5000000
              11          -2.18359215665747    0.4998213
              12          -2.18359215665792    0.4998213
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "water.dkn" ... done
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -16.540230316546=    -16.540230316546+      0.000000000000
    Trial step:       1.000000000000
            G0:     -12.991580039681
WARNING: minimum value of charge density: -0.0879
      Q1=E1+P1:     347.251481505088=    -21.322312946054+    368.573794451142
Quadratic term:    -376.783291861314
   Linear term:     -12.991580039681
  Optimal step:       0.017240122267
 Predicted min:     -16.652218530708
    !!! Quadratic minimum step length accepted !!!
 1    -16.54023031654571 0.30036528733 0.02832992623 0.0172  0.000    8.00000000
WARNING: minimum value of charge density: -0.0010
      Q0=E0+P0:     -16.747936554173=    -16.764182517372+      0.016245963200
    Trial step:       0.131301646094
            G0:      -0.090397010656
WARNING: minimum value of charge density: -0.0011
      Q1=E1+P1:     -16.759386904757=    -16.777193971761+      0.017807067004
Quadratic term:      -0.000418925716
   Linear term:      -0.011869276301
  Optimal step:       1.860061886748
 Predicted min:     -16.832008571271
    !!! Quadratic minimum step length accepted !!!
 2    -16.76418251737237 0.25423042192 0.03701668083 1.8601 -0.839    8.00000000
WARNING: minimum value of charge density: -0.0029
      Q0=E0+P0:     -16.825390130651=    -16.912569368932+      0.087179238281
    Trial step:       0.494195495292
            G0:      -8.922110646889
WARNING: minimum value of charge density: -0.0308
      Q1=E1+P1:       9.057341199338=    -20.927788371304+     29.985129570642
Quadratic term:     -30.291998220175
   Linear term:      -4.409266890186
  Optimal step:       0.035967251464
 Predicted min:     -16.985842029265
    !!! Quadratic minimum step length accepted !!!
 3    -16.91256936893169 0.24966604814 0.06138758030 0.0360  4.637    8.00000000
WARNING: minimum value of charge density: -0.0047

======================== Penalty functional minimisation =======================
   Final total energy     :     -17.313146439276
   Final penalty energy   :       0.235830569829
   RMS occupancy error    :       0.070094
   Occupancy bounds       : [-0.124, 1.109]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "water.dkn" ... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00000000
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.070094 (step -0.3812 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.004829 (step -0.4997 Ne1=      8.0000)
 RMS occupancy error at iteration   3:  0.000080 (step -0.5002 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.581259293045
             Q0:     -16.513828589275
             G0:      -0.274001131237
   RMS gradient:       0.043620931141
     Trial step:       0.500000000000
             Q1:     -16.517816983360
 Quadratic coef:       0.133012171533
 Linear coef   :      -0.137000565619
           Qmin:     -16.549105727381
Quadratic minimum step length (  0.257496295337) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002356 (step -0.4936 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000008 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.51382858927506 0.00000000000 0.06543139771 0.2575  0.000    8.00000000
      ideal mu1:      -0.509797443878
             Q0:     -16.548994806320
             G0:      -0.002884985324
   RMS gradient:       0.004464382970
     Trial step:       0.358814921190
             Q1:     -16.549516182873
 Quadratic coef:       0.000513799229
 Linear coef   :      -0.001035175782
           Qmin:     -16.549516210810
Quadratic minimum step length (  0.361460757155) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000109 (step -0.4997 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.54899480632011 0.00440964226 0.00669657445 0.3615  0.010    8.00000000
      ideal mu1:      -0.505463708214
             Q0:     -16.549516726112
             G0:      -0.000106453573
   RMS gradient:       0.000858745200
     Trial step:       0.360135409384
             Q1:     -16.549543156743
 Quadratic coef:       0.000011907070
 Linear coef   :      -0.000038337701
           Qmin:     -16.549547585495
Quadratic minimum step length (  0.579771668056) accepted
    Initial Ne1:       8.00000087
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.54951672611203 0.00006619272 0.00128811786 0.5798  0.037    8.00000000
      ideal mu1:      -0.505015893090
             Q0:     -16.549547587876
             G0:      -0.000022552710
   RMS gradient:       0.000395754072
     Trial step:       0.456942345405
             Q1:     -16.549553520724
 Quadratic coef:       0.000004372440
 Linear coef   :      -0.000010305288
           Qmin:     -16.549553659941
Quadratic minimum step length (  0.538477631535) accepted
    Initial Ne1:       8.00000015
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.54954758787583 0.00000401226 0.00059363111 0.5385  0.212    8.00000000
      ideal mu1:      -0.505012225959
             Q0:     -16.549553660353
             G0:      -0.000005313662
   RMS gradient:       0.000192089435
     Trial step:       0.496037530739
             Q1:     -16.549554877399
 Quadratic coef:       0.000001418730
 Linear coef   :      -0.000002635776
           Qmin:     -16.549554884567
Quadratic minimum step length (  0.460779570063) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.54955366035297 0.00000092707 0.00028813415 0.4608  0.236    8.00000000
      ideal mu1:      -0.505162467505
             Q0:     -16.549554884609
             G0:      -0.000001070968
   RMS gradient:       0.000086240155
     Trial step:       0.478083633007
             Q1:     -16.549555107898
 Quadratic coef:       0.000000288723
 Linear coef   :      -0.000000512012
           Qmin:     -16.549555111605
Quadratic minimum step length (  0.423909231816) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.54955488460852 0.00000019707 0.00012936023 0.4239  0.202    8.00000000
      ideal mu1:      -0.505216872906
             Q0:     -16.549555111608
             G0:      -0.000000059853
   RMS gradient:       0.000020387443
     Trial step:       0.450182258215
             Q1:     -16.549555125237
 Quadratic coef:       0.000000013317
 Linear coef   :      -0.000000026945
           Qmin:     -16.549555125238
Quadratic minimum step length (  0.455444246163) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.54955511160849 0.00000003574 0.00003058116 0.4554  0.000    8.00000000
      ideal mu1:      -0.505212280491
             Q0:     -16.549555125239
             G0:      -0.000000008977
   RMS gradient:       0.000007895697
     Trial step:       0.452805608654
             Q1:     -16.549555127792
 Quadratic coef:       0.000000001512
 Linear coef   :      -0.000000004065
           Qmin:     -16.549555127971
Quadratic minimum step length (  0.608732263860) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.54955512523857 0.00000000170 0.00001184355 0.6087  0.150    8.00000000
      ideal mu1:      -0.505210825096
             Q0:     -16.549555127971
             G0:      -0.000000003245
   RMS gradient:       0.000004746405
     Trial step:       0.525011793434
             Q1:     -16.549555128702
 Quadratic coef:       0.000000000973
 Linear coef   :      -0.000000001703
           Qmin:     -16.549555128717
Quadratic minimum step length (  0.459644083921) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.54955512797120 0.00000000039 0.00000711961 0.4596  0.361    8.00000000
      ideal mu1:      -0.505211187102
10    -16.54955512871712 0.00000000013 0.00000329589 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00768487867876              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.25206812E-01     0.12941331E-01
               2       0.32812907E-03     0.16227427E-03
               3       0.53873781E-07     0.25915492E-07
               4       0.84014419E-14     0.35527137E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28341744E-01     0.14134053E-01
               2       0.40733388E-03     0.19158888E-03
               3       0.79329346E-07     0.35511502E-07
               4       0.79875761E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00768487867876
Trial step length           =               0.122474
Gradient along search dir.  =         -1.74827503718
Functional at step 0        =     -16.54955512871712
Functional at step 1        =     -16.70759252073385
Functional predicted        =     -16.75393100762741
Selected quadratic step     =               0.233803
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.07864888
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.006185 (step -0.4831 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000030 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.501597753657
             Q0:     -16.753984258081
             G0:      -0.014769451038
   RMS gradient:       0.010127469191
     Trial step:       0.491241859821
             Q1:     -16.756482963669
 Quadratic coef:       0.004756667008
 Linear coef   :      -0.007255372596
           Qmin:     -16.756750923869
Quadratic minimum step length (  0.374647071373) accepted
    Initial Ne1:       7.99999989
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000277 (step -0.4993 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.75398425808053 0.00000000000 0.01519120362 0.3746  0.000    8.00000000
      ideal mu1:      -0.491807573130
             Q0:     -16.756747387718
             G0:      -0.000716735492
   RMS gradient:       0.002227306498
     Trial step:       0.429001543258
             Q1:     -16.756910025011
 Quadratic coef:       0.000144843339
 Linear coef   :      -0.000307480632
           Qmin:     -16.756910571506
Quadratic minimum step length (  0.455352889412) accepted
    Initial Ne1:       8.00000089
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000048 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.75674738771767 0.00034583322 0.00334096022 0.4554  0.048    8.00000000
      ideal mu1:      -0.495447347418
             Q0:     -16.756910622628
             G0:      -0.000179872599
   RMS gradient:       0.001118035227
     Trial step:       0.441980873211
             Q1:     -16.756956333693
 Quadratic coef:       0.000033789184
 Linear coef   :      -0.000079500249
           Qmin:     -16.756957385296
Quadratic minimum step length (  0.519953211246) accepted
    Initial Ne1:       8.00000034
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000027 (step -0.4999 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.75691062262829 0.00002144868 0.00167705284 0.5200  0.252    8.00000000
      ideal mu1:      -0.494091471830
             Q0:     -16.756957411234
             G0:      -0.000038587197
   RMS gradient:       0.000517347298
     Trial step:       0.479384370141
             Q1:     -16.756967589579
 Quadratic coef:       0.000008319754
 Linear coef   :      -0.000018498099
           Qmin:     -16.756967693379
Quadratic minimum step length (  0.532930385373) accepted
    Initial Ne1:       8.00000012
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.75695741123388 0.00000739614 0.00077602095 0.5329  0.214    8.00000000
      ideal mu1:      -0.493874909487
             Q0:     -16.756967695398
             G0:      -0.000003617696
   RMS gradient:       0.000158476530
     Trial step:       0.505448807616
             Q1:     -16.756968756076
 Quadratic coef:       0.000000767883
 Linear coef   :      -0.000001828560
           Qmin:     -16.756968783987
Quadratic minimum step length (  0.601813058247) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.75696769539835 0.00000163435 0.00023771480 0.6018  0.094    8.00000000
      ideal mu1:      -0.493979753648
             Q0:     -16.756968784015
             G0:      -0.000000403582
   RMS gradient:       0.000052939738
     Trial step:       0.551530318930
             Q1:     -16.756968892901
 Quadratic coef:       0.000000113702
 Linear coef   :      -0.000000222588
           Qmin:     -16.756968892952
Quadratic minimum step length (  0.539850112758) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.75696878401531 0.00000015237 0.00007940961 0.5399  0.112    8.00000000
      ideal mu1:      -0.493975812242
             Q0:     -16.756968892953
             G0:      -0.000000090345
   RMS gradient:       0.000025047930
     Trial step:       0.545658963881
             Q1:     -16.756968916975
 Quadratic coef:       0.000000025275
 Linear coef   :      -0.000000049298
           Qmin:     -16.756968916991
Quadratic minimum step length (  0.532145079996) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.75696889295253 0.00000001532 0.00003757190 0.5321  0.000    8.00000000
      ideal mu1:      -0.493973997216
             Q0:     -16.756968916991
             G0:      -0.000000037894
   RMS gradient:       0.000016222061
     Trial step:       0.538859659823
             Q1:     -16.756968928206
 Quadratic coef:       0.000000009204
 Linear coef   :      -0.000000020420
           Qmin:     -16.756968928316
Quadratic minimum step length (  0.597735885085) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.75696891699083 0.00000000300 0.00002433309 0.5977  0.419    8.00000000
      ideal mu1:      -0.493971452649
             Q0:     -16.756968928316
             G0:      -0.000000008221
   RMS gradient:       0.000007555748
     Trial step:       0.567534805718
             Q1:     -16.756968930434
 Quadratic coef:       0.000000002548
 Linear coef   :      -0.000000004666
           Qmin:     -16.756968930452
Quadratic minimum step length (  0.519637299434) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.75696892831617 0.00000000201 0.00001133362 0.5196  0.217    8.00000000
      ideal mu1:      -0.493973876003
10    -16.75696893045209 0.00000000035 0.00000398708 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00162450367882              |
           | Maximum change in energy = ***************** / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17013953E-01     0.53161959E-02
               2       0.18057675E-03     0.69047265E-04
               3       0.19483475E-07     0.79196694E-08
               4       0.58260618E-14     0.17763568E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23356134E-01     0.75739354E-02
               2       0.32892382E-03     0.13166184E-03
               3       0.71841776E-07     0.30127905E-07
               4       0.83530886E-14     0.43298698E-14
================================================================================
RMS gradient                =       0.00162450367882
Trial step length           =               0.169218
Gradient along search dir.  =         -0.07936327757
Functional at step 0        =     -16.75696893045209
Functional at step 1        =     -16.76723725836105
Functional predicted        =     -16.77123139851565
Selected quadratic step     =               0.359422
Conjugate gradients coeff.  =               0.044686
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.01425297
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001346 (step -0.4963 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.496445125921
             Q0:     -16.771214992644
             G0:      -0.001837049860
   RMS gradient:       0.003571734970
     Trial step:       0.543058241607
             Q1:     -16.771535906792
 Quadratic coef:       0.000676710919
 Linear coef   :      -0.000997625067
           Qmin:     -16.771582673934
Quadratic minimum step length (  0.400295384029) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000047 (step -0.4998 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77121499264419 0.00000000000 0.00535760245 0.4003  0.000    8.00000000
      ideal mu1:      -0.495215884323
             Q0:     -16.771582612936
             G0:      -0.000102589064
   RMS gradient:       0.000843788692
     Trial step:       0.466244257203
             Q1:     -16.771600416344
 Quadratic coef:       0.000030028154
 Linear coef   :      -0.000047831562
           Qmin:     -16.771601660546
Quadratic minimum step length (  0.371338030478) accepted
    Initial Ne1:       8.00000005
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77158261293580 0.00004596016 0.00126568305 0.3713  0.056    8.00000000
      ideal mu1:      -0.497101614453
             Q0:     -16.771601666008
             G0:      -0.000012583810
   RMS gradient:       0.000295637363
     Trial step:       0.416094008839
             Q1:     -16.771604587672
 Quadratic coef:       0.000002314384
 Linear coef   :      -0.000005236048
           Qmin:     -16.771604627508
Quadratic minimum step length (  0.470684192950) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77160166600821 0.00000251523 0.00044345604 0.4707  0.123    8.00000000
      ideal mu1:      -0.497091517923
             Q0:     -16.771604627554
             G0:      -0.000000632219
   RMS gradient:       0.000066259664
     Trial step:       0.442548158670
             Q1:     -16.771604785543
 Quadratic coef:       0.000000121798
 Linear coef   :      -0.000000279787
           Qmin:     -16.771604788232
Quadratic minimum step length (  0.508296833685) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77160462755441 0.00000041817 0.00009938950 0.5083  0.050    8.00000000
      ideal mu1:      -0.497012575354
             Q0:     -16.771604788233
             G0:      -0.000000065533
   RMS gradient:       0.000021332393
     Trial step:       0.474284543080
             Q1:     -16.771604808500
 Quadratic coef:       0.000000010814
 Linear coef   :      -0.000000031081
           Qmin:     -16.771604810565
Quadratic minimum step length (  0.681561907054) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77160478823314 0.00000002122 0.00003199859 0.6816  0.104    8.00000000
      ideal mu1:      -0.497017735762
             Q0:     -16.771604810565
             G0:      -0.000000008248
   RMS gradient:       0.000007568336
     Trial step:       0.568554551180
             Q1:     -16.771604812982
 Quadratic coef:       0.000000002273
 Linear coef   :      -0.000000004690
           Qmin:     -16.771604812985
Quadratic minimum step length (  0.586582603835) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77160481056546 0.00000000310 0.00001135250 0.5866  0.126    8.00000000
      ideal mu1:      -0.497013457664
             Q0:     -16.771604812985
             G0:      -0.000000001751
   RMS gradient:       0.000003486870
     Trial step:       0.577498232944
             Q1:     -16.771604813389
 Quadratic coef:       0.000000000607
 Linear coef   :      -0.000000001011
           Qmin:     -16.771604813406
Quadratic minimum step length (  0.480808888599) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77160481298471 0.00000000034 0.00000523030 0.4808  0.000    8.00000000
      ideal mu1:      -0.497017151692
             Q0:     -16.771604813406
             G0:      -0.000000000435
   RMS gradient:       0.000001738818
     Trial step:       0.526940493367
             Q1:     -16.771604813531
 Quadratic coef:       0.000000000104
 Linear coef   :      -0.000000000229
           Qmin:     -16.771604813532
Quadratic minimum step length (  0.581996061068) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77160481340570 0.00000000005 0.00000260823 0.5820  0.249    8.00000000
      ideal mu1:      -0.497016118094
             Q0:     -16.771604813533
             G0:      -0.000000000091
   RMS gradient:       0.000000795294
     Trial step:       0.553784517260
             Q1:     -16.771604813557
 Quadratic coef:       0.000000000026
 Linear coef   :      -0.000000000051
           Qmin:     -16.771604813557
Quadratic minimum step length (  0.542911894630) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77160481353262 0.00000000002 0.00000119294 0.5429  0.209    8.00000000
      ideal mu1:      -0.497016587024
10    -16.77160481355740 0.00000000000 0.00000056571 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00081234211273              |
           | Maximum change in energy =  0.06913793391166 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27940093E-01     0.82754077E-02
               2       0.52942604E-03     0.14042110E-03
               3       0.18921805E-06     0.52827120E-07
               4       0.21104522E-13     0.78825835E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21155853E-01     0.64899596E-02
               2       0.31398065E-03     0.86711329E-04
               3       0.78546669E-07     0.20634880E-07
               4       0.79017637E-14     0.27044339E-14
================================================================================
RMS gradient                =       0.00081234211273
Trial step length           =               0.246619
Gradient along search dir.  =         -0.01998240413
Functional at step 0        =     -16.77160481355740
Functional at step 1        =     -16.77503373906387
Functional predicted        =     -16.77565480159325
Selected quadratic step     =               0.405355
Conjugate gradients coeff.  =               0.250056
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00609053
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000639 (step -0.4974 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.505500070141
             Q0:     -16.775646769299
             G0:      -0.000215628901
   RMS gradient:       0.001223692333
     Trial step:       0.548321257551
             Q1:     -16.775688134615
 Quadratic coef:       0.000076868594
 Linear coef   :      -0.000118233910
           Qmin:     -16.775692234088
Quadratic minimum step length (  0.421694759893) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77564676929868 0.00000000000 0.00183553850 0.4217  0.000    8.00000000
      ideal mu1:      -0.504430804611
             Q0:     -16.775692223254
             G0:      -0.000031993758
   RMS gradient:       0.000471307289
     Trial step:       0.480857776320
             Q1:     -16.775698552803
 Quadratic coef:       0.000009054899
 Linear coef   :      -0.000015384447
           Qmin:     -16.775698757872
Quadratic minimum step length (  0.408493307865) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77569222325415 0.00000568310 0.00070696093 0.4085  0.148    8.00000000
      ideal mu1:      -0.505420028780
             Q0:     -16.775698758653
             G0:      -0.000002327845
   RMS gradient:       0.000127154264
     Trial step:       0.443201064599
             Q1:     -16.775699368311
 Quadratic coef:       0.000000422046
 Linear coef   :      -0.000001031703
           Qmin:     -16.775699389161
Quadratic minimum step length (  0.541708785335) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77569875865345 0.00000093815 0.00019073140 0.5417  0.073    8.00000000
      ideal mu1:      -0.505468374292
             Q0:     -16.775699389143
             G0:      -0.000000308141
   RMS gradient:       0.000046261363
     Trial step:       0.489985622608
             Q1:     -16.775699488432
 Quadratic coef:       0.000000051696
 Linear coef   :      -0.000000150985
           Qmin:     -16.775699499386
Quadratic minimum step length (  0.715535047774) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77569938914285 0.00000008539 0.00006939204 0.7155  0.132    8.00000000
      ideal mu1:      -0.505418014944
             Q0:     -16.775699499388
             G0:      -0.000000048746
   RMS gradient:       0.000018398211
     Trial step:       0.592116446218
             Q1:     -16.775699514039
 Quadratic coef:       0.000000014211
 Linear coef   :      -0.000000028863
           Qmin:     -16.775699514043
Quadratic minimum step length (  0.601285770938) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77569949938773 0.00000001576 0.00002759732 0.6013  0.158    8.00000000
      ideal mu1:      -0.505434993251
             Q0:     -16.775699514043
             G0:      -0.000000004254
   RMS gradient:       0.000005435020
     Trial step:       0.596683495539
             Q1:     -16.775699515409
 Quadratic coef:       0.000000001172
 Linear coef   :      -0.000000002538
           Qmin:     -16.775699515417
Quadratic minimum step length (  0.646174791953) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77569951404275 0.00000000216 0.00000815253 0.6462  0.087    8.00000000
      ideal mu1:      -0.505434739398
             Q0:     -16.775699515417
             G0:      -0.000000000875
   RMS gradient:       0.000002464919
     Trial step:       0.620936255659
             Q1:     -16.775699515621
 Quadratic coef:       0.000000000339
 Linear coef   :      -0.000000000543
           Qmin:     -16.775699515634
Quadratic minimum step length (  0.497018556844) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77569951541700 0.00000000019 0.00000369738 0.4970  0.000    8.00000000
      ideal mu1:      -0.505435302931
             Q0:     -16.775699515634
             G0:      -0.000000000255
   RMS gradient:       0.000001331007
     Trial step:       0.555532934829
             Q1:     -16.775699515727
 Quadratic coef:       0.000000000049
 Linear coef   :      -0.000000000142
           Qmin:     -16.775699515736
Quadratic minimum step length (  0.798248288845) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77569951563435 0.00000000003 0.00000199651 0.7982  0.292    8.00000000
      ideal mu1:      -0.505434894799
             Q0:     -16.775699515736
             G0:      -0.000000000059
   RMS gradient:       0.000000642064
     Trial step:       0.665922829331
             Q1:     -16.775699515750
 Quadratic coef:       0.000000000025
 Linear coef   :      -0.000000000039
           Qmin:     -16.775699515751
Quadratic minimum step length (  0.524088370792) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77569951573578 0.00000000002 0.00000096310 0.5241  0.233    8.00000000
      ideal mu1:      -0.505434822975
10    -16.77569951575120 0.00000000000 0.00000033712 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00049514356838              |
           | Maximum change in energy =  0.00487862770177 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46202039E-01     0.95997781E-02
               2       0.13620519E-02     0.30133514E-03
               3       0.11954773E-05     0.25461070E-06
               4       0.88740758E-12     0.18716929E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13205049E-01     0.30702498E-02
               2       0.11857590E-03     0.25831042E-04
               3       0.10173307E-07     0.21228965E-08
               4       0.78471736E-14     0.33319701E-14
================================================================================
RMS gradient                =       0.00049514356838
Trial step length           =               0.316178
Gradient along search dir.  =         -0.00731432624
Functional at step 0        =     -16.77569951575120
Functional at step 1        =     -16.77708980240219
Functional predicted        =     -16.77714915524564
Selected quadratic step     =               0.396384
Conjugate gradients coeff.  =               0.371522
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       8.00216260
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000322 (step -0.4991 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512252369909
             Q0:     -16.777147423943
             G0:      -0.000036076233
   RMS gradient:       0.000500529119
     Trial step:       0.590764259834
             Q1:     -16.777155092277
 Quadratic coef:       0.000013644215
 Linear coef   :      -0.000021312549
           Qmin:     -16.777155746605
Quadratic minimum step length (  0.461393062941) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77714742394286 0.00000000000 0.00075079368 0.4614  0.000    8.00000000
      ideal mu1:      -0.511628243211
             Q0:     -16.777155745488
             G0:      -0.000003279971
   RMS gradient:       0.000150913479
     Trial step:       0.522086708623
             Q1:     -16.777156376271
 Quadratic coef:       0.000001081646
 Linear coef   :      -0.000001712429
           Qmin:     -16.777156423254
Quadratic minimum step length (  0.413276046593) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77715574548779 0.00000104033 0.00022637022 0.4133  0.091    8.00000000
      ideal mu1:      -0.511953050767
             Q0:     -16.777156423290
             G0:      -0.000000356920
   RMS gradient:       0.000049786714
     Trial step:       0.464506115050
             Q1:     -16.777156505032
 Quadratic coef:       0.000000084049
 Linear coef   :      -0.000000165792
           Qmin:     -16.777156505048
Quadratic minimum step length (  0.458131482040) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77715642328999 0.00000009243 0.00007468007 0.4581  0.109    8.00000000
      ideal mu1:      -0.511963959579
             Q0:     -16.777156505048
             G0:      -0.000000030709
   RMS gradient:       0.000014603377
     Trial step:       0.461307787604
             Q1:     -16.777156513207
 Quadratic coef:       0.000000006008
 Linear coef   :      -0.000000014166
           Qmin:     -16.777156513399
Quadratic minimum step length (  0.543896487024) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77715650504810 0.00000001143 0.00002190507 0.5439  0.086    8.00000000
      ideal mu1:      -0.511958203975
             Q0:     -16.777156513399
             G0:      -0.000000003135
   RMS gradient:       0.000004666155
     Trial step:       0.500902869941
             Q1:     -16.777156514405
 Quadratic coef:       0.000000000565
 Linear coef   :      -0.000000001570
           Qmin:     -16.777156514491
Quadratic minimum step length (  0.696342962363) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77715651339922 0.00000000114 0.00000699923 0.6963  0.102    8.00000000
      ideal mu1:      -0.511955750781
             Q0:     -16.777156514491
             G0:      -0.000000000500
   RMS gradient:       0.000001863060
     Trial step:       0.590593081834
             Q1:     -16.777156514679
 Quadratic coef:       0.000000000107
 Linear coef   :      -0.000000000295
           Qmin:     -16.777156514695
Quadratic minimum step length (  0.816085652872) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77715651449102 0.00000000015 0.00000279459 0.8161  0.159    8.00000000
      ideal mu1:      -0.511957129786
             Q0:     -16.777156514695
             G0:      -0.000000000117
   RMS gradient:       0.000000902271
     Trial step:       0.694243862609
             Q1:     -16.777156514711
 Quadratic coef:       0.000000000065
 Linear coef   :      -0.000000000081
           Qmin:     -16.777156514720
Quadratic minimum step length (  0.432779321248) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77715651469504 0.00000000003 0.00000135341 0.4328  0.000    8.00000000
      ideal mu1:      -0.511957002706
             Q0:     -16.777156514720
             G0:      -0.000000000022
   RMS gradient:       0.000000390899
     Trial step:       0.548137197826
             Q1:     -16.777156514728
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000012
           Qmin:     -16.777156514729
Quadratic minimum step length (  0.773349901053) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77715651472028 0.00000000000 0.00000058635 0.7733  0.188    8.00000000
      ideal mu1:      -0.511957086957
             Q0:     -16.777156514729
             G0:      -0.000000000004
   RMS gradient:       0.000000164250
     Trial step:       0.651077451385
             Q1:     -16.777156514730
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777156514730
Quadratic minimum step length (  0.766014503939) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77715651472869 0.00000000000 0.00000024638 0.7660  0.177    8.00000000
      ideal mu1:      -0.511957106744
10    -16.77715651473031 0.00000000000 0.00000011066 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00026714415077              |
           | Maximum change in energy =  0.00136490073127 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.88034079087271 |
           | Pseudopotential (local)    :      -46.11227930825221 |
           | Pseudopotential (non-local):       -3.19222072690750 |
           | Hartree                    :       19.84181002303850 |
           | Exchange-correlation       :       -4.13065654145262 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77715651473031 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.11227930825206 |
           | Hartree                    :       19.84181002303862 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999974
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.32077465E-01     0.84203268E-02
               2       0.33864566E-03     0.83258895E-04
               3       0.57320228E-07     0.14074445E-07
               4       0.68089324E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26587374E-02     0.67066684E-03
               2       0.26858787E-05     0.66306798E-06
               3       0.35379188E-11     0.85763601E-12
================================================================================
RMS gradient                =       0.00026714415077
Trial step length           =               0.354016
Gradient along search dir.  =         -0.00211264762
Functional at step 0        =     -16.77715651473031
Functional at step 1        =     -16.77749839430320
Functional predicted        =     -16.77750092833125
Selected quadratic step     =               0.326049
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99802460
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000149 (step -0.5004 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512042987691
             Q0:     -16.777500628034
             G0:      -0.000005242161
   RMS gradient:       0.000190798051
     Trial step:       0.706211562457
             Q1:     -16.777501698932
 Quadratic coef:       0.000002631176
 Linear coef   :      -0.000003702075
           Qmin:     -16.777501930242
Quadratic minimum step length (  0.496821128456) accepted
    Initial Ne1:       8.00000085
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77750062803373 0.00000000000 0.00028619708 0.4968  0.000    8.00000000
      ideal mu1:      -0.512318353885
             Q0:     -16.777501930354
             G0:      -0.000000346215
   RMS gradient:       0.000049033756
     Trial step:       0.592335061759
             Q1:     -16.777502001906
 Quadratic coef:       0.000000133524
 Linear coef   :      -0.000000205076
           Qmin:     -16.777502009096
Quadratic minimum step length (  0.454874508788) accepted
    Initial Ne1:       8.00000005
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77750193035419 0.00000016278 0.00007355063 0.4549  0.066    8.00000000
      ideal mu1:      -0.512259480815
             Q0:     -16.777502009095
             G0:      -0.000000075458
   RMS gradient:       0.000022891278
     Trial step:       0.519074291654
             Q1:     -16.777502029713
 Quadratic coef:       0.000000018550
 Linear coef   :      -0.000000039168
           Qmin:     -16.777502029771
Quadratic minimum step length (  0.548010352210) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77750200909512 0.00000001049 0.00003433692 0.5480  0.218    8.00000000
      ideal mu1:      -0.512288089095
             Q0:     -16.777502029771
             G0:      -0.000000008153
   RMS gradient:       0.000007524764
     Trial step:       0.533346121568
             Q1:     -16.777502032011
 Quadratic coef:       0.000000002109
 Linear coef   :      -0.000000004349
           Qmin:     -16.777502032013
Quadratic minimum step length (  0.549964392063) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77750202977091 0.00000000318 0.00001128715 0.5500  0.108    8.00000000
      ideal mu1:      -0.512284497506
             Q0:     -16.777502032013
             G0:      -0.000000001255
   RMS gradient:       0.000002952673
     Trial step:       0.541591520897
             Q1:     -16.777502032391
 Quadratic coef:       0.000000000302
 Linear coef   :      -0.000000000680
           Qmin:     -16.777502032396
Quadratic minimum step length (  0.610069370654) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77750203201303 0.00000000032 0.00000442901 0.6101  0.154    8.00000000
      ideal mu1:      -0.512281307007
             Q0:     -16.777502032396
             G0:      -0.000000000154
   RMS gradient:       0.000001033860
     Trial step:       0.574811619842
             Q1:     -16.777502032432
 Quadratic coef:       0.000000000052
 Linear coef   :      -0.000000000088
           Qmin:     -16.777502032433
Quadratic minimum step length (  0.487480871203) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77750203239587 0.00000000006 0.00000155079 0.4875  0.123    8.00000000
      ideal mu1:      -0.512280618349
             Q0:     -16.777502032433
             G0:      -0.000000000018
   RMS gradient:       0.000000354422
     Trial step:       0.529348343927
             Q1:     -16.777502032438
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000010
           Qmin:     -16.777502032438
Quadratic minimum step length (  0.522975470009) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77750203243336 0.00000000001 0.00000053163 0.5230  0.000    8.00000000
      ideal mu1:      -0.512281092914
             Q0:     -16.777502032438
             G0:      -0.000000000003
   RMS gradient:       0.000000143539
     Trial step:       0.526152258347
             Q1:     -16.777502032439
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777502032439
Quadratic minimum step length (  0.505517474011) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77750203243809 0.00000000000 0.00000021531 0.5055  0.164    8.00000000
      ideal mu1:      -0.512281092267
             Q0:     -16.777502032439
             G0:      -0.000000000000
   RMS gradient:       0.000000053208
     Trial step:       0.515731674987
             Q1:     -16.777502032439
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777502032439
Quadratic minimum step length (  0.673419951800) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77750203243895 0.00000000000 0.00000007981 0.6734  0.137    8.00000000
      ideal mu1:      -0.512281050978
10    -16.77750203243908 0.00000000000 0.00000004370 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00016298319336              |
           | Maximum change in energy =  0.00048566632637 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46426221E-01     0.11356572E-01
               2       0.81746438E-03     0.19181338E-03
               3       0.33349407E-06     0.77329899E-07
               4       0.54431780E-13     0.14210855E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12043696E-01     0.27739298E-02
               2       0.64126864E-04     0.14937877E-04
               3       0.20523191E-08     0.46980464E-09
               4       0.56750162E-14     0.17763568E-14
================================================================================
RMS gradient                =       0.00016298319336
Trial step length           =               0.339745
Gradient along search dir.  =         -0.00078857459
Functional at step 0        =     -16.77750203243908
Functional at step 1        =     -16.77766193475673
Functional predicted        =     -16.77766816691135
Selected quadratic step     =               0.421354
Conjugate gradients coeff.  =               0.372215
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99649877
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000273 (step -0.5007 Ne1=      8.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.512673571389
             Q0:     -16.777667044001
             G0:      -0.000014539612
   RMS gradient:       0.000317757029
     Trial step:       0.589325037404
             Q1:     -16.777670922394
 Quadratic coef:       0.000004690164
 Linear coef   :      -0.000008568558
           Qmin:     -16.777670957520
Quadratic minimum step length (  0.538325041790) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77766704400083 0.00000000000 0.00047663554 0.5383  0.000    8.00000000
      ideal mu1:      -0.513235450979
             Q0:     -16.777670957679
             G0:      -0.000000528706
   RMS gradient:       0.000060598092
     Trial step:       0.563248102872
             Q1:     -16.777671070170
 Quadratic coef:       0.000000185302
 Linear coef   :      -0.000000297793
           Qmin:     -16.777671077322
Quadratic minimum step length (  0.452588128054) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77767095767929 0.00000048919 0.00009089714 0.4526  0.036    8.00000000
      ideal mu1:      -0.513185274153
             Q0:     -16.777671077321
             G0:      -0.000000076590
   RMS gradient:       0.000023062231
     Trial step:       0.504895439184
             Q1:     -16.777671093725
 Quadratic coef:       0.000000022266
 Linear coef   :      -0.000000038670
           Qmin:     -16.777671094111
Quadratic minimum step length (  0.438437914765) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77767107732090 0.00000001550 0.00003459335 0.4384  0.145    8.00000000
      ideal mu1:      -0.513230196773
             Q0:     -16.777671094111
             G0:      -0.000000005535
   RMS gradient:       0.000006199823
     Trial step:       0.470494743361
             Q1:     -16.777671095701
 Quadratic coef:       0.000000001014
 Linear coef   :      -0.000000002604
           Qmin:     -16.777671095783
Quadratic minimum step length (  0.604310002500) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77767109411104 0.00000000241 0.00000929973 0.6043  0.072    8.00000000
      ideal mu1:      -0.513233635667
             Q0:     -16.777671095784
             G0:      -0.000000001202
   RMS gradient:       0.000002888561
     Trial step:       0.533221041911
             Q1:     -16.777671096146
 Quadratic coef:       0.000000000278
 Linear coef   :      -0.000000000641
           Qmin:     -16.777671096153
Quadratic minimum step length (  0.614439048573) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77767109578354 0.00000000023 0.00000433284 0.6144  0.217    8.00000000
      ideal mu1:      -0.513231653078
             Q0:     -16.777671096153
             G0:      -0.000000000102
   RMS gradient:       0.000000841695
     Trial step:       0.572391325642
             Q1:     -16.777671096181
 Quadratic coef:       0.000000000030
 Linear coef   :      -0.000000000058
           Qmin:     -16.777671096182
Quadratic minimum step length (  0.553141433890) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77767109615326 0.00000000006 0.00000126254 0.5531  0.085    8.00000000
      ideal mu1:      -0.513231012326
             Q0:     -16.777671096181
             G0:      -0.000000000020
   RMS gradient:       0.000000374594
     Trial step:       0.562684066428
             Q1:     -16.777671096186
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000011
           Qmin:     -16.777671096186
Quadratic minimum step length (  0.519846276417) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77767109618121 0.00000000000 0.00000056189 0.5198  0.000    8.00000000
      ideal mu1:      -0.513231448713
             Q0:     -16.777671096186
             G0:      -0.000000000004
   RMS gradient:       0.000000175943
     Trial step:       0.540841212124
             Q1:     -16.777671096188
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777671096188
Quadratic minimum step length (  0.680105055769) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77767109618625 0.00000000000 0.00000026391 0.6801  0.221    8.00000000
      ideal mu1:      -0.513231404770
             Q0:     -16.777671096188
             G0:      -0.000000000000
   RMS gradient:       0.000000059318
     Trial step:       0.606488946918
             Q1:     -16.777671096188
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777671096188
  Cubic LS coeff:       0.732882788885
Predicted energy:     -16.777671096188
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77767109618772 0.00000000000 0.00000008898 0.7329  0.114    8.00000000
      ideal mu1:      -0.513231355328
10    -16.77767109618789 0.00000000000 0.00000005991 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00010377599238              |
           | Maximum change in energy =  0.00011517256959 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63341893E-01     0.14668196E-01
               2       0.17449275E-02     0.41267028E-03
               3       0.15493028E-05     0.36812165E-06
               4       0.12172640E-11     0.29043434E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11013037E-01     0.26089408E-02
               2       0.56861662E-04     0.13657410E-04
               3       0.16527894E-08     0.39696513E-09
               4       0.74156501E-14     0.31086245E-14
================================================================================
RMS gradient                =       0.00010377599238
Trial step length           =               0.378356
Gradient along search dir.  =         -0.00032474607
Functional at step 0        =     -16.77767109618789
Functional at step 1        =     -16.77772027903725
Functional predicted        =     -16.77772231616303
Selected quadratic step     =               0.315446
Conjugate gradients coeff.  =               0.405423
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99686721
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000238 (step -0.5006 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513251716771
             Q0:     -16.777721447720
             G0:      -0.000018475892
   RMS gradient:       0.000358196600
     Trial step:       0.666697315763
             Q1:     -16.777726494860
 Quadratic coef:       0.000007270688
 Linear coef   :      -0.000012317827
           Qmin:     -16.777726664863
Quadratic minimum step length (  0.564751412492) accepted
    Initial Ne1:       8.00000154
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77772144772004 0.00000000000 0.00053729500 0.5648  0.000    8.00000000
      ideal mu1:      -0.513858478504
             Q0:     -16.777726665312
             G0:      -0.000000717677
   RMS gradient:       0.000070601219
     Trial step:       0.613610830072
             Q1:     -16.777726871379
 Quadratic coef:       0.000000234307
 Linear coef   :      -0.000000440374
           Qmin:     -16.777726872230
Quadratic minimum step length (  0.576634446350) accepted
    Initial Ne1:       8.00000006
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77772666531154 0.00000065214 0.00010590183 0.5766  0.039    8.00000000
      ideal mu1:      -0.513835205302
             Q0:     -16.777726872230
             G0:      -0.000000118995
   RMS gradient:       0.000028746100
     Trial step:       0.594835390064
             Q1:     -16.777726898881
 Quadratic coef:       0.000000044131
 Linear coef   :      -0.000000070782
           Qmin:     -16.777726900612
Quadratic minimum step length (  0.477034978819) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77772687222986 0.00000002687 0.00004311915 0.4770  0.166    8.00000000
      ideal mu1:      -0.513894916197
             Q0:     -16.777726900613
             G0:      -0.000000025092
   RMS gradient:       0.000013200570
     Trial step:       0.532688734347
             Q1:     -16.777726908773
 Quadratic coef:       0.000000005206
 Linear coef   :      -0.000000013366
           Qmin:     -16.777726909191
Quadratic minimum step length (  0.683775576536) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77772690061267 0.00000000416 0.00001980085 0.6838  0.211    8.00000000
      ideal mu1:      -0.513884369207
             Q0:     -16.777726909191
             G0:      -0.000000003526
   RMS gradient:       0.000004948257
     Trial step:       0.603522614690
             Q1:     -16.777726909885
 Quadratic coef:       0.000000001434
 Linear coef   :      -0.000000002128
           Qmin:     -16.777726909980
Quadratic minimum step length (  0.447662411701) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77772690919126 0.00000000134 0.00000742239 0.4477  0.141    8.00000000
      ideal mu1:      -0.513881166056
             Q0:     -16.777726909980
             G0:      -0.000000000100
   RMS gradient:       0.000000833962
     Trial step:       0.519783021278
             Q1:     -16.777726910004
 Quadratic coef:       0.000000000029
 Linear coef   :      -0.000000000052
           Qmin:     -16.777726910004
Quadratic minimum step length (  0.473466927546) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77772690998027 0.00000000012 0.00000125094 0.4735  0.028    8.00000000
      ideal mu1:      -0.513880649562
             Q0:     -16.777726910004
             G0:      -0.000000000008
   RMS gradient:       0.000000235721
     Trial step:       0.496084740820
             Q1:     -16.777726910006
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777726910006
Quadratic minimum step length (  0.521897760088) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77772691000404 0.00000000000 0.00000035358 0.5219  0.000    8.00000000
      ideal mu1:      -0.513880881691
             Q0:     -16.777726910006
             G0:      -0.000000000002
   RMS gradient:       0.000000115284
     Trial step:       0.508827588725
             Q1:     -16.777726910007
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777726910007
Quadratic minimum step length (  0.612624514347) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77772691000610 0.00000000000 0.00000017293 0.6126  0.239    8.00000000
      ideal mu1:      -0.513880854423
             Q0:     -16.777726910007
             G0:      -0.000000000000
   RMS gradient:       0.000000039585
     Trial step:       0.558319133139
             Q1:     -16.777726910007
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777726910007
Quadratic minimum step length (  0.111518714501) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77772691000690 0.00000000000 0.00000005938 0.1115  0.118    8.00000000
      ideal mu1:      -0.513880849193
10    -16.77772691000690 0.00000000000 0.00000005148 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006613138760              |
           | Maximum change in energy =  0.00005635458294 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           | -> Energy change per atom higher than set threshold. |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.60899165E-01     0.14749169E-01
               2       0.16698204E-02     0.40766007E-03
               3       0.14538894E-05     0.35726100E-06
               4       0.10962185E-11     0.26734170E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14401592E-01     0.34713233E-02
               2       0.98349095E-04     0.24204151E-04
               3       0.50485135E-08     0.12467902E-08
               4       0.70291583E-14     0.22204460E-14
================================================================================
RMS gradient                =       0.00006613138760
Trial step length           =               0.345472
Gradient along search dir.  =         -0.00014132560
Functional at step 0        =     -16.77772691000690
Functional at step 1        =     -16.77774405051316
Functional predicted        =     -16.77774571935666
Selected quadratic step     =               0.266185
Conjugate gradients coeff.  =               0.406089
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99723376
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000217 (step -0.5006 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513601219126
             Q0:     -16.777745029472
             G0:      -0.000020268918
   RMS gradient:       0.000375175128
     Trial step:       0.249525613934
             Q1:     -16.777748975133
 Quadratic coef:       0.000001111954
 Linear coef   :      -0.000005057614
           Qmin:     -16.777750780491
Quadratic minimum step length (  0.567471647498) accepted
    Initial Ne1:       8.00000160
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77774502947233 0.00000000000 0.00056276279 0.5675  0.000    8.00000000
      ideal mu1:      -0.514139247084
             Q0:     -16.777750779212
             G0:      -0.000000784775
   RMS gradient:       0.000073838476
     Trial step:       0.376296042010
             Q1:     -16.777750991637
 Quadratic coef:       0.000000082883
 Linear coef   :      -0.000000295308
           Qmin:     -16.777751042253
Quadratic minimum step length (  0.670357877398) accepted
    Initial Ne1:       8.00000007
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77775077921239 0.00000071888 0.00011075771 0.6704  0.039    8.00000000
      ideal mu1:      -0.514173290867
             Q0:     -16.777751042246
             G0:      -0.000000089124
   RMS gradient:       0.000024878686
     Trial step:       0.502247962659
             Q1:     -16.777751069804
 Quadratic coef:       0.000000017205
 Linear coef   :      -0.000000044762
           Qmin:     -16.777751071361
Quadratic minimum step length (  0.653359227998) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77775104224649 0.00000003414 0.00003731803 0.6534  0.114    8.00000000
      ideal mu1:      -0.514214151269
             Q0:     -16.777751071361
             G0:      -0.000000025202
   RMS gradient:       0.000013229506
     Trial step:       0.572842335330
             Q1:     -16.777751078238
 Quadratic coef:       0.000000007560
 Linear coef   :      -0.000000014437
           Qmin:     -16.777751078253
Quadratic minimum step length (  0.546934864929) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77775107136124 0.00000000407 0.00001984426 0.5469  0.283    8.00000000
      ideal mu1:      -0.514191664558
             Q0:     -16.777751078253
             G0:      -0.000000002367
   RMS gradient:       0.000004054032
     Trial step:       0.559738729497
             Q1:     -16.777751078655
 Quadratic coef:       0.000000000923
 Linear coef   :      -0.000000001325
           Qmin:     -16.777751078728
Quadratic minimum step length (  0.401728434840) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77775107825308 0.00000000113 0.00000608105 0.4017  0.094    8.00000000
      ideal mu1:      -0.514192575899
             Q0:     -16.777751078728
             G0:      -0.000000000111
   RMS gradient:       0.000000877016
     Trial step:       0.474197178102
             Q1:     -16.777751078755
 Quadratic coef:       0.000000000026
 Linear coef   :      -0.000000000053
           Qmin:     -16.777751078755
Quadratic minimum step length (  0.473847163716) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77775107872849 0.00000000007 0.00000131552 0.4738  0.047    8.00000000
      ideal mu1:      -0.514191927630
             Q0:     -16.777751078755
             G0:      -0.000000000011
   RMS gradient:       0.000000277239
     Trial step:       0.474022138603
             Q1:     -16.777751078758
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.777751078758
Quadratic minimum step length (  0.571909919071) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77775107875504 0.00000000000 0.00000041586 0.5719  0.000    8.00000000
      ideal mu1:      -0.514192336958
             Q0:     -16.777751078758
             G0:      -0.000000000004
   RMS gradient:       0.000000158607
     Trial step:       0.520670685680
             Q1:     -16.777751078759
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777751078759
Quadratic minimum step length (  0.571849887871) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77775107875837 0.00000000000 0.00000023791 0.5718  0.327    8.00000000
      ideal mu1:      -0.514192274656
             Q0:     -16.777751078760
             G0:      -0.000000000001
   RMS gradient:       0.000000061140
     Trial step:       0.545660584268
             Q1:     -16.777751078760
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777751078760
Quadratic minimum step length (  0.232075926761) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77775107875967 0.00000000000 0.00000009171 0.2321  0.149    8.00000000
      ideal mu1:      -0.514192265667
10    -16.77775107875957 0.00000000000 0.00000006644 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006367491946              |
           | Maximum change in energy =  0.00001860460634 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28936635E-01     0.74773458E-02
               2       0.35423202E-03     0.90136796E-04
               3       0.69857097E-07     0.17864997E-07
               4       0.58294891E-14     0.17763568E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12062434E-01     0.31121178E-02
               2       0.65593113E-04     0.16690758E-04
               3       0.23731678E-08     0.60785155E-09
               4       0.54679695E-14     0.19984014E-14
================================================================================
RMS gradient                =       0.00006367491946
Trial step length           =               0.303248
Gradient along search dir.  =         -0.00012002523
Functional at step 0        =     -16.77775107875957
Functional at step 1        =     -16.77777450176677
Functional predicted        =     -16.77777660539929
Selected quadratic step     =               0.425355
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99734719
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000216 (step -0.5006 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513635212206
             Q0:     -16.777775962387
             G0:      -0.000025783606
   RMS gradient:       0.000423146332
     Trial step:       0.355857676313
             Q1:     -16.777782236977
 Quadratic coef:       0.000002900704
 Linear coef   :      -0.000009175294
           Qmin:     -16.777783218042
Quadratic minimum step length (  0.562811497786) accepted
    Initial Ne1:       8.00000172
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77777596238660 0.00000000000 0.00063471962 0.5628  0.000    8.00000000
      ideal mu1:      -0.514184842286
             Q0:     -16.777783216927
             G0:      -0.000001034545
   RMS gradient:       0.000084775962
     Trial step:       0.447527420170
             Q1:     -16.777783531931
 Quadratic coef:       0.000000147983
 Linear coef   :      -0.000000462987
           Qmin:     -16.777783579058
Quadratic minimum step length (  0.700077631128) accepted
    Initial Ne1:       8.00000009
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77778321692703 0.00000090696 0.00012716394 0.7001  0.040    8.00000000
      ideal mu1:      -0.514240765252
             Q0:     -16.777783579048
             G0:      -0.000000121730
   RMS gradient:       0.000029075907
     Trial step:       0.559735594882
             Q1:     -16.777783619587
 Quadratic coef:       0.000000027597
 Linear coef   :      -0.000000068137
           Qmin:     -16.777783621105
Quadratic minimum step length (  0.690989164715) accepted
    Initial Ne1:       8.00000001
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77778357904764 0.00000004707 0.00004361386 0.6910  0.118    8.00000000
      ideal mu1:      -0.514261279894
             Q0:     -16.777783621105
             G0:      -0.000000027455
   RMS gradient:       0.000013807966
     Trial step:       0.621909343207
             Q1:     -16.777783629007
 Quadratic coef:       0.000000009172
 Linear coef   :      -0.000000017074
           Qmin:     -16.777783629051
Quadratic minimum step length (  0.578870569589) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77778362110492 0.00000000590 0.00002071195 0.5789  0.226    8.00000000
      ideal mu1:      -0.514254758617
             Q0:     -16.777783629051
             G0:      -0.000000001910
   RMS gradient:       0.000003641855
     Trial step:       0.600004179765
             Q1:     -16.777783629378
 Quadratic coef:       0.000000000819
 Linear coef   :      -0.000000001146
           Qmin:     -16.777783629452
Quadratic minimum step length (  0.419551845115) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77778362905131 0.00000000124 0.00000546278 0.4196  0.070    8.00000000
      ideal mu1:      -0.514247818939
             Q0:     -16.777783629452
             G0:      -0.000000000132
   RMS gradient:       0.000000957706
     Trial step:       0.501729868253
             Q1:     -16.777783629485
 Quadratic coef:       0.000000000033
 Linear coef   :      -0.000000000066
           Qmin:     -16.777783629485
Quadratic minimum step length (  0.503021112433) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77778362945189 0.00000000005 0.00000143656 0.5030  0.069    8.00000000
      ideal mu1:      -0.514249334801
             Q0:     -16.777783629485
             G0:      -0.000000000022
   RMS gradient:       0.000000386951
     Trial step:       0.502375075486
             Q1:     -16.777783629490
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000011
           Qmin:     -16.777783629490
Quadratic minimum step length (  0.508190798976) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77778362948488 0.00000000000 0.00000058043 0.5082  0.000    8.00000000
      ideal mu1:      -0.514249089557
             Q0:     -16.777783629491
             G0:      -0.000000000007
   RMS gradient:       0.000000219491
     Trial step:       0.505274569909
             Q1:     -16.777783629493
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.777783629493
Quadratic minimum step length (  0.752842547686) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77778362949052 0.00000000000 0.00000032924 0.7528  0.322    8.00000000
      ideal mu1:      -0.514249544072
             Q0:     -16.777783629493
             G0:      -0.000000000002
   RMS gradient:       0.000000107588
     Trial step:       0.616759429998
             Q1:     -16.777783629494
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777783629494
Quadratic minimum step length (  0.538518982351) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77778362949335 0.00000000000 0.00000016138 0.5385  0.240    8.00000000
      ideal mu1:      -0.514249380719
10    -16.77778362949372 0.00000000000 0.00000007161 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00004291774301              |
           | Maximum change in energy =  0.00001085024472 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86830163148824 |
           | Pseudopotential (local)    :      -46.08960368334546 |
           | Pseudopotential (non-local):       -3.18794533936256 |
           | Hartree                    :       19.82303021304531 |
           | Exchange-correlation       :       -4.12741569929006 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77778362949372 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08960368334598 |
           | Hartree                    :       19.82303021304569 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999965
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.50771813E-01     0.13442237E-01
               2       0.12539184E-02     0.32614975E-03
               3       0.89465098E-06     0.23407992E-06
               4       0.45061780E-12     0.11723955E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.25617542E-01     0.67619867E-02
               2       0.32648223E-03     0.84956934E-04
               3       0.60577599E-07     0.15857323E-07
               4       0.69056108E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00004291774301
Trial step length           =               0.359149
Gradient along search dir.  =         -0.00006944611
Functional at step 0        =     -16.77778362949372
Functional at step 1        =     -16.77778346538313
Functional predicted        =     -16.77778982410670
Selected quadratic step     =               0.178401
Conjugate gradients coeff.  =               0.454294
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99839726
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000126 (step -0.5004 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.513951979897
             Q0:     -16.777789596900
             G0:      -0.000009520053
   RMS gradient:       0.000257121521
     Trial step:       0.576312988399
             Q1:     -16.777792266559
 Quadratic coef:       0.000002816871
 Linear coef   :      -0.000005486530
           Qmin:     -16.777792268483
Quadratic minimum step length (  0.561253727165) accepted
    Initial Ne1:       8.00000057
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77778959690031 0.00000000000 0.00038568231 0.5613  0.000    8.00000000
      ideal mu1:      -0.514280018928
             Q0:     -16.777792268507
             G0:      -0.000000401510
   RMS gradient:       0.000052807157
     Trial step:       0.568733516467
             Q1:     -16.777792402539
 Quadratic coef:       0.000000094321
 Linear coef   :      -0.000000228352
           Qmin:     -16.777792406718
Quadratic minimum step length (  0.688456463952) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779226850736 0.00000033395 0.00007921074 0.6885  0.042    8.00000000
      ideal mu1:      -0.514314836321
             Q0:     -16.777792406717
             G0:      -0.000000055483
   RMS gradient:       0.000019629333
     Trial step:       0.625738176618
             Q1:     -16.777792424190
 Quadratic coef:       0.000000017245
 Linear coef   :      -0.000000034718
           Qmin:     -16.777792424191
Quadratic minimum step length (  0.629877867363) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779240671724 0.00000001800 0.00002944400 0.6299  0.138    8.00000000
      ideal mu1:      -0.514318256292
             Q0:     -16.777792424191
             G0:      -0.000000012860
   RMS gradient:       0.000009450358
     Trial step:       0.627804609903
             Q1:     -16.777792427734
 Quadratic coef:       0.000000004530
 Linear coef   :      -0.000000008074
           Qmin:     -16.777792427788
Quadratic minimum step length (  0.559447921795) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779242419081 0.00000000250 0.00001417554 0.5594  0.232    8.00000000
      ideal mu1:      -0.514324803251
             Q0:     -16.777792427788
             G0:      -0.000000001750
   RMS gradient:       0.000003485653
     Trial step:       0.592641531032
             Q1:     -16.777792428103
 Quadratic coef:       0.000000000723
 Linear coef   :      -0.000000001037
           Qmin:     -16.777792428160
Quadratic minimum step length (  0.425195492699) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779242778823 0.00000000057 0.00000522848 0.4252  0.136    8.00000000
      ideal mu1:      -0.514316698107
             Q0:     -16.777792428160
             G0:      -0.000000000072
   RMS gradient:       0.000000706412
     Trial step:       0.501984569266
             Q1:     -16.777792428180
 Quadratic coef:       0.000000000017
 Linear coef   :      -0.000000000036
           Qmin:     -16.777792428180
Quadratic minimum step length (  0.543024435079) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779242816038 0.00000000005 0.00000105962 0.5430  0.041    8.00000000
      ideal mu1:      -0.514317215760
             Q0:     -16.777792428180
             G0:      -0.000000000011
   RMS gradient:       0.000000271966
     Trial step:       0.522101414616
             Q1:     -16.777792428183
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000006
           Qmin:     -16.777792428183
Quadratic minimum step length (  0.574701523782) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779242817979 0.00000000000 0.00000040795 0.5747  0.000    8.00000000
      ideal mu1:      -0.514317322500
             Q0:     -16.777792428183
             G0:      -0.000000000004
   RMS gradient:       0.000000156350
     Trial step:       0.547770461552
             Q1:     -16.777792428184
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777792428184
Quadratic minimum step length (  0.632918991473) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779242818310 0.00000000000 0.00000023452 0.6329  0.330    8.00000000
      ideal mu1:      -0.514317500022
             Q0:     -16.777792428184
             G0:      -0.000000000001
   RMS gradient:       0.000000060630
     Trial step:       0.588807547578
             Q1:     -16.777792428185
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777792428185
  Cubic LS coeff:       0.842601781463
Predicted energy:     -16.777792428185
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779242818421 0.00000000000 0.00000009095 0.8426  0.150    8.00000000
      ideal mu1:      -0.514317368267
10    -16.77779242818468 0.00000000000 0.00000006693 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00002102150956              |
           | Maximum change in energy =  0.00001085024472 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31637954E-01     0.85913539E-02
               2       0.50542007E-03     0.13434743E-03
               3       0.15056358E-06     0.40086208E-07
               4       0.15594383E-13     0.44408921E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22482497E-01     0.60995252E-02
               2       0.25695924E-03     0.68266657E-04
               3       0.38906637E-07     0.10359360E-07
               4       0.61458041E-14     0.19984014E-14
================================================================================
RMS gradient                =       0.00002102150956
Trial step length           =               0.253125
Gradient along search dir.  =         -0.00002007175
Functional at step 0        =     -16.77779242818468
Functional at step 1        =     -16.77778859270497
Functional predicted        =     -16.77779315196072
Selected quadratic step     =               0.072119
Conjugate gradients coeff.  =               0.239913
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99941336
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000046 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514215281356
             Q0:     -16.777793121783
             G0:      -0.000001400171
   RMS gradient:       0.000098607356
     Trial step:       0.704365167032
             Q1:     -16.777793483511
 Quadratic coef:       0.000000624504
 Linear coef   :      -0.000000986232
           Qmin:     -16.777793511153
Quadratic minimum step length (  0.556175150854) accepted
    Initial Ne1:       8.00000007
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779312178298 0.00000000000 0.00014791103 0.5562  0.000    8.00000000
      ideal mu1:      -0.514329161208
             Q0:     -16.777793511163
             G0:      -0.000000061539
   RMS gradient:       0.000020672779
     Trial step:       0.625899674892
             Q1:     -16.777793531449
 Quadratic coef:       0.000000018231
 Linear coef   :      -0.000000038517
           Qmin:     -16.777793531507
Quadratic minimum step length (  0.661176547045) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779351116288 0.00000004867 0.00003100917 0.6612  0.044    8.00000000
      ideal mu1:      -0.514349328731
             Q0:     -16.777793531507
             G0:      -0.000000011057
   RMS gradient:       0.000008762834
     Trial step:       0.643296343719
             Q1:     -16.777793534362
 Quadratic coef:       0.000000004258
 Linear coef   :      -0.000000007113
           Qmin:     -16.777793534478
Quadratic minimum step length (  0.537350875373) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779353150691 0.00000000265 0.00001314425 0.5374  0.180    8.00000000
      ideal mu1:      -0.514344053833
             Q0:     -16.777793534478
             G0:      -0.000000002489
   RMS gradient:       0.000004157740
     Trial step:       0.587942049373
             Q1:     -16.777793535199
 Quadratic coef:       0.000000000742
 Linear coef   :      -0.000000001464
           Qmin:     -16.777793535199
Quadratic minimum step length (  0.579550567000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779353447750 0.00000000044 0.00000623661 0.5796  0.225    8.00000000
      ideal mu1:      -0.514349553276
             Q0:     -16.777793535199
             G0:      -0.000000000342
   RMS gradient:       0.000001542058
     Trial step:       0.583731229315
             Q1:     -16.777793535281
 Quadratic coef:       0.000000000117
 Linear coef   :      -0.000000000200
           Qmin:     -16.777793535284
Quadratic minimum step length (  0.496280033755) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779353519887 0.00000000011 0.00000231309 0.4963  0.138    8.00000000
      ideal mu1:      -0.514346163597
             Q0:     -16.777793535284
             G0:      -0.000000000012
   RMS gradient:       0.000000282662
     Trial step:       0.538232435095
             Q1:     -16.777793535287
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000006
           Qmin:     -16.777793535287
Quadratic minimum step length (  0.591081712683) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779353528387 0.00000000001 0.00000042399 0.5911  0.034    8.00000000
      ideal mu1:      -0.514346289312
             Q0:     -16.777793535287
             G0:      -0.000000000002
   RMS gradient:       0.000000113640
     Trial step:       0.564038429150
             Q1:     -16.777793535288
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777793535288
Quadratic minimum step length (  0.566417551039) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779353528706 0.00000000000 0.00000017046 0.5664  0.000    8.00000000
      ideal mu1:      -0.514346361805
             Q0:     -16.777793535288
             G0:      -0.000000000001
   RMS gradient:       0.000000062192
     Trial step:       0.565226738337
             Q1:     -16.777793535288
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777793535288
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  3.088599238289)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779353528761 0.00000000000 0.00000009329 0.1500  0.000    8.00000000
      ideal mu1:      -0.514346374620
             Q0:     -16.777793535288
             G0:      -0.000000000001
   RMS gradient:       0.000000050270
     Trial step:       0.291176940623
             Q1:     -16.777793535288
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777793535288
Quadratic minimum step length (  0.087481819336) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779353528781 0.00000000000 0.00000007540 0.0875  0.653    8.00000000
      ideal mu1:      -0.514346381442
10    -16.77779353528758 0.00000000000 0.00000005811 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001916424209              |
           | Maximum change in energy =  0.00000293289699 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26222501E-01     0.71733760E-02
               2       0.35252922E-03     0.94389442E-04
               3       0.74075758E-07     0.19831221E-07
               4       0.70229397E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20059391E-01     0.54842083E-02
               2       0.20709616E-03     0.55430859E-04
               3       0.25561956E-07     0.68415629E-08
               4       0.64854244E-14     0.24424907E-14
================================================================================
RMS gradient                =       0.00001916424209
Trial step length           =               0.135111
Gradient along search dir.  =         -0.00001970237
Functional at step 0        =     -16.77779353528758
Functional at step 1        =     -16.77779040252722
Functional predicted        =     -16.77779384100812
Selected quadratic step     =               0.031034
Conjugate gradients coeff.  =               0.831104
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99960686
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000031 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514278245421
             Q0:     -16.777793827503
             G0:      -0.000000653821
   RMS gradient:       0.000067382665
     Trial step:       0.159601655739
             Q1:     -16.777793916846
 Quadratic coef:       0.000000015008
 Linear coef   :      -0.000000104351
           Qmin:     -16.777794008888
Quadratic minimum step length (  0.554843872359) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779382750342 0.00000000000 0.00010107400 0.5548  0.000    8.00000000
      ideal mu1:      -0.514352868943
             Q0:     -16.777794008885
             G0:      -0.000000029333
   RMS gradient:       0.000014272762
     Trial step:       0.297580242464
             Q1:     -16.777794015613
 Quadratic coef:       0.000000002000
 Linear coef   :      -0.000000008729
           Qmin:     -16.777794018408
Quadratic minimum step length (  0.649332134253) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779400888456 0.00000002267 0.00002140914 0.6493  0.045    8.00000000
      ideal mu1:      -0.514368215206
             Q0:     -16.777794018408
             G0:      -0.000000005702
   RMS gradient:       0.000006292779
     Trial step:       0.439577540317
             Q1:     -16.777794019858
 Quadratic coef:       0.000000001056
 Linear coef   :      -0.000000002507
           Qmin:     -16.777794019895
Quadratic minimum step length (  0.521659715503) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779401840779 0.00000000124 0.00000943917 0.5217  0.194    8.00000000
      ideal mu1:      -0.514363625139
             Q0:     -16.777794019895
             G0:      -0.000000001203
   RMS gradient:       0.000002889752
     Trial step:       0.478863127233
             Q1:     -16.777794020240
 Quadratic coef:       0.000000000231
 Linear coef   :      -0.000000000576
           Qmin:     -16.777794020254
Quadratic minimum step length (  0.596139184049) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779401989521 0.00000000022 0.00000433463 0.5961  0.211    8.00000000
      ideal mu1:      -0.514367547945
             Q0:     -16.777794020254
             G0:      -0.000000000163
   RMS gradient:       0.000001064277
     Trial step:       0.534293059977
             Q1:     -16.777794020295
 Quadratic coef:       0.000000000046
 Linear coef   :      -0.000000000087
           Qmin:     -16.777794020295
Quadratic minimum step length (  0.508800683485) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779402025380 0.00000000006 0.00000159642 0.5088  0.136    8.00000000
      ideal mu1:      -0.514365267921
             Q0:     -16.777794020295
             G0:      -0.000000000006
   RMS gradient:       0.000000195595
     Trial step:       0.521391095146
             Q1:     -16.777794020297
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777794020297
Quadratic minimum step length (  0.513159126554) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779402029546 0.00000000001 0.00000029339 0.5132  0.034    8.00000000
      ideal mu1:      -0.514365332879
             Q0:     -16.777794020297
             G0:      -0.000000000001
   RMS gradient:       0.000000072418
     Trial step:       0.517258735043
             Q1:     -16.777794020297
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777794020300
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  9.478927313718)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779402029686 0.00000000000 0.00000010863 0.1500  0.000    8.00000000
      ideal mu1:      -0.514365352131
             Q0:     -16.777794020297
             G0:      -0.000000000001
   RMS gradient:       0.000000059104
     Trial step:       0.278547680400
             Q1:     -16.777794020297
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777794020297
Quadratic minimum step length (  0.130585972976) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779402029710 0.00000000000 0.00000008866 0.1306  0.666    8.00000000
      ideal mu1:      -0.514365375779
             Q0:     -16.777794020297
             G0:      -0.000000000001
   RMS gradient:       0.000000045112
     Trial step:       0.190720790333
             Q1:     -16.777794020297
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777794020297
Quadratic minimum step length (  0.040311533427) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779402029722 0.00000000000 0.00000006767 0.0403  0.583    8.00000000
      ideal mu1:      -0.514365382296
10    -16.77779402029717 0.00000000000 0.00000006233 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001913111669              |
           | Maximum change in energy =  0.00000036903430 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56414859E-02     0.15681627E-02
               2       0.16213988E-04     0.44028000E-05
               3       0.16030740E-09     0.43546555E-10
               4       0.66868217E-14     0.20261570E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15467237E-02     0.42967742E-03
               2       0.12288317E-05     0.33357655E-06
               3       0.92106936E-12     0.24957814E-12
================================================================================
RMS gradient                =       0.00001913111669
Trial step length           =               0.064754
Gradient along search dir.  =         -0.00001083469
Functional at step 0        =     -16.77779402029717
Functional at step 1        =     -16.77779444630138
Functional predicted        =     -16.77779446682810
Selected quadratic step     =               0.082426
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99951644
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000038 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514281038820
             Q0:     -16.777794446279
             G0:      -0.000001066847
   RMS gradient:       0.000086073576
     Trial step:       0.087682652302
             Q1:     -16.777794532396
 Quadratic coef:       0.000000007427
 Linear coef   :      -0.000000093544
           Qmin:     -16.777794740826
Quadratic minimum step length (  0.552182340970) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779444627920 0.00000000000 0.00012911036 0.5522  0.000    8.00000000
      ideal mu1:      -0.514369558548
             Q0:     -16.777794740798
             G0:      -0.000000049568
   RMS gradient:       0.000018554424
     Trial step:       0.220038206252
             Q1:     -16.777794749794
 Quadratic coef:       0.000000001911
 Linear coef   :      -0.000000010907
           Qmin:     -16.777794756361
Quadratic minimum step length (  0.627926838677) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779474079803 0.00000003682 0.00002783164 0.6279  0.046    8.00000000
      ideal mu1:      -0.514392279604
             Q0:     -16.777794756361
             G0:      -0.000000010700
   RMS gradient:       0.000008619698
     Trial step:       0.371709423125
             Q1:     -16.777794758886
 Quadratic coef:       0.000000001453
 Linear coef   :      -0.000000003977
           Qmin:     -16.777794759083
Quadratic minimum step length (  0.508823316195) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779475636123 0.00000000204 0.00001292955 0.5088  0.216    8.00000000
      ideal mu1:      -0.514384839875
             Q0:     -16.777794759083
             G0:      -0.000000002012
   RMS gradient:       0.000003738509
     Trial step:       0.434895874131
             Q1:     -16.777794759651
 Quadratic coef:       0.000000000307
 Linear coef   :      -0.000000000875
           Qmin:     -16.777794759707
Quadratic minimum step length (  0.620257516140) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779475908295 0.00000000042 0.00000560776 0.6203  0.188    8.00000000
      ideal mu1:      -0.514389924987
             Q0:     -16.777794759708
             G0:      -0.000000000269
   RMS gradient:       0.000001366840
     Trial step:       0.519372154305
             Q1:     -16.777794759778
 Quadratic coef:       0.000000000069
 Linear coef   :      -0.000000000140
           Qmin:     -16.777794759778
Quadratic minimum step length (  0.523995098361) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779475970768 0.00000000010 0.00000205026 0.5240  0.134    8.00000000
      ideal mu1:      -0.514387096298
             Q0:     -16.777794759778
             G0:      -0.000000000009
   RMS gradient:       0.000000252407
     Trial step:       0.521678505482
             Q1:     -16.777794759781
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.777794759781
Quadratic minimum step length (  0.696584455535) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779475977825 0.00000000001 0.00000037861 0.6966  0.034    8.00000000
      ideal mu1:      -0.514387202414
             Q0:     -16.777794759781
             G0:      -0.000000000002
   RMS gradient:       0.000000122398
     Trial step:       0.602820983133
             Q1:     -16.777794759782
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777794759782
Quadratic minimum step length (  0.506108512551) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779475978107 0.00000000000 0.00000018360 0.5061  0.000    8.00000000
      ideal mu1:      -0.514387263666
             Q0:     -16.777794759782
             G0:      -0.000000000000
   RMS gradient:       0.000000052143
     Trial step:       0.552352089801
             Q1:     -16.777794759782
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777794759782
Quadratic minimum step length (  1.036891593747) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779475978156 0.00000000000 0.00000007821 1.0369  0.181    8.00000000
      ideal mu1:      -0.514387331802
             Q0:     -16.777794759782
             G0:      -0.000000000000
   RMS gradient:       0.000000042515
     Trial step:       0.756788767559
             Q1:     -16.777794759782
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777794759782
Quadratic minimum step length (  0.712396416470) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779475978176 0.00000000000 0.00000006377 0.7124  0.665    8.00000000
      ideal mu1:      -0.514387306198
10    -16.77779475978183 0.00000000000 0.00000002528 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001904775468              |
           | Maximum change in energy =  0.00000024649488 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12795628E-01     0.35621952E-02
               2       0.85642146E-04     0.23306036E-04
               3       0.44882526E-08     0.12216691E-08
               4       0.67300959E-14     0.31086245E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.67947448E-02     0.18905027E-02
               2       0.24276560E-04     0.66045926E-05
               3       0.36056810E-09     0.98108105E-10
               4       0.66953657E-14     0.26922908E-14
================================================================================
RMS gradient                =       0.00001904775468
Trial step length           =               0.073057
Gradient along search dir.  =         -0.00001778436
Functional at step 0        =     -16.77779475978183
Functional at step 1        =     -16.77779467310848
Functional predicted        =     -16.77779506428865
Selected quadratic step     =               0.034244
Conjugate gradients coeff.  =               0.991304
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  015 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99960186
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000032 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514317390432
             Q0:     -16.777795050477
             G0:      -0.000000736683
   RMS gradient:       0.000071525218
     Trial step:       0.734257179763
             Q1:     -16.777795231585
 Quadratic coef:       0.000000359808
 Linear coef   :      -0.000000540915
           Qmin:     -16.777795253773
Quadratic minimum step length (  0.551921063186) accepted
    Initial Ne1:       8.00000003
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779505047712 0.00000000000 0.00010728783 0.5519  0.000    8.00000000
      ideal mu1:      -0.514389414099
             Q0:     -16.777795253777
             G0:      -0.000000034696
   RMS gradient:       0.000015522435
     Trial step:       0.636594064775
             Q1:     -16.777795264596
 Quadratic coef:       0.000000011268
 Linear coef   :      -0.000000022087
           Qmin:     -16.777795264600
Quadratic minimum step length (  0.623912993962) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779525377655 0.00000002541 0.00002328365 0.6239  0.047    8.00000000
      ideal mu1:      -0.514408826195
             Q0:     -16.777795264600
             G0:      -0.000000007623
   RMS gradient:       0.000007275761
     Trial step:       0.630221634738
             Q1:     -16.777795266424
 Quadratic coef:       0.000000002980
 Linear coef   :      -0.000000004804
           Qmin:     -16.777795266536
Quadratic minimum step length (  0.507953332055) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779526460033 0.00000000142 0.00001091364 0.5080  0.220    8.00000000
      ideal mu1:      -0.514402390108
             Q0:     -16.777795266536
             G0:      -0.000000001396
   RMS gradient:       0.000003113420
     Trial step:       0.565794290620
             Q1:     -16.777795266969
 Quadratic coef:       0.000000000357
 Linear coef   :      -0.000000000790
           Qmin:     -16.777795266973
Quadratic minimum step length (  0.626271990550) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779526653619 0.00000000030 0.00000467013 0.6263  0.183    8.00000000
      ideal mu1:      -0.514406613797
             Q0:     -16.777795266973
             G0:      -0.000000000187
   RMS gradient:       0.000001139511
     Trial step:       0.595265584952
             Q1:     -16.777795267022
 Quadratic coef:       0.000000000062
 Linear coef   :      -0.000000000111
           Qmin:     -16.777795267023
Quadratic minimum step length (  0.531213520919) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779526697307 0.00000000007 0.00000170927 0.5312  0.134    8.00000000
      ideal mu1:      -0.514404245832
             Q0:     -16.777795267023
             G0:      -0.000000000006
   RMS gradient:       0.000000212363
     Trial step:       0.562328309144
             Q1:     -16.777795267025
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777795267025
Quadratic minimum step length (  0.581888087034) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779526702275 0.00000000001 0.00000031854 0.5819  0.035    8.00000000
      ideal mu1:      -0.514404350259
             Q0:     -16.777795267025
             G0:      -0.000000000001
   RMS gradient:       0.000000080819
     Trial step:       0.572024600951
             Q1:     -16.777795267025
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777795267025
Quadratic minimum step length (  0.646473062314) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779526702472 0.00000000000 0.00000012123 0.6465  0.000    8.00000000
      ideal mu1:      -0.514404421377
             Q0:     -16.777795267025
             G0:      -0.000000000000
   RMS gradient:       0.000000048772
     Trial step:       0.608110594790
             Q1:     -16.777795267025
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777795267025
  Cubic LS coeff:       0.732299712537
Predicted energy:     -16.777795267025
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779526702496 0.00000000000 0.00000007316 0.7323  0.364    8.00000000
      ideal mu1:      -0.514404464512
             Q0:     -16.777795267025
             G0:      -0.000000000000
   RMS gradient:       0.000000020466
     Trial step:       0.667322421140
             Q1:     -16.777795267025
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777795267025
  Cubic LS coeff:       0.706076517719
Predicted energy:     -16.777795267025
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779526702535 0.00000000000 0.00000003070 0.7061  0.176    8.00000000
      ideal mu1:      -0.514404431183
10    -16.77779526702537 0.00000000000 0.00000001302 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001892085373              |
           | Maximum change in energy =  0.00000024649488 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86822664805143 |
           | Pseudopotential (local)    :      -46.08809109031809 |
           | Pseudopotential (non-local):       -3.18830283568645 |
           | Hartree                    :       19.82173766244074 |
           | Exchange-correlation       :       -4.12721489948381 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779526702537 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08809109031860 |
           | Hartree                    :       19.82173766244108 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999974
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13063222E-01     0.36434198E-02
               2       0.90557795E-04     0.24698255E-04
               3       0.50379727E-08     0.13742459E-08
               4       0.60925971E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.79863514E-02     0.22262893E-02
               2       0.33980643E-04     0.92654884E-05
               3       0.70929931E-09     0.19342178E-09
               4       0.68007095E-14     0.19984014E-14
================================================================================
RMS gradient                =       0.00001892085373
Trial step length           =               0.050018
Gradient along search dir.  =         -0.00002227530
Functional at step 0        =     -16.77779526702537
Functional at step 1        =     -16.77779494394936
Functional predicted        =     -16.77779548295410
Selected quadratic step     =               0.019387
Conjugate gradients coeff.  =               0.986720
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  016 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99966580
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000027 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514345440387
             Q0:     -16.777795473258
             G0:      -0.000000527346
   RMS gradient:       0.000060515505
     Trial step:       0.686426027562
             Q1:     -16.777795610058
 Quadratic coef:       0.000000225184
 Linear coef   :      -0.000000361984
           Qmin:     -16.777795618731
Quadratic minimum step length (  0.551717252596) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779547325767 0.00000000000 0.00009077326 0.5517  0.000    8.00000000
      ideal mu1:      -0.514405299602
             Q0:     -16.777795618732
             G0:      -0.000000025139
   RMS gradient:       0.000013212798
     Trial step:       0.615396686729
             Q1:     -16.777795626528
 Quadratic coef:       0.000000007675
 Linear coef   :      -0.000000015470
           Qmin:     -16.777795626528
Quadratic minimum step length (  0.620199345470) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779561873245 0.00000001818 0.00001981920 0.6202  0.048    8.00000000
      ideal mu1:      -0.514422106558
             Q0:     -16.777795626528
             G0:      -0.000000005600
   RMS gradient:       0.000006236011
     Trial step:       0.617793349198
             Q1:     -16.777795627884
 Quadratic coef:       0.000000002104
 Linear coef   :      -0.000000003460
           Qmin:     -16.777795627950
Quadratic minimum step length (  0.508004046799) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779562652808 0.00000000102 0.00000935402 0.5080  0.223    8.00000000
      ideal mu1:      -0.514416484564
             Q0:     -16.777795627950
             G0:      -0.000000001004
   RMS gradient:       0.000002641168
     Trial step:       0.560215602673
             Q1:     -16.777795628263
 Quadratic coef:       0.000000000250
 Linear coef   :      -0.000000000563
           Qmin:     -16.777795628267
Quadratic minimum step length (  0.629981956190) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779562795045 0.00000000022 0.00000396175 0.6300  0.179    8.00000000
      ideal mu1:      -0.514420057567
             Q0:     -16.777795628267
             G0:      -0.000000000134
   RMS gradient:       0.000000965737
     Trial step:       0.594075518146
             Q1:     -16.777795628302
 Quadratic coef:       0.000000000044
 Linear coef   :      -0.000000000080
           Qmin:     -16.777795628303
Quadratic minimum step length (  0.533044793025) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779562826675 0.00000000005 0.00000144861 0.5330  0.134    8.00000000
      ideal mu1:      -0.514418063170
             Q0:     -16.777795628303
             G0:      -0.000000000005
   RMS gradient:       0.000000180294
     Trial step:       0.562733384127
             Q1:     -16.777795628304
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777795628304
Quadratic minimum step length (  0.620397989779) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779562830256 0.00000000001 0.00000027044 0.6204  0.035    8.00000000
      ideal mu1:      -0.514418152975
             Q0:     -16.777795628304
             G0:      -0.000000000001
   RMS gradient:       0.000000072785
     Trial step:       0.590862640801
             Q1:     -16.777795628304
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777795628304
Quadratic minimum step length (  0.707214974687) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779562830404 0.00000000000 0.00000010918 0.7072  0.000    8.00000000
      ideal mu1:      -0.514418214921
             Q0:     -16.777795628304
             G0:      -0.000000000000
   RMS gradient:       0.000000051924
     Trial step:       0.646426258407
             Q1:     -16.777795628305
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777795628304
  Cubic LS coeff:       0.852166676697
Predicted energy:     -16.777795628305
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779562830414 0.00000000000 0.00000007789 0.8522  0.509    8.00000000
      ideal mu1:      -0.514418264801
             Q0:     -16.777795628305
             G0:      -0.000000000000
   RMS gradient:       0.000000027952
     Trial step:       0.742201398784
             Q1:     -16.777795628305
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777795628305
Quadratic minimum step length (  0.124912711743) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779562830463 0.00000000000 0.00000004193 0.1249  0.290    8.00000000
      ideal mu1:      -0.514418257040
10    -16.77779562830449 0.00000000000 0.00000003498 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001874393624              |
           | Maximum change in energy =  0.00000016908118 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10705711E-01     0.29918888E-02
               2       0.61387960E-04     0.16778160E-04
               3       0.23238777E-08     0.63524028E-09
               4       0.66117617E-14     0.24424907E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63729697E-02     0.17801422E-02
               2       0.21825575E-04     0.59640266E-05
               3       0.29373401E-09     0.80272372E-10
               4       0.71751012E-14     0.35527137E-14
================================================================================
RMS gradient                =       0.00001874393624
Trial step length           =               0.031140
Gradient along search dir.  =         -0.00002510690
Functional at step 0        =     -16.77779562830449
Functional at step 1        =     -16.77779544240000
Functional predicted        =     -16.77779578621517
Selected quadratic step     =               0.012579
Conjugate gradients coeff.  =               0.981387
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  017 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99971514
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000023 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514367770407
             Q0:     -16.777795779188
             G0:      -0.000000388524
   RMS gradient:       0.000051943073
     Trial step:       0.304483808077
             Q1:     -16.777795864831
 Quadratic coef:       0.000000032656
 Linear coef   :      -0.000000118299
           Qmin:     -16.777795886324
Quadratic minimum step length (  0.551505783065) accepted
    Initial Ne1:       7.99999986
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779577918755 0.00000000000 0.00007791461 0.5515  0.000    8.00000000
      ideal mu1:      -0.514418288422
             Q0:     -16.777795886322
             G0:      -0.000000018720
   RMS gradient:       0.000011401972
     Trial step:       0.409786018556
             Q1:     -16.777795891445
 Quadratic coef:       0.000000002548
 Linear coef   :      -0.000000007671
           Qmin:     -16.777795892096
Quadratic minimum step length (  0.616892070544) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779588632206 0.00000001339 0.00001710296 0.6169  0.048    8.00000000
      ideal mu1:      -0.514433005350
             Q0:     -16.777795892096
             G0:      -0.000000004221
   RMS gradient:       0.000005414161
     Trial step:       0.502785983762
             Q1:     -16.777795893168
 Quadratic coef:       0.000000001050
 Linear coef   :      -0.000000002122
           Qmin:     -16.777795893169
Quadratic minimum step length (  0.508190132389) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779589209608 0.00000000076 0.00000812124 0.5082  0.225    8.00000000
      ideal mu1:      -0.514428047216
             Q0:     -16.777795893168
             G0:      -0.000000000743
   RMS gradient:       0.000002271398
     Trial step:       0.505480836087
             Q1:     -16.777795893394
 Quadratic coef:       0.000000000150
 Linear coef   :      -0.000000000375
           Qmin:     -16.777795893403
Quadratic minimum step length (  0.632261300822) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779589316846 0.00000000017 0.00000340710 0.6323  0.176    8.00000000
      ideal mu1:      -0.514431105470
             Q0:     -16.777795893403
             G0:      -0.000000000099
   RMS gradient:       0.000000828678
     Trial step:       0.565328197568
             Q1:     -16.777795893430
 Quadratic coef:       0.000000000029
 Linear coef   :      -0.000000000056
           Qmin:     -16.777795893430
Quadratic minimum step length (  0.537786094089) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779589340333 0.00000000004 0.00000124302 0.5378  0.133    8.00000000
      ideal mu1:      -0.514429398312
             Q0:     -16.777795893430
             G0:      -0.000000000003
   RMS gradient:       0.000000155747
     Trial step:       0.551385204053
             Q1:     -16.777795893431
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777795893431
Quadratic minimum step length (  0.513851549396) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779589343009 0.00000000000 0.00000023362 0.5139  0.035    8.00000000
      ideal mu1:      -0.514429467464
             Q0:     -16.777795893431
             G0:      -0.000000000000
   RMS gradient:       0.000000056962
     Trial step:       0.532287649130
             Q1:     -16.777795893431
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777795893431
  Cubic LS coeff:       1.280415038576
Predicted energy:     -16.777795893431
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779589343071 0.00000000000 0.00000008544 1.2804  0.000    8.00000000
      ideal mu1:      -0.514429601123
             Q0:     -16.777795893431
             G0:      -0.000000000000
   RMS gradient:       0.000000063947
     Trial step:       0.825559877171
             Q1:     -16.777795893431
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777795893431
Quadratic minimum step length (  0.625527660722) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779589343108 0.00000000000 0.00000009592 0.6255  1.260    8.00000000
      ideal mu1:      -0.514429615160
             Q0:     -16.777795893431
             G0:      -0.000000000000
   RMS gradient:       0.000000043365
     Trial step:       0.718617101628
             Q1:     -16.777795893431
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777795893431
Quadratic minimum step length (  0.211152525068) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779589343109 0.00000000000 0.00000006505 0.2112  0.460    8.00000000
      ideal mu1:      -0.514429593860
10    -16.77779589343119 0.00000000000 0.00000005572 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001852712278              |
           | Maximum change in energy =  0.00000012042637 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16847287E-02     0.47842530E-03
               2       0.15305110E-05     0.42264997E-06
               3       0.14705061E-11     0.40431547E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.49622776E-02     0.14077668E-02
               2       0.13369875E-04     0.36912973E-05
               3       0.11220272E-09     0.30996483E-10
               4       0.61677827E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00001852712278
Trial step length           =               0.019792
Gradient along search dir.  =         -0.00001016136
Functional at step 0        =     -16.77779589343119
Functional at step 1        =     -16.77779606894737
Functional predicted        =     -16.77779628848303
Selected quadratic step     =               0.077756
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  018 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99955629
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000035 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514349760827
             Q0:     -16.777796271171
             G0:      -0.000001001591
   RMS gradient:       0.000083399581
     Trial step:       0.389535384228
             Q1:     -16.777796523004
 Quadratic coef:       0.000000138322
 Linear coef   :      -0.000000390155
           Qmin:     -16.777796546291
Quadratic minimum step length (  0.549366380025) accepted
    Initial Ne1:       8.00000004
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779627117089 0.00000000000 0.00012509937 0.5494  0.000    8.00000000
      ideal mu1:      -0.514426082365
             Q0:     -16.777796546286
             G0:      -0.000000049844
   RMS gradient:       0.000018605210
     Trial step:       0.462598793692
             Q1:     -16.777796560489
 Quadratic coef:       0.000000008854
 Linear coef   :      -0.000000023058
           Qmin:     -16.777796561297
Quadratic minimum step length (  0.602320634449) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779654628589 0.00000003439 0.00002790781 0.6023  0.050    8.00000000
      ideal mu1:      -0.514451503911
             Q0:     -16.777796561296
             G0:      -0.000000011698
   RMS gradient:       0.000009013344
     Trial step:       0.527856797732
             Q1:     -16.777796564274
 Quadratic coef:       0.000000003196
 Linear coef   :      -0.000000006175
           Qmin:     -16.777796564278
Quadratic minimum step length (  0.509860441094) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779656129597 0.00000000197 0.00001352002 0.5099  0.235    8.00000000
      ideal mu1:      -0.514442880896
             Q0:     -16.777796564278
             G0:      -0.000000001922
   RMS gradient:       0.000003653252
     Trial step:       0.518780589195
             Q1:     -16.777796564873
 Quadratic coef:       0.000000000402
 Linear coef   :      -0.000000000997
           Qmin:     -16.777796564897
Quadratic minimum step length (  0.643916886834) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779656427813 0.00000000046 0.00000547988 0.6439  0.164    8.00000000
      ideal mu1:      -0.514447716757
             Q0:     -16.777796564897
             G0:      -0.000000000256
   RMS gradient:       0.000001333108
     Trial step:       0.577971956019
             Q1:     -16.777796564966
 Quadratic coef:       0.000000000079
 Linear coef   :      -0.000000000148
           Qmin:     -16.777796564966
Quadratic minimum step length (  0.543014242572) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779656489660 0.00000000009 0.00000199966 0.5430  0.133    8.00000000
      ideal mu1:      -0.514445026384
             Q0:     -16.777796564966
             G0:      -0.000000000009
   RMS gradient:       0.000000252241
     Trial step:       0.560220495810
             Q1:     -16.777796564969
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.777796564969
Quadratic minimum step length (  0.608006788901) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779656496594 0.00000000001 0.00000037836 0.6080  0.036    8.00000000
      ideal mu1:      -0.514445151037
             Q0:     -16.777796564969
             G0:      -0.000000000001
   RMS gradient:       0.000000097105
     Trial step:       0.583624763640
             Q1:     -16.777796564969
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777796564969
Quadratic minimum step length (  0.929878362391) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779656496879 0.00000000000 0.00000014566 0.9299  0.000    8.00000000
      ideal mu1:      -0.514445283717
             Q0:     -16.777796564969
             G0:      -0.000000000001
   RMS gradient:       0.000000098618
     Trial step:       0.736681776254
             Q1:     -16.777796564969
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777796564969
Quadratic minimum step length (  0.768666349223) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779656496892 0.00000000000 0.00000014793 0.7687  1.031    8.00000000
      ideal mu1:      -0.514445363592
             Q0:     -16.777796564969
             G0:      -0.000000000000
   RMS gradient:       0.000000067409
     Trial step:       0.752504147159
             Q1:     -16.777796564969
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777796564969
Quadratic minimum step length (  0.293661873511) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779656496931 0.00000000000 0.00000010111 0.2937  0.467    8.00000000
      ideal mu1:      -0.514445328797
10    -16.77779656496936 0.00000000000 0.00000007176 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001738432173              |
           | Maximum change in energy =  0.00000022384606 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63179579E-02     0.17969775E-02
               2       0.21963914E-04     0.60785267E-05
               3       0.30421019E-09     0.84233703E-10
               4       0.66708218E-14     0.26645353E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10302208E-02     0.29276821E-03
               2       0.58664401E-06     0.16232289E-06
               3       0.21835677E-12     0.61339822E-13
================================================================================
RMS gradient                =       0.00001738432173
Trial step length           =               0.039229
Gradient along search dir.  =         -0.00001520471
Functional at step 0        =     -16.77779656496936
Functional at step 1        =     -16.77779680522303
Functional predicted        =     -16.77779681466032
Selected quadratic step     =               0.032844
Conjugate gradients coeff.  =               0.880440
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  019 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99964921
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000028 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514382230079
             Q0:     -16.777796804069
             G0:      -0.000000635862
   RMS gradient:       0.000066450795
     Trial step:       0.470086989481
             Q1:     -16.777796975015
 Quadratic coef:       0.000000127965
 Linear coef   :      -0.000000298910
           Qmin:     -16.777796978624
Quadratic minimum step length (  0.549032925805) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779680406944 0.00000000000 0.00009967619 0.5490  0.000    8.00000000
      ideal mu1:      -0.514441737305
             Q0:     -16.777796978622
             G0:      -0.000000032095
   RMS gradient:       0.000014929476
     Trial step:       0.508028774006
             Q1:     -16.777796988007
 Quadratic coef:       0.000000006921
 Linear coef   :      -0.000000016305
           Qmin:     -16.777796988226
Quadratic minimum step length (  0.598436740393) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779697862237 0.00000002182 0.00002239421 0.5984  0.050    8.00000000
      ideal mu1:      -0.514462382018
             Q0:     -16.777796988226
             G0:      -0.000000007599
   RMS gradient:       0.000007264473
     Trial step:       0.551382882888
             Q1:     -16.777796990158
 Quadratic coef:       0.000000002258
 Linear coef   :      -0.000000004190
           Qmin:     -16.777796990169
Quadratic minimum step length (  0.511491802133) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779698822593 0.00000000126 0.00001089671 0.5115  0.237    8.00000000
      ideal mu1:      -0.514455354397
             Q0:     -16.777796990170
             G0:      -0.000000001225
   RMS gradient:       0.000002915980
     Trial step:       0.531062919468
             Q1:     -16.777796990553
 Quadratic coef:       0.000000000267
 Linear coef   :      -0.000000000650
           Qmin:     -16.777796990566
Quadratic minimum step length (  0.646470677735) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779699016974 0.00000000030 0.00000437397 0.6465  0.161    8.00000000
      ideal mu1:      -0.514459196845
             Q0:     -16.777796990565
             G0:      -0.000000000163
   RMS gradient:       0.000001063376
     Trial step:       0.585932253310
             Q1:     -16.777796990610
 Quadratic coef:       0.000000000051
 Linear coef   :      -0.000000000095
           Qmin:     -16.777796990610
Quadratic minimum step length (  0.547087334723) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779699056544 0.00000000006 0.00000159506 0.5471  0.133    8.00000000
      ideal mu1:      -0.514457054775
             Q0:     -16.777796990610
             G0:      -0.000000000006
   RMS gradient:       0.000000202276
     Trial step:       0.566176752253
             Q1:     -16.777796990612
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777796990612
Quadratic minimum step length (  0.696881703363) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779699060995 0.00000000001 0.00000030341 0.6969  0.036    8.00000000
      ideal mu1:      -0.514457178008
             Q0:     -16.777796990612
             G0:      -0.000000000001
   RMS gradient:       0.000000091858
     Trial step:       0.628138694489
             Q1:     -16.777796990612
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777796990612
Quadratic minimum step length (  0.507301433301) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779699061190 0.00000000000 0.00000013779 0.5073  0.000    8.00000000
      ideal mu1:      -0.514457219613
             Q0:     -16.777796990612
             G0:      -0.000000000000
   RMS gradient:       0.000000038544
     Trial step:       0.564495934464
             Q1:     -16.777796990612
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777796990612
  Cubic LS coeff:       0.760058607855
Predicted energy:     -16.777796990612
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779699061198 0.00000000000 0.00000005782 0.7601  0.176    8.00000000
      ideal mu1:      -0.514457263494
             Q0:     -16.777796990612
             G0:      -0.000000000000
   RMS gradient:       0.000000020279
     Trial step:       0.655019079179
             Q1:     -16.777796990612
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777796990612
Quadratic minimum step length (  0.107146930379) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779699061215 0.00000000000 0.00000003042 0.1071  0.277    8.00000000
      ideal mu1:      -0.514457261235
10    -16.77779699061215 0.00000000000 0.00000002599 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001643532133              |
           | Maximum change in energy =  0.00000022384606 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.82606808E-02     0.23536500E-02
               2       0.38065782E-04     0.10555792E-04
               3       0.91751218E-09     0.25452551E-09
               4       0.63773141E-14     0.17763568E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.39663465E-02     0.11292867E-02
               2       0.88032986E-05     0.24407901E-05
               3       0.49073235E-10     0.13609308E-10
               4       0.68996677E-14     0.24424907E-14
================================================================================
RMS gradient                =       0.00001643532133
Trial step length           =               0.035895
Gradient along search dir.  =         -0.00001756725
Functional at step 0        =     -16.77779699061215
Functional at step 1        =     -16.77779701451601
Functional predicted        =     -16.77779715446691
Selected quadratic step     =               0.018655
Conjugate gradients coeff.  =               0.893801
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  020 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99971713
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000023 (step -0.5001 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514406409028
             Q0:     -16.777797147620
             G0:      -0.000000419117
   RMS gradient:       0.000053949342
     Trial step:       0.264921278258
             Q1:     -16.777797231848
 Quadratic coef:       0.000000026805
 Linear coef   :      -0.000000111033
           Qmin:     -16.777797262602
Quadratic minimum step length (  0.548684095118) accepted
    Initial Ne1:       8.00000002
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779714762044 0.00000000000 0.00008092401 0.5487  0.000    8.00000000
      ideal mu1:      -0.514453860669
             Q0:     -16.777797262602
             G0:      -0.000000021410
   RMS gradient:       0.000012193652
     Trial step:       0.381258562971
             Q1:     -16.777797268151
 Quadratic coef:       0.000000002614
 Linear coef   :      -0.000000008163
           Qmin:     -16.777797268974
Quadratic minimum step length (  0.595226974124) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779726260199 0.00000001437 0.00001829048 0.5952  0.051    8.00000000
      ideal mu1:      -0.514470906926
             Q0:     -16.777797268973
             G0:      -0.000000005104
   RMS gradient:       0.000005954538
     Trial step:       0.476377351263
             Q1:     -16.777797270276
 Quadratic coef:       0.000000001129
 Linear coef   :      -0.000000002432
           Qmin:     -16.777797270282
Quadratic minimum step length (  0.513130090496) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779726897285 0.00000000084 0.00000893181 0.5131  0.238    8.00000000
      ideal mu1:      -0.514465097922
             Q0:     -16.777797270283
             G0:      -0.000000000810
   RMS gradient:       0.000002372346
     Trial step:       0.494412331322
             Q1:     -16.777797270530
 Quadratic coef:       0.000000000153
 Linear coef   :      -0.000000000401
           Qmin:     -16.777797270545
Quadratic minimum step length (  0.647166490294) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779727028259 0.00000000020 0.00000355852 0.6472  0.159    8.00000000
      ideal mu1:      -0.514468203978
             Q0:     -16.777797270545
             G0:      -0.000000000107
   RMS gradient:       0.000000862813
     Trial step:       0.565656338442
             Q1:     -16.777797270575
 Quadratic coef:       0.000000000031
 Linear coef   :      -0.000000000061
           Qmin:     -16.777797270575
Quadratic minimum step length (  0.556435053499) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779727054495 0.00000000004 0.00000129422 0.5564  0.132    8.00000000
      ideal mu1:      -0.514466456169
             Q0:     -16.777797270574
             G0:      -0.000000000004
   RMS gradient:       0.000000167212
     Trial step:       0.561026750648
             Q1:     -16.777797270576
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777797270576
Quadratic minimum step length (  0.776667049793) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779727057436 0.00000000000 0.00000025082 0.7767  0.038    8.00000000
      ideal mu1:      -0.514466596890
             Q0:     -16.777797270576
             G0:      -0.000000000001
   RMS gradient:       0.000000092008
     Trial step:       0.660099228360
             Q1:     -16.777797270576
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777797270576
Quadratic minimum step length (  0.786903275849) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779727057554 0.00000000000 0.00000013801 0.7869  0.000    8.00000000
      ideal mu1:      -0.514466613321
             Q0:     -16.777797270576
             G0:      -0.000000000000
   RMS gradient:       0.000000086753
     Trial step:       0.720717867949
             Q1:     -16.777797270576
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797270577
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  9.141335904752)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779727057574 0.00000000000 0.00000013013 0.1500  0.000    8.00000000
      ideal mu1:      -0.514466625709
             Q0:     -16.777797270576
             G0:      -0.000000000001
   RMS gradient:       0.000000079947
     Trial step:       0.328797323883
             Q1:     -16.777797270576
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797270579
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step=  5.421649449455)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779727057565 0.00000000000 0.00000011992 0.1500  0.000    8.00000000
      ideal mu1:      -0.514466642048
10    -16.77779727057605 0.00000000000 0.00000006804 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001563117646              |
           | Maximum change in energy =  0.00000014188093 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86819960193531 |
           | Pseudopotential (local)    :      -46.08747970971131 |
           | Pseudopotential (non-local):       -3.18844619282260 |
           | Hartree                    :       19.82121675036050 |
           | Exchange-correlation       :       -4.12713696830877 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779727057605 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08747970971184 |
           | Hartree                    :       19.82121675036074 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999958
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.76017068E-02     0.21702796E-02
               2       0.32522487E-04     0.90354404E-05
               3       0.67227640E-09     0.18683463E-09
               4       0.54918766E-14     0.19428903E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.40680641E-02     0.11607280E-02
               2       0.93364699E-05     0.25935210E-05
               3       0.55406421E-10     0.15393853E-10
               4       0.61608902E-14     0.19151347E-14
================================================================================
RMS gradient                =       0.00001563117646
Trial step length           =               0.025877
Gradient along search dir.  =         -0.00001848541
Functional at step 0        =     -16.77779727057605
Functional at step 1        =     -16.77779723395502
Functional predicted        =     -16.77779738165708
Selected quadratic step     =               0.012018
Conjugate gradients coeff.  =               0.904538
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  021 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99976801
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000019 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514424969706
             Q0:     -16.777797377069
             G0:      -0.000000285259
   RMS gradient:       0.000044508037
     Trial step:       0.222080162514
             Q1:     -16.777797427591
 Quadratic coef:       0.000000012828
 Linear coef   :      -0.000000063350
           Qmin:     -16.777797455279
Quadratic minimum step length (  0.548347516501) accepted
    Initial Ne1:       7.99999991
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779737706890 0.00000000000 0.00006676205 0.5483  0.000    8.00000000
      ideal mu1:      -0.514463491386
             Q0:     -16.777797455279
             G0:      -0.000000014724
   RMS gradient:       0.000010112055
     Trial step:       0.348965765626
             Q1:     -16.777797458904
 Quadratic coef:       0.000000001514
 Linear coef   :      -0.000000005138
           Qmin:     -16.777797459639
Quadratic minimum step length (  0.592229495097) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779745527941 0.00000000978 0.00001516808 0.5922  0.052    8.00000000
      ideal mu1:      -0.514477728332
             Q0:     -16.777797459639
             G0:      -0.000000003527
   RMS gradient:       0.000004949119
     Trial step:       0.454607324163
             Q1:     -16.777797460535
 Quadratic coef:       0.000000000708
 Linear coef   :      -0.000000001603
           Qmin:     -16.777797460547
Quadratic minimum step length (  0.514798904391) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779745963920 0.00000000057 0.00000742368 0.5148  0.240    8.00000000
      ideal mu1:      -0.514472870019
             Q0:     -16.777797460547
             G0:      -0.000000000553
   RMS gradient:       0.000001959481
     Trial step:       0.483767870375
             Q1:     -16.777797460715
 Quadratic coef:       0.000000000100
 Linear coef   :      -0.000000000267
           Qmin:     -16.777797460727
Quadratic minimum step length (  0.649380324221) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779746054702 0.00000000014 0.00000293922 0.6494  0.157    8.00000000
      ideal mu1:      -0.514475434074
             Q0:     -16.777797460727
             G0:      -0.000000000073
   RMS gradient:       0.000000713814
     Trial step:       0.560490264422
             Q1:     -16.777797460746
 Quadratic coef:       0.000000000021
 Linear coef   :      -0.000000000041
           Qmin:     -16.777797460746
Quadratic minimum step length (  0.541703557074) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779746072657 0.00000000003 0.00000107072 0.5417  0.133    8.00000000
      ideal mu1:      -0.514474031586
             Q0:     -16.777797460747
             G0:      -0.000000000003
   RMS gradient:       0.000000135103
     Trial step:       0.551016850870
             Q1:     -16.777797460748
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777797460748
Quadratic minimum step length (  0.510206493192) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779746074684 0.00000000000 0.00000020265 0.5102  0.036    8.00000000
      ideal mu1:      -0.514474062967
             Q0:     -16.777797460748
             G0:      -0.000000000000
   RMS gradient:       0.000000051115
     Trial step:       0.530219176542
             Q1:     -16.777797460748
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797460748
Quadratic minimum step length (  0.551330463210) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779746074756 0.00000000000 0.00000007667 0.5513  0.000    8.00000000
      ideal mu1:      -0.514474125905
             Q0:     -16.777797460748
             G0:      -0.000000000000
   RMS gradient:       0.000000026562
     Trial step:       0.540671789726
             Q1:     -16.777797460748
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797460748
Quadratic minimum step length (  0.086452445432) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779746074782 0.00000000000 0.00000003984 0.0865  0.270    8.00000000
      ideal mu1:      -0.514474128468
             Q0:     -16.777797460748
             G0:      -0.000000000000
   RMS gradient:       0.000000023839
     Trial step:       0.216199903787
             Q1:     -16.777797460748
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797460748
Quadratic minimum step length (  0.085352217282) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779746074788 0.00000000000 0.00000003576 0.0854  0.805    8.00000000
      ideal mu1:      -0.514474130260
10    -16.77779746074776 0.00000000000 0.00000002969 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001493912189              |
           | Maximum change in energy =  0.00000009332130 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14775496E-02     0.42692566E-03
               2       0.12386920E-05     0.34671778E-06
               3       0.98849377E-12     0.27750025E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27472701E-02     0.79323433E-03
               2       0.42983295E-05     0.12030022E-05
               3       0.11908834E-10     0.33358594E-11
               4       0.57189803E-14     0.24424907E-14
================================================================================
RMS gradient                =       0.00001493912189
Trial step length           =               0.017635
Gradient along search dir.  =         -0.00000660672
Functional at step 0        =     -16.77779746074776
Functional at step 1        =     -16.77779755684067
Functional predicted        =     -16.77779762696749
Selected quadratic step     =               0.050318
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  022 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99971982
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000023 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514424002591
             Q0:     -16.777797620166
             G0:      -0.000000434963
   RMS gradient:       0.000054959788
     Trial step:       0.135842339366
             Q1:     -16.777797671907
 Quadratic coef:       0.000000007346
 Linear coef   :      -0.000000059086
           Qmin:     -16.777797738979
Quadratic minimum step length (  0.546311483492) accepted
    Initial Ne1:       7.99999986
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779762016633 0.00000000000 0.00008243968 0.5463  0.000    8.00000000
      ideal mu1:      -0.514469069803
             Q0:     -16.777797738983
             G0:      -0.000000023103
   RMS gradient:       0.000012666166
     Trial step:       0.272419217274
             Q1:     -16.777797743802
 Quadratic coef:       0.000000001475
 Linear coef   :      -0.000000006294
           Qmin:     -16.777797745695
Quadratic minimum step length (  0.581064827317) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779773898328 0.00000001485 0.00001899925 0.5811  0.053    8.00000000
      ideal mu1:      -0.514487501770
             Q0:     -16.777797745694
             G0:      -0.000000005627
   RMS gradient:       0.000006251894
     Trial step:       0.397860811645
             Q1:     -16.777797747077
 Quadratic coef:       0.000000000856
 Linear coef   :      -0.000000002239
           Qmin:     -16.777797747158
Quadratic minimum step length (  0.520145775841) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779774569430 0.00000000088 0.00000937784 0.5201  0.244    8.00000000
      ideal mu1:      -0.514481249092
             Q0:     -16.777797747158
             G0:      -0.000000000845
   RMS gradient:       0.000002422917
     Trial step:       0.454912761472
             Q1:     -16.777797747408
 Quadratic coef:       0.000000000134
 Linear coef   :      -0.000000000384
           Qmin:     -16.777797747433
Quadratic minimum step length (  0.652907839872) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779774715761 0.00000000023 0.00000363437 0.6529  0.150    8.00000000
      ideal mu1:      -0.514484365978
             Q0:     -16.777797747434
             G0:      -0.000000000112
   RMS gradient:       0.000000879330
     Trial step:       0.544991842529
             Q1:     -16.777797747465
 Quadratic coef:       0.000000000030
 Linear coef   :      -0.000000000061
           Qmin:     -16.777797747465
Quadratic minimum step length (  0.556748714438) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779774743388 0.00000000004 0.00000131900 0.5567  0.132    8.00000000
      ideal mu1:      -0.514482632688
             Q0:     -16.777797747465
             G0:      -0.000000000004
   RMS gradient:       0.000000170049
     Trial step:       0.550838912666
             Q1:     -16.777797747466
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777797747466
Quadratic minimum step length (  0.495147395039) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779774746506 0.00000000000 0.00000025507 0.4951  0.037    8.00000000
      ideal mu1:      -0.514482702646
             Q0:     -16.777797747466
             G0:      -0.000000000001
   RMS gradient:       0.000000064289
     Trial step:       0.522251330963
             Q1:     -16.777797747466
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797747466
Quadratic minimum step length (  0.993301418390) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779774746616 0.00000000000 0.00000009643 0.9933  0.000    8.00000000
      ideal mu1:      -0.514482838435
             Q0:     -16.777797747467
             G0:      -0.000000000000
   RMS gradient:       0.000000039083
     Trial step:       0.720245088704
             Q1:     -16.777797747467
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777797747467
  Cubic LS coeff:       1.076952019327
Predicted energy:     -16.777797747467
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779774746658 0.00000000000 0.00000005862 1.0770  0.370    8.00000000
      ideal mu1:      -0.514482790231
             Q0:     -16.777797747467
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000051698
     Trial step:       0.880720956200
             Q1:     -16.777797747467
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777797747467
Quadratic minimum step length (  0.531825345705) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779774746653 0.00000000000 0.00000007755 0.5318  1.750    8.00000000
      ideal mu1:      -0.514482819126
10    -16.77779774746671 0.00000000000 0.00000003930 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001393726543              |
           | Maximum change in energy =  0.00000009557298 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46868820E-02     0.13550559E-02
               2       0.12611650E-04     0.35346339E-05
               3       0.10283605E-09     0.28840069E-10
               4       0.59501202E-14     0.26645353E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12949553E-02     0.37417447E-03
               2       0.96514375E-06     0.27047123E-06
               3       0.60308811E-12     0.16830981E-12
================================================================================
RMS gradient                =       0.00001393726543
Trial step length           =               0.029789
Gradient along search dir.  =         -0.00000991623
Functional at step 0        =     -16.77779774746671
Functional at step 1        =     -16.77779783882317
Functional predicted        =     -16.77779785437978
Selected quadratic step     =               0.021563
Conjugate gradients coeff.  =               0.870372
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  023 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99977611
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000018 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514442829921
             Q0:     -16.777797850133
             G0:      -0.000000280334
   RMS gradient:       0.000044122152
     Trial step:       0.684390040109
             Q1:     -16.777797921764
 Quadratic coef:       0.000000120227
 Linear coef   :      -0.000000191858
           Qmin:     -16.777797926674
Quadratic minimum step length (  0.546074711087) accepted
    Initial Ne1:       7.99999991
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779785013258 0.00000000000 0.00006618323 0.5461  0.000    8.00000000
      ideal mu1:      -0.514478455389
             Q0:     -16.777797926675
             G0:      -0.000000015030
   RMS gradient:       0.000010216611
     Trial step:       0.611333046238
             Q1:     -16.777797931011
 Quadratic coef:       0.000000004853
 Linear coef   :      -0.000000009189
           Qmin:     -16.777797931025
Quadratic minimum step length (  0.578803491921) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779792667499 0.00000000957 0.00001532492 0.5788  0.054    8.00000000
      ideal mu1:      -0.514493391078
             Q0:     -16.777797931025
             G0:      -0.000000003667
   RMS gradient:       0.000005046750
     Trial step:       0.594845948031
             Q1:     -16.777797931962
 Quadratic coef:       0.000000001244
 Linear coef   :      -0.000000002182
           Qmin:     -16.777797931981
Quadratic minimum step length (  0.521426196967) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779793102459 0.00000000057 0.00000757013 0.5214  0.244    8.00000000
      ideal mu1:      -0.514488323000
             Q0:     -16.777797931981
             G0:      -0.000000000545
   RMS gradient:       0.000001944807
     Trial step:       0.556927518142
             Q1:     -16.777797932155
 Quadratic coef:       0.000000000129
 Linear coef   :      -0.000000000303
           Qmin:     -16.777797932160
Quadratic minimum step length (  0.656695272817) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779793198070 0.00000000015 0.00000291721 0.6567  0.149    8.00000000
      ideal mu1:      -0.514490823835
             Q0:     -16.777797932160
             G0:      -0.000000000072
   RMS gradient:       0.000000708735
     Trial step:       0.604757528655
             Q1:     -16.777797932179
 Quadratic coef:       0.000000000024
 Linear coef   :      -0.000000000044
           Qmin:     -16.777797932180
Quadratic minimum step length (  0.550774968808) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779793215974 0.00000000003 0.00000106310 0.5508  0.133    8.00000000
      ideal mu1:      -0.514489442434
             Q0:     -16.777797932179
             G0:      -0.000000000003
   RMS gradient:       0.000000135784
     Trial step:       0.577135433830
             Q1:     -16.777797932180
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.777797932181
Quadratic minimum step length (  0.984336430058) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779793217939 0.00000000000 0.00000020368 0.9843  0.037    8.00000000
      ideal mu1:      -0.514489526984
             Q0:     -16.777797932180
             G0:      -0.000000000002
   RMS gradient:       0.000000108725
     Trial step:       0.753721057551
             Q1:     -16.777797932181
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777797932181
Quadratic minimum step length (  0.546579620354) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779793218022 0.00000000000 0.00000016309 0.5466  0.000    8.00000000
      ideal mu1:      -0.514489554851
             Q0:     -16.777797932180
             G0:      -0.000000000000
   RMS gradient:       0.000000040805
     Trial step:       0.641847777506
             Q1:     -16.777797932181
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777797932181
  Cubic LS coeff:       0.935120309389
Predicted energy:     -16.777797932181
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779793218042 0.00000000000 0.00000006121 0.9351  0.141    8.00000000
      ideal mu1:      -0.514489577996
             Q0:     -16.777797932181
             G0:      -0.000000000000
   RMS gradient:       0.000000041348
     Trial step:       0.774728915352
             Q1:     -16.777797932181
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777797932181
  Cubic LS coeff:       1.049639781512
Predicted energy:     -16.777797932181
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779793218073 0.00000000000 0.00000006202 1.0496  1.027    8.00000000
      ideal mu1:      -0.514489564732
10    -16.77779793218086 0.00000000000 0.00000003112 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001310617420              |
           | Maximum change in energy =  0.00000009557298 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56651582E-02     0.16394166E-02
               2       0.18572002E-04     0.52113373E-05
               3       0.22362079E-09     0.62784583E-10
               4       0.57848160E-14     0.15543122E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28977202E-02     0.83815732E-03
               2       0.48676361E-05     0.13657488E-05
               3       0.15362374E-10     0.43120785E-11
               4       0.56931742E-14     0.22204460E-14
================================================================================
RMS gradient                =       0.00001310617420
Trial step length           =               0.025344
Gradient along search dir.  =         -0.00001146128
Functional at step 0        =     -16.77779793218086
Functional at step 1        =     -16.77779792516366
Functional predicted        =     -16.77779800308781
Selected quadratic step     =               0.012373
Conjugate gradients coeff.  =               0.884294
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  024 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99981819
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000015 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514457145445
             Q0:     -16.777798000304
             G0:      -0.000000186376
   RMS gradient:       0.000035976055
     Trial step:       0.901768423400
             Q1:     -16.777798029535
 Quadratic coef:       0.000000138836
 Linear coef   :      -0.000000168068
           Qmin:     -16.777798051167
Quadratic minimum step length (  0.545816059137) accepted
    Initial Ne1:       7.99999994
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779800030396 0.00000000000 0.00005396408 0.5458  0.000    8.00000000
      ideal mu1:      -0.514485839233
             Q0:     -16.777798051168
             G0:      -0.000000010061
   RMS gradient:       0.000008358815
     Trial step:       0.701569445682
             Q1:     -16.777798053938
 Quadratic coef:       0.000000004289
 Linear coef   :      -0.000000007059
           Qmin:     -16.777798054072
Quadratic minimum step length (  0.577295917403) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779805116829 0.00000000636 0.00001253822 0.5773  0.054    8.00000000
      ideal mu1:      -0.514498107875
             Q0:     -16.777798054073
             G0:      -0.000000002460
   RMS gradient:       0.000004133399
     Trial step:       0.636406455629
             Q1:     -16.777798054685
 Quadratic coef:       0.000000000953
 Linear coef   :      -0.000000001566
           Qmin:     -16.777798054716
Quadratic minimum step length (  0.522883585303) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779805407257 0.00000000038 0.00000620010 0.5229  0.245    8.00000000
      ideal mu1:      -0.514493942498
             Q0:     -16.777798054716
             G0:      -0.000000000363
   RMS gradient:       0.000001587509
     Trial step:       0.576859158919
             Q1:     -16.777798054833
 Quadratic coef:       0.000000000092
 Linear coef   :      -0.000000000209
           Qmin:     -16.777798054835
Quadratic minimum step length (  0.654516417435) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779805471608 0.00000000010 0.00000238126 0.6545  0.148    8.00000000
      ideal mu1:      -0.514495973001
             Q0:     -16.777798054835
             G0:      -0.000000000048
   RMS gradient:       0.000000575311
     Trial step:       0.614462195794
             Q1:     -16.777798054848
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000029
           Qmin:     -16.777798054848
Quadratic minimum step length (  0.559981827692) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779805483492 0.00000000002 0.00000086297 0.5600  0.131    8.00000000
      ideal mu1:      -0.514494843988
             Q0:     -16.777798054848
             G0:      -0.000000000002
   RMS gradient:       0.000000111357
     Trial step:       0.586589859654
             Q1:     -16.777798054849
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798054850
Quadratic minimum step length (  1.667289988756) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779805484840 0.00000000000 0.00000016704 1.6673  0.037    8.00000000
      ideal mu1:      -0.514495001427
             Q0:     -16.777798054847
             G0:      -0.000000000006
   RMS gradient:       0.000000210933
     Trial step:       0.988946611555
             Q1:     -16.777798054847
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000006
           Qmin:     -16.777798054849
Quadratic minimum step length (  0.468086060613) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779805484736 0.00000000000 0.00000031640 0.4681  0.000    8.00000000
      ideal mu1:      -0.514494957587
             Q0:     -16.777798054849
             G0:      -0.000000000000
   RMS gradient:       0.000000053679
     Trial step:       0.680376457235
             Q1:     -16.777798054849
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798054849
Quadratic minimum step length (  0.504488975749) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779805484907 0.00000000000 0.00000008052 0.5045  0.065    8.00000000
      ideal mu1:      -0.514494967467
             Q0:     -16.777798054849
             G0:      -0.000000000000
   RMS gradient:       0.000000018561
     Trial step:       0.585868946125
             Q1:     -16.777798054849
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798054849
  Cubic LS coeff:       0.624750371003
Predicted energy:     -16.777798054849
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779805484933 0.00000000000 0.00000002784 0.6248  0.120    8.00000000
      ideal mu1:      -0.514494956698
10    -16.77779805484951 0.00000000000 0.00000000779 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001240588422              |
           | Maximum change in energy =  0.00000006157138 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.50346007E-02     0.14586473E-02
               2       0.14744948E-04     0.41420511E-05
               3       0.14130150E-09     0.39714565E-10
               4       0.86267694E-14     0.47887042E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27509518E-02     0.79670063E-03
               2       0.44084492E-05     0.12383026E-05
               3       0.12631696E-10     0.35507153E-11
               4       0.54760526E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00001240588422
Trial step length           =               0.017709
Gradient along search dir.  =         -0.00001204605
Functional at step 0        =     -16.77779805484951
Functional at step 1        =     -16.77779803282422
Functional predicted        =     -16.77779810318815
Selected quadratic step     =               0.008026
Conjugate gradients coeff.  =               0.895991
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  025 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99985026
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000012 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514468297455
             Q0:     -16.777798101306
             G0:      -0.000000127342
   RMS gradient:       0.000029737475
     Trial step:       0.604997389623
             Q1:     -16.777798135633
 Quadratic coef:       0.000000042714
 Linear coef   :      -0.000000077041
           Qmin:     -16.777798136045
Quadratic minimum step length (  0.545602114286) accepted
    Initial Ne1:       7.99999996
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779810130606 0.00000000000 0.00004460621 0.5456  0.000    8.00000000
      ideal mu1:      -0.514491745887
             Q0:     -16.777798136045
             G0:      -0.000000006921
   RMS gradient:       0.000006932559
     Trial step:       0.574532727454
             Q1:     -16.777798138036
 Quadratic coef:       0.000000001985
 Linear coef   :      -0.000000003976
           Qmin:     -16.777798138036
Quadratic minimum step length (  0.575409737344) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779813604522 0.00000000434 0.00001039884 0.5754  0.054    8.00000000
      ideal mu1:      -0.514501953902
             Q0:     -16.777798138037
             G0:      -0.000000001693
   RMS gradient:       0.000003428189
     Trial step:       0.574971065185
             Q1:     -16.777798138476
 Quadratic coef:       0.000000000534
 Linear coef   :      -0.000000000973
           Qmin:     -16.777798138480
Quadratic minimum step length (  0.524177641111) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779813803668 0.00000000026 0.00000514228 0.5242  0.245    8.00000000
      ideal mu1:      -0.514498489060
             Q0:     -16.777798138480
             G0:      -0.000000000248
   RMS gradient:       0.000001312360
     Trial step:       0.548987228135
             Q1:     -16.777798138560
 Quadratic coef:       0.000000000057
 Linear coef   :      -0.000000000136
           Qmin:     -16.777798138562
Quadratic minimum step length (  0.661467493530) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779813848002 0.00000000007 0.00000196854 0.6615  0.147    8.00000000
      ideal mu1:      -0.514500181431
             Q0:     -16.777798138561
             G0:      -0.000000000033
   RMS gradient:       0.000000480387
     Trial step:       0.602608667192
             Q1:     -16.777798138571
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000020
           Qmin:     -16.777798138571
Quadratic minimum step length (  0.576890142775) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779813856149 0.00000000001 0.00000072058 0.5769  0.134    8.00000000
      ideal mu1:      -0.514499196854
             Q0:     -16.777798138571
             G0:      -0.000000000001
   RMS gradient:       0.000000097250
     Trial step:       0.589609192647
             Q1:     -16.777798138571
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798138571
Quadratic minimum step length (  0.399638843104) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779813857108 0.00000000000 0.00000014587 0.3996  0.041    8.00000000
      ideal mu1:      -0.514499261506
             Q0:     -16.777798138571
             G0:      -0.000000000000
   RMS gradient:       0.000000041767
     Trial step:       0.485418103940
             Q1:     -16.777798138571
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798138571
Quadratic minimum step length (  0.138842450132) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779813857131 0.00000000000 0.00000006265 0.1388  0.000    8.00000000
      ideal mu1:      -0.514499274357
             Q0:     -16.777798138571
             G0:      -0.000000000000
   RMS gradient:       0.000000035203
     Trial step:       0.259608626377
             Q1:     -16.777798138571
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798138571
Quadratic minimum step length (  0.183187150195) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779813857116 0.00000000000 0.00000005280 0.1832  0.710    8.00000000
      ideal mu1:      -0.514499299455
             Q0:     -16.777798138571
             G0:      -0.000000000000
   RMS gradient:       0.000000023149
     Trial step:       0.218075593389
             Q1:     -16.777798138571
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798138571
  Cubic LS coeff:       0.342937611601
Predicted energy:     -16.777798138571
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779813857125 0.00000000000 0.00000003472 0.3429  0.432    8.00000000
      ideal mu1:      -0.514499330213
10    -16.77779813857140 0.00000000000 0.00000001804 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001180774593              |
           | Maximum change in energy =  0.00000004088955 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86822140492640 |
           | Pseudopotential (local)    :      -46.08718128072941 |
           | Pseudopotential (non-local):       -3.18853145226904 |
           | Hartree                    :       19.82094355879745 |
           | Exchange-correlation       :       -4.12709961726761 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779813857140 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08718128072976 |
           | Hartree                    :       19.82094355879757 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999982
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.98908064E-03     0.28863987E-03
               2       0.57214359E-06     0.16142245E-06
               3       0.21367803E-12     0.60396133E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16189018E-02     0.47221870E-03
               2       0.15359834E-05     0.43333302E-06
               3       0.15478513E-11     0.43781645E-12
================================================================================
RMS gradient                =       0.00001180774593
Trial step length           =               0.011922
Gradient along search dir.  =         -0.00000412734
Functional at step 0        =     -16.77779813857140
Functional at step 1        =     -16.77779817843428
Functional predicted        =     -16.77779820336580
Selected quadratic step     =               0.031398
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  026 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99982794
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514468884757
             Q0:     -16.777798200810
             G0:      -0.000000172744
   RMS gradient:       0.000034635437
     Trial step:       0.273470881714
             Q1:     -16.777798236182
 Quadratic coef:       0.000000011869
 Linear coef   :      -0.000000047241
           Qmin:     -16.777798247818
Quadratic minimum step length (  0.544245970392) accepted
    Initial Ne1:       7.99999995
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779820081017 0.00000000000 0.00005195316 0.5442  0.000    8.00000000
      ideal mu1:      -0.514495186540
             Q0:     -16.777798247818
             G0:      -0.000000009567
   RMS gradient:       0.000008150968
     Trial step:       0.385791945733
             Q1:     -16.777798250258
 Quadratic coef:       0.000000001251
 Linear coef   :      -0.000000003691
           Qmin:     -16.777798250540
Quadratic minimum step length (  0.569010252557) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779824781786 0.00000000588 0.00001222645 0.5690  0.055    8.00000000
      ideal mu1:      -0.514507386450
             Q0:     -16.777798250540
             G0:      -0.000000002353
   RMS gradient:       0.000004041893
     Trial step:       0.468529158619
             Q1:     -16.777798251153
 Quadratic coef:       0.000000000489
 Linear coef   :      -0.000000001102
           Qmin:     -16.777798251161
Quadratic minimum step length (  0.528323502420) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779825053983 0.00000000036 0.00000606284 0.5283  0.246    8.00000000
      ideal mu1:      -0.514503270652
             Q0:     -16.777798251161
             G0:      -0.000000000337
   RMS gradient:       0.000001529304
     Trial step:       0.497528859532
             Q1:     -16.777798251266
 Quadratic coef:       0.000000000063
 Linear coef   :      -0.000000000168
           Qmin:     -16.777798251273
Quadratic minimum step length (  0.660174534940) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779825116145 0.00000000010 0.00000229396 0.6602  0.143    8.00000000
      ideal mu1:      -0.514505212163
             Q0:     -16.777798251273
             G0:      -0.000000000045
   RMS gradient:       0.000000556667
     Trial step:       0.573110707857
             Q1:     -16.777798251285
 Quadratic coef:       0.000000000013
 Linear coef   :      -0.000000000026
           Qmin:     -16.777798251285
Quadratic minimum step length (  0.551031312664) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779825127266 0.00000000002 0.00000083500 0.5510  0.132    8.00000000
      ideal mu1:      -0.514504147617
             Q0:     -16.777798251285
             G0:      -0.000000000002
   RMS gradient:       0.000000107106
     Trial step:       0.561962583855
             Q1:     -16.777798251285
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798251285
Quadratic minimum step length (  0.647155330362) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779825128495 0.00000000000 0.00000016066 0.6472  0.037    8.00000000
      ideal mu1:      -0.514504179649
             Q0:     -16.777798251285
             G0:      -0.000000000000
   RMS gradient:       0.000000041823
     Trial step:       0.603056449767
             Q1:     -16.777798251286
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798251286
  Cubic LS coeff:       0.754131481582
Predicted energy:     -16.777798251286
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779825128550 0.00000000000 0.00000006273 0.7541  0.000    8.00000000
      ideal mu1:      -0.514504245991
             Q0:     -16.777798251286
             G0:      -0.000000000000
   RMS gradient:       0.000000028847
     Trial step:       0.674376641010
             Q1:     -16.777798251286
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798251286
Quadratic minimum step length (  0.099822400903) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779825128571 0.00000000000 0.00000004327 0.0998  0.476    8.00000000
      ideal mu1:      -0.514504246857
             Q0:     -16.777798251286
             G0:      -0.000000000000
   RMS gradient:       0.000000024864
     Trial step:       0.259456924014
             Q1:     -16.777798251286
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798251285
  Cubic LS coeff:       0.254802531910
Predicted energy:     -16.777798251286
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779825128572 0.00000000000 0.00000003730 0.2548  0.743    8.00000000
      ideal mu1:      -0.514504240400
10    -16.77779825128571 0.00000000000 0.00000001295 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001106712459              |
           | Maximum change in energy =  0.00000003757143 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30227567E-02     0.88230509E-03
               2       0.53803649E-05     0.15191173E-05
               3       0.19015162E-10     0.53727023E-11
               4       0.68358304E-14     0.28865799E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.90186825E-03     0.26314535E-03
               2       0.47963366E-06     0.13541483E-06
               3       0.15259300E-12     0.43853809E-13
================================================================================
RMS gradient                =       0.00001106712459
Trial step length           =               0.019347
Gradient along search dir.  =         -0.00000630504
Functional at step 0        =     -16.77779825128571
Functional at step 1        =     -16.77779828635100
Functional predicted        =     -16.77779829408458
Selected quadratic step     =               0.013576
Conjugate gradients coeff.  =               0.878488
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  027 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99986051
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514479595357
             Q0:     -16.777798292456
             G0:      -0.000000114159
   RMS gradient:       0.000028156223
     Trial step:       0.257119196406
             Q1:     -16.777798314873
 Quadratic coef:       0.000000006935
 Linear coef   :      -0.000000029353
           Qmin:     -16.777798323515
Quadratic minimum step length (  0.544133955689) accepted
    Initial Ne1:       7.99999997
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779829245564 0.00000000000 0.00004223433 0.5441  0.000    8.00000000
      ideal mu1:      -0.514500776852
             Q0:     -16.777798323513
             G0:      -0.000000006358
   RMS gradient:       0.000006644967
     Trial step:       0.374041823094
             Q1:     -16.777798325108
 Quadratic coef:       0.000000000783
 Linear coef   :      -0.000000002378
           Qmin:     -16.777798325319
Quadratic minimum step length (  0.568092269264) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779832351259 0.00000000388 0.00000996745 0.5681  0.056    8.00000000
      ideal mu1:      -0.514510740433
             Q0:     -16.777798325318
             G0:      -0.000000001564
   RMS gradient:       0.000003296136
     Trial step:       0.460966666996
             Q1:     -16.777798325725
 Quadratic coef:       0.000000000314
 Linear coef   :      -0.000000000721
           Qmin:     -16.777798325732
Quadratic minimum step length (  0.529030219695) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779832531831 0.00000000024 0.00000494420 0.5290  0.246    8.00000000
      ideal mu1:      -0.514507376081
             Q0:     -16.777798325732
             G0:      -0.000000000223
   RMS gradient:       0.000001243435
     Trial step:       0.493827193574
             Q1:     -16.777798325801
 Quadratic coef:       0.000000000041
 Linear coef   :      -0.000000000110
           Qmin:     -16.777798325806
Quadratic minimum step length (  0.660289288957) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779832573207 0.00000000007 0.00000186515 0.6603  0.142    8.00000000
      ideal mu1:      -0.514508948857
             Q0:     -16.777798325805
             G0:      -0.000000000029
   RMS gradient:       0.000000452387
     Trial step:       0.571024348441
             Q1:     -16.777798325814
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000017
           Qmin:     -16.777798325814
Quadratic minimum step length (  0.586360575580) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779832580531 0.00000000001 0.00000067858 0.5864  0.132    8.00000000
      ideal mu1:      -0.514508034570
             Q0:     -16.777798325814
             G0:      -0.000000000001
   RMS gradient:       0.000000093415
     Trial step:       0.578641655623
             Q1:     -16.777798325814
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798325814
Quadratic minimum step length (  0.919246055846) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779832581392 0.00000000000 0.00000014012 0.9192  0.043    8.00000000
      ideal mu1:      -0.514508172999
             Q0:     -16.777798325814
             G0:      -0.000000000001
   RMS gradient:       0.000000067932
     Trial step:       0.729324385771
             Q1:     -16.777798325814
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798325814
Quadratic minimum step length (  1.309116940826) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779832581405 0.00000000000 0.00000010190 1.3091  0.000    8.00000000
      ideal mu1:      -0.514508091064
             Q0:     -16.777798325814
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000003
   RMS gradient:       0.000000147778
     Trial step:       0.977123793984
             Q1:     -16.777798325813
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798325814
Quadratic minimum step length (  0.411453082053) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779832581362 0.00000000000 0.00000022167 0.4115  4.732    8.00000000
      ideal mu1:      -0.514508182059
             Q0:     -16.777798325815
             G0:      -0.000000000000
   RMS gradient:       0.000000025265
     Trial step:       0.634066713037
             Q1:     -16.777798325815
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798325815
Quadratic minimum step length (  0.689281319168) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779832581451 0.00000000000 0.00000003790 0.6893  0.029    8.00000000
      ideal mu1:      -0.514508143124
10    -16.77779832581442 0.00000000000 0.00000002683 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001044146589              |
           | Maximum change in energy =  0.00000003757143 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36046166E-02     0.10526420E-02
               2       0.76867848E-05     0.21718247E-05
               3       0.38876261E-10     0.10990486E-10
               4       0.51193728E-14     0.17763568E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18565007E-02     0.54198015E-03
               2       0.20411221E-05     0.57667167E-06
               3       0.27410798E-11     0.77432505E-12
================================================================================
RMS gradient                =       0.00001044146589
Trial step length           =               0.016207
Gradient along search dir.  =         -0.00000738401
Functional at step 0        =     -16.77779832581442
Functional at step 1        =     -16.77779832204489
Functional predicted        =     -16.77779835481842
Selected quadratic step     =               0.007856
Conjugate gradients coeff.  =               0.890130
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  028 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99988538
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514487920024
             Q0:     -16.777798353726
             G0:      -0.000000077461
   RMS gradient:       0.000023193215
     Trial step:       0.661097829676
             Q1:     -16.777798373818
 Quadratic coef:       0.000000031118
 Linear coef   :      -0.000000051209
           Qmin:     -16.777798374795
Quadratic minimum step length (  0.543969866297) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779835372632 0.00000000000 0.00003478982 0.5440  0.000    8.00000000
      ideal mu1:      -0.514505249883
             Q0:     -16.777798374795
             G0:      -0.000000004330
   RMS gradient:       0.000005483827
     Trial step:       0.599680996879
             Q1:     -16.777798376020
 Quadratic coef:       0.000000001372
 Linear coef   :      -0.000000002597
           Qmin:     -16.777798376024
Quadratic minimum step length (  0.567350958806) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779837479509 0.00000000263 0.00000822574 0.5674  0.056    8.00000000
      ideal mu1:      -0.514513477214
             Q0:     -16.777798376024
             G0:      -0.000000001065
   RMS gradient:       0.000002719226
     Trial step:       0.583292026825
             Q1:     -16.777798376303
 Quadratic coef:       0.000000000342
 Linear coef   :      -0.000000000621
           Qmin:     -16.777798376306
Quadratic minimum step length (  0.529745370962) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779837602361 0.00000000016 0.00000407884 0.5297  0.246    8.00000000
      ideal mu1:      -0.514510699096
             Q0:     -16.777798376306
             G0:      -0.000000000151
   RMS gradient:       0.000001024176
     Trial step:       0.555874312349
             Q1:     -16.777798376355
 Quadratic coef:       0.000000000035
 Linear coef   :      -0.000000000084
           Qmin:     -16.777798376357
Quadratic minimum step length (  0.671050934762) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779837630581 0.00000000004 0.00000153626 0.6711  0.142    8.00000000
      ideal mu1:      -0.514512014644
             Q0:     -16.777798376356
             G0:      -0.000000000020
   RMS gradient:       0.000000378953
     Trial step:       0.610753613916
             Q1:     -16.777798376361
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000012
           Qmin:     -16.777798376361
Quadratic minimum step length (  0.537927577691) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779837635592 0.00000000001 0.00000056843 0.5379  0.137    8.00000000
      ideal mu1:      -0.514511293522
             Q0:     -16.777798376361
             G0:      -0.000000000001
   RMS gradient:       0.000000072392
     Trial step:       0.573185146441
             Q1:     -16.777798376362
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798376362
  Cubic LS coeff:       0.723024298650
Predicted energy:     -16.777798376362
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779837636137 0.00000000000 0.00000010859 0.7230  0.036    8.00000000
      ideal mu1:      -0.514511305884
             Q0:     -16.777798376362
             G0:      -0.000000000000
   RMS gradient:       0.000000032383
     Trial step:       0.643759884197
             Q1:     -16.777798376362
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798376362
Quadratic minimum step length (  0.338742538551) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779837636187 0.00000000000 0.00000004857 0.3387  0.000    8.00000000
      ideal mu1:      -0.514511327329
             Q0:     -16.777798376362
             G0:      -0.000000000000
   RMS gradient:       0.000000014107
     Trial step:       0.466978433539
             Q1:     -16.777798376362
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798376362
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779837636173 0.00000000000 0.00000002116 0.1500  0.190    8.00000000
      ideal mu1:      -0.514511332927
             Q0:     -16.777798376362
             G0:      -0.000000000000
   RMS gradient:       0.000000011073
     Trial step:       0.264663493952
             Q1:     -16.777798376362
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798376362
  Cubic LS coeff:       0.398949023972
Predicted energy:     -16.777798376362
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779837636162 0.00000000000 0.00000001661 0.3989  0.616    8.00000000
      ideal mu1:      -0.514511348358
10    -16.77779837636200 0.00000000000 0.00000001100 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000990597967              |
           | Maximum change in energy =  0.00000002484290 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31967674E-02     0.93414407E-03
               2       0.60648853E-05     0.17146767E-05
               3       0.24238639E-10     0.68564598E-11
               4       0.51583290E-14     0.17993419E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17415588E-02     0.50877961E-03
               2       0.18015231E-05     0.50931016E-06
               3       0.21390570E-11     0.60509930E-12
================================================================================
RMS gradient                =       0.00000990597967
Trial step length           =               0.011284
Gradient along search dir.  =         -0.00000783540
Functional at step 0        =     -16.77779837636200
Functional at step 1        =     -16.77779836760503
Functional predicted        =     -16.77779839647280
Selected quadratic step     =               0.005133
Conjugate gradients coeff.  =               0.900061
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  029 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99990470
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514494556066
             Q0:     -16.777798395720
             G0:      -0.000000053785
   RMS gradient:       0.000019326271
     Trial step:       0.324941906490
             Q1:     -16.777798407975
 Quadratic coef:       0.000000005222
 Linear coef   :      -0.000000017477
           Qmin:     -16.777798410344
Quadratic minimum step length (  0.543780209847) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779839572035 0.00000000000 0.00002898941 0.5438  0.000    8.00000000
      ideal mu1:      -0.514508858962
             Q0:     -16.777798410345
             G0:      -0.000000003022
   RMS gradient:       0.000004580883
     Trial step:       0.420353396678
             Q1:     -16.777798411143
 Quadratic coef:       0.000000000472
 Linear coef   :      -0.000000001270
           Qmin:     -16.777798411200
Quadratic minimum step length (  0.566003357305) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779841034467 0.00000000183 0.00000687132 0.5660  0.056    8.00000000
      ideal mu1:      -0.514515753513
             Q0:     -16.777798411200
             G0:      -0.000000000743
   RMS gradient:       0.000002271882
     Trial step:       0.487771907529
             Q1:     -16.777798411396
 Quadratic coef:       0.000000000167
 Linear coef   :      -0.000000000363
           Qmin:     -16.777798411397
Quadratic minimum step length (  0.529888912738) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779841120025 0.00000000011 0.00000340782 0.5299  0.246    8.00000000
      ideal mu1:      -0.514513433444
             Q0:     -16.777798411397
             G0:      -0.000000000105
   RMS gradient:       0.000000852172
     Trial step:       0.508394458806
             Q1:     -16.777798411430
 Quadratic coef:       0.000000000021
 Linear coef   :      -0.000000000053
           Qmin:     -16.777798411432
Quadratic minimum step length (  0.658783864545) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779841139723 0.00000000003 0.00000127826 0.6588  0.141    8.00000000
      ideal mu1:      -0.514514496706
             Q0:     -16.777798411432
             G0:      -0.000000000014
   RMS gradient:       0.000000308979
     Trial step:       0.578724516748
             Q1:     -16.777798411436
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000008
           Qmin:     -16.777798411436
Quadratic minimum step length (  0.569163235036) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779841143199 0.00000000001 0.00000046347 0.5692  0.131    8.00000000
      ideal mu1:      -0.514513905139
             Q0:     -16.777798411436
             G0:      -0.000000000001
   RMS gradient:       0.000000060996
     Trial step:       0.573923965475
             Q1:     -16.777798411436
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798411436
  Cubic LS coeff:       0.876577503647
Predicted energy:     -16.777798411437
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779841143584 0.00000000000 0.00000009149 0.8766  0.039    8.00000000
      ideal mu1:      -0.514513946155
             Q0:     -16.777798411436
             G0:      -0.000000000000
   RMS gradient:       0.000000038567
     Trial step:       0.709287555889
             Q1:     -16.777798411436
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798411436
Quadratic minimum step length (  0.244604339841) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779841143626 0.00000000000 0.00000005785 0.2446  0.000    8.00000000
      ideal mu1:      -0.514513954908
             Q0:     -16.777798411436
             G0:      -0.000000000000
   RMS gradient:       0.000000018238
     Trial step:       0.416527087193
             Q1:     -16.777798411436
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798411436
Quadratic minimum step length (  0.013251639125) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779841143630 0.00000000000 0.00000002736 0.0133  0.224    8.00000000
      ideal mu1:      -0.514513955237
             Q0:     -16.777798411436
             G0:      -0.000000000000
   RMS gradient:       0.000000017566
     Trial step:       0.074294459048
             Q1:     -16.777798411436
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798411436
  Cubic LS coeff:       0.087387061443
Predicted energy:     -16.777798411436
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779841143622 0.00000000000 0.00000002635 0.0874  0.928    8.00000000
      ideal mu1:      -0.514513958666
10    -16.77779841143612 0.00000000000 0.00000001658 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000944375621              |
           | Maximum change in energy =  0.00000001684919 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.62771031E-03     0.18422941E-03
               2       0.23464382E-06     0.66508814E-07
               3       0.37455109E-13     0.11546319E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10307446E-02     0.30242573E-03
               2       0.63348121E-06     0.17955217E-06
               3       0.26567021E-12     0.75495166E-13
================================================================================
RMS gradient                =       0.00000944375621
Trial step length           =               0.007611
Gradient along search dir.  =         -0.00000264013
Functional at step 0        =     -16.77779841143612
Functional at step 1        =     -16.77779842772394
Functional predicted        =     -16.77779843796059
Selected quadratic step     =               0.020093
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  030 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99989100
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514494848675
             Q0:     -16.777798436925
             G0:      -0.000000071546
   RMS gradient:       0.000022290029
     Trial step:       0.080575271999
             Q1:     -16.777798442261
 Quadratic coef:       0.000000000428
 Linear coef   :      -0.000000005765
           Qmin:     -16.777798456336
Quadratic minimum step length (  0.542638983463) accepted
    Initial Ne1:       7.99999998
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779843692468 0.00000000000 0.00003343504 0.5426  0.000    8.00000000
      ideal mu1:      -0.514510941373
             Q0:     -16.777798456346
             G0:      -0.000000004066
   RMS gradient:       0.000005312383
     Trial step:       0.209101132684
             Q1:     -16.777798457038
 Quadratic coef:       0.000000000158
 Linear coef   :      -0.000000000850
           Qmin:     -16.777798457489
Quadratic minimum step length (  0.562326295266) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779845634596 0.00000000243 0.00000796857 0.5623  0.057    8.00000000
      ideal mu1:      -0.514519015511
             Q0:     -16.777798457489
             G0:      -0.000000001001
   RMS gradient:       0.000002636468
     Trial step:       0.342903871774
             Q1:     -16.777798457722
 Quadratic coef:       0.000000000110
 Linear coef   :      -0.000000000343
           Qmin:     -16.777798457757
Quadratic minimum step length (  0.533587274810) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779845748947 0.00000000015 0.00000395470 0.5336  0.246    8.00000000
      ideal mu1:      -0.514516311219
             Q0:     -16.777798457757
             G0:      -0.000000000140
   RMS gradient:       0.000000984253
     Trial step:       0.427748924559
             Q1:     -16.777798457798
 Quadratic coef:       0.000000000019
 Linear coef   :      -0.000000000060
           Qmin:     -16.777798457804
Quadratic minimum step length (  0.668238787832) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779845775688 0.00000000004 0.00000147638 0.6682  0.139    8.00000000
      ideal mu1:      -0.514517554698
             Q0:     -16.777798457803
             G0:      -0.000000000019
   RMS gradient:       0.000000361371
     Trial step:       0.534638590867
             Q1:     -16.777798457808
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000010
           Qmin:     -16.777798457808
Quadratic minimum step length (  0.548632057424) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779845780321 0.00000000001 0.00000054206 0.5486  0.135    8.00000000
      ideal mu1:      -0.514516868714
             Q0:     -16.777798457808
             G0:      -0.000000000001
   RMS gradient:       0.000000069582
     Trial step:       0.541590131082
             Q1:     -16.777798457808
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798457808
Quadratic minimum step length (  0.193137208369) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779845780843 0.00000000000 0.00000010437 0.1931  0.037    8.00000000
      ideal mu1:      -0.514516874434
             Q0:     -16.777798457808
             G0:      -0.000000000000
   RMS gradient:       0.000000050191
     Trial step:       0.323421097019
             Q1:     -16.777798457809
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798457809
Quadratic minimum step length (  1.335058613180) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779845780847 0.00000000000 0.00000007529 1.3351  0.000    8.00000000
      ideal mu1:      -0.514516968548
             Q0:     -16.777798457808
             G0:      -0.000000000000
   RMS gradient:       0.000000056431
     Trial step:       0.657104345793
             Q1:     -16.777798457809
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798457808
  Cubic LS coeff:       0.898411129127
Predicted energy:     -16.777798457809
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779845780842 0.00000000000 0.00000008465 0.8984  1.264    8.00000000
      ideal mu1:      -0.514516962013
             Q0:     -16.777798457809
             G0:      -0.000000000000
   RMS gradient:       0.000000052960
     Trial step:       0.768342278713
             Q1:     -16.777798457808
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798457809
Quadratic minimum step length (  0.101212754840) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779845780863 0.00000000000 0.00000007944 0.1012  0.881    8.00000000
      ideal mu1:      -0.514516959440
10    -16.77779845780848 0.00000000000 0.00000007344 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000888422682              |
           | Maximum change in energy =  0.00000001545745 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86824321818324 |
           | Pseudopotential (local)    :      -46.08702406040831 |
           | Pseudopotential (non-local):       -3.18858288282162 |
           | Hartree                    :       19.82079624136524 |
           | Exchange-correlation       :       -4.12708022209784 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779845780849 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08702406040891 |
           | Hartree                    :       19.82079624136561 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999936
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19256249E-02     0.56520024E-03
               2       0.22173513E-05     0.62877940E-06
               3       0.32616146E-11     0.92681418E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56642226E-03     0.16621299E-03
               2       0.19202076E-06     0.54450132E-07
               3       0.24386186E-13     0.75495166E-14
================================================================================
RMS gradient                =       0.00000888422682
Trial step length           =               0.012366
Gradient along search dir.  =         -0.00000408276
Functional at step 0        =     -16.77779845780848
Functional at step 1        =     -16.77779847253451
Functional predicted        =     -16.77779847562801
Selected quadratic step     =               0.008729
Conjugate gradients coeff.  =               0.885013
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  031 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99991085
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514501346338
             Q0:     -16.777798474969
             G0:      -0.000000048023
   RMS gradient:       0.000018261738
     Trial step:       0.278865628374
             Q1:     -16.777798484921
 Quadratic coef:       0.000000003440
 Linear coef   :      -0.000000013392
           Qmin:     -16.777798488002
Quadratic minimum step length (  0.542784127584) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779847496899 0.00000000000 0.00002739261 0.5428  0.000    8.00000000
      ideal mu1:      -0.514514440868
             Q0:     -16.777798488003
             G0:      -0.000000002741
   RMS gradient:       0.000004362793
     Trial step:       0.389055056272
             Q1:     -16.777798488700
 Quadratic coef:       0.000000000369
 Linear coef   :      -0.000000001066
           Qmin:     -16.777798488774
Quadratic minimum step length (  0.562130649274) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779848800306 0.00000000163 0.00000654419 0.5621  0.057    8.00000000
      ideal mu1:      -0.514521050729
             Q0:     -16.777798488773
             G0:      -0.000000000674
   RMS gradient:       0.000002164228
     Trial step:       0.467653473616
             Q1:     -16.777798488951
 Quadratic coef:       0.000000000138
 Linear coef   :      -0.000000000315
           Qmin:     -16.777798488954
Quadratic minimum step length (  0.533862990386) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779848877347 0.00000000010 0.00000324634 0.5339  0.246    8.00000000
      ideal mu1:      -0.514518815693
             Q0:     -16.777798488954
             G0:      -0.000000000094
   RMS gradient:       0.000000806039
     Trial step:       0.499662768164
             Q1:     -16.777798488983
 Quadratic coef:       0.000000000018
 Linear coef   :      -0.000000000047
           Qmin:     -16.777798488985
Quadratic minimum step length (  0.664489534259) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779848895356 0.00000000003 0.00000120906 0.6645  0.139    8.00000000
      ideal mu1:      -0.514519831389
             Q0:     -16.777798488984
             G0:      -0.000000000012
   RMS gradient:       0.000000294561
     Trial step:       0.576212356778
             Q1:     -16.777798488988
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000007
           Qmin:     -16.777798488988
Quadratic minimum step length (  0.585548594136) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779848898439 0.00000000000 0.00000044184 0.5855  0.134    8.00000000
      ideal mu1:      -0.514519240350
             Q0:     -16.777798488988
             G0:      -0.000000000001
   RMS gradient:       0.000000060550
     Trial step:       0.580861717998
             Q1:     -16.777798488988
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798488988
Quadratic minimum step length (  0.425603547851) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779848898784 0.00000000000 0.00000009083 0.4256  0.042    8.00000000
      ideal mu1:      -0.514519282230
             Q0:     -16.777798488988
             G0:      -0.000000000000
   RMS gradient:       0.000000024789
     Trial step:       0.497209018413
             Q1:     -16.777798488988
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798488988
  Cubic LS coeff:       0.671677245281
Predicted energy:     -16.777798488988
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779848898793 0.00000000000 0.00000003718 0.6717  0.000    8.00000000
      ideal mu1:      -0.514519319769
             Q0:     -16.777798488988
             G0:      -0.000000000000
   RMS gradient:       0.000000010063
     Trial step:       0.577896170446
             Q1:     -16.777798488988
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798488988
  Cubic LS coeff:       0.417581134252
Predicted energy:     -16.777798488988
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779848898826 0.00000000000 0.00000001509 0.4176  0.165    8.00000000
      ideal mu1:      -0.514519321968
             Q0:     -16.777798488988
             G0:      -0.000000000000
   RMS gradient:       0.000000005437
     Trial step:       0.491241832843
             Q1:     -16.777798488988
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798488988
  Cubic LS coeff:       0.564760209457
Predicted energy:     -16.777798488988
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779848898826 0.00000000000 0.00000000816 0.5648  0.292    8.00000000
      ideal mu1:      -0.514519321123
10    -16.77779848898822 0.00000000000 0.00000000479 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000840409960              |
           | Maximum change in energy =  0.00000001545745 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23071671E-02     0.67736038E-03
               2       0.31922716E-05     0.90561749E-06
               3       0.67667099E-11     0.19211854E-11
               4       0.60682821E-14     0.24424907E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11791749E-02     0.34612445E-03
               2       0.83440605E-06     0.23670674E-06
               3       0.46097949E-12     0.13136714E-12
================================================================================
RMS gradient                =       0.00000840409960
Trial step length           =               0.010390
Gradient along search dir.  =         -0.00000482592
Functional at step 0        =     -16.77779848898822
Functional at step 1        =     -16.77779848783381
Functional predicted        =     -16.77779850124112
Selected quadratic step     =               0.005078
Conjugate gradients coeff.  =               0.894835
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  032 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99992616
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514506402937
             Q0:     -16.777798500794
             G0:      -0.000000033046
   RMS gradient:       0.000015148789
     Trial step:       0.526719887996
             Q1:     -16.777798509753
 Quadratic coef:       0.000000008447
 Linear coef   :      -0.000000017406
           Qmin:     -16.777798509761
Quadratic minimum step length (  0.542688033091) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779850079399 0.00000000000 0.00002272318 0.5427  0.000    8.00000000
      ideal mu1:      -0.514517212527
             Q0:     -16.777798509761
             G0:      -0.000000001891
   RMS gradient:       0.000003623824
     Trial step:       0.534644349083
             Q1:     -16.777798510290
 Quadratic coef:       0.000000000482
 Linear coef   :      -0.000000001011
           Qmin:     -16.777798510291
Quadratic minimum step length (  0.561248772363) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779850976079 0.00000000112 0.00000543574 0.5612  0.057    8.00000000
      ideal mu1:      -0.514522725333
             Q0:     -16.777798510292
             G0:      -0.000000000466
   RMS gradient:       0.000001798619
     Trial step:       0.547785071514
             Q1:     -16.777798510416
 Quadratic coef:       0.000000000131
 Linear coef   :      -0.000000000255
           Qmin:     -16.777798510416
Quadratic minimum step length (  0.534924931128) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779851029181 0.00000000007 0.00000269793 0.5349  0.246    8.00000000
      ideal mu1:      -0.514520872120
             Q0:     -16.777798510416
             G0:      -0.000000000065
   RMS gradient:       0.000000669719
     Trial step:       0.541316812646
             Q1:     -16.777798510437
 Quadratic coef:       0.000000000015
 Linear coef   :      -0.000000000035
           Qmin:     -16.777798510437
Quadratic minimum step length (  0.647843637470) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779851041628 0.00000000002 0.00000100458 0.6478  0.139    8.00000000
      ideal mu1:      -0.514521692745
             Q0:     -16.777798510437
             G0:      -0.000000000008
   RMS gradient:       0.000000238582
     Trial step:       0.592189710252
             Q1:     -16.777798510440
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000005
           Qmin:     -16.777798510440
Quadratic minimum step length (  0.657766705091) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779851043738 0.00000000000 0.00000035787 0.6578  0.127    8.00000000
      ideal mu1:      -0.514521184112
             Q0:     -16.777798510440
             G0:      -0.000000000001
   RMS gradient:       0.000000063310
     Trial step:       0.624117516579
             Q1:     -16.777798510440
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798510440
Quadratic minimum step length (  0.266723285078) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779851044005 0.00000000000 0.00000009496 0.2667  0.070    8.00000000
      ideal mu1:      -0.514521221556
             Q0:     -16.777798510440
             G0:      -0.000000000000
   RMS gradient:       0.000000036276
     Trial step:       0.408003277311
             Q1:     -16.777798510440
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798510440
Quadratic minimum step length (  0.153084272842) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779851043998 0.00000000000 0.00000005441 0.1531  0.000    8.00000000
      ideal mu1:      -0.514521239867
             Q0:     -16.777798510440
             G0:      -0.000000000000
   RMS gradient:       0.000000027107
     Trial step:       0.249917756520
             Q1:     -16.777798510440
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798510440
  Cubic LS coeff:       0.342388487053
Predicted energy:     -16.777798510440
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779851043997 0.00000000000 0.00000004066 0.3424  0.558    8.00000000
      ideal mu1:      -0.514521291420
             Q0:     -16.777798510440
             G0:      -0.000000000000
   RMS gradient:       0.000000012199
     Trial step:       0.292521730035
             Q1:     -16.777798510440
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798510440
Quadratic minimum step length (  0.034890568397) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779851044005 0.00000000000 0.00000001830 0.0349  0.203    8.00000000
      ideal mu1:      -0.514521291984
10    -16.77779851044006 0.00000000000 0.00000001755 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000798957063              |
           | Maximum change in energy =  0.00000001039324 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20576499E-02     0.60433128E-03
               2       0.25441821E-05     0.72204206E-06
               3       0.43024441E-11     0.12219115E-11
               4       0.74422903E-14     0.41824183E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11128815E-02     0.32679840E-03
               2       0.74461136E-06     0.21131678E-06
               3       0.36954312E-12     0.10633161E-12
================================================================================
RMS gradient                =       0.00000798957063
Trial step length           =               0.007264
Gradient along search dir.  =         -0.00000515819
Functional at step 0        =     -16.77779851044006
Functional at step 1        =     -16.77779850709026
Functional predicted        =     -16.77779851903799
Selected quadratic step     =               0.003334
Conjugate gradients coeff.  =               0.903784
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  033 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99993821
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514510491379
             Q0:     -16.777798518726
             G0:      -0.000000023209
   RMS gradient:       0.000012695541
     Trial step:       0.101025983932
             Q1:     -16.777798520853
 Quadratic coef:       0.000000000219
 Linear coef   :      -0.000000002345
           Qmin:     -16.777798525016
Quadratic minimum step length (  0.541959651516) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779851872640 0.00000000000 0.00001904331 0.5420  0.000    8.00000000
      ideal mu1:      -0.514519485399
             Q0:     -16.777798525023
             G0:      -0.000000001329
   RMS gradient:       0.000003036323
     Trial step:       0.233991467891
             Q1:     -16.777798525269
 Quadratic coef:       0.000000000065
 Linear coef   :      -0.000000000311
           Qmin:     -16.777798525394
Quadratic minimum step length (  0.557708316741) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779852502315 0.00000000079 0.00000455448 0.5577  0.057    8.00000000
      ideal mu1:      -0.514524102884
             Q0:     -16.777798525396
             G0:      -0.000000000326
   RMS gradient:       0.000001499516
     Trial step:       0.361246436231
             Q1:     -16.777798525475
 Quadratic coef:       0.000000000039
 Linear coef   :      -0.000000000118
           Qmin:     -16.777798525484
Quadratic minimum step length (  0.538379847744) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779852539630 0.00000000005 0.00000224927 0.5384  0.244    8.00000000
      ideal mu1:      -0.514522572374
             Q0:     -16.777798525484
             G0:      -0.000000000045
   RMS gradient:       0.000000560624
     Trial step:       0.441007711198
             Q1:     -16.777798525497
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000020
           Qmin:     -16.777798525499
Quadratic minimum step length (  0.649728379698) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779852548420 0.00000000001 0.00000084094 0.6497  0.140    8.00000000
      ideal mu1:      -0.514523270372
             Q0:     -16.777798525499
             G0:      -0.000000000006
   RMS gradient:       0.000000200041
     Trial step:       0.535289851978
             Q1:     -16.777798525501
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798525501
Quadratic minimum step length (  0.646042984085) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779852549906 0.00000000000 0.00000030006 0.6460  0.127    8.00000000
      ideal mu1:      -0.514522841673
             Q0:     -16.777798525501
             G0:      -0.000000000000
   RMS gradient:       0.000000050299
     Trial step:       0.588064837686
             Q1:     -16.777798525501
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798525501
Quadratic minimum step length (  0.183306822948) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779852550103 0.00000000000 0.00000007545 0.1833  0.063    8.00000000
      ideal mu1:      -0.514522863948
             Q0:     -16.777798525501
             G0:      -0.000000000000
   RMS gradient:       0.000000035258
     Trial step:       0.328323464107
             Q1:     -16.777798525501
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798525501
Quadratic minimum step length (  0.084866052719) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779852550083 0.00000000000 0.00000005289 0.0849  0.000    8.00000000
      ideal mu1:      -0.514522873717
             Q0:     -16.777798525501
             G0:      -0.000000000000
   RMS gradient:       0.000000030021
     Trial step:       0.166923684401
             Q1:     -16.777798525501
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798525501
Quadratic minimum step length (  0.049540130738) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779852550085 0.00000000000 0.00000004503 0.0495  0.725    8.00000000
      ideal mu1:      -0.514522882548
             Q0:     -16.777798525501
             G0:      -0.000000000000
   RMS gradient:       0.000000025423
     Trial step:       0.090936357683
             Q1:     -16.777798525501
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798525501
  Cubic LS coeff:       0.080031780813
Predicted energy:     -16.777798525501
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779852550082 0.00000000000 0.00000003813 0.0800  0.717    8.00000000
      ideal mu1:      -0.514522898920
10    -16.77779852550084 0.00000000000 0.00000002627 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000762828818              |
           | Maximum change in energy =  0.00000000715061 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.40438195E-03     0.11909179E-03
               2       0.98481294E-07     0.27993062E-07
               3       0.85444003E-14     0.25049407E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.67457173E-03     0.19862364E-03
               2       0.27426165E-06     0.77956785E-07
               3       0.50192416E-13     0.15987212E-13
================================================================================
RMS gradient                =       0.00000762828818
Trial step length           =               0.004921
Gradient along search dir.  =         -0.00000172262
Functional at step 0        =     -16.77779852550084
Functional at step 1        =     -16.77779853238830
Functional predicted        =     -16.77779853680411
Selected quadratic step     =               0.013123
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  034 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99992928
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514510583781
             Q0:     -16.777798536362
             G0:      -0.000000030724
   RMS gradient:       0.000014606834
     Trial step:       0.085310014922
             Q1:     -16.777798538777
 Quadratic coef:       0.000000000206
 Linear coef   :      -0.000000002621
           Qmin:     -16.777798544692
Quadratic minimum step length (  0.542253089239) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779853636200 0.00000000000 0.00002191025 0.5423  0.000    8.00000000
      ideal mu1:      -0.514520808644
             Q0:     -16.777798544689
             G0:      -0.000000001777
   RMS gradient:       0.000003513536
     Trial step:       0.215080494547
             Q1:     -16.777798544997
 Quadratic coef:       0.000000000074
 Linear coef   :      -0.000000000382
           Qmin:     -16.777798545183
Quadratic minimum step length (  0.556316728903) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779854468899 0.00000000104 0.00000527030 0.5563  0.058    8.00000000
      ideal mu1:      -0.514526165589
             Q0:     -16.777798545185
             G0:      -0.000000000436
   RMS gradient:       0.000001737221
     Trial step:       0.345908770021
             Q1:     -16.777798545287
 Quadratic coef:       0.000000000049
 Linear coef   :      -0.000000000151
           Qmin:     -16.777798545302
Quadratic minimum step length (  0.536245064835) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779854518476 0.00000000007 0.00000260583 0.5362  0.244    8.00000000
      ideal mu1:      -0.514524384978
             Q0:     -16.777798545302
             G0:      -0.000000000060
   RMS gradient:       0.000000642846
     Trial step:       0.430687671993
             Q1:     -16.777798545320
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000026
           Qmin:     -16.777798545322
Quadratic minimum step length (  0.661380166102) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779854530212 0.00000000002 0.00000096427 0.6614  0.137    8.00000000
      ideal mu1:      -0.514525177706
             Q0:     -16.777798545322
             G0:      -0.000000000008
   RMS gradient:       0.000000233185
     Trial step:       0.533711798671
             Q1:     -16.777798545324
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798545324
Quadratic minimum step length (  0.476862179495) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779854532228 0.00000000000 0.00000034978 0.4769  0.132    8.00000000
      ideal mu1:      -0.514524814735
             Q0:     -16.777798545324
             G0:      -0.000000000001
   RMS gradient:       0.000000055498
     Trial step:       0.504486839805
             Q1:     -16.777798545324
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798545325
Quadratic minimum step length (  1.164924689193) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779854532422 0.00000000000 0.00000008325 1.1649  0.057    8.00000000
      ideal mu1:      -0.514524642362
             Q0:     -16.777798545324
             G0:      -0.000000000001
   RMS gradient:       0.000000073005
     Trial step:       0.766608880109
             Q1:     -16.777798545324
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798545325
Quadratic minimum step length (  0.409534977744) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779854532438 0.00000000000 0.00000010951 0.4095  0.000    8.00000000
      ideal mu1:      -0.514524787314
             Q0:     -16.777798545324
             G0:      -0.000000000000
   RMS gradient:       0.000000017351
     Trial step:       0.560315224364
             Q1:     -16.777798545325
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798545324
  Cubic LS coeff:       0.611806580774
Predicted energy:     -16.777798545325
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779854532444 0.00000000000 0.00000002603 0.6118  0.056    8.00000000
      ideal mu1:      -0.514524785594
             Q0:     -16.777798545324
             G0:      -0.000000000000
   RMS gradient:       0.000000008800
     Trial step:       0.585495125149
             Q1:     -16.777798545325
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798545325
  Cubic LS coeff:       0.914830416148
Predicted energy:     -16.777798545325
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779854532441 0.00000000000 0.00000001320 0.9148  0.257    8.00000000
      ideal mu1:      -0.514524795258
10    -16.77779854532443 0.00000000000 0.00000001237 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000719303502              |
           | Maximum change in energy =  0.00000000660786 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12488269E-02     0.36779091E-03
               2       0.94169435E-06     0.26774874E-06
               3       0.59250321E-12     0.16955881E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36061728E-03     0.10618800E-03
               2       0.78566365E-07     0.22338105E-07
               3       0.85169764E-14     0.28865799E-14
================================================================================
RMS gradient                =       0.00000719303502
Trial step length           =               0.008036
Gradient along search dir.  =         -0.00000268410
Functional at step 0        =     -16.77779854532443
Functional at step 1        =     -16.77779855173097
Functional predicted        =     -16.77779855299514
Selected quadratic step     =               0.005716
Conjugate gradients coeff.  =               0.889140
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  035 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99994186
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514514678294
             Q0:     -16.777798552717
             G0:      -0.000000020818
   RMS gradient:       0.000012023588
     Trial step:       0.731866619674
             Q1:     -16.777798557663
 Quadratic coef:       0.000000010289
 Linear coef   :      -0.000000015236
           Qmin:     -16.777798558357
Quadratic minimum step length (  0.541851140622) accepted
    Initial Ne1:       7.99999999
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779855271686 0.00000000000 0.00001803538 0.5419  0.000    8.00000000
      ideal mu1:      -0.514523019550
             Q0:     -16.777798558357
             G0:      -0.000000001207
   RMS gradient:       0.000002895310
     Trial step:       0.629732294434
             Q1:     -16.777798558688
 Quadratic coef:       0.000000000430
 Linear coef   :      -0.000000000760
           Qmin:     -16.777798558693
Quadratic minimum step length (  0.557230274575) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779855835709 0.00000000071 0.00000434297 0.5572  0.058    8.00000000
      ideal mu1:      -0.514527456041
             Q0:     -16.777798558694
             G0:      -0.000000000297
   RMS gradient:       0.000001436191
     Trial step:       0.592373108215
             Q1:     -16.777798558773
 Quadratic coef:       0.000000000097
 Linear coef   :      -0.000000000176
           Qmin:     -16.777798558773
Quadratic minimum step length (  0.537392601737) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779855869363 0.00000000004 0.00000215429 0.5374  0.246    8.00000000
      ideal mu1:      -0.514525974457
             Q0:     -16.777798558774
             G0:      -0.000000000041
   RMS gradient:       0.000000530601
     Trial step:       0.564213546295
             Q1:     -16.777798558787
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000023
           Qmin:     -16.777798558787
Quadratic minimum step length (  0.643716817249) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779855877364 0.00000000001 0.00000079590 0.6437  0.136    8.00000000
      ideal mu1:      -0.514526612212
             Q0:     -16.777798558787
             G0:      -0.000000000005
   RMS gradient:       0.000000187868
     Trial step:       0.602655580137
             Q1:     -16.777798558789
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798558789
Quadratic minimum step length (  0.561192368890) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779855878718 0.00000000000 0.00000028180 0.5612  0.125    8.00000000
      ideal mu1:      -0.514526283729
             Q0:     -16.777798558788
             G0:      -0.000000000000
   RMS gradient:       0.000000037904
     Trial step:       0.581554565489
             Q1:     -16.777798558789
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798558789
  Cubic LS coeff:       0.883771130239
Predicted energy:     -16.777798558789
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779855878850 0.00000000000 0.00000005686 0.8838  0.041    8.00000000
      ideal mu1:      -0.514526268293
             Q0:     -16.777798558789
             G0:      -0.000000000000
   RMS gradient:       0.000000024560
     Trial step:       0.716910828233
             Q1:     -16.777798558789
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798558789
  Cubic LS coeff:       0.945750309727
Predicted energy:     -16.777798558789
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779855878858 0.00000000000 0.00000003684 0.9458  0.000    8.00000000
      ideal mu1:      -0.514526349963
             Q0:     -16.777798558789
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000000
   RMS gradient:       0.000000033895
     Trial step:       0.823418871443
             Q1:     -16.777798558789
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798558789
Quadratic minimum step length (  1.214363785781) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779855878860 0.00000000000 0.00000005084 1.2144  1.905    8.00000000
      ideal mu1:      -0.514526182509
             Q0:     -16.777798558788
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.654E+01) too large - resetting
             G0:      -0.000000000001
   RMS gradient:       0.000000086684
     Trial step:       0.999965028393
             Q1:     -16.777798558788
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798558788
Quadratic minimum step length (  0.324671788214) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779855878829 0.00000000000 0.00000013003 0.3247  0.000    8.00000000
      ideal mu1:      -0.514526305729
10    -16.77779855878857 0.00000000000 0.00000001440 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000681759050              |
           | Maximum change in energy =  0.00000000660786 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86825857249379 |
           | Pseudopotential (local)    :      -46.08694191551010 |
           | Pseudopotential (non-local):       -3.18861237342619 |
           | Hartree                    :       19.82071813921665 |
           | Exchange-correlation       :       -4.12707022953353 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779855878857 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08694191551052 |
           | Hartree                    :       19.82071813921677 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999932
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15041611E-02     0.44305279E-03
               2       0.13686535E-05     0.38924626E-06
               3       0.12523237E-11     0.35799141E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.76383543E-03     0.22495921E-03
               2       0.35308760E-06     0.10041677E-06
               3       0.83011742E-13     0.23980817E-13
================================================================================
RMS gradient                =       0.00000681759050
Trial step length           =               0.006777
Gradient along search dir.  =         -0.00000319290
Functional at step 0        =     -16.77779855878857
Functional at step 1        =     -16.77779855844013
Functional predicted        =     -16.77779856411261
Selected quadratic step     =               0.003335
Conjugate gradients coeff.  =               0.898333
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  036 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99995160
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514517890318
             Q0:     -16.777798563923
             G0:      -0.000000014452
   RMS gradient:       0.000010018182
     Trial step:       0.569789815564
             Q1:     -16.777798567828
 Quadratic coef:       0.000000004330
 Linear coef   :      -0.000000008235
           Qmin:     -16.777798567838
Quadratic minimum step length (  0.541800242544) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779856392287 0.00000000000 0.00001502727 0.5418  0.000    8.00000000
      ideal mu1:      -0.514524819163
             Q0:     -16.777798567838
             G0:      -0.000000000840
   RMS gradient:       0.000002414925
     Trial step:       0.555618808422
             Q1:     -16.777798568072
 Quadratic coef:       0.000000000233
 Linear coef   :      -0.000000000467
           Qmin:     -16.777798568072
Quadratic minimum step length (  0.557465924341) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779856783802 0.00000000049 0.00000362239 0.5575  0.058    8.00000000
      ideal mu1:      -0.514528526367
             Q0:     -16.777798568072
             G0:      -0.000000000207
   RMS gradient:       0.000001198726
     Trial step:       0.556541600078
             Q1:     -16.777798568128
 Quadratic coef:       0.000000000059
 Linear coef   :      -0.000000000115
           Qmin:     -16.777798568128
Quadratic minimum step length (  0.541343939636) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779856807196 0.00000000003 0.00000179809 0.5413  0.246    8.00000000
      ideal mu1:      -0.514527278066
             Q0:     -16.777798568128
             G0:      -0.000000000028
   RMS gradient:       0.000000445593
     Trial step:       0.548890173311
             Q1:     -16.777798568137
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000016
           Qmin:     -16.777798568137
Quadratic minimum step length (  0.653320547230) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779856812779 0.00000000001 0.00000066839 0.6533  0.138    8.00000000
      ideal mu1:      -0.514527837107
             Q0:     -16.777798568137
             G0:      -0.000000000004
   RMS gradient:       0.000000159460
     Trial step:       0.598833222523
             Q1:     -16.777798568138
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798568138
Quadratic minimum step length (  0.514963964048) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779856813702 0.00000000000 0.00000023919 0.5150  0.128    8.00000000
      ideal mu1:      -0.514527558296
             Q0:     -16.777798568138
             G0:      -0.000000000000
   RMS gradient:       0.000000033081
     Trial step:       0.555317503843
             Q1:     -16.777798568138
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798568138
Quadratic minimum step length (  0.689997900490) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779856813806 0.00000000000 0.00000004962 0.6900  0.043    8.00000000
      ideal mu1:      -0.514527529512
             Q0:     -16.777798568138
             G0:      -0.000000000000
   RMS gradient:       0.000000014892
     Trial step:       0.619005582977
             Q1:     -16.777798568138
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798568138
Quadratic minimum step length (  0.050648365555) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779856813814 0.00000000000 0.00000002234 0.0506  0.000    8.00000000
      ideal mu1:      -0.514527532689
             Q0:     -16.777798568138
             G0:      -0.000000000000
   RMS gradient:       0.000000013531
     Trial step:       0.177063889732
             Q1:     -16.777798568138
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798568138
Quadratic minimum step length (  0.003170626983) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779856813816 0.00000000000 0.00000002030 0.0032  0.826    8.00000000
      ideal mu1:      -0.514527533029
             Q0:     -16.777798568138
             G0:      -0.000000000000
   RMS gradient:       0.000000013387
     Trial step:       0.023693955905
             Q1:     -16.777798568138
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798568138
  Cubic LS coeff:       0.031669443803
Predicted energy:     -16.777798568138
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779856813817 0.00000000000 0.00000002008 0.0317  0.979    8.00000000
      ideal mu1:      -0.514527538078
10    -16.77779856813831 0.00000000000 0.00000001692 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000649058211              |
           | Maximum change in energy =  0.00000000448805 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13473998E-02     0.39696870E-03
               2       0.10996505E-05     0.31281817E-06
               3       0.80852381E-12     0.22995494E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.72478338E-03     0.21351092E-03
               2       0.31829055E-06     0.90543015E-07
               3       0.67173204E-13     0.19872992E-13
================================================================================
RMS gradient                =       0.00000649058211
Trial step length           =               0.004754
Gradient along search dir.  =         -0.00000342942
Functional at step 0        =     -16.77779856813831
Functional at step 1        =     -16.77779856679591
Functional predicted        =     -16.77779857190420
Selected quadratic step     =               0.002196
Conjugate gradients coeff.  =               0.906370
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  037 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99995932
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514520469500
             Q0:     -16.777798571771
             G0:      -0.000000010227
   RMS gradient:       0.000008427335
     Trial step:       0.027392962691
             Q1:     -16.777798572044
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000280
           Qmin:     -16.777798574563
Quadratic minimum step length (  0.546014896820) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779857177128 0.00000000000 0.00001264100 0.5460  0.000    8.00000000
      ideal mu1:      -0.514526354574
             Q0:     -16.777798574542
             G0:      -0.000000000600
   RMS gradient:       0.000002049200
     Trial step:       0.122298674145
             Q1:     -16.777798574607
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000073
           Qmin:     -16.777798574706
Quadratic minimum step length (  0.547259971237) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779857454193 0.00000000035 0.00000307380 0.5473  0.059    8.00000000
      ideal mu1:      -0.514529391178
             Q0:     -16.777798574708
             G0:      -0.000000000145
   RMS gradient:       0.000000997543
     Trial step:       0.258706723714
             Q1:     -16.777798574737
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000037
           Qmin:     -16.777798574748
Quadratic minimum step length (  0.553366892897) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779857470781 0.00000000002 0.00000149631 0.5534  0.237    8.00000000
      ideal mu1:      -0.514528334411
             Q0:     -16.777798574748
             G0:      -0.000000000021
   RMS gradient:       0.000000380405
     Trial step:       0.378364554197
             Q1:     -16.777798574753
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000008
           Qmin:     -16.777798574753
Quadratic minimum step length (  0.570584570797) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779857474754 0.00000000001 0.00000057061 0.5706  0.145    8.00000000
      ideal mu1:      -0.514528796008
             Q0:     -16.777798574754
             G0:      -0.000000000003
   RMS gradient:       0.000000127722
     Trial step:       0.464638544206
             Q1:     -16.777798574755
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798574755
Quadratic minimum step length (  0.964733063223) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779857475385 0.00000000000 0.00000019158 0.9647  0.113    8.00000000
      ideal mu1:      -0.514528507538
             Q0:     -16.777798574755
             G0:      -0.000000000000
   RMS gradient:       0.000000080175
     Trial step:       0.669516367270
             Q1:     -16.777798574755
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798574755
Quadratic minimum step length (  1.992217740469) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779857475454 0.00000000000 0.00000012026 1.9922  0.394    8.00000000
      ideal mu1:      -0.514528576441
             Q0:     -16.777798574754
             G0:      -0.000000000003
   RMS gradient:       0.000000142959
     Trial step:       1.154912284293
             Q1:     -16.777798574753
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798574755
Quadratic minimum step length (  0.446246087017) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779857475398 0.00000000000 0.00000021444 0.4462  0.000    8.00000000
      ideal mu1:      -0.514528662914
             Q0:     -16.777798574755
             G0:      -0.000000000000
   RMS gradient:       0.000000049705
     Trial step:       0.717896293147
             Q1:     -16.777798574755
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798574755
Quadratic minimum step length (  0.367353198814) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779857475478 0.00000000000 0.00000007456 0.3674  0.121    8.00000000
      ideal mu1:      -0.514528622287
             Q0:     -16.777798574755
             G0:      -0.000000000000
   RMS gradient:       0.000000026225
     Trial step:       0.513538216401
             Q1:     -16.777798574755
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798574755
  Cubic LS coeff:       0.808413474643
Predicted energy:     -16.777798574755
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779857475456 0.00000000000 0.00000003934 0.8084  0.278    8.00000000
      ideal mu1:      -0.514528591554
10    -16.77779857475478 0.00000000000 0.00000003881 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000620814322              |
           | Maximum change in energy =  0.00000000311658 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26492449E-03     0.78188189E-04
               2       0.42573503E-07     0.12122930E-07
               3       0.56596680E-14     0.20539126E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44905122E-03     0.13251243E-03
               2       0.12237858E-06     0.34847271E-07
               3       0.11741305E-13     0.46629367E-14
================================================================================
RMS gradient                =       0.00000620814322
Trial step length           =               0.003231
Gradient along search dir.  =         -0.00000114093
Functional at step 0        =     -16.77779857475478
Functional at step 1        =     -16.77779857775725
Functional predicted        =     -16.77779857972105
Selected quadratic step     =               0.008706
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  038 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99995329
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514520496427
             Q0:     -16.777798579524
             G0:      -0.000000013552
   RMS gradient:       0.000009701050
     Trial step:       0.644322290382
             Q1:     -16.777798583063
 Quadratic coef:       0.000000005192
 Linear coef   :      -0.000000008732
           Qmin:     -16.777798583195
Quadratic minimum step length (  0.541781792523) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779857952353 0.00000000000 0.00001455158 0.5418  0.000    8.00000000
      ideal mu1:      -0.514527170521
             Q0:     -16.777798583195
             G0:      -0.000000000787
   RMS gradient:       0.000002338187
     Trial step:       0.590831689609
             Q1:     -16.777798583414
 Quadratic coef:       0.000000000246
 Linear coef   :      -0.000000000465
           Qmin:     -16.777798583414
Quadratic minimum step length (  0.558267053163) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779858319474 0.00000000046 0.00000350728 0.5583  0.058    8.00000000
      ideal mu1:      -0.514530751358
             Q0:     -16.777798583414
             G0:      -0.000000000194
   RMS gradient:       0.000001161805
     Trial step:       0.574318610418
             Q1:     -16.777798583467
 Quadratic coef:       0.000000000059
 Linear coef   :      -0.000000000112
           Qmin:     -16.777798583467
Quadratic minimum step length (  0.538972549022) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779858341449 0.00000000003 0.00000174271 0.5390  0.247    8.00000000
      ideal mu1:      -0.514529543643
             Q0:     -16.777798583467
             G0:      -0.000000000027
   RMS gradient:       0.000000429581
     Trial step:       0.556364957027
             Q1:     -16.777798583475
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000015
           Qmin:     -16.777798583476
Quadratic minimum step length (  0.670006956246) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779858346672 0.00000000001 0.00000064437 0.6700  0.137    8.00000000
      ideal mu1:      -0.514530087448
             Q0:     -16.777798583476
             G0:      -0.000000000004
   RMS gradient:       0.000000157720
     Trial step:       0.610547616014
             Q1:     -16.777798583476
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798583476
Quadratic minimum step length (  0.423346469272) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779858347565 0.00000000000 0.00000023658 0.4233  0.135    8.00000000
      ideal mu1:      -0.514529856379
             Q0:     -16.777798583477
             G0:      -0.000000000000
   RMS gradient:       0.000000046341
     Trial step:       0.508402574307
             Q1:     -16.777798583477
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798583477
Quadratic minimum step length (  0.484433951813) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779858347650 0.00000000000 0.00000006951 0.4844  0.086    8.00000000
      ideal mu1:      -0.514529773769
             Q0:     -16.777798583476
             G0:      -0.000000000000
   RMS gradient:       0.000000019660
     Trial step:       0.496273581992
             Q1:     -16.777798583477
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798583477
  Cubic LS coeff:      -2.581326436835
Predicted energy:     -16.777798583477
WARNING in lnv_denskernel_optimise_cg: setting cubic step to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779858347649 0.00000000000 0.00000002949 0.1500  0.000    8.00000000
      ideal mu1:      -0.514529786409
             Q0:     -16.777798583477
             G0:      -0.000000000000
   RMS gradient:       0.000000014745
     Trial step:       0.272838848588
             Q1:     -16.777798583477
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798583477
  Cubic LS coeff:       0.390261750163
Predicted energy:     -16.777798583477
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779858347652 0.00000000000 0.00000002212 0.3903  0.563    8.00000000
      ideal mu1:      -0.514529825393
             Q0:     -16.777798583477
             G0:      -0.000000000000
   RMS gradient:       0.000000009777
     Trial step:       0.326310537008
             Q1:     -16.777798583477
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798583477
Quadratic minimum step length (  0.012942812247) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779858347657 0.00000000000 0.00000001466 0.0129  0.440    8.00000000
      ideal mu1:      -0.514529825407
10    -16.77779858347670 0.00000000000 0.00000001449 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000585857425              |
           | Maximum change in energy =  0.00000000290730 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.82265147E-03     0.24279363E-03
               2       0.41120887E-06     0.11711417E-06
               3       0.11384115E-12     0.32335246E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23431866E-03     0.69148344E-04
               2       0.33373275E-07     0.95047547E-08
               3       0.62499589E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000585857425
Trial step length           =               0.005304
Gradient along search dir.  =         -0.00000178301
Functional at step 0        =     -16.77779858347670
Functional at step 1        =     -16.77779858632199
Functional predicted        =     -16.77779858685833
Selected quadratic step     =               0.003793
Conjugate gradients coeff.  =               0.890554
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  039 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99996155
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514523163991
             Q0:     -16.777798586738
             G0:      -0.000000009216
   RMS gradient:       0.000007999975
     Trial step:       0.064987506605
             Q1:     -16.777798587301
 Quadratic coef:       0.000000000036
 Linear coef   :      -0.000000000599
           Qmin:     -16.777798589230
Quadratic minimum step length (  0.540914287553) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779858673785 0.00000000000 0.00001199996 0.5409  0.000    8.00000000
      ideal mu1:      -0.514528580548
             Q0:     -16.777798589232
             G0:      -0.000000000540
   RMS gradient:       0.000001935080
     Trial step:       0.187490455317
             Q1:     -16.777798589317
 Quadratic coef:       0.000000000017
 Linear coef   :      -0.000000000101
           Qmin:     -16.777798589387
Quadratic minimum step length (  0.571524405623) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779858923239 0.00000000031 0.00000290262 0.5715  0.059    8.00000000
      ideal mu1:      -0.514531660067
             Q0:     -16.777798589383
             G0:      -0.000000000137
   RMS gradient:       0.000000990507
     Trial step:       0.327345950082
             Q1:     -16.777798589414
 Quadratic coef:       0.000000000014
 Linear coef   :      -0.000000000045
           Qmin:     -16.777798589419
Quadratic minimum step length (  0.524278286119) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779858938263 0.00000000002 0.00000148576 0.5243  0.262    8.00000000
      ideal mu1:      -0.514530618962
             Q0:     -16.777798589419
             G0:      -0.000000000018
   RMS gradient:       0.000000353960
     Trial step:       0.414270894074
             Q1:     -16.777798589424
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000008
           Qmin:     -16.777798589425
Quadratic minimum step length (  0.635648581342) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779858941886 0.00000000001 0.00000053094 0.6356  0.128    8.00000000
      ideal mu1:      -0.514530975720
             Q0:     -16.777798589425
             G0:      -0.000000000002
   RMS gradient:       0.000000125318
     Trial step:       0.513157584091
             Q1:     -16.777798589425
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798589426
Quadratic minimum step length (  0.929219491357) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779858942456 0.00000000000 0.00000018798 0.9292  0.125    8.00000000
      ideal mu1:      -0.514530685542
             Q0:     -16.777798589425
             G0:      -0.000000000000
   RMS gradient:       0.000000087733
     Trial step:       0.690533148571
             Q1:     -16.777798589425
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798589425
Quadratic minimum step length (  0.212417049292) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779858942530 0.00000000000 0.00000013160 0.2124  0.490    8.00000000
      ideal mu1:      -0.514530686644
             Q0:     -16.777798589425
             G0:      -0.000000000001
   RMS gradient:       0.000000070083
     Trial step:       0.382989574085
             Q1:     -16.777798589425
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798589425
Quadratic minimum step length (  0.286290743780) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779858942534 0.00000000000 0.00000010513 0.2863  0.000    8.00000000
      ideal mu1:      -0.514530739808
             Q0:     -16.777798589425
             G0:      -0.000000000000
   RMS gradient:       0.000000033336
     Trial step:       0.331128932630
             Q1:     -16.777798589425
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798589425
Quadratic minimum step length (  0.059364711040) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779858942542 0.00000000000 0.00000005000 0.0594  0.226    8.00000000
      ideal mu1:      -0.514530748222
             Q0:     -16.777798589425
             G0:      -0.000000000000
   RMS gradient:       0.000000028915
     Trial step:       0.140204755278
             Q1:     -16.777798589425
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798589426
Quadratic minimum step length (  0.014324597409) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779858942550 0.00000000000 0.00000004337 0.0143  0.752    8.00000000
      ideal mu1:      -0.514530750966
10    -16.77779858942560 0.00000000000 0.00000004131 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000555900104              |
           | Maximum change in energy =  0.00000000290730 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.99459271E-03     0.29356518E-03
               2       0.60178714E-06     0.17142078E-06
               3       0.24254409E-12     0.69139139E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.50295021E-03     0.14843839E-03
               2       0.15392826E-06     0.43846449E-07
               3       0.17845872E-13     0.53290705E-14
================================================================================
RMS gradient                =       0.00000555900104
Trial step length           =               0.004485
Gradient along search dir.  =         -0.00000212942
Functional at step 0        =     -16.77779858942560
Functional at step 1        =     -16.77779858931432
Functional predicted        =     -16.77779859178589
Selected quadratic step     =               0.002217
Conjugate gradients coeff.  =               0.900346
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  040 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99996789
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514525192163
             Q0:     -16.777798591704
             G0:      -0.000000006436
   RMS gradient:       0.000006685464
     Trial step:       0.044814915755
             Q1:     -16.777798591980
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000288
           Qmin:     -16.777798593460
Quadratic minimum step length (  0.545651091752) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779859170380 0.00000000000 0.00001002820 0.5457  0.000    8.00000000
      ideal mu1:      -0.514529808913
             Q0:     -16.777798593446
             G0:      -0.000000000380
   RMS gradient:       0.000001631029
     Trial step:       0.156375534239
             Q1:     -16.777798593497
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000059
           Qmin:     -16.777798593550
Quadratic minimum step length (  0.546198596633) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779859344592 0.00000000022 0.00000244654 0.5462  0.060    8.00000000
      ideal mu1:      -0.514532245894
             Q0:     -16.777798593550
             G0:      -0.000000000091
   RMS gradient:       0.000000793456
     Trial step:       0.292253481329
             Q1:     -16.777798593570
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000027
           Qmin:     -16.777798593576
Quadratic minimum step length (  0.562304446557) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779859355030 0.00000000001 0.00000119018 0.5623  0.237    8.00000000
      ideal mu1:      -0.514531384728
             Q0:     -16.777798593575
             G0:      -0.000000000013
   RMS gradient:       0.000000306854
     Trial step:       0.405383068311
             Q1:     -16.777798593579
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000005
           Qmin:     -16.777798593580
Quadratic minimum step length (  0.743441274970) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779859357510 0.00000000000 0.00000046028 0.7434  0.150    8.00000000
      ideal mu1:      -0.514531892190
             Q0:     -16.777798593579
             G0:      -0.000000000002
   RMS gradient:       0.000000135473
     Trial step:       0.548979512510
             Q1:     -16.777798593580
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798593580
Quadratic minimum step length (  0.334402340447) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779859357930 0.00000000000 0.00000020321 0.3344  0.195    8.00000000
      ideal mu1:      -0.514531695856
             Q0:     -16.777798593579
             G0:      -0.000000000001
   RMS gradient:       0.000000055117
     Trial step:       0.428462406567
             Q1:     -16.777798593580
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798593580
Quadratic minimum step length (  0.535728823357) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779859357949 0.00000000000 0.00000008268 0.5357  0.166    8.00000000
      ideal mu1:      -0.514531530927
             Q0:     -16.777798593580
             G0:      -0.000000000000
   RMS gradient:       0.000000037883
     Trial step:       0.479102975281
             Q1:     -16.777798593580
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798593580
Quadratic minimum step length (  0.180436911267) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779859357992 0.00000000000 0.00000005683 0.1804  0.000    8.00000000
      ideal mu1:      -0.514531571143
             Q0:     -16.777798593580
             G0:      -0.000000000000
   RMS gradient:       0.000000021037
     Trial step:       0.294020171143
             Q1:     -16.777798593580
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798593580
  Cubic LS coeff:       0.420067651977
Predicted energy:     -16.777798593580
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779859357972 0.00000000000 0.00000003155 0.4201  0.308    8.00000000
      ideal mu1:      -0.514531646803
             Q0:     -16.777798593580
             G0:      -0.000000000000
   RMS gradient:       0.000000016300
     Trial step:       0.351437566185
             Q1:     -16.777798593580
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798593580
Quadratic minimum step length (  0.065744578897) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779859357990 0.00000000000 0.00000002445 0.0657  0.600    8.00000000
      ideal mu1:      -0.514531647816
10    -16.77779859357999 0.00000000000 0.00000002417 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000529923927              |
           | Maximum change in energy =  0.00000000198297 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86826798916145 |
           | Pseudopotential (local)    :      -46.08689517260530 |
           | Pseudopotential (non-local):       -3.18862958042751 |
           | Hartree                    :       19.82067348671292 |
           | Exchange-correlation       :       -4.12706456439236 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779859357999 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08689517260584 |
           | Hartree                    :       19.82067348671318 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999924
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.89410116E-03     0.26394178E-03
               2       0.48673324E-06     0.13866926E-06
               3       0.15973668E-12     0.47073456E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.47937977E-03     0.14150416E-03
               2       0.13994983E-06     0.39871057E-07
               3       0.13590678E-13     0.36637360E-14
================================================================================
RMS gradient                =       0.00000529923927
Trial step length           =               0.003153
Gradient along search dir.  =         -0.00000229684
Functional at step 0        =     -16.77779859357999
Functional at step 1        =     -16.77779859301399
Functional predicted        =     -16.77779859525941
Selected quadratic step     =               0.001462
Conjugate gradients coeff.  =               0.908727
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  041 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99997293
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514526962541
             Q0:     -16.777798595201
             G0:      -0.000000004578
   RMS gradient:       0.000005638575
     Trial step:       0.152003667053
             Q1:     -16.777798595800
 Quadratic coef:       0.000000000098
 Linear coef   :      -0.000000000696
           Qmin:     -16.777798596442
Quadratic minimum step length (  0.542089682092) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779859520117 0.00000000000 0.00000845786 0.5421  0.000    8.00000000
      ideal mu1:      -0.514530736934
             Q0:     -16.777798596440
             G0:      -0.000000000270
   RMS gradient:       0.000001370197
     Trial step:       0.287053339206
             Q1:     -16.777798596497
 Quadratic coef:       0.000000000020
 Linear coef   :      -0.000000000077
           Qmin:     -16.777798596514
Quadratic minimum step length (  0.553522420548) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779859643979 0.00000000016 0.00000205530 0.5535  0.059    8.00000000
      ideal mu1:      -0.514532860923
             Q0:     -16.777798596515
             G0:      -0.000000000066
   RMS gradient:       0.000000680340
     Trial step:       0.398610661101
             Q1:     -16.777798596531
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000026
           Qmin:     -16.777798596533
Quadratic minimum step length (  0.543816927170) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779859651470 0.00000000001 0.00000102051 0.5438  0.247    8.00000000
      ideal mu1:      -0.514532147380
             Q0:     -16.777798596532
             G0:      -0.000000000009
   RMS gradient:       0.000000250513
     Trial step:       0.465586968092
             Q1:     -16.777798596535
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798596536
Quadratic minimum step length (  0.810839719885) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779859653228 0.00000000000 0.00000037577 0.8108  0.136    8.00000000
      ideal mu1:      -0.514532531907
             Q0:     -16.777798596535
             G0:      -0.000000000002
   RMS gradient:       0.000000124584
     Trial step:       0.614423637883
             Q1:     -16.777798596536
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798596536
Quadratic minimum step length (  0.356489807368) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779859653549 0.00000000000 0.00000018688 0.3565  0.247    8.00000000
      ideal mu1:      -0.514532359666
             Q0:     -16.777798596536
             G0:      -0.000000000000
   RMS gradient:       0.000000051739
     Trial step:       0.468012568540
             Q1:     -16.777798596536
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798596536
Quadratic minimum step length (  0.302224580981) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779859653571 0.00000000000 0.00000007761 0.3022  0.172    8.00000000
      ideal mu1:      -0.514532286250
             Q0:     -16.777798596536
             G0:      -0.000000000000
   RMS gradient:       0.000000020650
     Trial step:       0.376091614399
             Q1:     -16.777798596536
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798596536
Quadratic minimum step length (  0.050931875117) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779859653589 0.00000000000 0.00000003098 0.0509  0.000    8.00000000
      ideal mu1:      -0.514532288194
             Q0:     -16.777798596536
             G0:      -0.000000000000
   RMS gradient:       0.000000019331
     Trial step:       0.138401774328
             Q1:     -16.777798596536
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798596536
Quadratic minimum step length (  0.004387434637) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779859653597 0.00000000000 0.00000002900 0.0044  0.876    8.00000000
      ideal mu1:      -0.514532288487
             Q0:     -16.777798596536
             G0:      -0.000000000000
   RMS gradient:       0.000000019130
     Trial step:       0.024642011656
             Q1:     -16.777798596536
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798596536
  Cubic LS coeff:       0.031884852755
Predicted energy:     -16.777798596536
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779859653575 0.00000000000 0.00000002869 0.0319  0.979    8.00000000
      ideal mu1:      -0.514532291609
10    -16.77779859653582 0.00000000000 0.00000002549 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000506998546              |
           | Maximum change in energy =  0.00000000138480 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17579370E-03     0.51954516E-04
               2       0.18834075E-07     0.53692580E-08
               3       0.54306392E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30144521E-03     0.89081841E-04
               2       0.55398508E-07     0.15793014E-07
               3       0.55658378E-14     0.19984014E-14
================================================================================
RMS gradient                =       0.00000506998546
Trial step length           =               0.002147
Gradient along search dir.  =         -0.00000076094
Functional at step 0        =     -16.77779859653582
Functional at step 1        =     -16.77779859786883
Functional predicted        =     -16.77779859875336
Selected quadratic step     =               0.005828
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  042 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99996882
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514526905303
             Q0:     -16.777798598659
             G0:      -0.000000006101
   RMS gradient:       0.000006509334
     Trial step:       0.028030464021
             Q1:     -16.777798598826
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000171
           Qmin:     -16.777798600344
Quadratic minimum step length (  0.552121653498) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779859865944 0.00000000000 0.00000976400 0.5521  0.000    8.00000000
      ideal mu1:      -0.514531383963
             Q0:     -16.777798600309
             G0:      -0.000000000367
   RMS gradient:       0.000001612195
     Trial step:       0.124403481237
             Q1:     -16.777798600350
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000046
           Qmin:     -16.777798600416
Quadratic minimum step length (  0.582722757504) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779860030888 0.00000000021 0.00000241829 0.5827  0.061    8.00000000
      ideal mu1:      -0.514533904162
             Q0:     -16.777798600408
             G0:      -0.000000000095
   RMS gradient:       0.000000845559
     Trial step:       0.269244757849
             Q1:     -16.777798600427
 Quadratic coef:       0.000000000007
 Linear coef   :      -0.000000000026
           Qmin:     -16.777798600431
Quadratic minimum step length (  0.482994633327) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779860040827 0.00000000001 0.00000126834 0.4830  0.275    8.00000000
      ideal mu1:      -0.514533006171
             Q0:     -16.777798600433
             G0:      -0.000000000012
   RMS gradient:       0.000000282854
     Trial step:       0.360615824795
             Q1:     -16.777798600435
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798600436
Quadratic minimum step length (  0.518662893285) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779860043261 0.00000000000 0.00000042428 0.5187  0.112    8.00000000
      ideal mu1:      -0.514533129104
             Q0:     -16.777798600436
             G0:      -0.000000000002
   RMS gradient:       0.000000117299
     Trial step:       0.432478955618
             Q1:     -16.777798600437
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798600437
Quadratic minimum step length (  0.517259191198) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779860043625 0.00000000000 0.00000017595 0.5173  0.172    8.00000000
      ideal mu1:      -0.514533170959
             Q0:     -16.777798600437
             G0:      -0.000000000000
   RMS gradient:       0.000000052715
     Trial step:       0.472973270697
             Q1:     -16.777798600437
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798600437
Quadratic minimum step length (  0.186068580866) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779860043693 0.00000000000 0.00000007907 0.1861  0.202    8.00000000
      ideal mu1:      -0.514533125575
             Q0:     -16.777798600437
             G0:      -0.000000000000
   RMS gradient:       0.000000033035
     Trial step:       0.296657151045
             Q1:     -16.777798600437
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798600437
  Cubic LS coeff:       0.406441489115
Predicted energy:     -16.777798600437
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779860043669 0.00000000000 0.00000004955 0.4064  0.000    8.00000000
      ideal mu1:      -0.514533072405
             Q0:     -16.777798600437
             G0:      -0.000000000000
   RMS gradient:       0.000000015461
     Trial step:       0.347237345669
             Q1:     -16.777798600437
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798600437
  Cubic LS coeff:       0.493655688642
Predicted energy:     -16.777798600437
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779860043686 0.00000000000 0.00000002319 0.4937  0.219    8.00000000
      ideal mu1:      -0.514533081099
             Q0:     -16.777798600437
             G0:      -0.000000000000
   RMS gradient:       0.000000008358
     Trial step:       0.414023780716
             Q1:     -16.777798600437
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798600437
  Cubic LS coeff:       0.568588198639
Predicted energy:     -16.777798600437
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779860043672 0.00000000000 0.00000001254 0.5686  0.292    8.00000000
      ideal mu1:      -0.514533101300
10    -16.77779860043700 0.00000000000 0.00000000713 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000478957686              |
           | Maximum change in energy =  0.00000000130039 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.54832947E-03     0.16205417E-03
               2       0.18344500E-06     0.52303040E-07
               3       0.22534300E-13     0.67168493E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15551935E-03     0.45959143E-04
               2       0.14760229E-07     0.42083436E-08
               3       0.62497761E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000478957686
Trial step length           =               0.003538
Gradient along search dir.  =         -0.00000119271
Functional at step 0        =     -16.77779860043700
Functional at step 1        =     -16.77779860171151
Functional predicted        =     -16.77779860194840
Selected quadratic step     =               0.002534
Conjugate gradients coeff.  =               0.892444
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  043 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99997435
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514528672073
             Q0:     -16.777798601895
             G0:      -0.000000004134
   RMS gradient:       0.000005358058
     Trial step:       0.485189690401
             Q1:     -16.777798603001
 Quadratic coef:       0.000000000900
 Linear coef   :      -0.000000002006
           Qmin:     -16.777798603013
Quadratic minimum step length (  0.540864205151) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779860189524 0.00000000000 0.00000803709 0.5409  0.000    8.00000000
      ideal mu1:      -0.514532253698
             Q0:     -16.777798603014
             G0:      -0.000000000244
   RMS gradient:       0.000001301877
     Trial step:       0.512271155001
             Q1:     -16.777798603081
 Quadratic coef:       0.000000000058
 Linear coef   :      -0.000000000125
           Qmin:     -16.777798603081
Quadratic minimum step length (  0.552400131422) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779860301353 0.00000000014 0.00000195282 0.5524  0.059    8.00000000
      ideal mu1:      -0.514534262763
             Q0:     -16.777798603081
             G0:      -0.000000000060
   RMS gradient:       0.000000644474
     Trial step:       0.531957379257
             Q1:     -16.777798603097
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000032
           Qmin:     -16.777798603097
Quadratic minimum step length (  0.541380605671) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779860308102 0.00000000001 0.00000096671 0.5414  0.245    8.00000000
      ideal mu1:      -0.514533596839
             Q0:     -16.777798603097
             G0:      -0.000000000008
   RMS gradient:       0.000000236309
     Trial step:       0.536648309579
             Q1:     -16.777798603100
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798603100
Quadratic minimum step length (  0.580391199888) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779860309734 0.00000000000 0.00000035446 0.5804  0.134    8.00000000
      ideal mu1:      -0.514533850177
             Q0:     -16.777798603100
             G0:      -0.000000000001
   RMS gradient:       0.000000080914
     Trial step:       0.558091351227
             Q1:     -16.777798603100
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798603100
Quadratic minimum step length (  0.676338161686) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779860309969 0.00000000000 0.00000012137 0.6763  0.117    8.00000000
      ideal mu1:      -0.514533735990
             Q0:     -16.777798603100
             G0:      -0.000000000000
   RMS gradient:       0.000000023543
     Trial step:       0.614376495760
             Q1:     -16.777798603100
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798603100
  Cubic LS coeff:       0.817340340129
Predicted energy:     -16.777798603100
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779860310021 0.00000000000 0.00000003531 0.8173  0.085    8.00000000
      ideal mu1:      -0.514533702346
             Q0:     -16.777798603100
             G0:      -0.000000000000
   RMS gradient:       0.000000021613
     Trial step:       0.708628742016
             Q1:     -16.777798603100
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798603100
Quadratic minimum step length (  0.250187863061) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779860310014 0.00000000000 0.00000003242 0.2502  0.000    8.00000000
      ideal mu1:      -0.514533730891
             Q0:     -16.777798603100
             G0:      -0.000000000000
   RMS gradient:       0.000000006282
     Trial step:       0.421058559666
             Q1:     -16.777798603100
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798603100
Quadratic minimum step length (  0.001989033834) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779860310035 0.00000000000 0.00000000942 0.0020  0.084    8.00000000
      ideal mu1:      -0.514533730964
             Q0:     -16.777798603100
             G0:      -0.000000000000
   RMS gradient:       0.000000006248
     Trial step:       0.028939587439
             Q1:     -16.777798603100
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798603100
Quadratic minimum step length (  0.000074233145) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779860310030 0.00000000000 0.00000000937 0.0001  0.989    8.00000000
      ideal mu1:      -0.514533730969
10    -16.77779860310015 0.00000000000 0.00000000937 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000454839229              |
           | Maximum change in energy =  0.00000000130039 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66388309E-03     0.19621554E-03
               2       0.26912279E-06     0.76739583E-07
               3       0.48298501E-13     0.15099033E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.33500859E-03     0.99008448E-04
               2       0.68541835E-07     0.19544377E-07
               3       0.69651665E-14     0.35527137E-14
================================================================================
RMS gradient                =       0.00000454839229
Trial step length           =               0.002994
Gradient along search dir.  =         -0.00000142826
Functional at step 0        =     -16.77779860310015
Functional at step 1        =     -16.77779860305983
Functional predicted        =     -16.77779860415935
Selected quadratic step     =               0.001483
Conjugate gradients coeff.  =               0.901823
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  044 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99997854
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514530026163
             Q0:     -16.777798604123
             G0:      -0.000000002898
   RMS gradient:       0.000004485843
     Trial step:       0.001465700038
             Q1:     -16.777798604128
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000004
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798604132
  Cubic LS coeff:       0.005742479251
Predicted energy:     -16.777798604136
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779860412332 0.00000000000 0.00000672876 0.0057  0.000    8.00000000
      ideal mu1:      -0.514530058198
             Q0:     -16.777798604140
             G0:      -0.000000005643
   RMS gradient:       0.000004438256
     Trial step:       0.002901163914
             Q1:     -16.777798604157
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000016
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798604172
  Cubic LS coeff:       0.013572107332
Predicted energy:     -16.777798604195
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779860414001 0.00000000000 0.00000665738 0.0136  0.979    8.00000000
      ideal mu1:      -0.514530207610
             Q0:     -16.777798604215
             G0:      -0.000000007402
   RMS gradient:       0.000004217371
     Trial step:       0.006274942871
             Q1:     -16.777798604260
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000046
           Qmin:     -16.777798604779
Quadratic minimum step length (  0.152493010514) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779860421479 0.00000000001 0.00000632606 0.1525  0.903    8.00000000
      ideal mu1:      -0.514532547691
             Q0:     -16.777798604885
             G0:      -0.000000000308
   RMS gradient:       0.000001177827
     Trial step:       0.030933556684
             Q1:     -16.777798604894
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000010
           Qmin:     -16.777798604951
Quadratic minimum step length (  0.423626150669) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779860488528 0.00000000020 0.00000176674 0.4236  0.078    8.00000000
      ideal mu1:      -0.514534373887
             Q0:     -16.777798604942
             G0:      -0.000000000061
   RMS gradient:       0.000000722609
     Trial step:       0.114473855289
             Q1:     -16.777798604948
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000007
           Qmin:     -16.777798604956
Quadratic minimum step length (  0.440054684963) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779860494235 0.00000000001 0.00000108391 0.4401  0.376    8.00000000
      ideal mu1:      -0.514534923937
             Q0:     -16.777798604955
             G0:      -0.000000000043
   RMS gradient:       0.000000557397
     Trial step:       0.224443214033
             Q1:     -16.777798604962
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000010
           Qmin:     -16.777798604962
Quadratic minimum step length (  0.298341840066) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779860495546 0.00000000000 0.00000083610 0.2983  0.595    8.00000000
      ideal mu1:      -0.514534729793
             Q0:     -16.777798604963
             G0:      -0.000000000017
   RMS gradient:       0.000000345591
     Trial step:       0.258767852457
             Q1:     -16.777798604966
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798604967
Quadratic minimum step length (  0.533142562907) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779860496279 0.00000000000 0.00000051839 0.5331  0.000    8.00000000
      ideal mu1:      -0.514534313704
             Q0:     -16.777798604968
             G0:      -0.000000000002
   RMS gradient:       0.000000104329
     Trial step:       0.371429880404
             Q1:     -16.777798604968
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000001
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798604968
  Cubic LS coeff:       0.509015124955
Predicted energy:     -16.777798604968
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779860496769 0.00000000000 0.00000015649 0.5090  0.091    8.00000000
      ideal mu1:      -0.514534336853
             Q0:     -16.777798604968
             G0:      -0.000000000000
   RMS gradient:       0.000000037727
     Trial step:       0.434814244230
             Q1:     -16.777798604968
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798604968
  Cubic LS coeff:       0.562311991271
Predicted energy:     -16.777798604968
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779860496815 0.00000000000 0.00000005659 0.5623  0.131    8.00000000
      ideal mu1:      -0.514534240350
10    -16.77779860496814 0.00000000000 0.00000002439 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000433484915              |
           | Maximum change in energy =  0.00000000088772 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.59699390E-03     0.17646222E-03
               2       0.21774556E-06     0.62095953E-07
               3       0.32997072E-13     0.10547119E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31945099E-03     0.94420145E-04
               2       0.62356397E-07     0.17782488E-07
               3       0.64615665E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000433484915
Trial step length           =               0.002107
Gradient along search dir.  =         -0.00000153998
Functional at step 0        =     -16.77779860496814
Functional at step 1        =     -16.77779860472269
Functional predicted        =     -16.77779860572244
Selected quadratic step     =               0.000980
Conjugate gradients coeff.  =               0.908306
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  045 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998189
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514531115688
             Q0:     -16.777798605697
             G0:      -0.000000002067
   RMS gradient:       0.000003788347
     Trial step:       0.494470690240
             Q1:     -16.777798606252
 Quadratic coef:       0.000000000467
 Linear coef   :      -0.000000001022
           Qmin:     -16.777798606257
Quadratic minimum step length (  0.541208003280) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779860569735 0.00000000000 0.00000568252 0.5412  0.000    8.00000000
      ideal mu1:      -0.514533703596
             Q0:     -16.777798606257
             G0:      -0.000000000121
   RMS gradient:       0.000000916118
     Trial step:       0.517311796642
             Q1:     -16.777798606290
 Quadratic coef:       0.000000000029
 Linear coef   :      -0.000000000063
           Qmin:     -16.777798606290
Quadratic minimum step length (  0.552897325432) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779860625684 0.00000000007 0.00000137418 0.5529  0.058    8.00000000
      ideal mu1:      -0.514535094597
             Q0:     -16.777798606290
             G0:      -0.000000000029
   RMS gradient:       0.000000450660
     Trial step:       0.534808665578
             Q1:     -16.777798606298
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000016
           Qmin:     -16.777798606298
Quadratic minimum step length (  0.542108469528) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779860629040 0.00000000000 0.00000067599 0.5421  0.242    8.00000000
      ideal mu1:      -0.514534631630
             Q0:     -16.777798606298
             G0:      -0.000000000004
   RMS gradient:       0.000000167242
     Trial step:       0.538446197114
             Q1:     -16.777798606300
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798606300
Quadratic minimum step length (  0.954118612642) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779860629840 0.00000000000 0.00000025086 0.9541  0.138    8.00000000
      ideal mu1:      -0.514534936707
             Q0:     -16.777798606300
             G0:      -0.000000000001
   RMS gradient:       0.000000113999
     Trial step:       0.716757656794
             Q1:     -16.777798606300
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798606300
Quadratic minimum step length (  0.461359727910) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779860629973 0.00000000000 0.00000017100 0.4614  0.465    8.00000000
      ideal mu1:      -0.514534752244
             Q0:     -16.777798606300
             G0:      -0.000000000000
   RMS gradient:       0.000000054079
     Trial step:       0.575050534750
             Q1:     -16.777798606300
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798606300
  Cubic LS coeff:       0.708252462689
Predicted energy:     -16.777798606300
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779860629994 0.00000000000 0.00000008112 0.7083  0.225    8.00000000
      ideal mu1:      -0.514534645520
             Q0:     -16.777798606300
             G0:      -0.000000000000
   RMS gradient:       0.000000052078
     Trial step:       0.638185676279
             Q1:     -16.777798606300
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798606300
Quadratic minimum step length (  0.559658737546) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779860629995 0.00000000000 0.00000007812 0.5597  0.000    8.00000000
      ideal mu1:      -0.514534785175
             Q0:     -16.777798606300
             G0:      -0.000000000000
   RMS gradient:       0.000000024095
     Trial step:       0.597633825939
             Q1:     -16.777798606300
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798606300
Quadratic minimum step length (  0.055850403196) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779860630016 0.00000000000 0.00000003614 0.0559  0.214    8.00000000
      ideal mu1:      -0.514534781144
             Q0:     -16.777798606300
             G0:      -0.000000000000
   RMS gradient:       0.000000022046
     Trial step:       0.182696716287
             Q1:     -16.777798606300
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798606300
Quadratic minimum step length (  0.079975698704) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779860630028 0.00000000000 0.00000003307 0.0800  0.837    8.00000000
      ideal mu1:      -0.514534767263
10    -16.77779860630007 0.00000000000 0.00000002375 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000415571091              |
           | Maximum change in energy =  0.00000000062266 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86827405140833 |
           | Pseudopotential (local)    :      -46.08686803835361 |
           | Pseudopotential (non-local):       -3.18863998794175 |
           | Hartree                    :       19.82064741313212 |
           | Exchange-correlation       :       -4.12706129251598 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779860630007 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08686803835447 |
           | Hartree                    :       19.82064741313231 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999931
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11750766E-03     0.34759832E-04
               2       0.84415486E-08     0.24083546E-08
               3       0.57136207E-14     0.16653345E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20439603E-03     0.60458506E-04
               2       0.25546448E-07     0.72883072E-08
               3       0.61425354E-14     0.31988301E-14
================================================================================
RMS gradient                =       0.00000415571091
Trial step length           =               0.001437
Gradient along search dir.  =         -0.00000051124
Functional at step 0        =     -16.77779860630007
Functional at step 1        =     -16.77779860690055
Functional predicted        =     -16.77779860730608
Selected quadratic step     =               0.003936
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  046 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99997899
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514531145311
             Q0:     -16.777798607260
             G0:      -0.000000002783
   RMS gradient:       0.000004396424
     Trial step:       0.120877200232
             Q1:     -16.777798607559
 Quadratic coef:       0.000000000037
 Linear coef   :      -0.000000000336
           Qmin:     -16.777798608016
Quadratic minimum step length (  0.542921739277) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779860726006 0.00000000000 0.00000659464 0.5429  0.000    8.00000000
      ideal mu1:      -0.514534044741
             Q0:     -16.777798608013
             G0:      -0.000000000165
   RMS gradient:       0.000001072810
     Trial step:       0.256177399060
             Q1:     -16.777798608045
 Quadratic coef:       0.000000000010
 Linear coef   :      -0.000000000042
           Qmin:     -16.777798608057
Quadratic minimum step length (  0.536844087633) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779860801267 0.00000000009 0.00000160922 0.5368  0.060    8.00000000
      ideal mu1:      -0.514535662324
             Q0:     -16.777798608058
             G0:      -0.000000000039
   RMS gradient:       0.000000518100
     Trial step:       0.370846763597
             Q1:     -16.777798608068
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000015
           Qmin:     -16.777798608069
Quadratic minimum step length (  0.582322144814) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779860805760 0.00000000001 0.00000077715 0.5823  0.233    8.00000000
      ideal mu1:      -0.514535106279
             Q0:     -16.777798608069
             G0:      -0.000000000006
   RMS gradient:       0.000000205037
     Trial step:       0.464706663149
             Q1:     -16.777798608070
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798608071
Quadratic minimum step length (  0.772939003045) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779860806863 0.00000000000 0.00000030756 0.7729  0.157    8.00000000
      ideal mu1:      -0.514535476816
             Q0:     -16.777798608070
             G0:      -0.000000000001
   RMS gradient:       0.000000099620
     Trial step:       0.599324540565
             Q1:     -16.777798608071
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798608071
Quadratic minimum step length (  0.809641140454) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779860807046 0.00000000000 0.00000014943 0.8096  0.236    8.00000000
      ideal mu1:      -0.514535114820
             Q0:     -16.777798608071
             G0:      -0.000000000000
   RMS gradient:       0.000000069649
     Trial step:       0.696590126634
             Q1:     -16.777798608071
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798608071
Quadratic minimum step length (  0.960281246268) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779860807065 0.00000000000 0.00000010447 0.9603  0.489    8.00000000
      ideal mu1:      -0.514535292222
             Q0:     -16.777798608071
             G0:      -0.000000000001
   RMS gradient:       0.000000063301
     Trial step:       0.817876784695
             Q1:     -16.777798608070
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798608071
Quadratic minimum step length (  0.298463573896) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779860807066 0.00000000000 0.00000009495 0.2985  0.000    8.00000000
      ideal mu1:      -0.514535249757
             Q0:     -16.777798608071
             G0:      -0.000000000000
   RMS gradient:       0.000000022485
     Trial step:       0.494071278427
             Q1:     -16.777798608071
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798608071
  Cubic LS coeff:       0.566886221033
Predicted energy:     -16.777798608071
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779860807075 0.00000000000 0.00000003373 0.5669  0.126    8.00000000
      ideal mu1:      -0.514535259705
             Q0:     -16.777798608071
             G0:      -0.000000000000
   RMS gradient:       0.000000015819
     Trial step:       0.529227928164
             Q1:     -16.777798608071
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798608071
  Cubic LS coeff:       0.667690880992
Predicted energy:     -16.777798608071
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779860807074 0.00000000000 0.00000002373 0.6677  0.495    8.00000000
      ideal mu1:      -0.514535292200
10    -16.77779860807074 0.00000000000 0.00000001768 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000392577952              |
           | Maximum change in energy =  0.00000000059022 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36813731E-03     0.10889794E-03
               2       0.82915004E-07     0.23657317E-07
               3       0.63598333E-14     0.28033131E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10423955E-03     0.30833399E-04
               2       0.66488433E-08     0.18970396E-08
               3       0.65702011E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000392577952
Trial step length           =               0.002378
Gradient along search dir.  =         -0.00000080127
Functional at step 0        =     -16.77779860807074
Functional at step 1        =     -16.77779860864713
Functional predicted        =     -16.77779860875368
Selected quadratic step     =               0.001705
Conjugate gradients coeff.  =               0.892403
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  047 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998278
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514532324872
             Q0:     -16.777798608730
             G0:      -0.000000001873
   RMS gradient:       0.000003606876
     Trial step:       0.594441470290
             Q1:     -16.777798609231
 Quadratic coef:       0.000000000613
 Linear coef   :      -0.000000001114
           Qmin:     -16.777798609236
Quadratic minimum step length (  0.540347036759) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779860873031 0.00000000000 0.00000541031 0.5403  0.000    8.00000000
      ideal mu1:      -0.514534685340
             Q0:     -16.777798609237
             G0:      -0.000000000111
   RMS gradient:       0.000000878348
     Trial step:       0.566749227612
             Q1:     -16.777798609267
 Quadratic coef:       0.000000000032
 Linear coef   :      -0.000000000063
           Qmin:     -16.777798609267
Quadratic minimum step length (  0.553720823456) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779860923650 0.00000000006 0.00000131752 0.5537  0.059    8.00000000
      ideal mu1:      -0.514536057674
             Q0:     -16.777798609267
             G0:      -0.000000000027
   RMS gradient:       0.000000437948
     Trial step:       0.560197151908
             Q1:     -16.777798609274
 Quadratic coef:       0.000000000008
 Linear coef   :      -0.000000000015
           Qmin:     -16.777798609275
Quadratic minimum step length (  0.515147064591) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779860926742 0.00000000000 0.00000065692 0.5151  0.249    8.00000000
      ideal mu1:      -0.514535624202
             Q0:     -16.777798609274
             G0:      -0.000000000004
   RMS gradient:       0.000000153229
     Trial step:       0.537200072969
             Q1:     -16.777798609276
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798609276
Quadratic minimum step length (  0.627107051527) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779860927449 0.00000000000 0.00000022984 0.6271  0.122    8.00000000
      ideal mu1:      -0.514535753556
             Q0:     -16.777798609276
             G0:      -0.000000000001
   RMS gradient:       0.000000056782
     Trial step:       0.580415328743
             Q1:     -16.777798609276
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798609276
Quadratic minimum step length (  0.894182827713) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779860927573 0.00000000000 0.00000008517 0.8942  0.137    8.00000000
      ideal mu1:      -0.514535686005
             Q0:     -16.777798609276
             G0:      -0.000000000000
   RMS gradient:       0.000000040542
     Trial step:       0.720414755473
             Q1:     -16.777798609276
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798609276
Quadratic minimum step length (  0.111277422007) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779860927591 0.00000000000 0.00000006081 0.1113  0.510    8.00000000
      ideal mu1:      -0.514535677213
             Q0:     -16.777798609276
             G0:      -0.000000000000
   RMS gradient:       0.000000034420
     Trial step:       0.283135827414
             Q1:     -16.777798609276
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798609276
  Cubic LS coeff:       0.426832552821
Predicted energy:     -16.777798609276
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779860927581 0.00000000000 0.00000005163 0.4268  0.000    8.00000000
      ideal mu1:      -0.514535674133
             Q0:     -16.777798609276
             G0:      -0.000000000000
   RMS gradient:       0.000000011683
     Trial step:       0.347637149928
             Q1:     -16.777798609276
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798609276
Quadratic minimum step length (  0.016531203391) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779860927605 0.00000000000 0.00000001752 0.0165  0.115    8.00000000
      ideal mu1:      -0.514535675041
             Q0:     -16.777798609276
             G0:      -0.000000000000
   RMS gradient:       0.000000011314
     Trial step:       0.075808049915
             Q1:     -16.777798609276
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798609276
  Cubic LS coeff:       0.130447696145
Predicted energy:     -16.777798609276
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779860927596 0.00000000000 0.00000001697 0.1304  0.938    8.00000000
      ideal mu1:      -0.514535688739
10    -16.77779860927574 0.00000000000 0.00000000875 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000372999398              |
           | Maximum change in energy =  0.00000000059022 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44613046E-03     0.13197346E-03
               2       0.12183363E-06     0.34764134E-07
               3       0.13787232E-13     0.53290705E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22492415E-03     0.66534002E-04
               2       0.30971813E-07     0.88374887E-08
               3       0.57269760E-14     0.19984014E-14
================================================================================
RMS gradient                =       0.00000372999398
Trial step length           =               0.002013
Gradient along search dir.  =         -0.00000096135
Functional at step 0        =     -16.77779860927574
Functional at step 1        =     -16.77779860925934
Functional predicted        =     -16.77779860975555
Selected quadratic step     =               0.000998
Conjugate gradients coeff.  =               0.902744
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  048 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998557
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514533203097
             Q0:     -16.777798609740
             G0:      -0.000000001316
   RMS gradient:       0.000003022633
     Trial step:       0.099443378164
             Q1:     -16.777798609859
 Quadratic coef:       0.000000000012
 Linear coef   :      -0.000000000131
           Qmin:     -16.777798610108
Quadratic minimum step length (  0.560461338462) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779860973969 0.00000000000 0.00000453395 0.5605  0.000    8.00000000
      ideal mu1:      -0.514535292147
             Q0:     -16.777798610095
             G0:      -0.000000000082
   RMS gradient:       0.000000768376
     Trial step:       0.236080852308
             Q1:     -16.777798610110
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000019
           Qmin:     -16.777798610117
Quadratic minimum step length (  0.534751284912) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861009502 0.00000000005 0.00000115256 0.5348  0.065    8.00000000
      ideal mu1:      -0.514536363150
             Q0:     -16.777798610117
             G0:      -0.000000000019
   RMS gradient:       0.000000364273
     Trial step:       0.355309075475
             Q1:     -16.777798610122
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000007
           Qmin:     -16.777798610123
Quadratic minimum step length (  0.608297453336) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861011714 0.00000000000 0.00000054641 0.6083  0.225    8.00000000
      ideal mu1:      -0.514535899252
             Q0:     -16.777798610122
             G0:      -0.000000000003
   RMS gradient:       0.000000159893
     Trial step:       0.464901716235
             Q1:     -16.777798610123
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798610123
Quadratic minimum step length (  0.531898975261) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861012237 0.00000000000 0.00000023984 0.5319  0.193    8.00000000
      ideal mu1:      -0.514536130240
             Q0:     -16.777798610123
             G0:      -0.000000000000
   RMS gradient:       0.000000050766
     Trial step:       0.497273311633
             Q1:     -16.777798610123
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798610123
  Cubic LS coeff:       0.689338884111
Predicted energy:     -16.777798610124
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861012312 0.00000000000 0.00000007615 0.6893  0.101    8.00000000
      ideal mu1:      -0.514536058708
             Q0:     -16.777798610123
             G0:      -0.000000000000
   RMS gradient:       0.000000017282
     Trial step:       0.585482561431
             Q1:     -16.777798610123
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798610123
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861012325 0.00000000000 0.00000002592 0.1500  0.116    8.00000000
      ideal mu1:      -0.514536054249
             Q0:     -16.777798610123
             G0:      -0.000000000000
   RMS gradient:       0.000000013242
     Trial step:       0.296348416926
             Q1:     -16.777798610123
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798610123
  Cubic LS coeff:      -0.875240325756
Predicted energy:     -16.777798610123
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779861012312 0.00000000000 0.00000001986-0.8752  0.000    8.00000000
      ideal mu1:      -0.514536057441
             Q0:     -16.777798610123
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.717E+01) too large - resetting
             G0:      -0.000000000000
   RMS gradient:       0.000000035455
     Trial step:       0.296348416926
             Q1:     -16.777798610123
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798610123
  Cubic LS coeff:       0.455689781230
Predicted energy:     -16.777798610123
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861012318-0.00000000000 0.00000005318 0.4557  0.000    8.00000000
      ideal mu1:      -0.514536044067
             Q0:     -16.777798610123
             G0:      -0.000000000000
   RMS gradient:       0.000000007258
     Trial step:       0.367481897890
             Q1:     -16.777798610123
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798610123
Quadratic minimum step length (  0.005383257746) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861012319 0.00000000000 0.00000001089 0.0054  0.042    8.00000000
      ideal mu1:      -0.514536044214
10    -16.77779861012328 0.00000000000 0.00000001078 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000355905294              |
           | Maximum change in energy =  0.00000000040167 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.40197572E-03     0.11891885E-03
               2       0.98947581E-07     0.28235744E-07
               3       0.80312139E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21481545E-03     0.63548009E-04
               2       0.28260426E-07     0.80643817E-08
               3       0.71822845E-14     0.28865799E-14
================================================================================
RMS gradient                =       0.00000355905294
Trial step length           =               0.001418
Gradient along search dir.  =         -0.00000104043
Functional at step 0        =     -16.77779861012328
Functional at step 1        =     -16.77779861001418
Functional predicted        =     -16.77779861046663
Selected quadratic step     =               0.000660
Conjugate gradients coeff.  =               0.910443
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  049 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998779
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514533942006
             Q0:     -16.777798610456
             G0:      -0.000000000941
   RMS gradient:       0.000002555795
     Trial step:       0.044477519865
             Q1:     -16.777798610496
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000042
           Qmin:     -16.777798610685
Quadratic minimum step length (  0.487675640617) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861045593 0.00000000000 0.00000383369 0.4877  0.000    8.00000000
      ideal mu1:      -0.514535484943
             Q0:     -16.777798610708
             G0:      -0.000000000060
   RMS gradient:       0.000000613875
     Trial step:       0.147277299653
             Q1:     -16.777798610716
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000009
           Qmin:     -16.777798610732
Quadratic minimum step length (  0.830951966432) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779861070757 0.00000000003 0.00000092081 0.8310  0.058    8.00000000
      ideal mu1:      -0.514537052540
             Q0:     -16.777798610723
             G0:      -0.000000000019
   RMS gradient:       0.000000479298
     Trial step:       0.349829046475
             Q1:     -16.777798610727
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000007
           Qmin:     -16.777798610727
Quadratic minimum step length (  0.440266150579) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861072267 0.00000000000 0.00000071895 0.4403  0.610    8.00000000
      ideal mu1:      -0.514536672016
             Q0:     -16.777798610726
             G0:      -0.000000000010
   RMS gradient:       0.000000274077
     Trial step:       0.392451127724
             Q1:     -16.777798610729
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798610729
Quadratic minimum step length (  0.467200245056) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861072632 0.00000000000 0.00000041112 0.4672  0.327    8.00000000
      ideal mu1:      -0.514536328583
             Q0:     -16.777798610729
             G0:      -0.000000000005
   RMS gradient:       0.000000184458
     Trial step:       0.428197691546
             Q1:     -16.777798610730
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798610730
Quadratic minimum step length (  0.409735031609) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861072871 0.00000000000 0.00000027669 0.4097  0.453    8.00000000
      ideal mu1:      -0.514536375321
             Q0:     -16.777798610729
             G0:      -0.000000000001
   RMS gradient:       0.000000092870
     Trial step:       0.418864649595
             Q1:     -16.777798610730
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798610730
Quadratic minimum step length (  0.728237880283) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861072934 0.00000000000 0.00000013930 0.7282  0.253    8.00000000
      ideal mu1:      -0.514536405351
             Q0:     -16.777798610730
             G0:      -0.000000000001
   RMS gradient:       0.000000096371
     Trial step:       0.552298021494
             Q1:     -16.777798610730
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798610730
Quadratic minimum step length (  0.245355457625) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861072963 0.00000000000 0.00000014456 0.2454  0.000    8.00000000
      ideal mu1:      -0.514536337056
             Q0:     -16.777798610730
             G0:      -0.000000000000
   RMS gradient:       0.000000037936
     Trial step:       0.368115924417
             Q1:     -16.777798610730
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798610730
Quadratic minimum step length (  0.070978209084) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779861073004 0.00000000000 0.00000005690 0.0710  0.155    8.00000000
      ideal mu1:      -0.514536334019
             Q0:     -16.777798610730
             G0:      -0.000000000000
   RMS gradient:       0.000000031915
     Trial step:       0.161642225456
             Q1:     -16.777798610730
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798610730
Quadratic minimum step length (  0.031183251666) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779861072994 0.00000000000 0.00000004787 0.0312  0.708    8.00000000
      ideal mu1:      -0.514536333771
10    -16.77779861073013 0.00000000000 0.00000004322 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000340063370              |
           | Maximum change in energy =  0.00000000028252 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.79055726E-04     0.23399409E-04
               2       0.38287867E-08     0.10928961E-08
               3       0.63107893E-14     0.20539126E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13708305E-03     0.40573030E-04
               2       0.11513990E-07     0.32865618E-08
               3       0.67499780E-14     0.23965205E-14
================================================================================
RMS gradient                =       0.00000340063370
Trial step length           =               0.000967
Gradient along search dir.  =         -0.00000034234
Functional at step 0        =     -16.77779861073013
Functional at step 1        =     -16.77779861100071
Functional predicted        =     -16.77779861118277
Selected quadratic step     =               0.002644
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  050 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998590
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514533907383
             Q0:     -16.777798611161
             G0:      -0.000000001267
   RMS gradient:       0.000002965947
     Trial step:       0.070996691445
             Q1:     -16.777798611245
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000090
           Qmin:     -16.777798611493
Quadratic minimum step length (  0.523060684956) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861116140 0.00000000000 0.00000444892 0.5231  0.000    8.00000000
      ideal mu1:      -0.514535813837
             Q0:     -16.777798611503
             G0:      -0.000000000074
   RMS gradient:       0.000000705436
     Trial step:       0.192705936745
             Q1:     -16.777798611515
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000014
           Qmin:     -16.777798611525
Quadratic minimum step length (  0.586949208451) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861150345 0.00000000004 0.00000105815 0.5869  0.057    8.00000000
      ideal mu1:      -0.514537047036
             Q0:     -16.777798611524
             G0:      -0.000000000019
   RMS gradient:       0.000000368157
     Trial step:       0.336316215839
             Q1:     -16.777798611529
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000006
           Qmin:     -16.777798611530
Quadratic minimum step length (  0.553439539474) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779861152449 0.00000000000 0.00000055224 0.5534  0.272    8.00000000
      ideal mu1:      -0.514536652340
             Q0:     -16.777798611529
             G0:      -0.000000000003
   RMS gradient:       0.000000141806
     Trial step:       0.431428663410
             Q1:     -16.777798611530
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798611530
Quadratic minimum step length (  0.431908727820) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861152933 0.00000000000 0.00000021271 0.4319  0.148    8.00000000
      ideal mu1:      -0.514536757843
             Q0:     -16.777798611530
             G0:      -0.000000000001
   RMS gradient:       0.000000058021
     Trial step:       0.431668628879
             Q1:     -16.777798611530
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798611530
  Cubic LS coeff:       0.584631268068
Predicted energy:     -16.777798611530
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779861152987 0.00000000000 0.00000008703 0.5846  0.167    8.00000000
      ideal mu1:      -0.514536762862
             Q0:     -16.777798611530
             G0:      -0.000000000000
   RMS gradient:       0.000000029372
     Trial step:       0.502361401669
             Q1:     -16.777798611530
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798611530
Quadratic minimum step length (  0.112973555419) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861153028 0.00000000000 0.00000004406 0.1130  0.256    8.00000000
      ideal mu1:      -0.514536744982
             Q0:     -16.777798611530
             G0:      -0.000000000000
   RMS gradient:       0.000000022006
     Trial step:       0.238230043555
             Q1:     -16.777798611530
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798611530
Quadratic minimum step length (  0.011850835128) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861153009 0.00000000000 0.00000003301 0.0119  0.000    8.00000000
      ideal mu1:      -0.514536743679
             Q0:     -16.777798611530
             G0:      -0.000000000000
   RMS gradient:       0.000000021313
     Trial step:       0.053134028350
             Q1:     -16.777798611530
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798611530
Quadratic minimum step length (  0.002224447463) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861153015 0.00000000000 0.00000003197 0.0022  0.938    8.00000000
      ideal mu1:      -0.514536743214
             Q0:     -16.777798611530
             G0:      -0.000000000000
   RMS gradient:       0.000000021066
     Trial step:       0.010871699709
             Q1:     -16.777798611530
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798611530
  Cubic LS coeff:       0.015102563692
Predicted energy:     -16.777798611530
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861153013 0.00000000000 0.00000003160 0.0151  0.977    8.00000000
      ideal mu1:      -0.514536738556
10    -16.77779861153009 0.00000000000 0.00000002791 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000321900561              |
           | Maximum change in energy =  0.00000000026665 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86827809132410 |
           | Pseudopotential (local)    :      -46.08685092365901 |
           | Pseudopotential (non-local):       -3.18864672836547 |
           | Hartree                    :       19.82063093570538 |
           | Exchange-correlation       :       -4.12705923450590 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779861153009 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08685092365953 |
           | Hartree                    :       19.82063093570578 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999909
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.24788287E-03     0.73369656E-04
               2       0.37661991E-07     0.10750856E-07
               3       0.68906016E-14     0.28865799E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.70328190E-04     0.20815425E-04
               2       0.30318955E-08     0.86546956E-09
               3       0.55665987E-14     0.17763568E-14
================================================================================
RMS gradient                =       0.00000321900561
Trial step length           =               0.001599
Gradient along search dir.  =         -0.00000053936
Functional at step 0        =     -16.77779861153009
Functional at step 1        =     -16.77779861179056
Functional predicted        =     -16.77779861183903
Selected quadratic step     =               0.001146
Conjugate gradients coeff.  =               0.896032
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  051 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99998842
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514534746080
             Q0:     -16.777798611829
             G0:      -0.000000000852
   RMS gradient:       0.000002432251
     Trial step:       0.012813685547
             Q1:     -16.777798611839
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000011
           Qmin:     -16.777798611898
Quadratic minimum step length (  0.161353150961) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861182882 0.00000000000 0.00000364838 0.1614  0.000    8.00000000
      ideal mu1:      -0.514535210345
             Q0:     -16.777798611946
             G0:      -0.000000000721
   RMS gradient:       0.000001715405
     Trial step:       0.045470083994
             Q1:     -16.777798611976
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000033
           Qmin:     -16.777798612070
Quadratic minimum step length (  0.345043774109) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861194550 0.00000000001 0.00000257311 0.3450  0.497    8.00000000
      ideal mu1:      -0.514536560212
             Q0:     -16.777798612063
             G0:      -0.000000000037
   RMS gradient:       0.000000534432
     Trial step:       0.125256414567
             Q1:     -16.777798612067
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000005
           Qmin:     -16.777798612071
Quadratic minimum step length (  0.439443487120) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779861206297 0.00000000003 0.00000080165 0.4394  0.097    8.00000000
      ideal mu1:      -0.514537167832
             Q0:     -16.777798612073
             G0:      -0.000000000014
   RMS gradient:       0.000000283462
     Trial step:       0.234612692755
             Q1:     -16.777798612075
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798612076
Quadratic minimum step length (  0.534834037053) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861207260 0.00000000000 0.00000042519 0.5348  0.281    8.00000000
      ideal mu1:      -0.514537086949
             Q0:     -16.777798612076
             G0:      -0.000000000002
   RMS gradient:       0.000000132351
     Trial step:       0.354229944542
             Q1:     -16.777798612077
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798612077
Quadratic minimum step length (  0.265826913031) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861207633 0.00000000000 0.00000019853 0.2658  0.218    8.00000000
      ideal mu1:      -0.514537021798
             Q0:     -16.777798612077
             G0:      -0.000000000001
   RMS gradient:       0.000000078627
     Trial step:       0.306861292216
             Q1:     -16.777798612077
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612077
Quadratic minimum step length (  0.437406677885) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861207668 0.00000000000 0.00000011794 0.4374  0.353    8.00000000
      ideal mu1:      -0.514536984149
             Q0:     -16.777798612077
             G0:      -0.000000000000
   RMS gradient:       0.000000046888
     Trial step:       0.366364815996
             Q1:     -16.777798612077
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798612077
  Cubic LS coeff:       0.425126348863
Predicted energy:     -16.777798612077
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861207691 0.00000000000 0.00000007033 0.4251  0.000    8.00000000
      ideal mu1:      -0.514537025504
             Q0:     -16.777798612077
             G0:      -0.000000000000
   RMS gradient:       0.000000016654
     Trial step:       0.394653438571
             Q1:     -16.777798612077
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798612077
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861207694 0.00000000000 0.00000002498 0.1500  0.126    8.00000000
      ideal mu1:      -0.514537015903
             Q0:     -16.777798612077
             G0:      -0.000000000000
   RMS gradient:       0.000000011677
     Trial step:       0.243306423642
             Q1:     -16.777798612077
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798612077
  Cubic LS coeff:       0.247215207868
Predicted energy:     -16.777798612077
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861207706 0.00000000000 0.00000001752 0.2472  0.492    8.00000000
      ideal mu1:      -0.514536996515
10    -16.77779861207717 0.00000000000 0.00000000679 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000306277381              |
           | Maximum change in energy =  0.00000000026665 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30059233E-03     0.88972807E-04
               2       0.55401296E-07     0.15815421E-07
               3       0.71036074E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15157570E-03     0.44863940E-04
               2       0.14088264E-07     0.40217691E-08
               3       0.64046074E-14     0.28865799E-14
================================================================================
RMS gradient                =       0.00000306277381
Trial step length           =               0.001354
Gradient along search dir.  =         -0.00000064934
Functional at step 0        =     -16.77779861207717
Functional at step 1        =     -16.77779861206958
Functional predicted        =     -16.77779861229503
Selected quadratic step     =               0.000671
Conjugate gradients coeff.  =               0.905287
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  052 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999028
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514535325028
             Q0:     -16.777798612288
             G0:      -0.000000000598
   RMS gradient:       0.000002038543
     Trial step:       0.245253028720
             Q1:     -16.777798612402
 Quadratic coef:       0.000000000033
 Linear coef   :      -0.000000000147
           Qmin:     -16.777798612451
Quadratic minimum step length (  0.544641966081) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861228782 0.00000000000 0.00000305781 0.5446  0.000    8.00000000
      ideal mu1:      -0.514536688244
             Q0:     -16.777798612450
             G0:      -0.000000000036
   RMS gradient:       0.000000500360
     Trial step:       0.365479263091
             Q1:     -16.777798612458
 Quadratic coef:       0.000000000005
 Linear coef   :      -0.000000000013
           Qmin:     -16.777798612459
Quadratic minimum step length (  0.527760899315) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779861244995 0.00000000002 0.00000075054 0.5278  0.060    8.00000000
      ideal mu1:      -0.514537414626
             Q0:     -16.777798612460
             G0:      -0.000000000008
   RMS gradient:       0.000000237532
     Trial step:       0.439187505025
             Q1:     -16.777798612462
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798612462
Quadratic minimum step length (  0.491435545313) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861245956 0.00000000000 0.00000035630 0.4914  0.225    8.00000000
      ideal mu1:      -0.514537207344
             Q0:     -16.777798612462
             G0:      -0.000000000001
   RMS gradient:       0.000000084442
     Trial step:       0.464577604956
             Q1:     -16.777798612462
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798612462
Quadratic minimum step length (  0.755149294316) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861246183 0.00000000000 0.00000012666 0.7551  0.126    8.00000000
      ideal mu1:      -0.514537261576
             Q0:     -16.777798612462
             G0:      -0.000000000000
   RMS gradient:       0.000000041450
     Trial step:       0.592305200498
             Q1:     -16.777798612463
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612464
WARNING in lnv_denskernel_optimise_cg: setting quadratic optimal_step to safe
value (Calculated optimal quadratic step= 11.590309254149)
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861246240 0.00000000000 0.00000006218 0.1500  0.000    8.00000000
      ideal mu1:      -0.514537262087
             Q0:     -16.777798612463
             G0:      -0.000000000000
   RMS gradient:       0.000000029578
     Trial step:       0.298070092553
             Q1:     -16.777798612463
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612463
Quadratic minimum step length (  0.099862752357) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861246266 0.00000000000 0.00000004437 0.0999  0.509    8.00000000
      ideal mu1:      -0.514537259277
             Q0:     -16.777798612463
             G0:      -0.000000000000
   RMS gradient:       0.000000019595
     Trial step:       0.172528547892
             Q1:     -16.777798612463
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612463
Quadratic minimum step length (  0.006649936361) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779861246276 0.00000000000 0.00000002939 0.0066  0.439    8.00000000
      ideal mu1:      -0.514537258975
             Q0:     -16.777798612463
             G0:      -0.000000000000
   RMS gradient:       0.000000019061
     Trial step:       0.033871874231
             Q1:     -16.777798612462
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612463
Quadratic minimum step length (  0.000348139810) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861246272 0.00000000000 0.00000002859 0.0003  0.946    8.00000000
      ideal mu1:      -0.514537258948
             Q0:     -16.777798612463
             G0:      -0.000000000000
   RMS gradient:       0.000000019021
     Trial step:       0.003433969695
             Q1:     -16.777798612463
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612463
Quadratic minimum step length (  0.000031458468) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779861246266 0.00000000000 0.00000002853 0.0000  0.996    8.00000000
      ideal mu1:      -0.514537258945
10    -16.77779861246266 0.00000000000 0.00000002852 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000292036185              |
           | Maximum change in energy =  0.00000000018236 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.27031998E-03     0.80015638E-04
               2       0.44815553E-07     0.12794091E-07
               3       0.61937526E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14430652E-03     0.42714266E-04
               2       0.12772403E-07     0.36462977E-08
               3       0.53744327E-14     0.17763568E-14
================================================================================
RMS gradient                =       0.00000292036185
Trial step length           =               0.000953
Gradient along search dir.  =         -0.00000070089
Functional at step 0        =     -16.77779861246266
Functional at step 1        =     -16.77779861241414
Functional predicted        =     -16.77779861261834
Selected quadratic step     =               0.000444
Conjugate gradients coeff.  =               0.909167
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  053 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999178
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514535845848
             Q0:     -16.777798612614
             G0:      -0.000000000429
   RMS gradient:       0.000001726043
     Trial step:       0.000328675259
             Q1:     -16.777798612614
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612614
Quadratic minimum step length (  0.002174142707) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861261378 0.00000000000 0.00000258906 0.0022  0.000    8.00000000
      ideal mu1:      -0.514535850347
             Q0:     -16.777798612615
             G0:      -0.000000000849
   RMS gradient:       0.000001719111
     Trial step:       0.000845332431
             Q1:     -16.777798612615
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798612616
Quadratic minimum step length (  0.003050945271) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779861261460 0.00000000000 0.00000257867 0.0031  0.992    8.00000000
      ideal mu1:      -0.514535862912
             Q0:     -16.777798612617
             G0:      -0.000000001237
   RMS gradient:       0.000001699787
     Trial step:       0.001605946133
             Q1:     -16.777798612619
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798612621
Quadratic minimum step length (  0.006702267011) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861261712 0.00000000000 0.00000254968 0.0067  0.978    8.00000000
      ideal mu1:      -0.514535903665
             Q0:     -16.777798612625
             G0:      -0.000000001492
   RMS gradient:       0.000001637364
     Trial step:       0.003280774266
             Q1:     -16.777798612630
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000005
           Qmin:     -16.777798612661
Quadratic minimum step length (  0.048080822933) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861262528 0.00000000000 0.00000245605 0.0481  0.928    8.00000000
      ideal mu1:      -0.514536271910
             Q0:     -16.777798612685
             G0:      -0.000000000602
   RMS gradient:       0.000001087005
     Trial step:       0.012559551210
             Q1:     -16.777798612692
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000008
           Qmin:     -16.777798612749
Quadratic minimum step length (  0.212299180475) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861268479 0.00000000002 0.00000163051 0.2123  0.441    8.00000000
      ideal mu1:      -0.514537344247
             Q0:     -16.777798612725
WARNING in lnv_denskernel_optimise_cg: positive line search gradient -
  resetting conjugate gradients
             G0:      -0.000000000056
   RMS gradient:       0.000000622329
     Trial step:       0.051637025756
             Q1:     -16.777798612727
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798612731
Quadratic minimum step length (  0.211397189533) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861272487 0.00000000003 0.00000093349 0.2114  0.328    8.00000000
      ideal mu1:      -0.514537455734
             Q0:     -16.777798612734
             G0:      -0.000000000016
   RMS gradient:       0.000000336767
     Trial step:       0.104479290391
             Q1:     -16.777798612735
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798612736
Quadratic minimum step length (  0.305969656934) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861273387 0.00000000000 0.00000050515 0.3060  0.000    8.00000000
      ideal mu1:      -0.514537458497
             Q0:     -16.777798612737
             G0:      -0.000000000005
   RMS gradient:       0.000000152817
     Trial step:       0.178794554273
             Q1:     -16.777798612738
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798612738
Quadratic minimum step length (  0.485045653026) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861273720 0.00000000000 0.00000022923 0.4850  0.206    8.00000000
      ideal mu1:      -0.514537414514
             Q0:     -16.777798612738
             G0:      -0.000000000001
   RMS gradient:       0.000000086793
     Trial step:       0.294488575899
             Q1:     -16.777798612738
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798612738
Quadratic minimum step length (  0.468856503492) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861273819 0.00000000000 0.00000013019 0.4689  0.323    8.00000000
      ideal mu1:      -0.514537405866
10    -16.77779861273856 0.00000000000 0.00000008460 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000275675523              |
           | Maximum change in energy =  0.00000000012850 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.53154255E-04     0.15739189E-04
               2       0.17333076E-08     0.49492474E-09
               3       0.56772387E-14     0.18717666E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.89844665E-04     0.26602643E-04
               2       0.49525193E-08     0.14141272E-08
               3       0.56363738E-14     0.24424907E-14
================================================================================
RMS gradient                =       0.00000275675523
Trial step length           =               0.000651
Gradient along search dir.  =         -0.00000022497
Functional at step 0        =     -16.77779861273856
Functional at step 1        =     -16.77779861285774
Functional predicted        =     -16.77779861293546
Selected quadratic step     =               0.001750
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  054 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999067
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514535803000
             Q0:     -16.777798612925
             G0:      -0.000000000579
   RMS gradient:       0.000002004835
     Trial step:       0.371581598057
             Q1:     -16.777798613066
 Quadratic coef:       0.000000000074
 Linear coef   :      -0.000000000215
           Qmin:     -16.777798613081
Quadratic minimum step length (  0.539477511078) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779861292505 0.00000000000 0.00000300725 0.5395  0.000    8.00000000
      ideal mu1:      -0.514537142499
             Q0:     -16.777798613081
             G0:      -0.000000000033
   RMS gradient:       0.000000482102
     Trial step:       0.447727501592
             Q1:     -16.777798613090
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000015
           Qmin:     -16.777798613091
Quadratic minimum step length (  0.552660435261) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861308140 0.00000000002 0.00000072315 0.5527  0.058    8.00000000
      ideal mu1:      -0.514537861047
             Q0:     -16.777798613091
             G0:      -0.000000000008
   RMS gradient:       0.000000238282
     Trial step:       0.497434695119
             Q1:     -16.777798613093
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798613093
Quadratic minimum step length (  0.564070042046) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861309066 0.00000000000 0.00000035742 0.5641  0.244    8.00000000
      ideal mu1:      -0.514537612966
             Q0:     -16.777798613093
             G0:      -0.000000000001
   RMS gradient:       0.000000091709
     Trial step:       0.529705587464
             Q1:     -16.777798613093
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798613093
Quadratic minimum step length (  0.578817636726) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861309303 0.00000000000 0.00000013756 0.5788  0.148    8.00000000
      ideal mu1:      -0.514537729496
             Q0:     -16.777798613093
             G0:      -0.000000000000
   RMS gradient:       0.000000030652
     Trial step:       0.553717379442
             Q1:     -16.777798613094
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613093
  Cubic LS coeff:       0.834028585760
Predicted energy:     -16.777798613094
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779861309321 0.00000000000 0.00000004598 0.8340  0.112    8.00000000
      ideal mu1:      -0.514537657284
             Q0:     -16.777798613094
             G0:      -0.000000000000
   RMS gradient:       0.000000013336
     Trial step:       0.679570542981
             Q1:     -16.777798613093
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613094
Quadratic minimum step length (  0.049673559873) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861309357 0.00000000000 0.00000002000 0.0497  0.189    8.00000000
      ideal mu1:      -0.514537658499
             Q0:     -16.777798613093
             G0:      -0.000000000000
   RMS gradient:       0.000000012479
     Trial step:       0.183729932386
             Q1:     -16.777798613093
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613093
  Cubic LS coeff:       0.199528882840
Predicted energy:     -16.777798613093
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861309345 0.00000000000 0.00000001872 0.1995  0.000    8.00000000
      ideal mu1:      -0.514537666157
             Q0:     -16.777798613093
             G0:      -0.000000000000
   RMS gradient:       0.000000007882
     Trial step:       0.191466519667
             Q1:     -16.777798613093
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613094
  Cubic LS coeff:       0.480426005447
Predicted energy:     -16.777798613094
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861309328 0.00000000000 0.00000001182 0.4804  0.399    8.00000000
      ideal mu1:      -0.514537684481
             Q0:     -16.777798613094
             G0:      -0.000000000000
   RMS gradient:       0.000000004783
     Trial step:       0.303291106398
             Q1:     -16.777798613094
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613093
  Cubic LS coeff:       0.279675891226
Predicted energy:     -16.777798613094
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779861309367 0.00000000000 0.00000000717 0.2797  0.368    8.00000000
      ideal mu1:      -0.514537684911
10    -16.77779861309362 0.00000000000 0.00000000604 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000265147173              |
           | Maximum change in energy =  0.00000000011835 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16785362E-03     0.49701885E-04
               2       0.17290358E-07     0.49372078E-08
               3       0.53758533E-14     0.17763568E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.47767257E-04     0.14143696E-04
               2       0.14003401E-08     0.39986328E-09
               3       0.59493893E-14     0.15543122E-14
================================================================================
RMS gradient                =       0.00000265147173
Trial step length           =               0.001067
Gradient along search dir.  =         -0.00000036934
Functional at step 0        =     -16.77779861309362
Functional at step 1        =     -16.77779861321231
Functional predicted        =     -16.77779861323462
Selected quadratic step     =               0.000763
Conjugate gradients coeff.  =               0.925076
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  055 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999217
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514536339204
             Q0:     -16.777798613230
             G0:      -0.000000000390
   RMS gradient:       0.000001645559
     Trial step:       0.291244245407
             Q1:     -16.777798613313
 Quadratic coef:       0.000000000030
 Linear coef   :      -0.000000000114
           Qmin:     -16.777798613336
Quadratic minimum step length (  0.543674073802) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861322987 0.00000000000 0.00000246834 0.5437  0.000    8.00000000
      ideal mu1:      -0.514537420598
             Q0:     -16.777798613335
             G0:      -0.000000000023
   RMS gradient:       0.000000403252
     Trial step:       0.397922034288
             Q1:     -16.777798613342
 Quadratic coef:       0.000000000003
 Linear coef   :      -0.000000000009
           Qmin:     -16.777798613342
Quadratic minimum step length (  0.616715674409) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861333532 0.00000000001 0.00000060488 0.6167  0.060    8.00000000
      ideal mu1:      -0.514538112874
             Q0:     -16.777798613342
             G0:      -0.000000000007
   RMS gradient:       0.000000229067
     Trial step:       0.495383443141
             Q1:     -16.777798613343
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000003
           Qmin:     -16.777798613343
Quadratic minimum step length (  0.409119106577) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861334198 0.00000000000 0.00000034360 0.4091  0.323    8.00000000
      ideal mu1:      -0.514537907334
             Q0:     -16.777798613343
             G0:      -0.000000000001
   RMS gradient:       0.000000080108
     Trial step:       0.450189772953
             Q1:     -16.777798613343
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613344
Quadratic minimum step length (  0.549151601099) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779861334322 0.00000000000 0.00000012016 0.5492  0.122    8.00000000
      ideal mu1:      -0.514537840097
             Q0:     -16.777798613344
             G0:      -0.000000000000
   RMS gradient:       0.000000052960
     Trial step:       0.497214676589
             Q1:     -16.777798613343
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613344
Quadratic minimum step length (  0.110998849900) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861334369 0.00000000000 0.00000007944 0.1110  0.437    8.00000000
      ideal mu1:      -0.514537851490
             Q0:     -16.777798613343
             G0:      -0.000000000000
   RMS gradient:       0.000000042001
     Trial step:       0.234926067635
             Q1:     -16.777798613344
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613344
  Cubic LS coeff:       0.319601193196
Predicted energy:     -16.777798613344
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861334346 0.00000000000 0.00000006300 0.3196  0.629    8.00000000
      ideal mu1:      -0.514537906662
             Q0:     -16.777798613344
             G0:      -0.000000000000
   RMS gradient:       0.000000022706
     Trial step:       0.274012137558
             Q1:     -16.777798613344
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613344
  Cubic LS coeff:       0.356928312732
Predicted energy:     -16.777798613344
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861334356 0.00000000000 0.00000003406 0.3569  0.000    8.00000000
      ideal mu1:      -0.514537864833
             Q0:     -16.777798613344
             G0:      -0.000000000000
   RMS gradient:       0.000000005222
     Trial step:       0.312734216111
             Q1:     -16.777798613344
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613344
Quadratic minimum step length (  0.006181329999) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 8    -16.77779861334366 0.00000000000 0.00000000783 0.0062  0.053    8.00000000
      ideal mu1:      -0.514537864924
             Q0:     -16.777798613344
             G0:      -0.000000000000
   RMS gradient:       0.000000005162
     Trial step:       0.043967185398
             Q1:     -16.777798613344
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613344
  Cubic LS coeff:       0.053375059724
Predicted energy:     -16.777798613344
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861334369 0.00000000000 0.00000000774 0.0534  0.977    8.00000000
      ideal mu1:      -0.514537866810
10    -16.77779861334356 0.00000000000 0.00000000612 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000251987116              |
           | Maximum change in energy =  0.00000000011835 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86828067452710 |
           | Pseudopotential (local)    :      -46.08684121104670 |
           | Pseudopotential (non-local):       -3.18865075997592 |
           | Hartree                    :       19.82062150694020 |
           | Exchange-correlation       :       -4.12705807175905 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779861334356 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08684121104748 |
           | Hartree                    :       19.82062150694068 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999927
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20199208E-03     0.59811222E-04
               2       0.25044607E-07     0.71516399E-08
               3       0.62454057E-14     0.22204460E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10134385E-03     0.30008058E-04
               2       0.63046846E-08     0.18003374E-08
               3       0.59642849E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000251987116
Trial step length           =               0.000903
Gradient along search dir.  =         -0.00000044136
Functional at step 0        =     -16.77779861334356
Functional at step 1        =     -16.77779861334217
Functional predicted        =     -16.77779861344282
Selected quadratic step     =               0.000450
Conjugate gradients coeff.  =               0.903197
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  056 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999344
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514536739246
             Q0:     -16.777798613440
             G0:      -0.000000000274
   RMS gradient:       0.000001379198
     Trial step:       0.048443277620
             Q1:     -16.777798613453
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000013
           Qmin:     -16.777798613492
Quadratic minimum step length (  0.378524999532) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861344023 0.00000000000 0.00000206880 0.3785  0.000    8.00000000
      ideal mu1:      -0.514537379126
             Q0:     -16.777798613508
             G0:      -0.000000000042
   RMS gradient:       0.000000476154
     Trial step:       0.135414148590
             Q1:     -16.777798613512
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000006
           Qmin:     -16.777798613518
Quadratic minimum step length (  0.486914515775) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861350754 0.00000000001 0.00000071423 0.4869  0.119    8.00000000
      ideal mu1:      -0.514538008949
             Q0:     -16.777798613518
             G0:      -0.000000000005
   RMS gradient:       0.000000184183
     Trial step:       0.256778337462
             Q1:     -16.777798613519
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798613519
Quadratic minimum step length (  0.447675298611) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861351786 0.00000000000 0.00000027627 0.4477  0.150    8.00000000
      ideal mu1:      -0.514538072819
             Q0:     -16.777798613519
             G0:      -0.000000000002
   RMS gradient:       0.000000095927
     Trial step:       0.339047664643
             Q1:     -16.777798613520
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798613521
Quadratic minimum step length (  2.089558680686) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861351912 0.00000000000 0.00000014389 2.0896  0.271    8.00000000
      ideal mu1:      -0.514537925093
             Q0:     -16.777798613515
WARNING in lnv_denskernel_optimise_cg: 
  conjugate gradient coefficient ( 0.105E+02) too large - resetting
             G0:      -0.000000000014
   RMS gradient:       0.000000310897
     Trial step:       0.841700653927
             Q1:     -16.777798613518
 Quadratic coef:       0.000000000009
 Linear coef   :      -0.000000000012
           Qmin:     -16.777798613519
Quadratic minimum step length (  0.552898996556) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779861351533 0.00000000000 0.00000046634 0.5529  0.000    8.00000000
      ideal mu1:      -0.514538167686
             Q0:     -16.777798613519
             G0:      -0.000000000001
   RMS gradient:       0.000000084859
     Trial step:       0.682184320369
             Q1:     -16.777798613519
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798613519
Quadratic minimum step length (  0.534789394656) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861351898 0.00000000000 0.00000012729 0.5348  0.075    8.00000000
      ideal mu1:      -0.514538016267
             Q0:     -16.777798613519
             G0:      -0.000000000000
   RMS gradient:       0.000000042378
     Trial step:       0.604007400396
             Q1:     -16.777798613519
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613519
Quadratic minimum step length (  0.307886325855) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861351942 0.00000000000 0.00000006357 0.3079  0.249    8.00000000
      ideal mu1:      -0.514538022591
             Q0:     -16.777798613520
             G0:      -0.000000000000
   RMS gradient:       0.000000023451
     Trial step:       0.431237312042
             Q1:     -16.777798613520
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613520
  Cubic LS coeff:       0.571615898146
Predicted energy:     -16.777798613520
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861351959 0.00000000000 0.00000003518 0.5716  0.306    8.00000000
      ideal mu1:      -0.514538056297
             Q0:     -16.777798613519
             G0:      -0.000000000000
   RMS gradient:       0.000000015776
     Trial step:       0.496489781805
             Q1:     -16.777798613520
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613520
  Cubic LS coeff:       0.963997159422
Predicted energy:     -16.777798613520
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861351947 0.00000000000 0.00000002366 0.9640  0.453    8.00000000
      ideal mu1:      -0.514538021923
10    -16.77779861351969 0.00000000000 0.00000002715 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000239925869              |
           | Maximum change in energy =  0.00000000008331 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18131798E-03     0.53690905E-04
               2       0.20183673E-07     0.57637475E-08
               3       0.54087540E-14     0.13860441E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.96356570E-04     0.28532159E-04
               2       0.57003310E-08     0.16278117E-08
               3       0.64611656E-14     0.24589705E-14
================================================================================
RMS gradient                =       0.00000239925869
Trial step length           =               0.000637
Gradient along search dir.  =         -0.00000047348
Functional at step 0        =     -16.77779861351969
Functional at step 1        =     -16.77779861349945
Functional predicted        =     -16.77779861359037
Selected quadratic step     =               0.000299
Conjugate gradients coeff.  =               0.906562
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  057 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999446
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514537070275
             Q0:     -16.777798613589
             G0:      -0.000000000196
   RMS gradient:       0.000001166424
     Trial step:       0.691819874926
             Q1:     -16.777798613638
 Quadratic coef:       0.000000000086
 Linear coef   :      -0.000000000136
           Qmin:     -16.777798613642
Quadratic minimum step length (  0.544560258816) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861358867 0.00000000000 0.00000174964 0.5446  0.000    8.00000000
      ideal mu1:      -0.514537866683
             Q0:     -16.777798613642
             G0:      -0.000000000012
   RMS gradient:       0.000000283979
     Trial step:       0.613789548741
             Q1:     -16.777798613645
 Quadratic coef:       0.000000000004
 Linear coef   :      -0.000000000007
           Qmin:     -16.777798613645
Quadratic minimum step length (  0.580449696342) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861364209 0.00000000001 0.00000042597 0.5804  0.059    8.00000000
      ideal mu1:      -0.514538300665
             Q0:     -16.777798613646
             G0:      -0.000000000003
   RMS gradient:       0.000000145908
     Trial step:       0.596886888099
             Q1:     -16.777798613646
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798613646
Quadratic minimum step length (  0.476404890164) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779861364558 0.00000000000 0.00000021886 0.4764  0.264    8.00000000
      ideal mu1:      -0.514538158848
             Q0:     -16.777798613646
             G0:      -0.000000000000
   RMS gradient:       0.000000049947
     Trial step:       0.533254003609
             Q1:     -16.777798613646
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613646
Quadratic minimum step length (  0.237895679394) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861364635 0.00000000000 0.00000007492 0.2379  0.117    8.00000000
      ideal mu1:      -0.514538167430
             Q0:     -16.777798613646
             G0:      -0.000000000000
   RMS gradient:       0.000000033926
     Trial step:       0.356172463111
             Q1:     -16.777798613646
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613647
Quadratic minimum step length (  0.097268780083) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779861364650 0.00000000000 0.00000005089 0.0973  0.461    8.00000000
      ideal mu1:      -0.514538173281
             Q0:     -16.777798613647
             G0:      -0.000000000000
   RMS gradient:       0.000000026942
     Trial step:       0.186130225879
             Q1:     -16.777798613646
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613647
Quadratic minimum step length (  0.018093015128) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861364657 0.00000000000 0.00000004041 0.0181  0.631    8.00000000
      ideal mu1:      -0.514538174348
             Q0:     -16.777798613646
             G0:      -0.000000000000
   RMS gradient:       0.000000025577
     Trial step:       0.058031517235
             Q1:     -16.777798613646
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613646
  Cubic LS coeff:       0.088612221105
Predicted energy:     -16.777798613646
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 7    -16.77779861364638 0.00000000000 0.00000003837 0.0886  0.000    8.00000000
      ideal mu1:      -0.514538175807
             Q0:     -16.777798613647
             G0:      -0.000000000000
   RMS gradient:       0.000000022946
     Trial step:       0.071709843371
             Q1:     -16.777798613646
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613647
Quadratic minimum step length (  0.003250191787) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861364655 0.00000000000 0.00000003442 0.0033  0.805    8.00000000
      ideal mu1:      -0.514538175878
             Q0:     -16.777798613646
             G0:      -0.000000000000
   RMS gradient:       0.000000022787
     Trial step:       0.015266654642
             Q1:     -16.777798613646
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613646
  Cubic LS coeff:       0.079149627702
Predicted energy:     -16.777798613647
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861364637 0.00000000000 0.00000003418 0.0791  0.986    8.00000000
      ideal mu1:      -0.514538178232
10    -16.77779861364635 0.00000000000 0.00000002588 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000230259883              |
           | Maximum change in energy =  0.00000000005871 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.35619464E-04     0.10549865E-04
               2       0.77907576E-09     0.22250499E-09
               3       0.64533868E-14     0.28865799E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63894228E-04     0.18923997E-04
               2       0.25070156E-08     0.71600564E-09
               3       0.63257031E-14     0.32708211E-14
================================================================================
RMS gradient                =       0.00000230259883
Trial step length           =               0.000436
Gradient along search dir.  =         -0.00000015695
Functional at step 0        =     -16.77779861364635
Functional at step 1        =     -16.77779861370255
Functional predicted        =     -16.77779861374197
Selected quadratic step     =               0.001218
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  058 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999351
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514537063797
             Q0:     -16.777798613737
             G0:      -0.000000000268
   RMS gradient:       0.000001363940
     Trial step:       0.034761329536
             Q1:     -16.777798613746
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000009
           Qmin:     -16.777798613850
Quadratic minimum step length (  0.843648553343) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779861373734 0.00000000000 0.00000204591 0.8436  0.000    8.00000000
      ideal mu1:      -0.514538453711
             Q0:     -16.777798613787
             G0:      -0.000000000054
   RMS gradient:       0.000000925862
     Trial step:       0.171249366059
             Q1:     -16.777798613796
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000009
           Qmin:     -16.777798613807
Quadratic minimum step length (  0.708092204032) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861378733 0.00000000001 0.00000138879 0.7081  0.461    8.00000000
      ideal mu1:      -0.514539253746
             Q0:     -16.777798613804
             G0:      -0.000000000045
   RMS gradient:       0.000000580278
     Trial step:       0.348224555498
             Q1:     -16.777798613813
 Quadratic coef:       0.000000000006
 Linear coef   :      -0.000000000016
           Qmin:     -16.777798613814
Quadratic minimum step length (  0.452447618129) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 3    -16.77779861380361 0.00000000000 0.00000087042 0.4524  0.393    8.00000000
      ideal mu1:      -0.514538472417
             Q0:     -16.777798613814
             G0:      -0.000000000006
   RMS gradient:       0.000000200147
     Trial step:       0.396929931737
             Q1:     -16.777798613815
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798613816
Quadratic minimum step length (  0.508290242697) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861381403 0.00000000000 0.00000030022 0.5083  0.119    8.00000000
      ideal mu1:      -0.514538303943
             Q0:     -16.777798613815
             G0:      -0.000000000001
   RMS gradient:       0.000000094716
     Trial step:       0.449172139982
             Q1:     -16.777798613816
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798613816
Quadratic minimum step length (  0.293957336520) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 5    -16.77779861381545 0.00000000000 0.00000014207 0.2940  0.224    8.00000000
      ideal mu1:      -0.514538341330
             Q0:     -16.777798613816
             G0:      -0.000000000000
   RMS gradient:       0.000000046045
     Trial step:       0.363369572072
             Q1:     -16.777798613816
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613816
  Cubic LS coeff:       0.523014359848
Predicted energy:     -16.777798613816
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861381554 0.00000000000 0.00000006907 0.5230  0.236    8.00000000
      ideal mu1:      -0.514538361213
             Q0:     -16.777798613816
             G0:      -0.000000000000
   RMS gradient:       0.000000034072
     Trial step:       0.435944381918
             Q1:     -16.777798613816
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613816
WARNING in lnv_denskernel_optimise_cg: line search unsuccessful -
  optimal step length set to safe value
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861381576 0.00000000000 0.00000005111 0.1500  0.000    8.00000000
      ideal mu1:      -0.514538343779
             Q0:     -16.777798613816
             G0:      -0.000000000000
   RMS gradient:       0.000000020881
     Trial step:       0.255717925237
             Q1:     -16.777798613816
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613816
  Cubic LS coeff:       0.346556266537
Predicted energy:     -16.777798613816
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861381583 0.00000000000 0.00000003132 0.3466  0.376    8.00000000
      ideal mu1:      -0.514538310569
             Q0:     -16.777798613816
             G0:      -0.000000000000
   RMS gradient:       0.000000015127
     Trial step:       0.297692205905
             Q1:     -16.777798613816
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613816
Quadratic minimum step length (  0.022675073639) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861381587 0.00000000000 0.00000002269 0.0227  0.525    8.00000000
      ideal mu1:      -0.514538311125
10    -16.77779861381586 0.00000000000 0.00000002244 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000218508738              |
           | Maximum change in energy =  0.00000000005650 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11315985E-03     0.33515871E-04
               2       0.78648070E-08     0.22462507E-08
               3       0.65696637E-14     0.26645353E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31091515E-04     0.92085977E-05
               2       0.59375601E-09     0.16958129E-09
               3       0.69250153E-14     0.24424907E-14
================================================================================
RMS gradient                =       0.00000218508738
Trial step length           =               0.000729
Gradient along search dir.  =         -0.00000024877
Functional at step 0        =     -16.77779861381586
Functional at step 1        =     -16.77779861387219
Functional predicted        =     -16.77779861388163
Selected quadratic step     =               0.000529
Conjugate gradients coeff.  =               0.900536
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  059 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999465
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514537392285
             Q0:     -16.777798613879
             G0:      -0.000000000182
   RMS gradient:       0.000001122742
     Trial step:       0.082159556295
             Q1:     -16.777798613893
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000015
           Qmin:     -16.777798613939
Quadratic minimum step length (  0.660705931509) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861387937 0.00000000000 0.00000168411 0.6607  0.000    8.00000000
      ideal mu1:      -0.514538341836
             Q0:     -16.777798613926
             G0:      -0.000000000019
   RMS gradient:       0.000000409674
     Trial step:       0.232987781169
             Q1:     -16.777798613930
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798613930
Quadratic minimum step length (  0.377100739164) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861392649 0.00000000001 0.00000061451 0.3771  0.133    8.00000000
      ideal mu1:      -0.514538586407
             Q0:     -16.777798613931
             G0:      -0.000000000006
   RMS gradient:       0.000000182812
     Trial step:       0.296411647030
             Q1:     -16.777798613932
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000002
           Qmin:     -16.777798613932
Quadratic minimum step length (  0.452592305283) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861393099 0.00000000000 0.00000027422 0.4526  0.199    8.00000000
      ideal mu1:      -0.514538496038
             Q0:     -16.777798613932
             G0:      -0.000000000001
   RMS gradient:       0.000000073386
     Trial step:       0.366269887708
             Q1:     -16.777798613932
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613932
  Cubic LS coeff:       0.528761645779
Predicted energy:     -16.777798613933
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 4    -16.77779861393189 0.00000000000 0.00000011008 0.5288  0.161    8.00000000
      ideal mu1:      -0.514538415315
             Q0:     -16.777798613932
             G0:      -0.000000000000
   RMS gradient:       0.000000044507
     Trial step:       0.440078934538
             Q1:     -16.777798613932
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613933
  Cubic LS coeff:       0.780242767765
Predicted energy:     -16.777798613932
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861393230 0.00000000000 0.00000006676 0.7802  0.368    8.00000000
      ideal mu1:      -0.514538496369
             Q0:     -16.777798613932
             G0:      -0.000000000000
   RMS gradient:       0.000000027980
     Trial step:       0.585976455089
             Q1:     -16.777798613932
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613932
  Cubic LS coeff:       0.938933253904
Predicted energy:     -16.777798613932
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861393232 0.00000000000 0.00000004197 0.9389  0.395    8.00000000
      ideal mu1:      -0.514538448811
             Q0:     -16.777798613932
             G0:      -0.000000000000
   RMS gradient:       0.000000023968
     Trial step:       0.741749809362
             Q1:     -16.777798613933
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613932
  Cubic LS coeff:       0.975621869910
Predicted energy:     -16.777798613933
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861393234 0.00000000000 0.00000003595 0.9756  0.000    8.00000000
      ideal mu1:      -0.514538482593
             Q0:     -16.777798613932
             G0:      -0.000000000000
   RMS gradient:       0.000000027830
     Trial step:       0.850686391107
             Q1:     -16.777798613933
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798613932
  Cubic LS coeff:       1.145399974111
Predicted energy:     -16.777798613933
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861393234 0.00000000000 0.00000004175 1.1454  1.348    8.00000000
      ideal mu1:      -0.514538515677
             Q0:     -16.777798613932
             G0:      -0.000000000000
   RMS gradient:       0.000000034501
     Trial step:       0.987104943940
             Q1:     -16.777798613932
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798613932
Quadratic minimum step length (  0.213792756403) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779861393241 0.00000000000 0.00000005175 0.2138  1.537    8.00000000
      ideal mu1:      -0.514538499639
10    -16.77779861393248 0.00000000000 0.00000004027 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000205521466              |
           | Maximum change in energy =  0.00000000005650 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13596341E-03     0.40270324E-04
               2       0.11355794E-07     0.32433776E-08
               3       0.65743720E-14     0.21094237E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68207831E-04     0.20201893E-04
               2       0.28579681E-08     0.81627560E-09
               3       0.58440553E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000205521466
Trial step length           =               0.000621
Gradient along search dir.  =         -0.00000028967
Functional at step 0        =     -16.77779861393248
Functional at step 1        =     -16.77779861393188
Functional predicted        =     -16.77779861397729
Selected quadratic step     =               0.000309
Conjugate gradients coeff.  =               0.884661
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  060 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999558
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514537741164
             Q0:     -16.777798613976
             G0:      -0.000000000128
   RMS gradient:       0.000000940991
     Trial step:       0.459386424292
             Q1:     -16.777798614010
 Quadratic coef:       0.000000000025
 Linear coef   :      -0.000000000059
           Qmin:     -16.777798614010
Quadratic minimum step length (  0.536255674854) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 1    -16.77779861397610 0.00000000000 0.00000141149 0.5363  0.000    8.00000000
      ideal mu1:      -0.514538299095
             Q0:     -16.777798614011
             G0:      -0.000000000008
   RMS gradient:       0.000000231068
     Trial step:       0.496335145822
             Q1:     -16.777798614013
 Quadratic coef:       0.000000000002
 Linear coef   :      -0.000000000004
           Qmin:     -16.777798614013
Quadratic minimum step length (  0.562725069373) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 2    -16.77779861401057 0.00000000000 0.00000034660 0.5627  0.060    8.00000000
      ideal mu1:      -0.514538676447
             Q0:     -16.777798614012
             G0:      -0.000000000002
   RMS gradient:       0.000000119299
     Trial step:       0.528488627470
             Q1:     -16.777798614013
 Quadratic coef:       0.000000000001
 Linear coef   :      -0.000000000001
           Qmin:     -16.777798614013
Quadratic minimum step length (  0.498438018066) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861401228 0.00000000000 0.00000017895 0.4984  0.267    8.00000000
      ideal mu1:      -0.514538565072
             Q0:     -16.777798614013
             G0:      -0.000000000000
   RMS gradient:       0.000000040399
     Trial step:       0.513243435464
             Q1:     -16.777798614013
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798614013
  Cubic LS coeff:       0.645697250578
Predicted energy:     -16.777798614013
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779861401298 0.00000000000 0.00000006060 0.6457  0.115    8.00000000
      ideal mu1:      -0.514538583221
             Q0:     -16.777798614013
             G0:      -0.000000000000
   RMS gradient:       0.000000016616
     Trial step:       0.575673410152
             Q1:     -16.777798614013
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614013
Quadratic minimum step length (  0.045325556304) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861401315 0.00000000000 0.00000002492 0.0453  0.169    8.00000000
      ideal mu1:      -0.514538583178
             Q0:     -16.777798614013
             G0:      -0.000000000000
   RMS gradient:       0.000000015194
     Trial step:       0.161532404070
             Q1:     -16.777798614013
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614013
Quadratic minimum step length (  0.005763143128) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 6    -16.77779861401313 0.00000000000 0.00000002279 0.0058  0.836    8.00000000
      ideal mu1:      -0.514538583129
             Q0:     -16.777798614013
             G0:      -0.000000000000
   RMS gradient:       0.000000014872
     Trial step:       0.030511217028
             Q1:     -16.777798614013
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614013
Quadratic minimum step length (  0.000198706097) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861401304 0.00000000000 0.00000002231 0.0002  0.000    8.00000000
      ideal mu1:      -0.514538583127
             Q0:     -16.777798614013
             G0:      -0.000000000000
   RMS gradient:       0.000000014866
     Trial step:       0.002462268235
             Q1:     -16.777798614013
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798614013
  Cubic LS coeff:       0.003589102054
Predicted energy:     -16.777798614013
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861401299 0.00000000000 0.00000002230 0.0036  0.999    8.00000000
      ideal mu1:      -0.514538583070
             Q0:     -16.777798614013
             G0:      -0.000000000000
   RMS gradient:       0.000000014657
     Trial step:       0.002972765039
             Q1:     -16.777798614013
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614013
Quadratic minimum step length (  0.000002788582) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 9    -16.77779861401320 0.00000000000 0.00000002199 0.0000  0.972    8.00000000
      ideal mu1:      -0.514538583070
10    -16.77779861401316 0.00000000000 0.00000002199 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000197869425              |
           | Maximum change in energy =  0.00000000003887 / atom  |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86828202648270 |
           | Pseudopotential (local)    :      -46.08683496613637 |
           | Pseudopotential (non-local):       -3.18865312253189 |
           | Hartree                    :       19.82061551710921 |
           | Exchange-correlation       :       -4.12705731690760 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779861401316 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08683496613708 |
           | Hartree                    :       19.82061551710944 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999893
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12476027E-03     0.36952761E-04
               2       0.95625965E-08     0.27312723E-08
               3       0.61645295E-14     0.19055937E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66500659E-04     0.19696636E-04
               2       0.27169900E-08     0.77602616E-09
               3       0.63828724E-14     0.25526456E-14
================================================================================
RMS gradient                =       0.00000197869425
Trial step length           =               0.000438
Gradient along search dir.  =         -0.00000032298
Functional at step 0        =     -16.77779861401316
Functional at step 1        =     -16.77779861400314
Functional predicted        =     -16.77779861404620
Selected quadratic step     =               0.000205
Conjugate gradients coeff.  =               0.926922
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "water.tightbox_ngwfs"....  done

################################################################################
########################### NGWF CG iteration  061 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:       7.99999620
     Final electron number for spin 1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.514537930978
             Q0:     -16.777798614046
             G0:      -0.000000000092
   RMS gradient:       0.000000798465
     Trial step:       0.000091048331
             Q1:     -16.777798614046
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614046
Quadratic minimum step length (  0.000003967015) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -16.77779861404571 0.00000000000 0.00000119770 0.0000  0.000    8.00000000
      ideal mu1:      -0.514537930982
             Q0:     -16.777798614046
             G0:      -0.000000000184
   RMS gradient:       0.000000798459
     Trial step:       0.000019005003
             Q1:     -16.777798614046
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614046
Quadratic minimum step length (  0.000002333359) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -16.77779861404575 0.00000000000 0.00000119769 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930986
             Q0:     -16.777798614046
             G0:      -0.000000000275
   RMS gradient:       0.000000798452
     Trial step:       0.000006659242
             Q1:     -16.777798614046
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614046
Quadratic minimum step length (  0.000000122775) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 3    -16.77779861404566 0.00000000000 0.00000119768 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930987
             Q0:     -16.777798614046
             G0:      -0.000000000367
   RMS gradient:       0.000000798451
     Trial step:       0.000000904205
             Q1:     -16.777798614046
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614046
Quadratic minimum step length (  0.000000007042) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 4    -16.77779861404560 0.00000000000 0.00000119768 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930987
             Q0:     -16.777798614046
             G0:      -0.000000000459
   RMS gradient:       0.000000798451
     Trial step:       0.000000079797
             Q1:     -16.777798614046
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798614046
  Cubic LS coeff:       0.000000105958
Predicted energy:     -16.777798614046
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 5    -16.77779861404562 0.00000000000 0.00000119768 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930987
             Q0:     -16.777798614046
             G0:      -0.000000000551
   RMS gradient:       0.000000798451
     Trial step:       0.000000091952
             Q1:     -16.777798614046
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798614046
  Cubic LS coeff:       0.000000079442
Predicted energy:     -16.777798614046
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

 6    -16.77779861404574 0.00000000000 0.00000119768 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930988
             Q0:     -16.777798614046
             G0:      -0.000000000092
   RMS gradient:       0.000000798450
     Trial step:       0.000000085468
             Q1:     -16.777798614046
 Quadratic coef:      -0.000000000000
 Linear coef   :      -0.000000000000
         Quadratic fit unsuccessful: proceeding to cubic fit
             Q2:     -16.777798614046
  Cubic LS coeff:       0.000000124886
Predicted energy:     -16.777798614046
Cubic minimum step length accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 7    -16.77779861404564 0.00000000000 0.00000119767 0.0000  0.000    8.00000000
      ideal mu1:      -0.514537930988
             Q0:     -16.777798614046
             G0:      -0.000000000184
   RMS gradient:       0.000000798450
     Trial step:       0.000000103314
             Q1:     -16.777798614046
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614046
Quadratic minimum step length (  0.000000000020) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 8    -16.77779861404571 0.00000000000 0.00000119767 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930988
             Q0:     -16.777798614046
             G0:      -0.000000000275
   RMS gradient:       0.000000798450
     Trial step:       0.000000001427
             Q1:     -16.777798614046
 Quadratic coef:       0.000000000000
 Linear coef   :      -0.000000000000
           Qmin:     -16.777798614046
Quadratic minimum step length (  0.000000000000) accepted
    Initial Ne1:       8.00000000
      Final Ne1:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      8.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=      8.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 9    -16.77779861404571 0.00000000000 0.00000119767 0.0000  1.000    8.00000000
      ideal mu1:      -0.514537930988
10    -16.77779861404571 0.00000000000 0.00000119767 0.0000  0.000    8.00000000
Finished density kernel iterations (  10)

Writing density kernel to file "water.dkn" ... done

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000082444440              |
           | Maximum change in energy =  0.00000000002689 / atom  |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           | -> Energy change per atom lower than set threshold.  |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.86828560388940 |
           | Pseudopotential (local)    :      -46.08684292838228 |
           | Pseudopotential (non-local):       -3.18865319823003 |
           | Hartree                    :       19.82062106820824 |
           | Exchange-correlation       :       -4.12705840750185 |
           | Ewald                      :        5.93584924797081 |
           | Total                      :      -16.77779861404571 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -46.08684292838277 |
           | Hartree                    :       19.82062106820861 |
           --------------------------------------------------------
           Integrated density           :        7.99999999999902
           Integrated density tr(KS)    :        8.00000000000000
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.00768487867876    -16.54955512871712   0.233803    -16.75393100762741
   2     0.00162450367882    -16.75696893045209   0.359422    -16.77123139851565
   3     0.00081234211273    -16.77160481355740   0.405355    -16.77565480159325
   4     0.00049514356838    -16.77569951575120   0.396384    -16.77714915524564
   5     0.00026714415077    -16.77715651473031   0.326049    -16.77750092833125
   6     0.00016298319336    -16.77750203243908   0.421354    -16.77766816691135
   7     0.00010377599238    -16.77767109618789   0.315446    -16.77772231616303
   8     0.00006613138760    -16.77772691000690   0.266185    -16.77774571935666
   9     0.00006367491946    -16.77775107875957   0.425355    -16.77777660539929
  10     0.00004291774301    -16.77778362949372   0.178401    -16.77778982410670
  11     0.00002102150956    -16.77779242818468   0.072119    -16.77779315196072
  12     0.00001916424209    -16.77779353528758   0.031034    -16.77779384100812
  13     0.00001913111669    -16.77779402029717   0.082426    -16.77779446682810
  14     0.00001904775468    -16.77779475978183   0.034244    -16.77779506428865
  15     0.00001892085373    -16.77779526702537   0.019387    -16.77779548295410
  16     0.00001874393624    -16.77779562830449   0.012579    -16.77779578621517
  17     0.00001852712278    -16.77779589343119   0.077756    -16.77779628848303
  18     0.00001738432173    -16.77779656496936   0.032844    -16.77779681466032
  19     0.00001643532133    -16.77779699061215   0.018655    -16.77779715446691
  20     0.00001563117646    -16.77779727057605   0.012018    -16.77779738165708
  21     0.00001493912189    -16.77779746074776   0.050318    -16.77779762696749
  22     0.00001393726543    -16.77779774746671   0.021563    -16.77779785437978
  23     0.00001310617420    -16.77779793218086   0.012373    -16.77779800308781
  24     0.00001240588422    -16.77779805484951   0.008026    -16.77779810318815
  25     0.00001180774593    -16.77779813857140   0.031398    -16.77779820336580
  26     0.00001106712459    -16.77779825128571   0.013576    -16.77779829408458
  27     0.00001044146589    -16.77779832581442   0.007856    -16.77779835481842
  28     0.00000990597967    -16.77779837636200   0.005133    -16.77779839647280
  29     0.00000944375621    -16.77779841143612   0.020093    -16.77779843796059
  30     0.00000888422682    -16.77779845780848   0.008729    -16.77779847562801
  31     0.00000840409960    -16.77779848898822   0.005078    -16.77779850124112
  32     0.00000798957063    -16.77779851044006   0.003334    -16.77779851903799
  33     0.00000762828818    -16.77779852550084   0.013123    -16.77779853680411
  34     0.00000719303502    -16.77779854532443   0.005716    -16.77779855299514
  35     0.00000681759050    -16.77779855878857   0.003335    -16.77779856411261
  36     0.00000649058211    -16.77779856813831   0.002196    -16.77779857190420
  37     0.00000620814322    -16.77779857475478   0.008706    -16.77779857972105
  38     0.00000585857425    -16.77779858347670   0.003793    -16.77779858685833
  39     0.00000555900104    -16.77779858942560   0.002217    -16.77779859178589
  40     0.00000529923927    -16.77779859357999   0.001462    -16.77779859525941
  41     0.00000506998546    -16.77779859653582   0.005828    -16.77779859875336
  42     0.00000478957686    -16.77779860043700   0.002534    -16.77779860194840
  43     0.00000454839229    -16.77779860310015   0.001483    -16.77779860415935
  44     0.00000433484915    -16.77779860496814   0.000980    -16.77779860572244
  45     0.00000415571091    -16.77779860630007   0.003936    -16.77779860730608
  46     0.00000392577952    -16.77779860807074   0.001705    -16.77779860875368
  47     0.00000372999398    -16.77779860927574   0.000998    -16.77779860975555
  48     0.00000355905294    -16.77779861012328   0.000660    -16.77779861046663
  49     0.00000340063370    -16.77779861073013   0.002644    -16.77779861118277
  50     0.00000321900561    -16.77779861153009   0.001146    -16.77779861183903
  51     0.00000306277381    -16.77779861207717   0.000671    -16.77779861229503
  52     0.00000292036185    -16.77779861246266   0.000444    -16.77779861261834
  53     0.00000275675523    -16.77779861273856   0.001750    -16.77779861293546
  54     0.00000265147173    -16.77779861309362   0.000763    -16.77779861323462
  55     0.00000251987116    -16.77779861334356   0.000450    -16.77779861344282
  56     0.00000239925869    -16.77779861351969   0.000299    -16.77779861359037
  57     0.00000230259883    -16.77779861364635   0.001218    -16.77779861374197
  58     0.00000218508738    -16.77779861381586   0.000529    -16.77779861388163
  59     0.00000205521466    -16.77779861393248   0.000309    -16.77779861397729
  60     0.00000197869425    -16.77779861401316   0.000205    -16.77779861404620
  61     0.00000082444440    -16.77779861404571  <-- CG                         
 
===================== Density of States (DOS) calculation ======================
Writing "water_DOS.txt" ...  done
================================================================================
 
Writing bands to file "water.val_bands" ... done

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      12
   Number of occupied orbitals:       4
                 Occupancy sum:       4.000000000
                 HOMO-LUMO gap:       0.262156960 Eh
                 Mid-gap level:      -0.129209210 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.968644597   1.0000000
                            2    -0.471031392   1.0000000
                            3    -0.358188045   1.0000000
                            4    -0.260287690   1.0000000
                        .......   --- gap ---   .........
                            5     0.001869270   0.0000000
                            6     0.093688307   0.0000000
                            7     0.212419759   0.0000000
                            8     0.246785105   0.0000000
                            9     0.262779375   0.0000000
                           10     0.308070581   0.0000000
                        .......   ...........   .........
                           12     0.468520676   0.0000000

================================================================================

********************* Unconstrained **********************
********************* Ewald forces  **********************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -2.30074936   0.13293069   0.13450602 *
*    H       2      1.16935963  -0.93070254   1.14015809 *
*    H       3      1.13138973   0.79777185  -1.27466411 *
*                                                        *
**********************************************************
TOTAL:             -0.00000000   0.00000000  -0.00000000
 
********************* Unconstrained **********************
***************** Local potential forces *****************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      1.49573831  -0.08664818  -0.08344823 *
*    H       2     -1.16851744   0.92141443  -1.13057828 *
*    H       3     -1.12832203  -0.78656916   1.26641809 *
*                                                        *
**********************************************************
TOTAL:             -0.80110116   0.04819708   0.05239158
********************* Unconstrained **********************
*************** Non-local potential forces ***************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.77465432  -0.04369933  -0.02340446 *
*    H       2      0.00000000   0.00000000   0.00000000 *
*    H       3      0.00000000   0.00000000   0.00000000 *
*                                                        *
**********************************************************
TOTAL:              0.77465432  -0.04369933  -0.02340446
 
********************* Unconstrained **********************
************ NGWF non self-consistent forces *************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1      0.00318035  -0.00049822  -0.00280922 *
*    H       2      0.00008433   0.00056645  -0.00097084 *
*    H       3      0.00007286  -0.00062573   0.00078527 *
*                                                        *
**********************************************************
TOTAL:              0.00333753  -0.00055750  -0.00299479
 
********************* Unconstrained **********************
****** Correction to ensure the total force is zero ******
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.00770310   0.00131342   0.00866411 *
*    H       2     -0.00770310   0.00131342   0.00866411 *
*    H       3     -0.00770310   0.00131342   0.00866411 *
*                                                        *
**********************************************************
TOTAL:             -0.02310931   0.00394025   0.02599232

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    O       1     -0.01947328   0.00077154   0.01618000 *
*    H       2      0.00862962  -0.01003507  -0.00005514 *
*    H       3      0.01084366   0.00926353  -0.01612486 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000   0.00000000 *
**********************************************************

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    8074.047s on      1 node(s)                                    
TOTAL TIME:      8074.047s on      1 node(s)                                    
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| work_imbalance                       :     1        0.00s   0.000%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.000%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.00s   0.000%  ------ ||
|| sparse_init                          :     1        0.00s   0.000%  ------ ||
|| eigenstates_calculate                :     1        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :   121        0.01s   0.000%  ------ ||
|| restart_kernel_write                 :    63        0.01s   0.000%  ------ ||
|| ngwf_gradient_coeffs                 :    61        0.02s   0.000%  ------ ||
|| basis_extract_function_from_box      :  1464        0.03s   0.000%  ------ ||
|| restart_ngwfs_tightbox_output        :    60        0.04s   0.000%  ------ ||
|| sparse_hotelling_invert              :   121        0.04s   0.001%  ------ ||
|| integrals_brappd_ketppd              :   121        0.05s   0.001%  ------ ||
|| integrals_grad                       :     1        0.07s   0.001%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.07s   0.001%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.10s   0.001%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.10s   0.001%  ------ ||
|| kernel_purify                        :  1971        0.11s   0.001%  ------ ||
|| kernel_fix                           :   610        0.13s   0.002%  ------ ||
|| lnv_gradient_norm                    :   610        0.14s   0.002%  ------ ||
|| sparse_trace                         : 15340        0.18s   0.002%  ------ ||
|| sparse_product                       : 20258        0.33s   0.004%  ------ ||
|| pseudo_make_structure_factor         :     1        0.50s   0.006%  ------ ||
|| density_initial_guess_real           :     1        0.58s   0.007%  ------ ||
|| integrals_locpot_mat_els_batch       :   641        1.04s   0.013%  ------ ||
|| basis_dot_function_with_box          : 106.3k       1.11s   0.014%  ------ ||
|| pseudo_local_calculate_forces        :     1        1.84s   0.023%  ------ ||
|| pseudopotentials_local_on_grid       :     1        1.86s   0.023%  ------ ||
|| density_batch_row_sums               :  1322        2.10s   0.026%  ------ ||
|| basis_add_function_to_box            : 225.5k       2.27s   0.028%  ------ ||
|| forces_calculate                     :     1        2.28s   0.028%  ------ ||
|| basis_copy_function_to_box           : 25740        3.76s   0.047%  ------ ||
|| projectors_func_ovlp_box             :   121        3.78s   0.047%  ------ ||
|| projectors_init_fftbox_recip         :   185        3.80s   0.047%  ------ ||
|| integrals_kinetic                    :   121        4.47s   0.055%  ------ ||
|| fourier_apply_box_pair               :  2196        5.13s   0.064%   6.173 ||
|| properties_calculate                 :     1        5.73s   0.071%  ------ ||
|| projectors_gradient_batch            :    61        8.67s   0.107%  ------ ||
|| cell_grid_extract_box                :  8546        9.15s   0.113%  ------ ||
|| cell_grid_deposit_box                : 15867       18.13s   0.225%  ------ ||
|| density_fftbox_deposit_to_cell       : 15864       18.20s   0.225%  ------ ||
|| ngwf_gradient_batch                  :    61       53.00s   0.656%  ------ ||
|| ngwf_gradient_lnv                    :    61       56.16s   0.696%  ------ ||
|| hamiltonian_energy_components        :    13       84.19s   1.043%  ------ ||
|| penalty_denskernel_optimise_cg       :     1       85.81s   1.063%  ------ ||
|| potential_apply_to_ngwf_batch        :   641      208.51s   2.582%  ------ ||
|| integrals_locpot_dbl_grid            :   641      209.58s   2.596%  ------ ||
|| density_fftbox_interpolate_multiply  : 15864      395.91s   4.904%  ------ ||
|| fourier_apply_box                    : 53352      415.69s   5.148%   9.132 ||
|| density_batch_interp_deposit         :  1322      418.70s   5.186%  ------ ||
|| density_on_dbl_grid                  :  1322      448.36s   5.553%  ------ ||
|| hartree_on_grid                      :  1322     1054.74s  13.063%  ------ ||
|| fourier_apply_cell_backward          :  6611     2009.57s  24.889%   3.670 ||
|| fourier_apply_cell_forward           :  6611     3143.69s  38.936%   2.346 ||
|| xc_energy_potential                  :  1322     6056.64s  75.014%  ------ ||
|| lnv_denskernel_optimise_cg           :    61     7464.72s  92.453%  ------ ||
|| ngwf_cg_optimise                     :     1     7964.83s  98.647%  ------ ||
|| total_time                           :     1     8074.05s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 0 ms printing in order.

Job completed: 10-03-2015 01:26 (-0000)

